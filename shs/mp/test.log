nohup: ignoring input
2025-04-24 11:46:49.206659: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-24 11:46:49.413431: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-24 11:46:49.418736: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 11:46:49.418758: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2025-04-24 11:46:53.140376: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 11:46:53.140884: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 11:46:53.140901: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
torch 2.3.1+cu121
transformers 4.47.1
accelerate 0.29.1
# of gpus:  2
loading llm model /h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  3.90it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.57it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.45it/s]
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
model.embed_tokens.weight torch.Size([32000, 4096])
model.layers.0.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.0.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.0.input_layernorm.weight torch.Size([4096])
model.layers.0.post_attention_layernorm.weight torch.Size([4096])
model.layers.1.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.1.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.1.input_layernorm.weight torch.Size([4096])
model.layers.1.post_attention_layernorm.weight torch.Size([4096])
model.layers.2.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.2.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.2.input_layernorm.weight torch.Size([4096])
model.layers.2.post_attention_layernorm.weight torch.Size([4096])
model.layers.3.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.3.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.3.input_layernorm.weight torch.Size([4096])
model.layers.3.post_attention_layernorm.weight torch.Size([4096])
model.layers.4.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.4.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.4.input_layernorm.weight torch.Size([4096])
model.layers.4.post_attention_layernorm.weight torch.Size([4096])
model.layers.5.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.5.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.5.input_layernorm.weight torch.Size([4096])
model.layers.5.post_attention_layernorm.weight torch.Size([4096])
model.layers.6.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.6.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.6.input_layernorm.weight torch.Size([4096])
model.layers.6.post_attention_layernorm.weight torch.Size([4096])
model.layers.7.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.7.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.7.input_layernorm.weight torch.Size([4096])
model.layers.7.post_attention_layernorm.weight torch.Size([4096])
model.layers.8.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.8.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.8.input_layernorm.weight torch.Size([4096])
model.layers.8.post_attention_layernorm.weight torch.Size([4096])
model.layers.9.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.9.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.9.input_layernorm.weight torch.Size([4096])
model.layers.9.post_attention_layernorm.weight torch.Size([4096])
model.layers.10.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.10.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.10.input_layernorm.weight torch.Size([4096])
model.layers.10.post_attention_layernorm.weight torch.Size([4096])
model.layers.11.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.11.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.11.input_layernorm.weight torch.Size([4096])
model.layers.11.post_attention_layernorm.weight torch.Size([4096])
model.layers.12.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.12.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.12.input_layernorm.weight torch.Size([4096])
model.layers.12.post_attention_layernorm.weight torch.Size([4096])
model.layers.13.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.13.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.13.input_layernorm.weight torch.Size([4096])
model.layers.13.post_attention_layernorm.weight torch.Size([4096])
model.layers.14.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.14.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.14.input_layernorm.weight torch.Size([4096])
model.layers.14.post_attention_layernorm.weight torch.Size([4096])
model.layers.15.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.15.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.15.input_layernorm.weight torch.Size([4096])
model.layers.15.post_attention_layernorm.weight torch.Size([4096])
model.layers.16.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.16.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.16.input_layernorm.weight torch.Size([4096])
model.layers.16.post_attention_layernorm.weight torch.Size([4096])
model.layers.17.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.17.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.17.input_layernorm.weight torch.Size([4096])
model.layers.17.post_attention_layernorm.weight torch.Size([4096])
model.layers.18.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.18.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.18.input_layernorm.weight torch.Size([4096])
model.layers.18.post_attention_layernorm.weight torch.Size([4096])
model.layers.19.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.19.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.19.input_layernorm.weight torch.Size([4096])
model.layers.19.post_attention_layernorm.weight torch.Size([4096])
model.layers.20.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.20.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.20.input_layernorm.weight torch.Size([4096])
model.layers.20.post_attention_layernorm.weight torch.Size([4096])
model.layers.21.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.21.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.21.input_layernorm.weight torch.Size([4096])
model.layers.21.post_attention_layernorm.weight torch.Size([4096])
model.layers.22.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.22.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.22.input_layernorm.weight torch.Size([4096])
model.layers.22.post_attention_layernorm.weight torch.Size([4096])
model.layers.23.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.23.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.23.input_layernorm.weight torch.Size([4096])
model.layers.23.post_attention_layernorm.weight torch.Size([4096])
model.layers.24.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.24.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.24.input_layernorm.weight torch.Size([4096])
model.layers.24.post_attention_layernorm.weight torch.Size([4096])
model.layers.25.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.25.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.25.input_layernorm.weight torch.Size([4096])
model.layers.25.post_attention_layernorm.weight torch.Size([4096])
model.layers.26.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.26.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.26.input_layernorm.weight torch.Size([4096])
model.layers.26.post_attention_layernorm.weight torch.Size([4096])
model.layers.27.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.27.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.27.input_layernorm.weight torch.Size([4096])
model.layers.27.post_attention_layernorm.weight torch.Size([4096])
model.layers.28.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.28.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.28.input_layernorm.weight torch.Size([4096])
model.layers.28.post_attention_layernorm.weight torch.Size([4096])
model.layers.29.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.29.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.29.input_layernorm.weight torch.Size([4096])
model.layers.29.post_attention_layernorm.weight torch.Size([4096])
model.layers.30.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.30.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.30.input_layernorm.weight torch.Size([4096])
model.layers.30.post_attention_layernorm.weight torch.Size([4096])
model.layers.31.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.31.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.31.input_layernorm.weight torch.Size([4096])
model.layers.31.post_attention_layernorm.weight torch.Size([4096])
model.norm.weight torch.Size([4096])
lm_head.weight torch.Size([32000, 4096])
use device  cpu
loading calibdation data
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<03:19,  1.28it/s]  1%|          | 2/256 [00:01<03:12,  1.32it/s]  2%|▏         | 4/256 [00:01<01:36,  2.60it/s]  2%|▏         | 5/256 [00:02<01:53,  2.21it/s]  2%|▏         | 6/256 [00:02<01:32,  2.71it/s]  3%|▎         | 7/256 [00:03<02:12,  1.88it/s]  3%|▎         | 8/256 [00:03<01:41,  2.46it/s]  4%|▎         | 9/256 [00:03<01:17,  3.17it/s]  4%|▍         | 11/256 [00:03<00:50,  4.82it/s]  5%|▍         | 12/256 [00:04<00:45,  5.34it/s]  5%|▌         | 13/256 [00:04<01:30,  2.68it/s]  5%|▌         | 14/256 [00:05<01:29,  2.72it/s]  6%|▌         | 15/256 [00:05<01:15,  3.20it/s]  6%|▋         | 16/256 [00:05<01:06,  3.63it/s]  7%|▋         | 18/256 [00:06<01:07,  3.51it/s]  8%|▊         | 20/256 [00:06<00:50,  4.66it/s]  8%|▊         | 21/256 [00:06<00:44,  5.26it/s]  9%|▊         | 22/256 [00:06<00:47,  4.91it/s]  9%|▉         | 24/256 [00:07<00:41,  5.63it/s] 10%|▉         | 25/256 [00:07<00:39,  5.90it/s] 10%|█         | 26/256 [00:07<00:51,  4.45it/s] 11%|█         | 28/256 [00:07<00:42,  5.32it/s] 11%|█▏        | 29/256 [00:08<00:44,  5.13it/s] 12%|█▏        | 31/256 [00:08<00:37,  5.97it/s] 12%|█▎        | 32/256 [00:08<00:46,  4.84it/s] 13%|█▎        | 33/256 [00:09<00:57,  3.86it/s] 13%|█▎        | 34/256 [00:09<01:01,  3.60it/s] 14%|█▎        | 35/256 [00:09<01:08,  3.22it/s] 14%|█▍        | 36/256 [00:10<01:18,  2.80it/s] 14%|█▍        | 37/256 [00:10<01:12,  3.01it/s] 15%|█▍        | 38/256 [00:10<01:07,  3.24it/s] 16%|█▌        | 40/256 [00:11<01:03,  3.41it/s] 16%|█▋        | 42/256 [00:11<00:44,  4.77it/s] 17%|█▋        | 43/256 [00:11<00:39,  5.34it/s] 17%|█▋        | 44/256 [00:11<00:38,  5.44it/s] 18%|█▊        | 46/256 [00:12<00:33,  6.35it/s] 18%|█▊        | 47/256 [00:12<00:34,  6.07it/s] 19%|█▉        | 48/256 [00:12<00:37,  5.54it/s] 19%|█▉        | 49/256 [00:12<00:33,  6.09it/s] 20%|█▉        | 50/256 [00:13<00:49,  4.12it/s] 20%|██        | 52/256 [00:13<00:32,  6.20it/s] 21%|██        | 53/256 [00:13<00:55,  3.69it/s] 21%|██        | 54/256 [00:14<00:52,  3.85it/s] 21%|██▏       | 55/256 [00:14<00:43,  4.58it/s] 22%|██▏       | 56/256 [00:14<00:51,  3.91it/s] 22%|██▏       | 57/256 [00:14<00:45,  4.33it/s] 23%|██▎       | 58/256 [00:14<00:50,  3.93it/s] 23%|██▎       | 59/256 [00:15<00:43,  4.50it/s] 23%|██▎       | 60/256 [00:15<00:46,  4.20it/s] 24%|██▍       | 61/256 [00:15<00:53,  3.62it/s] 24%|██▍       | 62/256 [00:16<00:58,  3.30it/s] 25%|██▍       | 63/256 [00:16<00:50,  3.79it/s] 25%|██▌       | 64/256 [00:16<00:41,  4.59it/s] 25%|██▌       | 65/256 [00:17<01:07,  2.82it/s] 26%|██▌       | 67/256 [00:17<00:44,  4.27it/s] 27%|██▋       | 68/256 [00:17<00:43,  4.33it/s] 27%|██▋       | 69/256 [00:17<00:43,  4.26it/s] 28%|██▊       | 71/256 [00:17<00:33,  5.50it/s] 29%|██▊       | 73/256 [00:18<00:27,  6.77it/s] 29%|██▉       | 74/256 [00:18<00:26,  6.75it/s] 29%|██▉       | 75/256 [00:18<00:31,  5.68it/s] 30%|██▉       | 76/256 [00:19<00:44,  4.07it/s] 30%|███       | 78/256 [00:19<00:30,  5.90it/s] 31%|███       | 79/256 [00:19<00:37,  4.70it/s] 31%|███▏      | 80/256 [00:19<00:47,  3.67it/s] 32%|███▏      | 81/256 [00:20<00:52,  3.32it/s] 32%|███▏      | 82/256 [00:20<00:43,  3.99it/s] 32%|███▏      | 83/256 [00:20<00:53,  3.24it/s] 33%|███▎      | 84/256 [00:21<00:50,  3.39it/s] 33%|███▎      | 85/256 [00:21<00:47,  3.60it/s] 34%|███▎      | 86/256 [00:21<00:43,  3.95it/s] 34%|███▍      | 87/256 [00:22<01:00,  2.81it/s] 34%|███▍      | 88/256 [00:22<01:02,  2.70it/s] 35%|███▍      | 89/256 [00:22<00:57,  2.92it/s] 35%|███▌      | 90/256 [00:23<00:57,  2.87it/s] 36%|███▌      | 91/256 [00:23<00:56,  2.91it/s] 36%|███▌      | 92/256 [00:23<00:47,  3.44it/s] 36%|███▋      | 93/256 [00:23<00:41,  3.91it/s] 37%|███▋      | 94/256 [00:24<00:49,  3.25it/s] 37%|███▋      | 95/256 [00:24<01:03,  2.54it/s] 38%|███▊      | 96/256 [00:25<00:50,  3.17it/s] 38%|███▊      | 97/256 [00:25<00:54,  2.90it/s] 38%|███▊      | 98/256 [00:25<00:45,  3.46it/s] 39%|███▊      | 99/256 [00:25<00:43,  3.57it/s] 39%|███▉      | 100/256 [00:26<00:41,  3.73it/s] 39%|███▉      | 101/256 [00:27<01:14,  2.09it/s] 40%|███▉      | 102/256 [00:27<01:03,  2.42it/s] 41%|████      | 104/256 [00:27<00:40,  3.74it/s] 41%|████▏     | 106/256 [00:27<00:33,  4.49it/s] 42%|████▏     | 107/256 [00:28<00:33,  4.48it/s] 42%|████▏     | 108/256 [00:28<00:47,  3.12it/s] 43%|████▎     | 111/256 [00:29<00:29,  4.84it/s] 44%|████▍     | 112/256 [00:29<00:32,  4.48it/s] 44%|████▍     | 113/256 [00:29<00:32,  4.42it/s] 45%|████▍     | 114/256 [00:29<00:29,  4.75it/s] 45%|████▍     | 115/256 [00:29<00:28,  5.03it/s] 45%|████▌     | 116/256 [00:30<00:38,  3.63it/s] 46%|████▌     | 118/256 [00:30<00:29,  4.64it/s] 47%|████▋     | 120/256 [00:30<00:22,  6.14it/s] 47%|████▋     | 121/256 [00:30<00:20,  6.51it/s] 48%|████▊     | 122/256 [00:31<00:35,  3.72it/s] 48%|████▊     | 123/256 [00:31<00:38,  3.41it/s] 48%|████▊     | 124/256 [00:32<00:50,  2.60it/s] 49%|████▉     | 125/256 [00:33<01:20,  1.63it/s] 49%|████▉     | 126/256 [00:34<01:07,  1.92it/s] 50%|████▉     | 127/256 [00:34<01:13,  1.75it/s] 50%|█████     | 129/256 [00:34<00:44,  2.84it/s] 51%|█████     | 130/256 [00:35<00:40,  3.09it/s] 51%|█████     | 131/256 [00:35<00:38,  3.27it/s] 52%|█████▏    | 132/256 [00:35<00:36,  3.35it/s] 52%|█████▏    | 133/256 [00:36<00:45,  2.71it/s] 52%|█████▏    | 134/256 [00:36<00:44,  2.73it/s] 53%|█████▎    | 135/256 [00:36<00:35,  3.36it/s] 53%|█████▎    | 136/256 [00:37<00:35,  3.35it/s] 54%|█████▎    | 137/256 [00:37<00:29,  3.97it/s] 54%|█████▍    | 138/256 [00:37<00:26,  4.46it/s] 54%|█████▍    | 139/256 [00:37<00:24,  4.79it/s] 55%|█████▍    | 140/256 [00:37<00:22,  5.17it/s] 55%|█████▌    | 142/256 [00:37<00:16,  6.73it/s] 56%|█████▌    | 143/256 [00:37<00:16,  6.95it/s] 57%|█████▋    | 145/256 [00:39<00:34,  3.21it/s] 57%|█████▋    | 146/256 [00:39<00:38,  2.88it/s] 57%|█████▋    | 147/256 [00:39<00:35,  3.10it/s] 58%|█████▊    | 148/256 [00:40<00:35,  3.00it/s] 59%|█████▊    | 150/256 [00:40<00:28,  3.69it/s] 59%|█████▉    | 151/256 [00:40<00:24,  4.27it/s] 59%|█████▉    | 152/256 [00:41<00:27,  3.74it/s] 60%|█████▉    | 153/256 [00:41<00:24,  4.15it/s] 60%|██████    | 154/256 [00:41<00:29,  3.46it/s] 61%|██████    | 155/256 [00:41<00:26,  3.83it/s] 61%|██████    | 156/256 [00:41<00:21,  4.56it/s] 61%|██████▏   | 157/256 [00:42<00:27,  3.65it/s] 62%|██████▏   | 158/256 [00:42<00:23,  4.17it/s] 62%|██████▏   | 159/256 [00:43<00:41,  2.34it/s] 62%|██████▎   | 160/256 [00:43<00:32,  3.00it/s] 63%|██████▎   | 162/256 [00:44<00:36,  2.59it/s] 64%|██████▎   | 163/256 [00:44<00:32,  2.90it/s] 64%|██████▍   | 164/256 [00:44<00:26,  3.46it/s] 65%|██████▍   | 166/256 [00:45<00:22,  4.04it/s] 65%|██████▌   | 167/256 [00:45<00:25,  3.55it/s] 66%|██████▌   | 168/256 [00:45<00:28,  3.14it/s] 66%|██████▌   | 169/256 [00:46<00:31,  2.75it/s] 66%|██████▋   | 170/256 [00:46<00:31,  2.76it/s] 67%|██████▋   | 172/256 [00:47<00:21,  3.85it/s] 68%|██████▊   | 173/256 [00:47<00:21,  3.95it/s] 68%|██████▊   | 174/256 [00:47<00:28,  2.83it/s] 68%|██████▊   | 175/256 [00:48<00:41,  1.96it/s] 69%|██████▉   | 176/256 [00:49<00:35,  2.23it/s] 69%|██████▉   | 177/256 [00:49<00:29,  2.69it/s] 70%|██████▉   | 179/256 [00:49<00:20,  3.78it/s] 70%|███████   | 180/256 [00:50<00:38,  1.98it/s] 71%|███████   | 181/256 [00:50<00:30,  2.47it/s] 71%|███████   | 182/256 [00:51<00:38,  1.94it/s] 72%|███████▏  | 184/256 [00:52<00:34,  2.06it/s] 73%|███████▎  | 186/256 [00:52<00:23,  2.96it/s] 73%|███████▎  | 187/256 [00:53<00:27,  2.54it/s] 73%|███████▎  | 188/256 [00:53<00:23,  2.84it/s] 74%|███████▍  | 189/256 [00:53<00:23,  2.90it/s] 74%|███████▍  | 190/256 [00:54<00:21,  3.14it/s] 75%|███████▍  | 191/256 [00:54<00:18,  3.45it/s] 75%|███████▌  | 192/256 [00:54<00:21,  2.94it/s] 75%|███████▌  | 193/256 [00:55<00:20,  3.06it/s] 77%|███████▋  | 196/256 [00:55<00:13,  4.60it/s] 77%|███████▋  | 197/256 [00:55<00:14,  3.95it/s] 78%|███████▊  | 199/256 [00:56<00:11,  5.01it/s] 79%|███████▊  | 201/256 [00:56<00:09,  5.65it/s] 79%|███████▉  | 202/256 [00:56<00:11,  4.67it/s] 80%|███████▉  | 204/256 [00:57<00:08,  5.93it/s] 80%|████████  | 206/256 [00:57<00:06,  7.27it/s] 81%|████████  | 207/256 [00:57<00:06,  7.57it/s] 81%|████████▏ | 208/256 [00:57<00:07,  6.58it/s] 82%|████████▏ | 210/256 [00:57<00:05,  8.33it/s] 82%|████████▏ | 211/256 [00:57<00:05,  8.51it/s] 83%|████████▎ | 212/256 [00:57<00:05,  7.35it/s] 83%|████████▎ | 213/256 [00:58<00:06,  6.71it/s] 84%|████████▎ | 214/256 [00:58<00:08,  5.11it/s] 84%|████████▍ | 215/256 [00:58<00:10,  4.05it/s] 84%|████████▍ | 216/256 [00:59<00:09,  4.05it/s] 85%|████████▌ | 218/256 [00:59<00:07,  4.95it/s] 86%|████████▌ | 219/256 [01:00<00:15,  2.33it/s] 86%|████████▌ | 220/256 [01:00<00:13,  2.75it/s] 86%|████████▋ | 221/256 [01:01<00:13,  2.68it/s] 87%|████████▋ | 222/256 [01:01<00:12,  2.65it/s] 87%|████████▋ | 223/256 [01:01<00:13,  2.49it/s] 88%|████████▊ | 224/256 [01:03<00:26,  1.23it/s] 88%|████████▊ | 225/256 [01:04<00:23,  1.30it/s] 88%|████████▊ | 226/256 [01:04<00:17,  1.69it/s] 89%|████████▊ | 227/256 [01:04<00:14,  2.04it/s] 89%|████████▉ | 228/256 [01:05<00:12,  2.21it/s] 89%|████████▉ | 229/256 [01:06<00:19,  1.41it/s] 90%|████████▉ | 230/256 [01:06<00:13,  1.88it/s] 90%|█████████ | 231/256 [01:07<00:12,  1.95it/s] 91%|█████████ | 232/256 [01:07<00:10,  2.23it/s] 91%|█████████ | 233/256 [01:07<00:08,  2.71it/s] 92%|█████████▏| 235/256 [01:07<00:05,  3.78it/s] 92%|█████████▏| 236/256 [01:08<00:05,  3.67it/s] 93%|█████████▎| 237/256 [01:08<00:04,  3.98it/s] 93%|█████████▎| 238/256 [01:08<00:03,  4.62it/s] 93%|█████████▎| 239/256 [01:08<00:03,  4.45it/s] 94%|█████████▍| 241/256 [01:08<00:02,  5.75it/s] 95%|█████████▍| 242/256 [01:09<00:04,  2.83it/s] 95%|█████████▌| 244/256 [01:09<00:02,  4.33it/s] 96%|█████████▌| 245/256 [01:10<00:02,  4.30it/s] 96%|█████████▌| 246/256 [01:10<00:02,  4.79it/s] 97%|█████████▋| 248/256 [01:10<00:01,  6.52it/s] 97%|█████████▋| 249/256 [01:11<00:01,  3.98it/s] 98%|█████████▊| 251/256 [01:11<00:00,  5.56it/s] 98%|█████████▊| 252/256 [01:11<00:01,  3.52it/s] 99%|█████████▉| 253/256 [01:12<00:01,  2.94it/s]100%|█████████▉| 255/256 [01:13<00:00,  3.09it/s]100%|██████████| 256/256 [01:13<00:00,  3.18it/s]100%|██████████| 256/256 [01:13<00:00,  3.49it/s]
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
dataset loading complete
pruning layer 0 name self_attn.q_proj
Validation after prune:
out_inf: tensor(7.8555, device='cuda:0', dtype=torch.float16) tensor(0.6099, device='cuda:0', dtype=torch.float16)
tensor(0.2046, device='cuda:0', dtype=torch.float16) tensor(0.0040, device='cuda:0', dtype=torch.float16)
tensor(0.2046, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.2046, device='cuda:0', dtype=torch.float16) tensor(0.0040, device='cuda:0', dtype=torch.float16)
tensor(0.2046, device='cuda:0', dtype=torch.float16) tensor(0.0040, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.k_proj
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.2725, device='cuda:0', dtype=torch.float16) tensor(0.0060, device='cuda:0', dtype=torch.float16)
tensor(0.2725, device='cuda:0', dtype=torch.float16) tensor(0.0061, device='cuda:0', dtype=torch.float16)
tensor(0.2725, device='cuda:0', dtype=torch.float16) tensor(0.0060, device='cuda:0', dtype=torch.float16)
tensor(0.2725, device='cuda:0', dtype=torch.float16) tensor(0.0061, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.v_proj
Validation after prune:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.1890, device='cuda:0', dtype=torch.float16) tensor(0.0049, device='cuda:0', dtype=torch.float16)
tensor(0.1890, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.1890, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
tensor(0.1890, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.0337, device='cuda:0')
old_score: tensor(0.0050, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0019, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 33.13528561592102
Validation after dual ascent:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.1851, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
tensor(0.1646, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
tensor(0.3931, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.2771, device='cuda:0', dtype=torch.float16) tensor(0.0019, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0145, device='cuda:0', dtype=torch.float16) tensor(0.0006, device='cuda:0', dtype=torch.float16)
tensor(0.0157, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0135, device='cuda:0', dtype=torch.float16) tensor(0.0006, device='cuda:0', dtype=torch.float16)
tensor(0.0104, device='cuda:0', dtype=torch.float16) tensor(0.0006, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0111, device='cuda:0')
tensor(0.0240, device='cuda:0')
old_score: tensor(0.0006, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0001, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.088555335998535
Validation after dual ascent:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0070, device='cuda:0', dtype=torch.float16) tensor(0.0001, device='cuda:0', dtype=torch.float16)
tensor(0.0055, device='cuda:0', dtype=torch.float16) tensor(0.0001, device='cuda:0', dtype=torch.float16)
tensor(0.0072, device='cuda:0', dtype=torch.float16) tensor(0.0001, device='cuda:0', dtype=torch.float16)
tensor(0.0083, device='cuda:0', dtype=torch.float16) tensor(0.0001, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.gate_proj
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.4053, device='cuda:0', dtype=torch.float16) tensor(0.0160, device='cuda:0', dtype=torch.float16)
tensor(0.3906, device='cuda:0', dtype=torch.float16) tensor(0.0165, device='cuda:0', dtype=torch.float16)
tensor(0.4473, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
tensor(0.4619, device='cuda:0', dtype=torch.float16) tensor(0.0162, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0192, device='cuda:0')
tensor(0.0176, device='cuda:0')
old_score: tensor(0.0164, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0063, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 42.940568923950195
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.2725, device='cuda:0', dtype=torch.float16) tensor(0.0061, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
tensor(0.2727, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.3257, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.up_proj
Validation after prune:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.1494, device='cuda:0', dtype=torch.float16) tensor(0.0130, device='cuda:0', dtype=torch.float16)
tensor(0.1592, device='cuda:0', dtype=torch.float16) tensor(0.0133, device='cuda:0', dtype=torch.float16)
tensor(0.1846, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.1602, device='cuda:0', dtype=torch.float16) tensor(0.0130, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0183, device='cuda:0')
tensor(0.0170, device='cuda:0')
old_score: tensor(0.0134, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0061, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 42.53157687187195
Validation after dual ascent:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.1118, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
tensor(0.1133, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.1187, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.1357, device='cuda:0', dtype=torch.float16) tensor(0.0061, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0675, device='cuda:0', dtype=torch.float16) tensor(0.0021, device='cuda:0', dtype=torch.float16)
tensor(0.0693, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0922, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
tensor(0.0592, device='cuda:0', dtype=torch.float16) tensor(0.0021, device='cuda:0', dtype=torch.float16)
tensor(0.0676, device='cuda:0')
old_score: tensor(0.0022, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0013, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 212.84004712104797
Validation after dual ascent:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0351, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
tensor(0.0449, device='cuda:0', dtype=torch.float16) tensor(0.0013, device='cuda:0', dtype=torch.float16)
tensor(0.0445, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0344, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.q_proj
Validation after prune:
out_inf: tensor(9.2734, device='cuda:0', dtype=torch.float16) tensor(0.7656, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.0538, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.0541, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
tensor(1.1377, device='cuda:0', dtype=torch.float16) tensor(0.0537, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.k_proj
Validation after prune:
out_inf: tensor(7.5977, device='cuda:0', dtype=torch.float16) tensor(0.7695, device='cuda:0', dtype=torch.float16)
tensor(1.1104, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
tensor(1.0723, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(1.0791, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(1.1445, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.v_proj
Validation after prune:
out_inf: tensor(1.5332, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.2563, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.2490, device='cuda:0', dtype=torch.float16) tensor(0.0153, device='cuda:0', dtype=torch.float16)
tensor(0.3594, device='cuda:0', dtype=torch.float16) tensor(0.0149, device='cuda:0', dtype=torch.float16)
tensor(0.3037, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0192, device='cuda:0')
tensor(0.0260, device='cuda:0')
old_score: tensor(0.0150, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0065, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 18.275015115737915
Validation after dual ascent:
out_inf: tensor(1.5332, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.4365, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.4424, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.4612, device='cuda:0', dtype=torch.float16) tensor(0.0071, device='cuda:0', dtype=torch.float16)
tensor(0.4248, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.5444, device='cuda:0', dtype=torch.float16) tensor(0.0099, device='cuda:0', dtype=torch.float16)
tensor(0.0300, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0223, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0326, device='cuda:0', dtype=torch.float16) tensor(0.0017, device='cuda:0', dtype=torch.float16)
tensor(0.0341, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0192, device='cuda:0')
tensor(0.0391, device='cuda:0')
old_score: tensor(0.0016, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0007, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.124581336975098
Validation after dual ascent:
out_inf: tensor(0.5444, device='cuda:0', dtype=torch.float16) tensor(0.0099, device='cuda:0', dtype=torch.float16)
tensor(0.0170, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0154, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0149, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
tensor(0.0186, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.gate_proj
Validation after prune:
out_inf: tensor(42.9375, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(3.5000, device='cuda:0', dtype=torch.float16) tensor(0.0290, device='cuda:0', dtype=torch.float16)
tensor(3.3750, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(3.1250, device='cuda:0', dtype=torch.float16) tensor(0.0302, device='cuda:0', dtype=torch.float16)
tensor(3.6562, device='cuda:0', dtype=torch.float16) tensor(0.0294, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0172, device='cuda:0')
tensor(0.0224, device='cuda:0')
old_score: tensor(0.0295, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0141, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.739973068237305
Validation after dual ascent:
out_inf: tensor(42.9375, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.0138, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.0136, device='cuda:0', dtype=torch.float16)
tensor(0.9961, device='cuda:0', dtype=torch.float16) tensor(0.0149, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.0140, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.up_proj
Validation after prune:
out_inf: tensor(37.2500, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(2.1875, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(2.0625, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0124, device='cuda:0')
tensor(0.0182, device='cuda:0')
old_score: tensor(0.0232, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0132, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.74923300743103
Validation after dual ascent:
out_inf: tensor(37.2500, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.5625, device='cuda:0', dtype=torch.float16) tensor(0.0129, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.7969, device='cuda:0', dtype=torch.float16) tensor(0.0140, device='cuda:0', dtype=torch.float16)
tensor(0.8594, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.down_proj
Validation after prune:
out_inf: tensor(2602., device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(27.7188, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
tensor(27.3438, device='cuda:0', dtype=torch.float16) tensor(0.0047, device='cuda:0', dtype=torch.float16)
tensor(24.6875, device='cuda:0', dtype=torch.float16) tensor(0.0054, device='cuda:0', dtype=torch.float16)
tensor(27.8594, device='cuda:0', dtype=torch.float16) tensor(0.0048, device='cuda:0', dtype=torch.float16)
tensor(0.2333, device='cuda:0')
old_score: tensor(0.0050, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0083, device='cuda:0', dtype=torch.float16)
Not converged!
Dual ascent finished!
Time: 213.00020670890808
Validation after dual ascent:
out_inf: tensor(2602., device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(27.7188, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
tensor(27.3438, device='cuda:0', dtype=torch.float16) tensor(0.0047, device='cuda:0', dtype=torch.float16)
tensor(24.6875, device='cuda:0', dtype=torch.float16) tensor(0.0054, device='cuda:0', dtype=torch.float16)
tensor(27.8594, device='cuda:0', dtype=torch.float16) tensor(0.0048, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.q_proj
Validation after prune:
out_inf: tensor(11.8438, device='cuda:0', dtype=torch.float16) tensor(0.8818, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1180, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.1163, device='cuda:0', dtype=torch.float16)
tensor(1.5273, device='cuda:0', dtype=torch.float16) tensor(0.1182, device='cuda:0', dtype=torch.float16)
tensor(0.1172, device='cuda:0')
old_score: tensor(0.1178, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0391, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.42905592918396
Validation after dual ascent:
out_inf: tensor(11.8438, device='cuda:0', dtype=torch.float16) tensor(0.8818, device='cuda:0', dtype=torch.float16)
tensor(0.8193, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.8940, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.7158, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
tensor(0.6987, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.k_proj
Validation after prune:
out_inf: tensor(13.3047, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(1.8555, device='cuda:0', dtype=torch.float16) tensor(0.1178, device='cuda:0', dtype=torch.float16)
tensor(1.7852, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
tensor(1.5332, device='cuda:0', dtype=torch.float16) tensor(0.1161, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1168, device='cuda:0', dtype=torch.float16)
tensor(0.0815, device='cuda:0')
old_score: tensor(0.1169, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0398, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.38140296936035
Validation after dual ascent:
out_inf: tensor(13.3047, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.0389, device='cuda:0', dtype=torch.float16)
tensor(0.8423, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0395, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(0.4766, device='cuda:0', dtype=torch.float16) tensor(0.0452, device='cuda:0', dtype=torch.float16)
tensor(0.5156, device='cuda:0', dtype=torch.float16) tensor(0.0448, device='cuda:0', dtype=torch.float16)
tensor(0.4873, device='cuda:0', dtype=torch.float16) tensor(0.0447, device='cuda:0', dtype=torch.float16)
tensor(0.5161, device='cuda:0', dtype=torch.float16) tensor(0.0450, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0076, device='cuda:0')
tensor(0.0396, device='cuda:0')
old_score: tensor(0.0449, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0228, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.93232798576355
Validation after dual ascent:
out_inf: tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(0.2666, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.3015, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
tensor(0.2998, device='cuda:0', dtype=torch.float16) tensor(0.0244, device='cuda:0', dtype=torch.float16)
tensor(0.2876, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.9082, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1549, device='cuda:0', dtype=torch.float16) tensor(0.0046, device='cuda:0', dtype=torch.float16)
tensor(0.1266, device='cuda:0', dtype=torch.float16) tensor(0.0045, device='cuda:0', dtype=torch.float16)
tensor(0.1323, device='cuda:0', dtype=torch.float16) tensor(0.0052, device='cuda:0', dtype=torch.float16)
tensor(0.1379, device='cuda:0', dtype=torch.float16) tensor(0.0048, device='cuda:0', dtype=torch.float16)
tensor(0.0243, device='cuda:0')
old_score: tensor(0.0048, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0032, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.036676168441772
Validation after dual ascent:
out_inf: tensor(0.9082, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1077, device='cuda:0', dtype=torch.float16) tensor(0.0031, device='cuda:0', dtype=torch.float16)
tensor(0.0959, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.1125, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.1172, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.gate_proj
Validation after prune:
out_inf: tensor(2.4141, device='cuda:0', dtype=torch.float16) tensor(0.1256, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(0.4766, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0157, device='cuda:0')
tensor(0.0174, device='cuda:0')
old_score: tensor(0.0373, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0235, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.886279821395874
Validation after dual ascent:
out_inf: tensor(2.4141, device='cuda:0', dtype=torch.float16) tensor(0.1256, device='cuda:0', dtype=torch.float16)
tensor(0.3286, device='cuda:0', dtype=torch.float16) tensor(0.0235, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0221, device='cuda:0', dtype=torch.float16)
tensor(0.3086, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
tensor(0.3645, device='cuda:0', dtype=torch.float16) tensor(0.0235, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.up_proj
Validation after prune:
out_inf: tensor(2.2363, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
tensor(0.3398, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
tensor(0.3496, device='cuda:0', dtype=torch.float16) tensor(0.0308, device='cuda:0', dtype=torch.float16)
tensor(0.2744, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(0.4004, device='cuda:0', dtype=torch.float16) tensor(0.0315, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0163, device='cuda:0')
tensor(0.0276, device='cuda:0')
old_score: tensor(0.0318, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0217, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.067203998565674
Validation after dual ascent:
out_inf: tensor(2.2363, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
tensor(0.2537, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
tensor(0.2296, device='cuda:0', dtype=torch.float16) tensor(0.0205, device='cuda:0', dtype=torch.float16)
tensor(0.2197, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(0.2371, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.5410, device='cuda:0', dtype=torch.float16) tensor(0.0194, device='cuda:0', dtype=torch.float16)
tensor(0.1077, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.0962, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
tensor(0.1284, device='cuda:0', dtype=torch.float16) tensor(0.0077, device='cuda:0', dtype=torch.float16)
tensor(0.0974, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.0633, device='cuda:0')
old_score: tensor(0.0067, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0054, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 212.88476061820984
Validation after dual ascent:
out_inf: tensor(3.5410, device='cuda:0', dtype=torch.float16) tensor(0.0194, device='cuda:0', dtype=torch.float16)
tensor(0.0800, device='cuda:0', dtype=torch.float16) tensor(0.0053, device='cuda:0', dtype=torch.float16)
tensor(0.0729, device='cuda:0', dtype=torch.float16) tensor(0.0049, device='cuda:0', dtype=torch.float16)
tensor(0.1007, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
tensor(0.0950, device='cuda:0', dtype=torch.float16) tensor(0.0054, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.2500, device='cuda:0', dtype=torch.float16) tensor(0.8525, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.1573, device='cuda:0', dtype=torch.float16)
tensor(1.8086, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
tensor(1.7773, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
tensor(0.1423, device='cuda:0')
old_score: tensor(0.1577, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0775, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 27.64262080192566
Validation after dual ascent:
out_inf: tensor(16.2500, device='cuda:0', dtype=torch.float16) tensor(0.8525, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(1.2549, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.0777, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.k_proj
Validation after prune:
out_inf: tensor(16.3594, device='cuda:0', dtype=torch.float16) tensor(1.0254, device='cuda:0', dtype=torch.float16)
tensor(2.3555, device='cuda:0', dtype=torch.float16) tensor(0.1636, device='cuda:0', dtype=torch.float16)
tensor(2.4258, device='cuda:0', dtype=torch.float16) tensor(0.1638, device='cuda:0', dtype=torch.float16)
tensor(2.1602, device='cuda:0', dtype=torch.float16) tensor(0.1660, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1635, device='cuda:0', dtype=torch.float16)
tensor(0.0701, device='cuda:0')
old_score: tensor(0.1642, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0794, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.82635521888733
Validation after dual ascent:
out_inf: tensor(16.3594, device='cuda:0', dtype=torch.float16) tensor(1.0254, device='cuda:0', dtype=torch.float16)
tensor(1.1260, device='cuda:0', dtype=torch.float16) tensor(0.0778, device='cuda:0', dtype=torch.float16)
tensor(1.2197, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.0796, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.9062, device='cuda:0', dtype=torch.float16) tensor(0.1964, device='cuda:0', dtype=torch.float16)
tensor(0.6079, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.6074, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.6875, device='cuda:0', dtype=torch.float16) tensor(0.0730, device='cuda:0', dtype=torch.float16)
tensor(0.6753, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0082, device='cuda:0')
tensor(0.0878, device='cuda:0')
old_score: tensor(0.0719, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0444, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.53808331489563
Validation after dual ascent:
out_inf: tensor(2.9062, device='cuda:0', dtype=torch.float16) tensor(0.1964, device='cuda:0', dtype=torch.float16)
tensor(0.4885, device='cuda:0', dtype=torch.float16) tensor(0.0438, device='cuda:0', dtype=torch.float16)
tensor(0.4502, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(0.5322, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.4956, device='cuda:0', dtype=torch.float16) tensor(0.0445, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.o_proj
Validation after prune:
out_inf: tensor(1.4785, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
tensor(0.1489, device='cuda:0', dtype=torch.float16) tensor(0.0044, device='cuda:0', dtype=torch.float16)
tensor(0.1758, device='cuda:0', dtype=torch.float16) tensor(0.0053, device='cuda:0', dtype=torch.float16)
tensor(0.1929, device='cuda:0', dtype=torch.float16) tensor(0.0052, device='cuda:0', dtype=torch.float16)
tensor(0.1665, device='cuda:0', dtype=torch.float16) tensor(0.0049, device='cuda:0', dtype=torch.float16)
tensor(0.0223, device='cuda:0')
old_score: tensor(0.0050, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0036, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.817983388900757
Validation after dual ascent:
out_inf: tensor(1.4785, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
tensor(0.1143, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.1411, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(0.1494, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(0.1807, device='cuda:0', dtype=torch.float16) tensor(0.0037, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.3750, device='cuda:0', dtype=torch.float16) tensor(0.1465, device='cuda:0', dtype=torch.float16)
tensor(0.9570, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0478, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
tensor(1.3125, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0163, device='cuda:0')
tensor(0.0234, device='cuda:0')
old_score: tensor(0.0489, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0341, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.87714672088623
Validation after dual ascent:
out_inf: tensor(6.3750, device='cuda:0', dtype=torch.float16) tensor(0.1465, device='cuda:0', dtype=torch.float16)
tensor(0.4907, device='cuda:0', dtype=torch.float16) tensor(0.0333, device='cuda:0', dtype=torch.float16)
tensor(0.5859, device='cuda:0', dtype=torch.float16) tensor(0.0323, device='cuda:0', dtype=torch.float16)
tensor(0.5210, device='cuda:0', dtype=torch.float16) tensor(0.0366, device='cuda:0', dtype=torch.float16)
tensor(0.6099, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.up_proj
Validation after prune:
out_inf: tensor(2.3594, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(0.4102, device='cuda:0', dtype=torch.float16) tensor(0.0417, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0088, device='cuda:0')
tensor(0.0190, device='cuda:0')
old_score: tensor(0.0423, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0315, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.941659688949585
Validation after dual ascent:
out_inf: tensor(2.3594, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(0.3096, device='cuda:0', dtype=torch.float16) tensor(0.0308, device='cuda:0', dtype=torch.float16)
tensor(0.3188, device='cuda:0', dtype=torch.float16) tensor(0.0298, device='cuda:0', dtype=torch.float16)
tensor(0.3235, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.3276, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.3262, device='cuda:0', dtype=torch.float16) tensor(0.0265, device='cuda:0', dtype=torch.float16)
tensor(0.1582, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
tensor(0.1577, device='cuda:0', dtype=torch.float16) tensor(0.0087, device='cuda:0', dtype=torch.float16)
tensor(0.1304, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
tensor(0.1383, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
Converged at iteration 700
tensor(0.0164, device='cuda:0')
tensor(0.0379, device='cuda:0')
old_score: tensor(0.0091, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0077, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 150.6072289943695
Validation after dual ascent:
out_inf: tensor(1.3262, device='cuda:0', dtype=torch.float16) tensor(0.0265, device='cuda:0', dtype=torch.float16)
tensor(0.1069, device='cuda:0', dtype=torch.float16) tensor(0.0076, device='cuda:0', dtype=torch.float16)
tensor(0.1331, device='cuda:0', dtype=torch.float16) tensor(0.0073, device='cuda:0', dtype=torch.float16)
tensor(0.1060, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(0.1016, device='cuda:0', dtype=torch.float16) tensor(0.0079, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.2188, device='cuda:0', dtype=torch.float16) tensor(0.8545, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1583, device='cuda:0', dtype=torch.float16)
tensor(1.7285, device='cuda:0', dtype=torch.float16) tensor(0.1575, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
tensor(1.5684, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
tensor(0.1158, device='cuda:0')
old_score: tensor(0.1580, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0806, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.916181325912476
Validation after dual ascent:
out_inf: tensor(14.2188, device='cuda:0', dtype=torch.float16) tensor(0.8545, device='cuda:0', dtype=torch.float16)
tensor(1.0322, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(1.0371, device='cuda:0', dtype=torch.float16) tensor(0.0778, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.0852, device='cuda:0', dtype=torch.float16)
tensor(1.0410, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.4062, device='cuda:0', dtype=torch.float16) tensor(1.0840, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.1566, device='cuda:0', dtype=torch.float16)
tensor(1.6787, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
tensor(1.7832, device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
tensor(1.8359, device='cuda:0', dtype=torch.float16) tensor(0.1566, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0177, device='cuda:0')
tensor(0.0662, device='cuda:0')
old_score: tensor(0.1567, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0806, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.586286306381226
Validation after dual ascent:
out_inf: tensor(19.4062, device='cuda:0', dtype=torch.float16) tensor(1.0840, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.0777, device='cuda:0', dtype=torch.float16)
tensor(1.0488, device='cuda:0', dtype=torch.float16) tensor(0.0851, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.0812, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.9766, device='cuda:0', dtype=torch.float16) tensor(0.1963, device='cuda:0', dtype=torch.float16)
tensor(0.7432, device='cuda:0', dtype=torch.float16) tensor(0.0730, device='cuda:0', dtype=torch.float16)
tensor(0.6401, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(0.7002, device='cuda:0', dtype=torch.float16) tensor(0.0742, device='cuda:0', dtype=torch.float16)
tensor(0.6758, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0186, device='cuda:0')
tensor(0.1904, device='cuda:0')
old_score: tensor(0.0731, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0481, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.573826551437378
Validation after dual ascent:
out_inf: tensor(2.9766, device='cuda:0', dtype=torch.float16) tensor(0.1963, device='cuda:0', dtype=torch.float16)
tensor(0.4265, device='cuda:0', dtype=torch.float16) tensor(0.0475, device='cuda:0', dtype=torch.float16)
tensor(0.4438, device='cuda:0', dtype=torch.float16) tensor(0.0466, device='cuda:0', dtype=torch.float16)
tensor(0.4551, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.4272, device='cuda:0', dtype=torch.float16) tensor(0.0485, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.o_proj
Validation after prune:
out_inf: tensor(2.4785, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(0.2285, device='cuda:0', dtype=torch.float16) tensor(0.0073, device='cuda:0', dtype=torch.float16)
tensor(0.2148, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(0.2031, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.2524, device='cuda:0', dtype=torch.float16) tensor(0.0077, device='cuda:0', dtype=torch.float16)
tensor(0.0178, device='cuda:0')
old_score: tensor(0.0072, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0054, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.200518131256104
Validation after dual ascent:
out_inf: tensor(2.4785, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(0.1694, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
tensor(0.1982, device='cuda:0', dtype=torch.float16) tensor(0.0053, device='cuda:0', dtype=torch.float16)
tensor(0.1963, device='cuda:0', dtype=torch.float16) tensor(0.0049, device='cuda:0', dtype=torch.float16)
tensor(0.1885, device='cuda:0', dtype=torch.float16) tensor(0.0060, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.1986, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(0.7461, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(0.9648, device='cuda:0', dtype=torch.float16) tensor(0.0623, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.0619, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0070, device='cuda:0')
tensor(0.0206, device='cuda:0')
old_score: tensor(0.0616, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0415, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.343384742736816
Validation after dual ascent:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.1986, device='cuda:0', dtype=torch.float16)
tensor(0.5322, device='cuda:0', dtype=torch.float16) tensor(0.0404, device='cuda:0', dtype=torch.float16)
tensor(0.5762, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0442, device='cuda:0', dtype=torch.float16)
tensor(0.6895, device='cuda:0', dtype=torch.float16) tensor(0.0419, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.0859, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(0.4229, device='cuda:0', dtype=torch.float16) tensor(0.0497, device='cuda:0', dtype=torch.float16)
tensor(0.4375, device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
tensor(0.4358, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.4355, device='cuda:0', dtype=torch.float16) tensor(0.0504, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0068, device='cuda:0')
tensor(0.0186, device='cuda:0')
old_score: tensor(0.0502, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0374, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.565354108810425
Validation after dual ascent:
out_inf: tensor(3.0859, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(0.3984, device='cuda:0', dtype=torch.float16) tensor(0.0364, device='cuda:0', dtype=torch.float16)
tensor(0.3608, device='cuda:0', dtype=torch.float16) tensor(0.0357, device='cuda:0', dtype=torch.float16)
tensor(0.3550, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.3867, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.down_proj
Validation after prune:
out_inf: tensor(7.6289, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.2759, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
tensor(0.3281, device='cuda:0', dtype=torch.float16) tensor(0.0130, device='cuda:0', dtype=torch.float16)
tensor(0.2197, device='cuda:0', dtype=torch.float16) tensor(0.0135, device='cuda:0', dtype=torch.float16)
tensor(0.2920, device='cuda:0', dtype=torch.float16) tensor(0.0136, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0172, device='cuda:0')
tensor(0.0257, device='cuda:0')
old_score: tensor(0.0133, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0112, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 79.00064039230347
Validation after dual ascent:
out_inf: tensor(7.6289, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.1941, device='cuda:0', dtype=torch.float16) tensor(0.0111, device='cuda:0', dtype=torch.float16)
tensor(0.1943, device='cuda:0', dtype=torch.float16) tensor(0.0108, device='cuda:0', dtype=torch.float16)
tensor(0.1927, device='cuda:0', dtype=torch.float16) tensor(0.0112, device='cuda:0', dtype=torch.float16)
tensor(0.1945, device='cuda:0', dtype=torch.float16) tensor(0.0117, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.4141, device='cuda:0', dtype=torch.float16) tensor(0.8418, device='cuda:0', dtype=torch.float16)
tensor(1.4922, device='cuda:0', dtype=torch.float16) tensor(0.1650, device='cuda:0', dtype=torch.float16)
tensor(1.5342, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1633, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1646, device='cuda:0', dtype=torch.float16)
tensor(0.2414, device='cuda:0')
old_score: tensor(0.1643, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0880, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.928497552871704
Validation after dual ascent:
out_inf: tensor(15.4141, device='cuda:0', dtype=torch.float16) tensor(0.8418, device='cuda:0', dtype=torch.float16)
tensor(0.9951, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(1.1582, device='cuda:0'dataset loading complete
pruning layer 0 name self_attn.q_proj
Validation after prune:
out_inf: tensor(7.8555, device='cuda:0', dtype=torch.float16) tensor(0.6099, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.k_proj
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.3340, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.3340, device='cuda:0', dtype=torch.float16) tensor(0.0142, device='cuda:0', dtype=torch.float16)
tensor(0.3284, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.3340, device='cuda:0', dtype=torch.float16) tensor(0.0142, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.v_proj
Validation after prune:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.3101, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.3101, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.3101, device='cuda:0', dtype=torch.float16) tensor(0.0066, device='cuda:0', dtype=torch.float16)
tensor(0.2783, device='cuda:0', dtype=torch.float16) tensor(0.0067, device='cuda:0', dtype=torch.float16)
tensor(0.0506, device='cuda:0')
old_score: tensor(0.0066, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0033, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.022320985794067
Validation after dual ascent:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.2795, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.2795, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.2795, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.3340, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0218, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0225, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
tensor(0.0210, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0199, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0145, device='cuda:0')
tensor(0.0368, device='cuda:0')
old_score: tensor(0.0011, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0003, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.797216892242432
Validation after dual ascent:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0133, device='cuda:0', dtype=torch.float16) tensor(0.0002, device='cuda:0', dtype=torch.float16)
tensor(0.0124, device='cuda:0', dtype=torch.float16) tensor(0.0003, device='cuda:0', dtype=torch.float16)
tensor(0.0133, device='cuda:0', dtype=torch.float16) tensor(0.0003, device='cuda:0', dtype=torch.float16)
tensor(0.0154, device='cuda:0', dtype=torch.float16) tensor(0.0003, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.gate_proj
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.8921, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
tensor(0.9072, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.8789, device='cuda:0', dtype=torch.float16) tensor(0.0268, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0189, device='cuda:0')
tensor(0.0194, device='cuda:0')
old_score: tensor(0.0275, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0134, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 62.75250029563904
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.6846, device='cuda:0', dtype=torch.float16) tensor(0.0130, device='cuda:0', dtype=torch.float16)
tensor(0.6494, device='cuda:0', dtype=torch.float16) tensor(0.0129, device='cuda:0', dtype=torch.float16)
tensor(0.7471, device='cuda:0', dtype=torch.float16) tensor(0.0146, device='cuda:0', dtype=torch.float16)
tensor(0.6631, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.up_proj
Validation after prune:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.3994, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
tensor(0.4023, device='cuda:0', dtype=torch.float16) tensor(0.0228, device='cuda:0', dtype=torch.float16)
tensor(0.4497, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
tensor(0.4097, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
Converged at iteration 700
tensor(0.0194, device='cuda:0')
tensor(0.0204, device='cuda:0')
old_score: tensor(0.0228, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0129, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 59.710492849349976
Validation after dual ascent:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.2964, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.3130, device='cuda:0', dtype=torch.float16) tensor(0.0124, device='cuda:0', dtype=torch.float16)
tensor(0.3159, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.3115, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.2686, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.2708, device='cuda:0', dtype=torch.float16) tensor(0.0037, device='cuda:0', dtype=torch.float16)
tensor(0.3062, device='cuda:0', dtype=torch.float16) tensor(0.0042, device='cuda:0', dtype=torch.float16)
tensor(0.2371, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.1112, device='cuda:0')
old_score: tensor(0.0038, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0026, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 213.7142505645752
Validation after dual ascent:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0784, device='cuda:0', dtype=torch.float16) tensor(0.0023, device='cuda:0', dtype=torch.float16)
tensor(0.1149, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.0962, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0768, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.q_proj
Validation after prune:
out_inf: tensor(9.1641, device='cuda:0', dtype=torch.float16) tensor(0.7344, device='cuda:0', dtype=torch.float16)
tensor(1.7959, device='cuda:0', dtype=torch.float16) tensor(0.1070, device='cuda:0', dtype=torch.float16)
tensor(1.7676, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
tensor(1.8027, device='cuda:0', dtype=torch.float16) tensor(0.1063, device='cuda:0', dtype=torch.float16)
tensor(0.0634, device='cuda:0')
old_score: tensor(0.1073, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0342, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 30.605258226394653
Validation after dual ascent:
out_inf: tensor(9.1641, device='cuda:0', dtype=torch.float16) tensor(0.7344, device='cuda:0', dtype=torch.float16)
tensor(1.4766, device='cuda:0', dtype=torch.float16) tensor(0.0330, device='cuda:0', dtype=torch.float16)
tensor(1.4355, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(1.4951, device='cuda:0', dtype=torch.float16) tensor(0.0365, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.0336, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.k_proj
Validation after prune:
out_inf: tensor(7.3672, device='cuda:0', dtype=torch.float16) tensor(0.7319, device='cuda:0', dtype=torch.float16)
tensor(1.7793, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1137, device='cuda:0', dtype=torch.float16)
tensor(1.8398, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(0.0627, device='cuda:0')
old_score: tensor(0.1132, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0339, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.44685745239258
Validation after dual ascent:
out_inf: tensor(7.3672, device='cuda:0', dtype=torch.float16) tensor(0.7319, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.0328, device='cuda:0', dtype=torch.float16)
tensor(1.1572, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(1.2822, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(1.6338, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.v_proj
Validation after prune:
out_inf: tensor(1.5693, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0228, device='cuda:0', dtype=torch.float16)
tensor(0.5469, device='cuda:0', dtype=torch.float16) tensor(0.0234, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.6064, device='cuda:0', dtype=torch.float16) tensor(0.0228, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0161, device='cuda:0')
tensor(0.0219, device='cuda:0')
old_score: tensor(0.0228, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0125, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.476435899734497
Validation after dual ascent:
out_inf: tensor(1.5693, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.3750, device='cuda:0', dtype=torch.float16) tensor(0.0122, device='cuda:0', dtype=torch.float16)
tensor(0.3804, device='cuda:0', dtype=torch.float16) tensor(0.0123, device='cuda:0', dtype=torch.float16)
tensor(0.3770, device='cuda:0', dtype=torch.float16) tensor(0.0133, device='cuda:0', dtype=torch.float16)
tensor(0.4346, device='cuda:0', dtype=torch.float16) tensor(0.0123, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.0613, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0811, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.0661, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0658, device='cuda:0', dtype=torch.float16) tensor(0.0034, device='cuda:0', dtype=torch.float16)
tensor(0.0203, device='cuda:0')
old_score: tensor(0.0035, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0015, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.18666410446167
Validation after dual ascent:
out_inf: tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.0490, device='cuda:0', dtype=torch.float16) tensor(0.0014, device='cuda:0', dtype=torch.float16)
tensor(0.0566, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0488, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0516, device='cuda:0', dtype=torch.float16) tensor(0.0014, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.gate_proj
Validation after prune:
out_inf: tensor(39.2500, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(11.4219, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(11.3750, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(10.3594, device='cuda:0', dtype=torch.float16) tensor(0.0546, device='cuda:0', dtype=torch.float16)
tensor(12.0469, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0152, device='cuda:0')
tensor(0.0216, device='cuda:0')
old_score: tensor(0.0517, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0280, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 47.0023410320282
Validation after dual ascent:
out_inf: tensor(39.2500, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(3.3320, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(3.1055, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(3.2812, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(3.3125, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.up_proj
Validation after prune:
out_inf: tensor(35.0625, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(7.5625, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(7.5781, device='cuda:0', dtype=torch.float16) tensor(0.0390, device='cuda:0', dtype=torch.float16)
tensor(6.8906, device='cuda:0', dtype=torch.float16) tensor(0.0411, device='cuda:0', dtype=torch.float16)
tensor(8.2031, device='cuda:0', dtype=torch.float16) tensor(0.0386, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0177, device='cuda:0')
tensor(0.0290, device='cuda:0')
old_score: tensor(0.0394, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0258, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 30.21576166152954
Validation after dual ascent:
out_inf: tensor(35.0625, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
tensor(2.5469, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.down_proj
Validation after prune:
out_inf: tensor(2254., device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(27.4688, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(27.2344, device='cuda:0', dtype=torch.float16) tensor(0.0078, device='cuda:0', dtype=torch.float16)
tensor(24.4375, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
tensor(27.3125, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
tensor(0.7235, device='cuda:0')
old_score: tensor(0.0083, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0072, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 190.46505904197693
Validation after dual ascent:
out_inf: tensor(2254., device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(7.4531, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(7.2500, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(6.6641, device='cuda:0', dtype=torch.float16) tensor(0.0079, device='cuda:0', dtype=torch.float16)
tensor(6.7500, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.q_proj
Validation after prune:
out_inf: tensor(13.2344, device='cuda:0', dtype=torch.float16) tensor(0.9023, device='cuda:0', dtype=torch.float16)
tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.2295, device='cuda:0', dtype=torch.float16)
tensor(3.3633, device='cuda:0', dtype=torch.float16) tensor(0.2307, device='cuda:0', dtype=torch.float16)
tensor(2.8906, device='cuda:0', dtype=torch.float16) tensor(0.2281, device='cuda:0', dtype=torch.float16)
tensor(3.1602, device='cuda:0', dtype=torch.float16) tensor(0.2324, device='cuda:0', dtype=torch.float16)
tensor(0.1695, device='cuda:0')
old_score: tensor(0.2302, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0768, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.28002405166626
Validation after dual ascent:
out_inf: tensor(13.2344, device='cuda:0', dtype=torch.float16) tensor(0.9023, device='cuda:0', dtype=torch.float16)
tensor(1.3145, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(1.3535, device='cuda:0', dtype=torch.float16) tensor(0.0755, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.0817, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.k_proj
Validation after prune:
out_inf: tensor(14.4531, device='cuda:0', dtype=torch.float16) tensor(1.0146, device='cuda:0', dtype=torch.float16)
tensor(3.2305, device='cuda:0', dtype=torch.float16) tensor(0.2371, device='cuda:0', dtype=torch.float16)
tensor(3.0723, device='cuda:0', dtype=torch.float16) tensor(0.2374, device='cuda:0', dtype=torch.float16)
tensor(3.1738, device='cuda:0', dtype=torch.float16) tensor(0.2349, device='cuda:0', dtype=torch.float16)
tensor(3.1719, device='cuda:0', dtype=torch.float16) tensor(0.2380, device='cuda:0', dtype=torch.float16)
tensor(0.1800, device='cuda:0')
old_score: tensor(0.2368, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0784, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.08923864364624
Validation after dual ascent:
out_inf: tensor(14.4531, device='cuda:0', dtype=torch.float16) tensor(1.0146, device='cuda:0', dtype=torch.float16)
tensor(1.6797, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
tensor(1.7246, device='cuda:0', dtype=torch.float16) tensor(0.0771, device='cuda:0', dtype=torch.float16)
tensor(1.4668, device='cuda:0', dtype=torch.float16) tensor(0.0834, device='cuda:0', dtype=torch.float16)
tensor(1.5791, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.0508, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(0.9717, device='cuda:0', dtype=torch.float16) tensor(0.0710, device='cuda:0', dtype=torch.float16)
tensor(1.2021, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0705, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.0734, device='cuda:0')
old_score: tensor(0.0712, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0413, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.80782198905945
Validation after dual ascent:
out_inf: tensor(3.0508, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(0.4563, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
tensor(0.4883, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.4927, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
tensor(0.4744, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.o_proj
Validation after prune:
out_inf: tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.0178, device='cuda:0', dtype=torch.float16)
tensor(0.3521, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.3237, device='cuda:0', dtype=torch.float16) tensor(0.0083, device='cuda:0', dtype=torch.float16)
tensor(0.3494, device='cuda:0', dtype=torch.float16) tensor(0.0093, device='cuda:0', dtype=torch.float16)
tensor(0.3037, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(0.0441, device='cuda:0')
old_score: tensor(0.0086, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0057, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.90144896507263
Validation after dual ascent:
out_inf: tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.0178, device='cuda:0', dtype=torch.float16)
tensor(0.1832, device='cuda:0', dtype=torch.float16) tensor(0.0056, device='cuda:0', dtype=torch.float16)
tensor(0.1827, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
tensor(0.2302, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.1779, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.gate_proj
Validation after prune:
out_inf: tensor(2.6719, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
tensor(1.4629, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(1.8223, device='cuda:0', dtype=torch.float16) tensor(0.0662, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0158, device='cuda:0')
tensor(0.0239, device='cuda:0')
old_score: tensor(0.0674, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0425, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 30.209172248840332
Validation after dual ascent:
out_inf: tensor(2.6719, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(0.6143, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(0.8438, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(0.6714, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
tensor(0.7490, device='cuda:0', dtype=torch.float16) tensor(0.0423, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.up_proj
Validation after prune:
out_inf: tensor(2.5273, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(1.0186, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.0523, device='cuda:0', dtype=torch.float16)
tensor(0.7148, device='cuda:0', dtype=torch.float16) tensor(0.0567, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0182, device='cuda:0')
tensor(0.0207, device='cuda:0')
old_score: tensor(0.0536, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 26.032209157943726
Validation after dual ascent:
out_inf: tensor(2.5273, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.3811, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.5479, device='cuda:0', dtype=torch.float16) tensor(0.0373, device='cuda:0', dtype=torch.float16)
tensor(0.4229, device='cuda:0', dtype=torch.float16) tensor(0.0417, device='cuda:0', dtype=torch.float16)
tensor(0.4370, device='cuda:0', dtype=torch.float16) tensor(0.0385, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.5957, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.1379, device='cuda:0', dtype=torch.float16) tensor(0.0104, device='cuda:0', dtype=torch.float16)
tensor(0.1873, device='cuda:0', dtype=torch.float16) tensor(0.0103, device='cuda:0', dtype=torch.float16)
tensor(0.2158, device='cuda:0', dtype=torch.float16) tensor(0.0124, device='cuda:0', dtype=torch.float16)
tensor(0.1626, device='cuda:0', dtype=torch.float16) tensor(0.0107, device='cuda:0', dtype=torch.float16)
tensor(0.1231, device='cuda:0')
old_score: tensor(0.0109, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0090, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 183.41454911231995
Validation after dual ascent:
out_inf: tensor(3.5957, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.1211, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.1111, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.1311, device='cuda:0', dtype=torch.float16) tensor(0.0102, device='cuda:0', dtype=torch.float16)
tensor(0.1329, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.5312, device='cuda:0', dtype=torch.float16) tensor(0.8906, device='cuda:0', dtype=torch.float16)
tensor(3.5273, device='cuda:0', dtype=torch.float16) tensor(0.2891, device='cuda:0', dtype=torch.float16)
tensor(3.5371, device='cuda:0', dtype=torch.float16) tensor(0.2913, device='cuda:0', dtype=torch.float16)
tensor(3.7129, device='cuda:0', dtype=torch.float16) tensor(0.2917, device='cuda:0', dtype=torch.float16)
tensor(3.6816, device='cuda:0', dtype=torch.float16) tensor(0.2900, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0169, device='cuda:0')
tensor(0.0504, device='cuda:0')
old_score: tensor(0.2905, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1340, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 27.65178918838501
Validation after dual ascent:
out_inf: tensor(17.5312, device='cuda:0', dtype=torch.float16) tensor(0.8906, device='cuda:0', dtype=torch.float16)
tensor(2.1953, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(2.0879, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
tensor(2.1465, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
tensor(1.9980, device='cuda:0', dtype=torch.float16) tensor(0.1333, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.k_proj
Validation after prune:
out_inf: tensor(16.3594, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(4.6289, device='cuda:0', dtype=torch.float16) tensor(0.3083, device='cuda:0', dtype=torch.float16)
tensor(4.5156, device='cuda:0', dtype=torch.float16) tensor(0.3101, device='cuda:0', dtype=torch.float16)
tensor(4.2617, device='cuda:0', dtype=torch.float16) tensor(0.3159, device='cuda:0', dtype=torch.float16)
tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.3086, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0186, device='cuda:0')
tensor(0.0483, device='cuda:0')
old_score: tensor(0.3105, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1371, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.087533712387085
Validation after dual ascent:
out_inf: tensor(16.3594, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(2.0352, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
tensor(2.0977, device='cuda:0', dtype=torch.float16) tensor(0.1461, device='cuda:0', dtype=torch.float16)
tensor(2.1484, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.5977, device='cuda:0', dtype=torch.float16) tensor(0.1875, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.1088, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1115, device='cuda:0', dtype=torch.float16)
tensor(1.1670, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0113, device='cuda:0')
tensor(0.2155, device='cuda:0')
old_score: tensor(0.1099, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0739, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.081419467926025
Validation after dual ascent:
out_inf: tensor(2.5977, device='cuda:0', dtype=torch.float16) tensor(0.1875, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.6895, device='cuda:0', dtype=torch.float16) tensor(0.0725, device='cuda:0', dtype=torch.float16)
tensor(0.7197, device='cuda:0', dtype=torch.float16) tensor(0.0780, device='cuda:0', dtype=torch.float16)
tensor(0.7964, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.o_proj
Validation after prune:
out_inf: tensor(1.2393, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
tensor(0.3057, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.3809, device='cuda:0', dtype=torch.float16) tensor(0.0073, device='cuda:0', dtype=torch.float16)
tensor(0.4326, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.3276, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.0480, device='cuda:0')
old_score: tensor(0.0069, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0046, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.87226366996765
Validation after dual ascent:
out_inf: tensor(1.2393, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
tensor(0.1768, device='cuda:0', dtype=torch.float16) tensor(0.0042, device='cuda:0', dtype=torch.float16)
tensor(0.1953, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
tensor(0.2148, device='cuda:0', dtype=torch.float16) tensor(0.0046, device='cuda:0', dtype=torch.float16)
tensor(0.1970, device='cuda:0', dtype=torch.float16) tensor(0.0046, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.1914, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(2.0879, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
tensor(2.1309, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(2.0430, device='cuda:0', dtype=torch.float16) tensor(0.0799, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0197, device='cuda:0')
tensor(0.0216, device='cuda:0')
old_score: tensor(0.0805, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0558, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 54.58377742767334
Validation after dual ascent:
out_inf: tensor(5.1914, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(1.1270, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0545, device='cuda:0', dtype=torch.float16)
tensor(0.9932, device='cuda:0', dtype=torch.float16) tensor(0.0603, device='cuda:0', dtype=torch.float16)
tensor(1.2949, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.up_proj
Validation after prune:
out_inf: tensor(2.6113, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(1.1865, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0138, device='cuda:0')
tensor(0.0313, device='cuda:0')
old_score: tensor(0.0676, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0513, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.707144260406494
Validation after dual ascent:
out_inf: tensor(2.6113, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(0.6035, device='cuda:0', dtype=torch.float16) tensor(0.0490, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0501, device='cuda:0', dtype=torch.float16)
tensor(0.5190, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(0.5791, device='cuda:0', dtype=torch.float16) tensor(0.0508, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.down_proj
Validation after prune:
out_inf: tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0220, device='cuda:0', dtype=torch.float16)
tensor(0.2046, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.1953, device='cuda:0', dtype=torch.float16) tensor(0.0131, device='cuda:0', dtype=torch.float16)
tensor(0.2239, device='cuda:0', dtype=torch.float16) tensor(0.0138, device='cuda:0', dtype=torch.float16)
tensor(0.2886, device='cuda:0', dtype=torch.float16) tensor(0.0134, device='cuda:0', dtype=torch.float16)
tensor(0.0991, device='cuda:0')
old_score: tensor(0.0133, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0112, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 188.8327169418335
Validation after dual ascent:
out_inf: tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0220, device='cuda:0', dtype=torch.float16)
tensor(0.1322, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
tensor(0.1423, device='cuda:0', dtype=torch.float16) tensor(0.0110, device='cuda:0', dtype=torch.float16)
tensor(0.1686, device='cuda:0', dtype=torch.float16) tensor(0.0119, device='cuda:0', dtype=torch.float16)
tensor(0.1831, device='cuda:0', dtype=torch.float16) tensor(0.0113, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.8125, device='cuda:0', dtype=torch.float16) tensor(0.9263, device='cuda:0', dtype=torch.float16)
tensor(3.1484, device='cuda:0', dtype=torch.float16) tensor(0.2966, device='cuda:0', dtype=torch.float16)
tensor(2.7656, device='cuda:0', dtype=torch.float16) tensor(0.2930, device='cuda:0', dtype=torch.float16)
tensor(2.6914, device='cuda:0', dtype=torch.float16) tensor(0.2986, device='cuda:0', dtype=torch.float16)
tensor(2.8789, device='cuda:0', dtype=torch.float16) tensor(0.2944, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0169, device='cuda:0')
tensor(0.0636, device='cuda:0')
old_score: tensor(0.2959, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1371, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 18.03679132461548
Validation after dual ascent:
out_inf: tensor(16.8125, device='cuda:0', dtype=torch.float16) tensor(0.9263, device='cuda:0', dtype=torch.float16)
tensor(1.8164, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(1.6660, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
tensor(1.7002, device='cuda:0', dtype=torch.float16) tensor(0.1458, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.8281, device='cuda:0', dtype=torch.float16) tensor(1.1436, device='cuda:0', dtype=torch.float16)
tensor(3.0840, device='cuda:0', dtype=torch.float16) tensor(0.3064, device='cuda:0', dtype=torch.float16)
tensor(3.2656, device='cuda:0', dtype=torch.float16) tensor(0.3035, device='cuda:0', dtype=torch.float16)
tensor(3.3359, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(3.0801, device='cuda:0', dtype=torch.float16) tensor(0.3044, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0187, device='cuda:0')
tensor(0.0569, device='cuda:0')
old_score: tensor(0.3054, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1370, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.79601812362671
Validation after dual ascent:
out_inf: tensor(20.8281, device='cuda:0', dtype=torch.float16) tensor(1.1436, device='cuda:0', dtype=torch.float16)
tensor(2.0273, device='cuda:0', dtype=torch.float16) tensor(0.1307, device='cuda:0', dtype=torch.float16)
tensor(1.7598, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.8770, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.9941, device='cuda:0', dtype=torch.float16) tensor(0.1859, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.1109, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(1.0811, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(1.1533, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0131, device='cuda:0')
tensor(0.2590, device='cuda:0')
old_score: tensor(0.1121, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0757, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.027929782867432
Validation after dual ascent:
out_inf: tensor(2.9941, device='cuda:0', dtype=torch.float16) tensor(0.1859, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.7661, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
tensor(0.7427, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
tensor(0.7593, device='cuda:0', dtype=torch.float16) tensor(0.0751, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.o_proj
Validation after prune:
out_inf: tensor(3.1035, device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
tensor(0.3301, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.4360, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.2939, device='cuda:0', dtype=torch.float16) tensor(0.0077, device='cuda:0', dtype=torch.float16)
tensor(0.4365, device='cuda:0', dtype=torch.float16) tensor(0.0094, device='cuda:0', dtype=torch.float16)
tensor(0.0479, device='cuda:0')
old_score: tensor(0.0086, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0060, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.554860830307007
Validation after dual ascent:
out_inf: tensor(3.1035, device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
tensor(0.2002, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.4399, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.1943, device='cuda:0', dtype=torch.float16) tensor(0.0054, device='cuda:0', dtype=torch.float16)
tensor(0.2661, device='cuda:0', dtype=torch.float16) tensor(0.0067, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.1738, device='cuda:0', dtype=torch.float16)
tensor(1.8926, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
tensor(1.7754, device='cuda:0', dtype=torch.float16) tensor(0.1024, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(1.8496, device='cuda:0', dtype=torch.float16) tensor(0.1029, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0111, device='cuda:0')
tensor(0.0542, device='cuda:0')
old_score: tensor(0.1019, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0691, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.732026100158691
Validation after dual ascent:
out_inf: tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.1738, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.9795, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.8374, device='cuda:0', dtype=torch.float16) tensor(0.0734, device='cuda:0', dtype=torch.float16)
tensor(0.9307, device='cuda:0', dtype=torch.float16) tensor(0.0688, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.2969, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(1.0996, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(1.1973, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0087, device='cuda:0')
tensor(0.0471, device='cuda:0')
old_score: tensor(0.0824, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0618, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.651606559753418
Validation after dual ascent:
out_inf: tensor(3.2969, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(0.7188, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
tensor(0.6914, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(0.6299, device='cuda:0', dtype=torch.float16) tensor(0.0657, device='cuda:0', dtype=torch.float16)
tensor(0.6875, device='cuda:0', dtype=torch.float16) tensor(0.0616, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.down_proj
Validation after prune:
out_inf: tensor(7.7539, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.4302, device='cuda:0', dtype=torch.float16) tensor(0.0199, device='cuda:0', dtype=torch.float16)
tensor(0.5249, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
tensor(0.4705, device='cuda:0', dtype=torch.float16) tensor(0.0204, device='cuda:0', dtype=torch.float16)
tensor(0.3940, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
Converged at iteration 800
tensor(0.0197, device='cuda:0')
tensor(0.0231, device='cuda:0')
old_score: tensor(0.0207, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0166, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 165.42868328094482
Validation after dual ascent:
out_inf: tensor(7.7539, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.3267, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.3271, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
tensor(0.3237, device='cuda:0', dtype=torch.float16) tensor(0.0167, device='cuda:0', dtype=torch.float16)
tensor(0.3293, device='cuda:0', dtype=torch.float16) tensor(0.0171, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.5625, device='cuda:0', dtype=torch.float16) tensor(0.9492, device='cuda:0', dtype=torch.float16)
tensor(3.0547, device='cuda:0', dtype=torch.float16) tensor(0.3220, device='cuda:0', dtype=torch.float16)
tensor(3.1641, device='cuda:0', dtype=torch.float16) tensor(0.3198, device='cuda:0', dtype=torch.float16)
tensor(3.0449, device='cuda:0', dtype=torch.float16) tensor(0.3210, device='cuda:0', dtype=torch.float16)
tensor(3.1309, device='cuda:0', dtype=torch.float16) tensor(0.3191, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0199, device='cuda:0')
tensor(0.0549, device='cuda:0')
old_score: tensor(0.3206, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1390, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 19.048128843307495
Validation after dual ascent:
out_inf: tensor(17.5625, device='cuda:0', dtype=torch.float16) tensor(0.9492, device='cuda:0', dtype=torch.float16)
tensor(1.5254, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
tensor(1.6348, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(1.7207, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
tensor(1.7324, device='cuda:0', dtype=torch.float16) tensor(0.1379, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.4531, device='cuda:0', dtype=torch.float16) tensor(1.1543, device='cuda:0', dtype=torch.float16)
tensor(3.1602, device='cuda:0', dtype=torch.float16) tensor(0.3330, device='cuda:0', dtype=torch.float16)
tensor(2.9609, device='cuda:0', dtype=torch.float16) tensor(0.3289, device='cuda:0', dtype=torch.float16)
tensor(3., device='cuda:0', dtype=torch.float16) tensor(0.3330, device='cuda:0', dtype=torch.float16)
tensor(3.5430, device='cuda:0', dtype=torch.float16) tensor(0.3296, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0180, device='cuda:0')
tensor(0.0424, device='cuda:0')
old_score: tensor(0.3311, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1423, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.7654447555542
Validation after dual ascent:
out_inf: tensor(19.4531, device='cuda:0', dtype=torch.float16) tensor(1.1543, device='cuda:0', dtype=torch.float16)
tensor(1.7314, device='cuda:0', dtype=torch.float16) tensor(0.1370, device='cuda:0', dtype=torch.float16)
tensor(1.6699, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(1.8828, device='cuda:0', dtype=torch.float16) tensor(0.1489, device='cuda:0', dtype=torch.float16)
tensor(1.6660, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.5059, device='cuda:0', dtype=torch.float16) tensor(0.2069, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.1228, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1228, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0113, device='cuda:0')
tensor(0.2011, device='cuda:0')
old_score: tensor(0.1224, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0772, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.103129625320435
Validation after dual ascent:
out_inf: tensor(2.5059, device='cuda:0', dtype=torch.float16) tensor(0.2069, device='cuda:0', dtype=torch.float16)
tensor(0.6587, device='cuda:0', dtype=torch.float16) tensor(0.0748, device='cuda:0', dtype=torch.float16)
tensor(0.6426, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(0.7227, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
tensor(0.7124, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.o_proj
Validation after prune:
out_inf: tensor(2.2480, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.5845, device='cuda:0', dtype=torch.float16) tensor(0.0213, device='cuda:0', dtype=torch.float16)
tensor(0.6187, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.5679, device='cuda:0', dtype=torch.float16) tensor(0.0221, device='cuda:0', dtype=torch.float16)
tensor(0.7373, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.0422, device='cuda:0')
old_score: tensor(0.0221, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0129, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.34945273399353
Validation after dual ascent:
out_inf: tensor(2.2480, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.2932, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
tensor(0.4043, device='cuda:0', dtype=torch.float16) tensor(0.0134, device='cuda:0', dtype=torch.float16)
tensor(0.3433, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.3682, device='cuda:0', dtype=torch.float16) tensor(0.0131, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.6289, device='cuda:0', dtype=torch.float16) tensor(0.2196, device='cuda:0', dtype=torch.float16)
tensor(2.0781, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(2.0020, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(1.8750, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(2.1914, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0105, device='cuda:0')
tensor(0.0493, device='cuda:0')
old_score: tensor(0.1192, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0659, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.01420259475708
Validation after dual ascent:
out_inf: tensor(4.6289, device='cuda:0', dtype=torch.float16) tensor(0.2196, device='cuda:0', dtype=torch.float16)
tensor(0.8486, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
tensor(1.0879, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(1.0762, device='cuda:0', dtype=torch.float16) tensor(0.0657, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.1094, device='cuda:0', dtype=torch.float16) tensor(0.1660, device='cuda:0', dtype=torch.float16)
tensor(1.3379, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(1.6855, device='cuda:0', dtype=torch.float16) tensor(0.0932, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0082, device='cuda:0')
tensor(0.0416, device='cuda:0')
old_score: tensor(0.0932, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0585, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.994077444076538
Validation after dual ascent:
out_inf: tensor(4.1094, device='cuda:0', dtype=torch.float16) tensor(0.1660, device='cuda:0', dtype=torch.float16)
tensor(1.0479, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
tensor(1.1553, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.5488, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.5908, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.6582, device='cuda:0', dtype=torch.float16) tensor(0.0619, device='cuda:0', dtype=torch.float16)
tensor(0.4663, device='cuda:0', dtype=torch.float16) tensor(0.0352, device='cuda:0', dtype=torch.float16)
tensor(0.4434, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.4067, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
tensor(0.4697, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0077, device='cuda:0')
tensor(0.0182, device='cuda:0')
old_score: tensor(0.0353, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0206, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 158.84623193740845
Validation after dual ascent:
out_inf: tensor(3.6582, device='cuda:0', dtype=torch.float16) tensor(0.0619, device='cuda:0', dtype=torch.float16)
tensor(0.2759, device='cuda:0', dtype=torch.float16) tensor(0.0202, device='cuda:0', dtype=torch.float16)
tensor(0.2427, device='cuda:0', dtype=torch.float16) tensor(0.0209, device='cuda:0', dtype=torch.float16)
tensor(0.2374, device='cuda:0', dtype=torch.float16) tensor(0.0204, device='cuda:0', dtype=torch.float16)
tensor(0.2827, device='cuda:0', dtype=torch.float16) tensor(0.0207, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.2656, device='cuda:0', dtype=torch.float16) tensor(0.8906, device='cuda:0', dtype=torch.float16)
tensor(4.2734, device='cuda:0', dtype=torch.float16) tensor(0.3401, device='cuda:0', dtype=torch.float16)
tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3398, device='cuda:0', dtype=torch.float16)
tensor(3.9141, device='cuda:0', dtype=torch.float16) tensor(0.3381, device='cuda:0', dtype=torch.float16)
tensor(4.3867, device='cuda:0', dtype=torch.float16) tensor(0.3394, device='cuda:0', dtype=torch.float16)
tensor(0.1792, device='cuda:0')
old_score: tensor(0.3394, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1388, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.58764982223511
Validation after dual ascent:
out_inf: tensor(14.2656, device='cuda:0', dtype=torch.float16) tensor(0.8906, device='cuda:0', dtype=torch.float16)
tensor(2.1992, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(2.2090, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(2.0195, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(2.3145, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.1875, device='cuda:0', dtype=torch.float16) tensor(1.0117, device='cuda:0', dtype=torch.float16)
tensor(4.4180, device='cuda:0', dtype=torch.float16) tensor(0.3562, device='cuda:0', dtype=torch.float16)
tensor(4.5312, device='cuda:0', dtype=torch.float16) tensor(0.3589, device='cuda:0', dtype=torch.float16)
tensor(4.4062, device='cuda:0', dtype=torch.float16) tensor(0.3557, device='cuda:0', dtype=torch.float16)
tensor(4.1289, device='cuda:0', dtype=torch.float16) tensor(0.3560, device='cuda:0', dtype=torch.float16)
tensor(0.1660, device='cuda:0')
old_score: tensor(0.3564, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1399, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.448070526123047
Validation after dual ascent:
out_inf: tensor(17.1875, device='cuda:0', dtype=torch.float16) tensor(1.0117, device='cuda:0', dtype=torch.float16)
tensor(2.2891, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.9297, device='cuda:0', dtype=torch.float16) tensor(0.1409, device='cuda:0', dtype=torch.float16)
tensor(2.4004, device='cuda:0', dtype=torch.float16) tensor(0.1414, device='cuda:0', dtype=torch.float16)
tensor(2.0820, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.8594, device='cuda:0', dtype=torch.float16) tensor(0.2615, device='cuda:0', dtype=torch.float16)
tensor(1.5010, device='cuda:0', dtype=torch.float16) tensor(0.1459, device='cuda:0', dtype=torch.float16)
tensor(1.4238, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(1.3184, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.3887, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0192, device='cuda:0')
tensor(0.0835, device='cuda:0')
old_score: tensor(0.1448, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0752, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.24046039581299
Validation after dual ascent:
out_inf: tensor(3.8594, device='cuda:0', dtype=torch.float16) tensor(0.2615, device='cuda:0', dtype=torch.float16)
tensor(0.7129, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(0.7788, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(0.6851, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.2734, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.0280, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.0315, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.0352, device='cuda:0')
old_score: tensor(0.0291, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0102, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.743369579315186
Validation after dual ascent:
out_inf: tensor(8.2734, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
tensor(0.3750, device='cuda:0', dtype=torch.float16) tensor(0.0093, device='cuda:0', dtype=torch.float16)
tensor(0.3506, device='cuda:0', dtype=torch.float16) tensor(0.0109, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0108, device='cuda:0', dtype=torch.float16)
tensor(0.3730, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.2722, device='cuda:0', dtype=torch.float16)
tensor(2.0605, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(2.0586, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(2.2969, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(1.8828, device='cuda:0', dtype=torch.float16) tensor(0.1399, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0176, device='cuda:0')
tensor(0.0317, device='cuda:0')
old_score: tensor(0.1394, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0573, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.778061628341675
Validation after dual ascent:
out_inf: tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.2722, device='cuda:0', dtype=torch.float16)
tensor(1.2061, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.9922, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.7539, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
tensor(0.7710, device='cuda:0', dtype=torch.float16) tensor(0.0559, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.7168, device='cuda:0', dtype=torch.float16) tensor(0.1761, device='cuda:0', dtype=torch.float16)
tensor(1.5684, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.0954, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.0993, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0119, device='cuda:0')
tensor(0.0258, device='cuda:0')
old_score: tensor(0.0970, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0499, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.973532915115356
Validation after dual ascent:
out_inf: tensor(3.7168, device='cuda:0', dtype=torch.float16) tensor(0.1761, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0492, device='cuda:0', dtype=torch.float16)
tensor(0.5127, device='cuda:0', dtype=torch.float16) tensor(0.0504, device='cuda:0', dtype=torch.float16)
tensor(0.5273, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.down_proj
Validation after prune:
out_inf: tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.9385, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
tensor(0.8896, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
tensor(1.0459, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
tensor(0.0647, device='cuda:0')
old_score: tensor(0.0379, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0173, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 204.3135063648224
Validation after dual ascent:
out_inf: tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.2456, device='cuda:0', dtype=torch.float16) tensor(0.0172, device='cuda:0', dtype=torch.float16)
tensor(0.2869, device='cuda:0', dtype=torch.float16) tensor(0.0174, device='cuda:0', dtype=torch.float16)
tensor(0.2178, device='cuda:0', dtype=torch.float16) tensor(0.0179, device='cuda:0', dtype=torch.float16)
tensor(0.2598, device='cuda:0', dtype=torch.float16) tensor(0.0166, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.4688, device='cuda:0', dtype=torch.float16) tensor(0.8745, device='cuda:0', dtype=torch.float16)
tensor(5.1016, device='cuda:0', dtype=torch.float16) tensor(0.3477, device='cuda:0', dtype=torch.float16)
tensor(6.2109, device='cuda:0', dtype=torch.float16) tensor(0.3484, device='cuda:0', dtype=torch.float16)
tensor(4.8164, device='cuda:0', dtype=torch.float16) tensor(0.3503, device='cuda:0', dtype=torch.float16)
tensor(5.2148, device='cuda:0', dtype=torch.float16) tensor(0.3486, device='cuda:0', dtype=torch.float16)
tensor(0.1660, device='cuda:0')
old_score: tensor(0.3489, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1273, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.765788078308105
Validation after dual ascent:
out_inf: tensor(16.4688, device='cuda:0', dtype=torch.float16) tensor(0.8745, device='cuda:0', dtype=torch.float16)
tensor(1.9863, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
tensor(1.9531, device='cuda:0', dtype=torch.float16) tensor(0.1334, device='cuda:0', dtype=torch.float16)
tensor(2.0410, device='cuda:0', dtype=torch.float16) tensor(0.1287, device='cuda:0', dtype=torch.float16)
tensor(2.0469, device='cuda:0', dtype=torch.float16) tensor(0.1252, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.k_proj
Validation after prune:
out_inf: tensor(16.2344, device='cuda:0', dtype=torch.float16) tensor(0.9790, device='cuda:0', dtype=torch.float16)
tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.3594, device='cuda:0', dtype=torch.float16)
tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3611, device='cuda:0', dtype=torch.float16)
tensor(4.2578, device='cuda:0', dtype=torch.float16) tensor(0.3655, device='cuda:0', dtype=torch.float16)
tensor(4.3828, device='cuda:0', dtype=torch.float16) tensor(0.3601, device='cuda:0', dtype=torch.float16)
tensor(0.1452, device='cuda:0')
old_score: tensor(0.3616, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1268, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.48018503189087
Validation after dual ascent:
out_inf: tensor(16.2344, device='cuda:0', dtype=torch.float16) tensor(0.9790, device='cuda:0', dtype=torch.float16)
tensor(1.6768, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(1.9170, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1281, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.1247, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.8438, device='cuda:0', dtype=torch.float16) tensor(0.2627, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.1500, device='cuda:0', dtype=torch.float16)
tensor(1.3604, device='cuda:0', dtype=torch.float16) tensor(0.1489, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.1498, device='cuda:0', dtype=torch.float16)
tensor(0.0596, device='cuda:0')
old_score: tensor(0.1497, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0698, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.33195209503174
Validation after dual ascent:
out_inf: tensor(4.8438, device='cuda:0', dtype=torch.float16) tensor(0.2627, device='cuda:0', dtype=torch.float16)
tensor(0.7046, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.7290, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.7690, device='cuda:0', dtype=torch.float16) tensor(0.0704, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.o_proj
Validation after prune:
out_inf: tensor(3.6582, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.7910, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(1.0420, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(0.9238, device='cuda:0', dtype=torch.float16) tensor(0.0284, device='cuda:0', dtype=torch.float16)
tensor(0.0355, device='cuda:0')
old_score: tensor(0.0296, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0125, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.863141536712646
Validation after dual ascent:
out_inf: tensor(3.6582, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.3379, device='cuda:0', dtype=torch.float16) tensor(0.0109, device='cuda:0', dtype=torch.float16)
tensor(0.4082, device='cuda:0', dtype=torch.float16) tensor(0.0136, device='cuda:0', dtype=torch.float16)
tensor(0.5469, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.3018, device='cuda:0', dtype=torch.float16) tensor(0.0113, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.5742, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(2.5859, device='cuda:0', dtype=torch.float16) tensor(0.1578, device='cuda:0', dtype=torch.float16)
tensor(2.6875, device='cuda:0', dtype=torch.float16) tensor(0.1575, device='cuda:0', dtype=torch.float16)
tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(2.6328, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0163, device='cuda:0')
tensor(0.0387, device='cuda:0')
old_score: tensor(0.1576, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0621, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.336466312408447
Validation after dual ascent:
out_inf: tensor(4.5742, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(1.1621, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(1.2324, device='cuda:0', dtype=torch.float16) tensor(0.0650, device='cuda:0', dtype=torch.float16)
tensor(0.9736, device='cuda:0', dtype=torch.float16) tensor(0.0630, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.2461, device='cuda:0', dtype=torch.float16) tensor(0.1907, device='cuda:0', dtype=torch.float16)
tensor(1.2686, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(1.3135, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
tensor(1.3096, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(1.3193, device='cuda:0', dtype=torch.float16) tensor(0.1092, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0085, device='cuda:0')
tensor(0.0313, device='cuda:0')
old_score: tensor(0.1090, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0545, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.939322471618652
Validation after dual ascent:
out_inf: tensor(3.2461, device='cuda:0', dtype=torch.float16) tensor(0.1907, device='cuda:0', dtype=torch.float16)
tensor(0.6812, device='cuda:0', dtype=torch.float16) tensor(0.0524, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
tensor(0.5771, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
tensor(0.7295, device='cuda:0', dtype=torch.float16) tensor(0.0534, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.2793, device='cuda:0', dtype=torch.float16) tensor(0.0644, device='cuda:0', dtype=torch.float16)
tensor(0.6895, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.7285, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0365, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
Converged at iteration 900
tensor(0.0165, device='cuda:0')
tensor(0.0385, device='cuda:0')
old_score: tensor(0.0357, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0194, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 161.4553120136261
Validation after dual ascent:
out_inf: tensor(2.2793, device='cuda:0', dtype=torch.float16) tensor(0.0644, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0185, device='cuda:0', dtype=torch.float16)
tensor(0.2822, device='cuda:0', dtype=torch.float16) tensor(0.0205, device='cuda:0', dtype=torch.float16)
tensor(0.2627, device='cuda:0', dtype=torch.float16) tensor(0.0199, device='cuda:0', dtype=torch.float16)
tensor(0.2568, device='cuda:0', dtype=torch.float16) tensor(0.0189, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.3438, device='cuda:0', dtype=torch.float16) tensor(0.8506, device='cuda:0', dtype=torch.float16)
tensor(5.5938, device='cuda:0', dtype=torch.float16) tensor(0.3438, device='cuda:0', dtype=torch.float16)
tensor(5.5469, device='cuda:0', dtype=torch.float16) tensor(0.3452, device='cuda:0', dtype=torch.float16)
tensor(5.5469, device='cuda:0', dtype=torch.float16) tensor(0.3484, device='cuda:0', dtype=torch.float16)
tensor(5.9766, device='cuda:0', dtype=torch.float16) tensor(0.3450, device='cuda:0', dtype=torch.float16)
tensor(0.1022, device='cuda:0')
old_score: tensor(0.3455, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1342, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.82848620414734
Validation after dual ascent:
out_inf: tensor(17.3438, device='cuda:0', dtype=torch.float16) tensor(0.8506, device='cuda:0', dtype=torch.float16)
tensor(2.4727, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(2.3203, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(2.5352, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
tensor(2.4512, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.9531, device='cuda:0', dtype=torch.float16) tensor(1.0322, device='cuda:0', dtype=torch.float16)
tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.3638, device='cuda:0', dtype=torch.float16)
tensor(4.2305, device='cuda:0', dtype=torch.float16) tensor(0.3643, device='cuda:0', dtype=torch.float16)
tensor(4.1875, device='cuda:0', dtype=torch.float16) tensor(0.3633, device='cuda:0', dtype=torch.float16)
tensor(4.0234, device='cuda:0', dtype=torch.float16) tensor(0.3640, device='cuda:0', dtype=torch.float16)
tensor(0.0932, device='cuda:0')
old_score: tensor(0.3640, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1340, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.812172889709473
Validation after dual ascent:
out_inf: tensor(17.9531, device='cuda:0', dtype=torch.float16) tensor(1.0322, device='cuda:0', dtype=torch.float16)
tensor(1.7598, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(2.0664, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
tensor(1.8311, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(1.8018, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.2603, device='cuda:0', dtype=torch.float16)
tensor(1.3857, device='cuda:0', dtype=torch.float16) tensor(0.1533, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(1.4473, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.1530, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0161, device='cuda:0')
tensor(0.0964, device='cuda:0')
old_score: tensor(0.1533, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0757, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.137563228607178
Validation after dual ascent:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.2603, device='cuda:0', dtype=torch.float16)
tensor(0.7568, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.8340, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
tensor(0.7690, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
tensor(0.7676, device='cuda:0', dtype=torch.float16) tensor(0.0741, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.o_proj
Validation after prune:
out_inf: tensor(3.6543, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0290, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
tensor(0.8320, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(0.0305, device='cuda:0')
old_score: tensor(0.0330, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0156, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.150370597839355
Validation after dual ascent:
out_inf: tensor(3.6543, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.3574, device='cuda:0', dtype=torch.float16) tensor(0.0133, device='cuda:0', dtype=torch.float16)
tensor(0.3926, device='cuda:0', dtype=torch.float16) tensor(0.0176, device='cuda:0', dtype=torch.float16)
tensor(0.4492, device='cuda:0', dtype=torch.float16) tensor(0.0180, device='cuda:0', dtype=torch.float16)
tensor(0.3672, device='cuda:0', dtype=torch.float16) tensor(0.0137, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(2.5469, device='cuda:0', dtype=torch.float16) tensor(0.1431, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(2.3867, device='cuda:0', dtype=torch.float16) tensor(0.1439, device='cuda:0', dtype=torch.float16)
tensor(2.1367, device='cuda:0', dtype=torch.float16) tensor(0.1439, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0116, device='cuda:0')
tensor(0.0501, device='cuda:0')
old_score: tensor(0.1438, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0676, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.030489921569824
Validation after dual ascent:
out_inf: tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(1.6992, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(0.9600, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(0.9883, device='cuda:0', dtype=torch.float16) tensor(0.0675, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.9570, device='cuda:0', dtype=torch.float16) tensor(0.1995, device='cuda:0', dtype=torch.float16)
tensor(2.3242, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.6641, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.5801, device='cuda:0', dtype=torch.float16) tensor(0.1146, device='cuda:0', dtype=torch.float16)
tensor(1.6211, device='cuda:0', dtype=torch.float16) tensor(0.1153, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0080, device='cuda:0')
tensor(0.0434, device='cuda:0')
old_score: tensor(0.1152, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0610, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.350296974182129
Validation after dual ascent:
out_inf: tensor(7.9570, device='cuda:0', dtype=torch.float16) tensor(0.1995, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0596, device='cuda:0', dtype=torch.float16)
tensor(0.6768, device='cuda:0', dtype=torch.float16) tensor(0.0631, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0609, device='cuda:0', dtype=torch.float16)
tensor(0.7139, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.3008, device='cuda:0', dtype=torch.float16) tensor(0.0620, device='cuda:0', dtype=torch.float16)
tensor(0.7251, device='cuda:0', dtype=torch.float16) tensor(0.0360, device='cuda:0', dtype=torch.float16)
tensor(0.7314, device='cuda:0', dtype=torch.float16) tensor(0.0371, device='cuda:0', dtype=torch.float16)
tensor(0.6787, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(1.0029, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0148, device='cuda:0')
tensor(0.0321, device='cuda:0')
old_score: tensor(0.0366, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0235, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 125.2489447593689
Validation after dual ascent:
out_inf: tensor(3.3008, device='cuda:0', dtype=torch.float16) tensor(0.0620, device='cuda:0', dtype=torch.float16)
tensor(0.3535, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.6685, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.4062, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
tensor(0.9067, device='cuda:0', dtype=torch.float16) tensor(0.0230, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.6328, device='cuda:0', dtype=torch.float16) tensor(0.8716, device='cuda:0', dtype=torch.float16)
tensor(3.7656, device='cuda:0', dtype=torch.float16) tensor(0.3499, device='cuda:0', dtype=torch.float16)
tensor(3.9727, device='cuda:0', dtype=torch.float16) tensor(0.3496, device='cuda:0', dtype=torch.float16)
tensor(3.8184, device='cuda:0', dtype=torch.float16) tensor(0.3557, device='cuda:0', dtype=torch.float16)
tensor(4.1953, device='cuda:0', dtype=torch.float16) tensor(0.3508, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0190, device='cuda:0')
tensor(0.0575, device='cuda:0')
old_score: tensor(0.3513, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1442, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.460747241973877
Validation after dual ascent:
out_inf: tensor(15.6328, device='cuda:0', dtype=torch.float16) tensor(0.8716, device='cuda:0', dtype=torch.float16)
tensor(1.7139, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(2.0078, device='cuda:0', dtype=torch.float16) tensor(0.1493, device='cuda:0', dtype=torch.float16)
tensor(1.9961, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(1.6914, device='cuda:0', dtype=torch.float16) tensor(0.1420, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.7344, device='cuda:0', dtype=torch.float16) tensor(1.0928, device='cuda:0', dtype=torch.float16)
tensor(3.8203, device='cuda:0', dtype=torch.float16) tensor(0.3779, device='cuda:0', dtype=torch.float16)
tensor(3.5859, device='cuda:0', dtype=torch.float16) tensor(0.3750, device='cuda:0', dtype=torch.float16)
tensor(3.5000, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(3.5820, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(0.0248, device='cuda:0')
old_score: tensor(0.3772, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1455, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.362393617630005
Validation after dual ascent:
out_inf: tensor(18.7344, device='cuda:0', dtype=torch.float16) tensor(1.0928, device='cuda:0', dtype=torch.float16)
tensor(1.6729, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(2.1074, device='cuda:0', dtype=torch.float16) tensor(0.1510, device='cuda:0', dtype=torch.float16)
tensor(1.9209, device='cuda:0', dtype=torch.float16) tensor(0.1462, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.v_proj
Validation after prune:
out_inf: tensor(6.5547, device='cuda:0', dtype=torch.float16) tensor(0.2642, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(1.4580, device='cuda:0', dtype=torch.float16) tensor(0.1562, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(1.5371, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0185, device='cuda:0')
tensor(0.2499, device='cuda:0')
old_score: tensor(0.1561, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0823, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.465198516845703
Validation after dual ascent:
out_inf: tensor(6.5547, device='cuda:0', dtype=torch.float16) tensor(0.2642, device='cuda:0', dtype=torch.float16)
tensor(0.7051, device='cuda:0', dtype=torch.float16) tensor(0.0805, device='cuda:0', dtype=torch.float16)
tensor(0.6851, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
tensor(0.6758, device='cuda:0', dtype=torch.float16) tensor(0.0812, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.2617, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.8418, device='cuda:0', dtype=torch.float16) tensor(0.0305, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0318, device='cuda:0', dtype=torch.float16)
tensor(1.0977, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.7393, device='cuda:0', dtype=torch.float16) tensor(0.0286, device='cuda:0', dtype=torch.float16)
tensor(0.0222, device='cuda:0')
old_score: tensor(0.0315, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0171, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.805379390716553
Validation after dual ascent:
out_inf: tensor(4.2617, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.4014, device='cuda:0', dtype=torch.float16) tensor(0.0162, device='cuda:0', dtype=torch.float16)
tensor(0.4473, device='cuda:0', dtype=torch.float16) tensor(0.0171, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.3643, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.1016, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(2.3711, device='cuda:0', dtype=torch.float16) tensor(0.1467, device='cuda:0', dtype=torch.float16)
tensor(2.1250, device='cuda:0', dtype=torch.float16) tensor(0.1493, device='cuda:0', dtype=torch.float16)
tensor(2.6758, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(2.3672, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0120, device='cuda:0')
tensor(0.0715, device='cuda:0')
old_score: tensor(0.1466, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0709, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.8448326587677
Validation after dual ascent:
out_inf: tensor(5.1016, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.0704, device='cuda:0', dtype=torch.float16)
tensor(1.4268, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
tensor(1.0322, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
tensor(1.4785, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.0742, device='cuda:0', dtype=torch.float16) tensor(0.2070, device='cuda:0', dtype=torch.float16)
tensor(1.5137, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.4238, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.7949, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
tensor(1.5508, device='cuda:0', dtype=torch.float16) tensor(0.1180, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0088, device='cuda:0')
tensor(0.0621, device='cuda:0')
old_score: tensor(0.1184, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0651, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.361486911773682
Validation after dual ascent:
out_inf: tensor(4.0742, device='cuda:0', dtype=torch.float16) tensor(0.2070, device='cuda:0', dtype=torch.float16)
tensor(1.0791, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
tensor(0.6680, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(0.9434, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.6885, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.9980, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.7314, device='cuda:0', dtype=torch.float16) tensor(0.0387, device='cuda:0', dtype=torch.float16)
tensor(0.7061, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.7520, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0192, device='cuda:0')
tensor(0.0440, device='cuda:0')
old_score: tensor(0.0391, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0263, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 77.16012811660767
Validation after dual ascent:
out_inf: tensor(1.9980, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.4556, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
tensor(0.3591, device='cuda:0', dtype=torch.float16) tensor(0.0270, device='cuda:0', dtype=torch.float16)
tensor(0.3176, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.3604, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.4844, device='cuda:0', dtype=torch.float16) tensor(0.8755, device='cuda:0', dtype=torch.float16)
tensor(4.0820, device='cuda:0', dtype=torch.float16) tensor(0.3594, device='cuda:0', dtype=torch.float16)
tensor(4.5234, device='cuda:0', dtype=torch.float16) tensor(0.3518, device='cuda:0', dtype=torch.float16)
tensor(4.7344, device='cuda:0', dtype=torch.float16) tensor(0.3545, device='cuda:0', dtype=torch.float16)
tensor(4.1797, device='cuda:0', dtype=torch.float16) tensor(0.3547, device='cuda:0', dtype=torch.float16)
tensor(0.1294, device='cuda:0')
old_score: tensor(0.3550, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1484, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.188212156295776
Validation after dual ascent:
out_inf: tensor(16.4844, device='cuda:0', dtype=torch.float16) tensor(0.8755, device='cuda:0', dtype=torch.float16)
tensor(1.9893, device='cuda:0', dtype=torch.float16) tensor(0.1464, device='cuda:0', dtype=torch.float16)
tensor(2.0176, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.8008, device='cuda:0', dtype=torch.float16) tensor(0.1486, device='cuda:0', dtype=torch.float16)
tensor(1.8213, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.1396, device='cuda:0', dtype=torch.float16)
tensor(3.8906, device='cuda:0', dtype=torch.float16) tensor(0.3955, device='cuda:0', dtype=torch.float16)
tensor(3.7109, device='cuda:0', dtype=torch.float16) tensor(0.3894, device='cuda:0', dtype=torch.float16)
tensor(3.7539, device='cuda:0', dtype=torch.float16) tensor(0.3918, device='cuda:0', dtype=torch.float16)
tensor(3.8301, device='cuda:0', dtype=torch.float16) tensor(0.3926, device='cuda:0', dtype=torch.float16)
tensor(0.1382, device='cuda:0')
old_score: tensor(0.3923, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1505, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.1033992767334
Validation after dual ascent:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.1396, device='cuda:0', dtype=torch.float16)
tensor(2.0098, device='cuda:0', dtype=torch.float16) tensor(0.1483, device='cuda:0', dtype=torch.float16)
tensor(1.7705, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.1505, device='cuda:0', dtype=torch.float16)
tensor(1.8066, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.1172, device='cuda:0', dtype=torch.float16) tensor(0.2781, device='cuda:0', dtype=torch.float16)
tensor(1.3955, device='cuda:0', dtype=torch.float16) tensor(0.1603, device='cuda:0', dtype=torch.float16)
tensor(1.3857, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(1.5146, device='cuda:0', dtype=torch.float16) tensor(0.1583, device='cuda:0', dtype=torch.float16)
tensor(1.3857, device='cuda:0', dtype=torch.float16) tensor(0.1591, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0171, device='cuda:0')
tensor(0.0793, device='cuda:0')
old_score: tensor(0.1589, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0839, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 18.56733274459839
Validation after dual ascent:
out_inf: tensor(7.1172, device='cuda:0', dtype=torch.float16) tensor(0.2781, device='cuda:0', dtype=torch.float16)
tensor(0.7397, device='cuda:0', dtype=torch.float16) tensor(0.0829, device='cuda:0', dtype=torch.float16)
tensor(0.7402, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(0.9121, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(0.7070, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.o_proj
Validation after prune:
out_inf: tensor(6.7656, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.9277, device='cuda:0', dtype=torch.float16) tensor(0.0432, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0395, device='cuda:0', dtype=torch.float16)
Converged at iteration 700
tensor(0.0128, device='cuda:0')
tensor(0.0238, device='cuda:0')
old_score: tensor(0.0426, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0245, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 16.206222772598267
Validation after dual ascent:
out_inf: tensor(6.7656, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.4043, device='cuda:0', dtype=torch.float16) tensor(0.0245, device='cuda:0', dtype=torch.float16)
tensor(0.4609, device='cuda:0', dtype=torch.float16) tensor(0.0240, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.3638, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.3242, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(2.6250, device='cuda:0', dtype=torch.float16) tensor(0.1466, device='cuda:0', dtype=torch.float16)
tensor(2.5098, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(2.5996, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(2.7363, device='cuda:0', dtype=torch.float16) tensor(0.1454, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0114, device='cuda:0')
tensor(0.0620, device='cuda:0')
old_score: tensor(0.1458, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0701, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.948156595230103
Validation after dual ascent:
out_inf: tensor(6.3242, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(1.3965, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(1.4590, device='cuda:0', dtype=torch.float16) tensor(0.0694, device='cuda:0', dtype=torch.float16)
tensor(1.4639, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.2949, device='cuda:0', dtype=torch.float16) tensor(0.2148, device='cuda:0', dtype=torch.float16)
tensor(1.3906, device='cuda:0', dtype=torch.float16) tensor(0.1209, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1188, device='cuda:0', dtype=torch.float16)
tensor(1.4902, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0087, device='cuda:0')
tensor(0.0556, device='cuda:0')
old_score: tensor(0.1196, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0655, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.60697865486145
Validation after dual ascent:
out_inf: tensor(3.2949, device='cuda:0', dtype=torch.float16) tensor(0.2148, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.0653, device='cuda:0', dtype=torch.float16)
tensor(0.6890, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.6660, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
tensor(0.7021, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.6533, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.8281, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.7783, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(0.8857, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0145, device='cuda:0')
tensor(0.0331, device='cuda:0')
old_score: tensor(0.0415, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0281, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 88.30686116218567
Validation after dual ascent:
out_inf: tensor(1.6533, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.3721, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
tensor(0.3613, device='cuda:0', dtype=torch.float16) tensor(0.0277, device='cuda:0', dtype=torch.float16)
tensor(0.3979, device='cuda:0', dtype=torch.float16) tensor(0.0286, device='cuda:0', dtype=torch.float16)
tensor(0.4932, device='cuda:0', dtype=torch.float16) tensor(0.0278, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.q_proj
Validation after prune:
out_inf: tensor(19.3281, device='cuda:0', dtype=torch.float16) tensor(0.8667, device='cuda:0', dtype=torch.float16)
tensor(5.7656, device='cuda:0', dtype=torch.float16) tensor(0.3589, device='cuda:0', dtype=torch.float16)
tensor(5.4453, device='cuda:0', dtype=torch.float16) tensor(0.3550, device='cuda:0', dtype=torch.float16)
tensor(5.8242, device='cuda:0', dtype=torch.float16) tensor(0.3596, device='cuda:0', dtype=torch.float16)
tensor(6.2891, device='cuda:0', dtype=torch.float16) tensor(0.3579, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0173, device='cuda:0')
tensor(0.0961, device='cuda:0')
old_score: tensor(0.3579, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1536, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.03289246559143
Validation after dual ascent:
out_inf: tensor(19.3281, device='cuda:0', dtype=torch.float16) tensor(0.8667, device='cuda:0', dtype=torch.float16)
tensor(2.7422, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(2.5195, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.1533, device='cuda:0', dtype=torch.float16)
tensor(3.6250, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.1045, device='cuda:0', dtype=torch.float16)
tensor(4.5547, device='cuda:0', dtype=torch.float16) tensor(0.3792, device='cuda:0', dtype=torch.float16)
tensor(4.4609, device='cuda:0', dtype=torch.float16) tensor(0.3740, device='cuda:0', dtype=torch.float16)
tensor(4.9609, device='cuda:0', dtype=torch.float16) tensor(0.3794, device='cuda:0', dtype=torch.float16)
tensor(4.2578, device='cuda:0', dtype=torch.float16) tensor(0.3806, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0195, device='cuda:0')
tensor(0.0911, device='cuda:0')
old_score: tensor(0.3784, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1525, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.79042100906372
Validation after dual ascent:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.1045, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(1.9668, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(2.2812, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(2.0234, device='cuda:0', dtype=torch.float16) tensor(0.1514, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.9531, device='cuda:0', dtype=torch.float16) tensor(0.3196, device='cuda:0', dtype=torch.float16)
tensor(1.6494, device='cuda:0', dtype=torch.float16) tensor(0.1788, device='cuda:0', dtype=torch.float16)
tensor(1.6777, device='cuda:0', dtype=torch.float16) tensor(0.1775, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1785, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1793, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0093, device='cuda:0')
tensor(0.1781, device='cuda:0')
old_score: tensor(0.1786, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0975, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.428175210952759
Validation after dual ascent:
out_inf: tensor(7.9531, device='cuda:0', dtype=torch.float16) tensor(0.3196, device='cuda:0', dtype=torch.float16)
tensor(0.8691, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(0.8506, device='cuda:0', dtype=torch.float16) tensor(0.0987, device='cuda:0', dtype=torch.float16)
tensor(0.8774, device='cuda:0', dtype=torch.float16) tensor(0.0968, device='cuda:0', dtype=torch.float16)
tensor(0.8403, device='cuda:0', dtype=torch.float16) tensor(0.0973, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.7617, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(1.0029, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(1.2090, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.8438, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0131, device='cuda:0')
tensor(0.0261, device='cuda:0')
old_score: tensor(0.0491, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0240, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.620182991027832
Validation after dual ascent:
out_inf: tensor(4.7617, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(0.4961, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
tensor(0.6797, device='cuda:0', dtype=torch.float16) tensor(0.0237, device='cuda:0', dtype=torch.float16)
tensor(0.6572, device='cuda:0', dtype=torch.float16) tensor(0.0307, device='cuda:0', dtype=torch.float16)
tensor(0.6191, device='cuda:0', dtype=torch.float16) tensor(0.0200, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.0625, device='cuda:0', dtype=torch.float16) tensor(0.3018, device='cuda:0', dtype=torch.float16)
tensor(2.5840, device='cuda:0', dtype=torch.float16) tensor(0.1549, device='cuda:0', dtype=torch.float16)
tensor(2.5938, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(2.8496, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(2.3047, device='cuda:0', dtype=torch.float16) tensor(0.1538, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0130, device='cuda:0')
tensor(0.0707, device='cuda:0')
old_score: tensor(0.1536, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0744, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.597728967666626
Validation after dual ascent:
out_inf: tensor(6.0625, device='cuda:0', dtype=torch.float16) tensor(0.3018, device='cuda:0', dtype=torch.float16)
tensor(1.8740, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.0752, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.0725, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.3047, device='cuda:0', dtype=torch.float16) tensor(0.2249, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1285, device='cuda:0', dtype=torch.float16)
tensor(1.4570, device='cuda:0', dtype=torch.float16) tensor(0.1268, device='cuda:0', dtype=torch.float16)
tensor(1.4902, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0098, device='cuda:0')
tensor(0.0648, device='cuda:0')
old_score: tensor(0.1274, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0704, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.3428635597229
Validation after dual ascent:
out_inf: tensor(4.3047, device='cuda:0', dtype=torch.float16) tensor(0.2249, device='cuda:0', dtype=torch.float16)
tensor(0.8359, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(0.6396, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.4717, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.8066, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0462, device='cuda:0', dtype=torch.float16)
tensor(1.0566, device='cuda:0', dtype=torch.float16) tensor(0.0463, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0111, device='cuda:0')
tensor(0.0198, device='cuda:0')
old_score: tensor(0.0471, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0301, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 88.91937375068665
Validation after dual ascent:
out_inf: tensor(1.4717, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.5459, device='cuda:0', dtype=torch.float16) tensor(0.0300, device='cuda:0', dtype=torch.float16)
tensor(0.4990, device='cuda:0', dtype=torch.float16) tensor(0.0300, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0313, device='cuda:0', dtype=torch.float16)
tensor(0.4756, device='cuda:0', dtype=torch.float16) tensor(0.0292, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.q_proj
Validation after prune:
out_inf: tensor(21.4688, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(4.9297, device='cuda:0', dtype=torch.float16) tensor(0.3647, device='cuda:0', dtype=torch.float16)
tensor(4.8906, device='cuda:0', dtype=torch.float16) tensor(0.3618, device='cuda:0', dtype=torch.float16)
tensor(4.6484, device='cuda:0', dtype=torch.float16) tensor(0.3682, device='cuda:0', dtype=torch.float16)
tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(0.1241, device='cuda:0')
old_score: tensor(0.3650, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1591, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.90481662750244
Validation after dual ascent:
out_inf: tensor(21.4688, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(2.0742, device='cuda:0', dtype=torch.float16) tensor(0.1570, device='cuda:0', dtype=torch.float16)
tensor(2.0469, device='cuda:0', dtype=torch.float16) tensor(0.1605, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.1653, device='cuda:0', dtype=torch.float16)
tensor(2.0371, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.1094, device='cuda:0', dtype=torch.float16) tensor(1.0986, device='cuda:0', dtype=torch.float16)
tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.3962, device='cuda:0', dtype=torch.float16)
tensor(4.2031, device='cuda:0', dtype=torch.float16) tensor(0.3931, device='cuda:0', dtype=torch.float16)
tensor(4.6250, device='cuda:0', dtype=torch.float16) tensor(0.3984, device='cuda:0', dtype=torch.float16)
tensor(4.3125, device='cuda:0', dtype=torch.float16) tensor(0.3953, device='cuda:0', dtype=torch.float16)
tensor(0.1325, device='cuda:0')
old_score: tensor(0.3958, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1624, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.059866189956665
Validation after dual ascent:
out_inf: tensor(17.1094, device='cuda:0', dtype=torch.float16) tensor(1.0986, device='cuda:0', dtype=torch.float16)
tensor(2.1113, device='cuda:0', dtype=torch.float16) tensor(0.1603, device='cuda:0', dtype=torch.float16)
tensor(1.9863, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
tensor(1.9629, device='cuda:0', dtype=torch.float16) tensor(0.1686, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1570, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.6875, device='cuda:0', dtype=torch.float16) tensor(0.3149, device='cuda:0', dtype=torch.float16)
tensor(1.5146, device='cuda:0', dtype=torch.float16) tensor(0.1788, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1772, device='cuda:0', dtype=torch.float16)
tensor(1.5381, device='cuda:0', dtype=torch.float16) tensor(0.1787, device='cuda:0', dtype=torch.float16)
tensor(1.5234, device='cuda:0', dtype=torch.float16) tensor(0.1787, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0169, device='cuda:0')
tensor(0.0799, device='cuda:0')
old_score: tensor(0.1783, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0958, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 18.60372829437256
Validation after dual ascent:
out_inf: tensor(5.6875, device='cuda:0', dtype=torch.float16) tensor(0.3149, device='cuda:0', dtype=torch.float16)
tensor(0.8525, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(0.8838, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0993, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.o_proj
Validation after prune:
out_inf: tensor(6.4766, device='cuda:0', dtype=torch.float16) tensor(0.0876, device='cuda:0', dtype=torch.float16)
tensor(1.7227, device='cuda:0', dtype=torch.float16) tensor(0.0532, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0169, device='cuda:0')
tensor(0.0333, device='cuda:0')
old_score: tensor(0.0555, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0252, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.89392375946045
Validation after dual ascent:
out_inf: tensor(6.4766, device='cuda:0', dtype=torch.float16) tensor(0.0876, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0230, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0259, device='cuda:0', dtype=torch.float16)
tensor(0.6777, device='cuda:0', dtype=torch.float16) tensor(0.0294, device='cuda:0', dtype=torch.float16)
tensor(0.6553, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.0547, device='cuda:0', dtype=torch.float16) tensor(0.3169, device='cuda:0', dtype=torch.float16)
tensor(2.3516, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
tensor(2.1172, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(2.2734, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(2.4219, device='cuda:0', dtype=torch.float16) tensor(0.1593, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0143, device='cuda:0')
tensor(0.0696, device='cuda:0')
old_score: tensor(0.1578, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0734, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.897202968597412
Validation after dual ascent:
out_inf: tensor(5.0547, device='cuda:0', dtype=torch.float16) tensor(0.3169, device='cuda:0', dtype=torch.float16)
tensor(1.4854, device='cuda:0', dtype=torch.float16) tensor(0.0734, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(1.4580, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.2322, device='cuda:0', dtype=torch.float16)
tensor(1.5410, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.4473, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.4609, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0103, device='cuda:0')
tensor(0.0650, device='cuda:0')
old_score: tensor(0.1318, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0705, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.491629123687744
Validation after dual ascent:
out_inf: tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.2322, device='cuda:0', dtype=torch.float16)
tensor(0.7930, device='cuda:0', dtype=torch.float16) tensor(0.0705, device='cuda:0', dtype=torch.float16)
tensor(0.6660, device='cuda:0', dtype=torch.float16) tensor(0.0703, device='cuda:0', dtype=torch.float16)
tensor(0.7168, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
tensor(0.7368, device='cuda:0', dtype=torch.float16) tensor(0.0678, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.4014, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.8809, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.7910, device='cuda:0', dtype=torch.float16) tensor(0.0495, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0125, device='cuda:0')
tensor(0.0264, device='cuda:0')
old_score: tensor(0.0494, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0307, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 88.57552766799927
Validation after dual ascent:
out_inf: tensor(1.4014, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.4436, device='cuda:0', dtype=torch.float16) tensor(0.0306, device='cuda:0', dtype=torch.float16)
tensor(0.5107, device='cuda:0', dtype=torch.float16) tensor(0.0302, device='cuda:0', dtype=torch.float16)
tensor(0.4707, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.3672, device='cuda:0', dtype=torch.float16) tensor(0.0292, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.1719, device='cuda:0', dtype=torch.float16) tensor(0.8594, device='cuda:0', dtype=torch.float16)
tensor(4.5547, device='cuda:0', dtype=torch.float16) tensor(0.3586, device='cuda:0', dtype=torch.float16)
tensor(4.8516, device='cuda:0', dtype=torch.float16) tensor(0.3574, device='cuda:0', dtype=torch.float16)
tensor(4.3398, device='cuda:0', dtype=torch.float16) tensor(0.3645, device='cuda:0', dtype=torch.float16)
tensor(4.5430, device='cuda:0', dtype=torch.float16) tensor(0.3594, device='cuda:0', dtype=torch.float16)
tensor(0.1961, device='cuda:0')
old_score: tensor(0.3599, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1560, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.219053506851196
Validation after dual ascent:
out_inf: tensor(16.1719, device='cuda:0', dtype=torch.float16) tensor(0.8594, device='cuda:0', dtype=torch.float16)
tensor(2.1406, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(1.9805, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(2.1934, device='cuda:0', dtype=torch.float16) tensor(0.1628, device='cuda:0', dtype=torch.float16)
tensor(2.1660, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.2969, device='cuda:0', dtype=torch.float16) tensor(1.0381, device='cuda:0', dtype=torch.float16)
tensor(4.4844, device='cuda:0', dtype=torch.float16) tensor(0.3821, device='cuda:0', dtype=torch.float16)
tensor(3.8906, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3882, device='cuda:0', dtype=torch.float16)
tensor(4.1836, device='cuda:0', dtype=torch.float16) tensor(0.3816, device='cuda:0', dtype=torch.float16)
tensor(0.1959, device='cuda:0')
old_score: tensor(0.3826, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1566, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.984029293060303
Validation after dual ascent:
out_inf: tensor(18.2969, device='cuda:0', dtype=torch.float16) tensor(1.0381, device='cuda:0', dtype=torch.float16)
tensor(1.9365, device='cuda:0', dtype=torch.float16) tensor(0.1553, device='cuda:0', dtype=torch.float16)
tensor(1.9570, device='cuda:0', dtype=torch.float16) tensor(0.1571, device='cuda:0', dtype=torch.float16)
tensor(2.5293, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(2.1289, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.8477, device='cuda:0', dtype=torch.float16) tensor(0.3113, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.1841, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1832, device='cuda:0', dtype=torch.float16)
tensor(1.7764, device='cuda:0', dtype=torch.float16) tensor(0.1853, device='cuda:0', dtype=torch.float16)
tensor(1.5127, device='cuda:0', dtype=torch.float16) tensor(0.1836, device='cuda:0', dtype=torch.float16)
tensor(0.1217, device='cuda:0')
old_score: tensor(0.1841, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0976, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.960394859313965
Validation after dual ascent:
out_inf: tensor(4.8477, device='cuda:0', dtype=torch.float16) tensor(0.3113, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.0968, device='cuda:0', dtype=torch.float16)
tensor(0.8560, device='cuda:0', dtype=torch.float16) tensor(0.0979, device='cuda:0', dtype=torch.float16)
tensor(0.9922, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.6641, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
tensor(1.0391, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
tensor(2.3203, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(2.1680, device='cuda:0', dtype=torch.float16) tensor(0.0589, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.0494, device='cuda:0', dtype=torch.float16)
tensor(0.0211, device='cuda:0')
old_score: tensor(0.0544, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0246, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.860820055007935
Validation after dual ascent:
out_inf: tensor(5.6641, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
tensor(0.5742, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
tensor(0.5781, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.5664, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.4141, device='cuda:0', dtype=torch.float16) tensor(0.3215, device='cuda:0', dtype=torch.float16)
tensor(2.9336, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
tensor(2.3398, device='cuda:0', dtype=torch.float16) tensor(0.1642, device='cuda:0', dtype=torch.float16)
tensor(2.6699, device='cuda:0', dtype=torch.float16) tensor(0.1658, device='cuda:0', dtype=torch.float16)
tensor(2.6055, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0154, device='cuda:0')
tensor(0.0849, device='cuda:0')
old_score: tensor(0.1646, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0748, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.548522710800171
Validation after dual ascent:
out_inf: tensor(6.4141, device='cuda:0', dtype=torch.float16) tensor(0.3215, device='cuda:0', dtype=torch.float16)
tensor(1.5078, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.0774, device='cuda:0', dtype=torch.float16)
tensor(1.5605, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.7969, device='cuda:0', dtype=torch.float16) tensor(0.2432, device='cuda:0', dtype=torch.float16)
tensor(1.6777, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(1.5400, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
tensor(1.5176, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0118, device='cuda:0')
tensor(0.0805, device='cuda:0')
old_score: tensor(0.1382, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0729, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.337202072143555
Validation after dual ascent:
out_inf: tensor(4.7969, device='cuda:0', dtype=torch.float16) tensor(0.2432, device='cuda:0', dtype=torch.float16)
tensor(0.8291, device='cuda:0', dtype=torch.float16) tensor(0.0743, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0704, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
tensor(0.8301, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.6758, device='cuda:0', dtype=torch.float16) tensor(0.0935, device='cuda:0', dtype=torch.float16)
tensor(0.7827, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
tensor(0.9307, device='cuda:0', dtype=torch.float16) tensor(0.0559, device='cuda:0', dtype=torch.float16)
tensor(0.9629, device='cuda:0', dtype=torch.float16) tensor(0.0564, device='cuda:0', dtype=torch.float16)
tensor(0.8882, device='cuda:0', dtype=torch.float16) tensor(0.0551, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0129, device='cuda:0')
tensor(0.0231, device='cuda:0')
old_score: tensor(0.0555, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0338, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 87.63623857498169
Validation after dual ascent:
out_inf: tensor(2.6758, device='cuda:0', dtype=torch.float16) tensor(0.0935, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0344, device='cuda:0', dtype=torch.float16)
tensor(0.3965, device='cuda:0', dtype=torch.float16) tensor(0.0321, device='cuda:0', dtype=torch.float16)
tensor(0.4453, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
tensor(0.3672, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.4375, device='cuda:0', dtype=torch.float16) tensor(0.8486, device='cuda:0', dtype=torch.float16)
tensor(4.6328, device='cuda:0', dtype=torch.float16) tensor(0.3704, device='cuda:0', dtype=torch.float16)
tensor(4.3438, device='cuda:0', dtype=torch.float16) tensor(0.3672, device='cuda:0', dtype=torch.float16)
tensor(5.1562, device='cuda:0', dtype=torch.float16) tensor(0.3792, device='cuda:0', dtype=torch.float16)
tensor(5.3828, device='cuda:0', dtype=torch.float16) tensor(0.3713, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0188, device='cuda:0')
tensor(0.0339, device='cuda:0')
old_score: tensor(0.3718, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1562, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 18.78818702697754
Validation after dual ascent:
out_inf: tensor(16.4375, device='cuda:0', dtype=torch.float16) tensor(0.8486, device='cuda:0', dtype=torch.float16)
tensor(2.0430, device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
tensor(1.9961, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(2.3262, device='cuda:0', dtype=torch.float16) tensor(0.1637, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.3125, device='cuda:0', dtype=torch.float16) tensor(1.1279, device='cuda:0', dtype=torch.float16)
tensor(4.1016, device='cuda:0', dtype=torch.float16) tensor(0.4028, device='cuda:0', dtype=torch.float16)
tensor(3.7344, device='cuda:0', dtype=torch.float16) tensor(0.3962, device='cuda:0', dtype=torch.float16)
tensor(4.3281, device='cuda:0', dtype=torch.float16) tensor(0.4087, device='cuda:0', dtype=torch.float16)
tensor(4.5938, device='cuda:0', dtype=torch.float16) tensor(0.4033, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0196, device='cuda:0')
tensor(0.0379, device='cuda:0')
old_score: tensor(0.4026, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1572, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.510432481765747
Validation after dual ascent:
out_inf: tensor(17.3125, device='cuda:0', dtype=torch.float16) tensor(1.1279, device='cuda:0', dtype=torch.float16)
tensor(1.9023, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(1.7676, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(2.0781, device='cuda:0', dtype=torch.float16) tensor(0.1644, device='cuda:0', dtype=torch.float16)
tensor(1.7529, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3086, device='cuda:0', dtype=torch.float16)
tensor(1.5244, device='cuda:0', dtype=torch.float16) tensor(0.1829, device='cuda:0', dtype=torch.float16)
tensor(1.6318, device='cuda:0', dtype=torch.float16) tensor(0.1799, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1832, device='cuda:0', dtype=torch.float16)
tensor(1.6436, device='cuda:0', dtype=torch.float16) tensor(0.1819, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0092, device='cuda:0')
tensor(0.1382, device='cuda:0')
old_score: tensor(0.1819, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0963, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.096728324890137
Validation after dual ascent:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3086, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
tensor(0.7974, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.9482, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.1719, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(1.8008, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(1.9277, device='cuda:0', dtype=torch.float16) tensor(0.0601, device='cuda:0', dtype=torch.float16)
tensor(2.2422, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(1.8398, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0147, device='cuda:0')
tensor(0.0215, device='cuda:0')
old_score: tensor(0.0578, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0275, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.512298822402954
Validation after dual ascent:
out_inf: tensor(8.1719, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.4980, device='cuda:0', dtype=torch.float16) tensor(0.0274, device='cuda:0', dtype=torch.float16)
tensor(0.4336, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.8262, device='cuda:0', dtype=torch.float16) tensor(0.0309, device='cuda:0', dtype=torch.float16)
tensor(0.4297, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.3276, device='cuda:0', dtype=torch.float16)
tensor(3.5586, device='cuda:0', dtype=torch.float16) tensor(0.1674, device='cuda:0', dtype=torch.float16)
tensor(3.1074, device='cuda:0', dtype=torch.float16) tensor(0.1652, device='cuda:0', dtype=torch.float16)
tensor(3.1172, device='cuda:0', dtype=torch.float16) tensor(0.1665, device='cuda:0', dtype=torch.float16)
tensor(3.7363, device='cuda:0', dtype=torch.float16) tensor(0.1676, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0163, device='cuda:0')
tensor(0.0969, device='cuda:0')
old_score: tensor(0.1666, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0770, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.350566864013672
Validation after dual ascent:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.3276, device='cuda:0', dtype=torch.float16)
tensor(1.8076, device='cuda:0', dtype=torch.float16) tensor(0.0794, device='cuda:0', dtype=torch.float16)
tensor(1.6768, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(1.4248, device='cuda:0', dtype=torch.float16) tensor(0.0803, device='cuda:0', dtype=torch.float16)
tensor(1.7773, device='cuda:0', dtype=torch.float16) tensor(0.0749, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.5430, device='cuda:0', dtype=torch.float16) tensor(0.2489, device='cuda:0', dtype=torch.float16)
tensor(2.0273, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(1.7852, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0128, device='cuda:0')
tensor(0.0924, device='cuda:0')
old_score: tensor(0.1403, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0751, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.346451044082642
Validation after dual ascent:
out_inf: tensor(4.5430, device='cuda:0', dtype=torch.float16) tensor(0.2489, device='cuda:0', dtype=torch.float16)
tensor(0.8320, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.7363, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.8203, device='cuda:0', dtype=torch.float16) tensor(0.0784, device='cuda:0', dtype=torch.float16)
tensor(0.8994, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.7803, device='cuda:0', dtype=torch.float16) tensor(0.0976, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.8750, device='cuda:0', dtype=torch.float16) tensor(0.0558, device='cuda:0', dtype=torch.float16)
tensor(0.9082, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0182, device='cuda:0')
tensor(0.0186, device='cuda:0')
old_score: tensor(0.0568, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0359, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 77.01965022087097
Validation after dual ascent:
out_inf: tensor(1.7803, device='cuda:0', dtype=torch.float16) tensor(0.0976, device='cuda:0', dtype=torch.float16)
tensor(0.4751, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
tensor(0.4688, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(0.4375, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.q_proj
Validation after prune:
out_inf: tensor(18.2812, device='cuda:0', dtype=torch.float16) tensor(0.8560, device='cuda:0', dtype=torch.float16)
tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.3674, device='cuda:0', dtype=torch.float16)
tensor(4.8555, device='cuda:0', dtype=torch.float16) tensor(0.3618, device='cuda:0', dtype=torch.float16)
tensor(5.0195, device='cuda:0', dtype=torch.float16) tensor(0.3706, device='cuda:0', dtype=torch.float16)
tensor(4.8906, device='cuda:0', dtype=torch.float16) tensor(0.3657, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0191, device='cuda:0')
tensor(0.2167, device='cuda:0')
old_score: tensor(0.3662, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1532, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 9.213053464889526
Validation after dual ascent:
out_inf: tensor(18.2812, device='cuda:0', dtype=torch.float16) tensor(0.8560, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.1558, device='cuda:0', dtype=torch.float16)
tensor(1.9209, device='cuda:0', dtype=torch.float16) tensor(0.1479, device='cuda:0', dtype=torch.float16)
tensor(2.2148, device='cuda:0', dtype=torch.float16) tensor(0.1609, device='cuda:0', dtype=torch.float16)
tensor(1.8955, device='cuda:0', dtype=torch.float16) tensor(0.1482, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.8125, device='cuda:0', dtype=torch.float16) tensor(1.1123, device='cuda:0', dtype=torch.float16)
tensor(4.4141, device='cuda:0', dtype=torch.float16) tensor(0.4053, device='cuda:0', dtype=torch.float16)
tensor(4.0078, device='cuda:0', dtype=torch.float16) tensor(0.3982, device='cuda:0', dtype=torch.float16)
tensor(5.1758, device='cuda:0', dtype=torch.float16) tensor(0.4082, device='cuda:0', dtype=torch.float16)
tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.4053, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0195, device='cuda:0')
tensor(0.1219, device='cuda:0')
old_score: tensor(0.4043, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1562, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.641712427139282
Validation after dual ascent:
out_inf: tensor(17.8125, device='cuda:0', dtype=torch.float16) tensor(1.1123, device='cuda:0', dtype=torch.float16)
tensor(1.9492, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(1.8516, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.8926, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.8174, device='cuda:0', dtype=torch.float16) tensor(0.1511, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.9062, device='cuda:0', dtype=torch.float16) tensor(0.3184, device='cuda:0', dtype=torch.float16)
tensor(1.6494, device='cuda:0', dtype=torch.float16) tensor(0.1880, device='cuda:0', dtype=torch.float16)
tensor(1.4590, device='cuda:0', dtype=torch.float16) tensor(0.1818, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.1869, device='cuda:0', dtype=torch.float16)
tensor(1.4326, device='cuda:0', dtype=torch.float16) tensor(0.1851, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0085, device='cuda:0')
tensor(0.1722, device='cuda:0')
old_score: tensor(0.1854, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0992, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.41737699508667
Validation after dual ascent:
out_inf: tensor(4.9062, device='cuda:0', dtype=torch.float16) tensor(0.3184, device='cuda:0', dtype=torch.float16)
tensor(0.8286, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
tensor(0.8760, device='cuda:0', dtype=torch.float16) tensor(0.1038, device='cuda:0', dtype=torch.float16)
tensor(0.8452, device='cuda:0', dtype=torch.float16) tensor(0.0963, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.o_proj
Validation after prune:
out_inf: tensor(9.3203, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.0613, device='cuda:0', dtype=torch.float16)
tensor(1.9043, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.0595, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0186, device='cuda:0')
tensor(0.0409, device='cuda:0')
old_score: tensor(0.0624, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0342, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.64826488494873
Validation after dual ascent:
out_inf: tensor(9.3203, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(0.5957, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(0.5645, device='cuda:0', dtype=torch.float16) tensor(0.0329, device='cuda:0', dtype=torch.float16)
tensor(0.6387, device='cuda:0', dtype=torch.float16) tensor(0.0394, device='cuda:0', dtype=torch.float16)
tensor(0.6094, device='cuda:0', dtype=torch.float16) tensor(0.0314, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.8086, device='cuda:0', dtype=torch.float16) tensor(0.3452, device='cuda:0', dtype=torch.float16)
tensor(3.1758, device='cuda:0', dtype=torch.float16) tensor(0.1754, device='cuda:0', dtype=torch.float16)
tensor(2.6738, device='cuda:0', dtype=torch.float16) tensor(0.1719, device='cuda:0', dtype=torch.float16)
tensor(2.6973, device='cuda:0', dtype=torch.float16) tensor(0.1742, device='cuda:0', dtype=torch.float16)
tensor(3.6211, device='cuda:0', dtype=torch.float16) tensor(0.1754, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0184, device='cuda:0')
tensor(0.1158, device='cuda:0')
old_score: tensor(0.1742, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0786, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.788947582244873
Validation after dual ascent:
out_inf: tensor(6.8086, device='cuda:0', dtype=torch.float16) tensor(0.3452, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(1.5244, device='cuda:0', dtype=torch.float16) tensor(0.0752, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.0815, device='cuda:0', dtype=torch.float16)
tensor(1.4922, device='cuda:0', dtype=torch.float16) tensor(0.0763, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.2632, device='cuda:0', dtype=torch.float16)
tensor(2.1484, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(2.0410, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(2.3398, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(2.1602, device='cuda:0', dtype=torch.float16) tensor(0.1490, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0150, device='cuda:0')
tensor(0.1092, device='cuda:0')
old_score: tensor(0.1479, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0768, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.702370882034302
Validation after dual ascent:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.2632, device='cuda:0', dtype=torch.float16)
tensor(0.8413, device='cuda:0', dtype=torch.float16) tensor(0.0794, device='cuda:0', dtype=torch.float16)
tensor(0.7910, device='cuda:0', dtype=torch.float16) tensor(0.0736, device='cuda:0', dtype=torch.float16)
tensor(0.7764, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.4688, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0650, device='cuda:0', dtype=torch.float16)
tensor(0.7939, device='cuda:0', dtype=torch.float16) tensor(0.0624, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0642, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0112, device='cuda:0')
tensor(0.0140, device='cuda:0')
old_score: tensor(0.0638, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0411, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 76.07283806800842
Validation after dual ascent:
out_inf: tensor(3.4688, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(0.5171, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.5557, device='cuda:0', dtype=torch.float16) tensor(0.0393, device='cuda:0', dtype=torch.float16)
tensor(0.5332, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.4954, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.5625, device='cuda:0', dtype=torch.float16) tensor(0.8296, device='cuda:0', dtype=torch.float16)
tensor(6.3906, device='cuda:0', dtype=torch.float16) tensor(0.3591, device='cuda:0', dtype=torch.float16)
tensor(6.8125, device='cuda:0', dtype=torch.float16) tensor(0.3481, device='cuda:0', dtype=torch.float16)
tensor(6.2969, device='cuda:0', dtype=torch.float16) tensor(0.3643, device='cuda:0', dtype=torch.float16)
tensor(6.1250, device='cuda:0', dtype=torch.float16) tensor(0.3530, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0193, device='cuda:0')
tensor(0.2185, device='cuda:0')
old_score: tensor(0.3560, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1489, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 9.45836591720581
Validation after dual ascent:
out_inf: tensor(16.5625, device='cuda:0', dtype=torch.float16) tensor(0.8296, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.1527, device='cuda:0', dtype=torch.float16)
tensor(1.9648, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
tensor(2.1680, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(2.9375, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.6562, device='cuda:0', dtype=torch.float16) tensor(1.0938, device='cuda:0', dtype=torch.float16)
tensor(4.3594, device='cuda:0', dtype=torch.float16) tensor(0.3821, device='cuda:0', dtype=torch.float16)
tensor(3.9141, device='cuda:0', dtype=torch.float16) tensor(0.3789, device='cuda:0', dtype=torch.float16)
tensor(3.9062, device='cuda:0', dtype=torch.float16) tensor(0.3960, device='cuda:0', dtype=torch.float16)
tensor(3.9766, device='cuda:0', dtype=torch.float16) tensor(0.3809, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0199, device='cuda:0')
tensor(0.1167, device='cuda:0')
old_score: tensor(0.3843, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1509, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.86994743347168
Validation after dual ascent:
out_inf: tensor(17.6562, device='cuda:0', dtype=torch.float16) tensor(1.0938, device='cuda:0', dtype=torch.float16)
tensor(1.8174, device='cuda:0', dtype=torch.float16) tensor(0.1548, device='cuda:0', dtype=torch.float16)
tensor(1.9326, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.8770, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(1.7207, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.7227, device='cuda:0', dtype=torch.float16) tensor(0.3228, device='cuda:0', dtype=torch.float16)
tensor(2.1426, device='cuda:0', dtype=torch.float16) tensor(0.1940, device='cuda:0', dtype=torch.float16)
tensor(1.6348, device='cuda:0', dtype=torch.float16) tensor(0.1886, device='cuda:0', dtype=torch.float16)
tensor(2.3770, device='cuda:0', dtype=torch.float16) tensor(0.1910, device='cuda:0', dtype=torch.float16)
tensor(1.9629, device='cuda:0', dtype=torch.float16) tensor(0.1915, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0110, device='cuda:0')
tensor(0.1700, device='cuda:0')
old_score: tensor(0.1913, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1008, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.751921653747559
Validation after dual ascent:
out_inf: tensor(4.7227, device='cuda:0', dtype=torch.float16) tensor(0.3228, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
tensor(0.9590, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
tensor(0.9951, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.1484, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.0734, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0762, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0190, device='cuda:0')
tensor(0.0295, device='cuda:0')
old_score: tensor(0.0770, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0378, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.579437732696533
Validation after dual ascent:
out_inf: tensor(8.1484, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.0391, device='cuda:0', dtype=torch.float16)
tensor(0.5898, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
tensor(0.6641, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
tensor(0.6172, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.2773, device='cuda:0', dtype=torch.float16) tensor(0.3569, device='cuda:0', dtype=torch.float16)
tensor(2.6973, device='cuda:0', dtype=torch.float16) tensor(0.1849, device='cuda:0', dtype=torch.float16)
tensor(2.9785, device='cuda:0', dtype=torch.float16) tensor(0.1777, device='cuda:0', dtype=torch.float16)
tensor(2.9180, device='cuda:0', dtype=torch.float16) tensor(0.1862, device='cuda:0', dtype=torch.float16)
tensor(2.8105, device='cuda:0', dtype=torch.float16) tensor(0.1812, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0197, device='cuda:0')
tensor(0.1098, device='cuda:0')
old_score: tensor(0.1825, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0795, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.026380062103271
Validation after dual ascent:
out_inf: tensor(6.2773, device='cuda:0', dtype=torch.float16) tensor(0.3569, device='cuda:0', dtype=torch.float16)
tensor(1.4316, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(1.7559, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(1.9160, device='cuda:0', dtype=torch.float16) tensor(0.0763, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.7031, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.1481, device='cuda:0', dtype=torch.float16)
tensor(2.0293, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0152, device='cuda:0')
tensor(0.1036, device='cuda:0')
old_score: tensor(0.1509, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0770, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.110148668289185
Validation after dual ascent:
out_inf: tensor(4.7031, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(0.8633, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
tensor(0.8018, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.down_proj
Validation after prune:
out_inf: tensor(5.2500, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.0710, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.0680, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.0748, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.0692, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0112, device='cuda:0')
tensor(0.0139, device='cuda:0')
old_score: tensor(0.0707, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0418, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 61.71971344947815
Validation after dual ascent:
out_inf: tensor(5.2500, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(0.4307, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0393, device='cuda:0', dtype=torch.float16)
tensor(0.6543, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.4248, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(0.8140, device='cuda:0', dtype=torch.float16)
tensor(4.3281, device='cuda:0', dtype=torch.float16) tensor(0.3582, device='cuda:0', dtype=torch.float16)
tensor(4.2461, device='cuda:0', dtype=torch.float16) tensor(0.3511, device='cuda:0', dtype=torch.float16)
tensor(4.7422, device='cuda:0', dtype=torch.float16) tensor(0.3638, device='cuda:0', dtype=torch.float16)
tensor(4.2422, device='cuda:0', dtype=torch.float16) tensor(0.3511, device='cuda:0', dtype=torch.float16)
tensor(0.0328, device='cuda:0')
old_score: tensor(0.3560, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1329, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.818204641342163
Validation after dual ascent:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(0.8140, device='cuda:0', dtype=torch.float16)
tensor(1.6289, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.7158, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
tensor(1.6650, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
tensor(1.5342, device='cuda:0', dtype=torch.float16) tensor(0.1266, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.0244, device='cuda:0', dtype=torch.float16)
tensor(4.5156, device='cuda:0', dtype=torch.float16) tensor(0.3850, device='cuda:0', dtype=torch.float16)
tensor(4.3594, device='cuda:0', dtype=torch.float16) tensor(0.3804, device='cuda:0', dtype=torch.float16)
tensor(4.7188, device='cuda:0', dtype=torch.float16) tensor(0.3901, device='cuda:0', dtype=torch.float16)
tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.3804, device='cuda:0', dtype=torch.float16)
tensor(0.0374, device='cuda:0')
old_score: tensor(0.3843, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1343, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.1702344417572
Validation after dual ascent:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.0244, device='cuda:0', dtype=torch.float16)
tensor(1.9238, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1294, device='cuda:0', dtype=torch.float16)
tensor(1.7363, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3193, device='cuda:0', dtype=torch.float16)
tensor(1.6230, device='cuda:0', dtype=torch.float16) tensor(0.1935, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1868, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.1926, device='cuda:0', dtype=torch.float16)
tensor(1.6289, device='cuda:0', dtype=torch.float16) tensor(0.1896, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0109, device='cuda:0')
tensor(0.1289, device='cuda:0')
old_score: tensor(0.1907, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0913, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.705398082733154
Validation after dual ascent:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3193, device='cuda:0', dtype=torch.float16)
tensor(0.7988, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(0.9634, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(0.8809, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.0873, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.6992, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(1.9824, device='cuda:0', dtype=torch.float16) tensor(0.0707, device='cuda:0', dtype=torch.float16)
tensor(1.8887, device='cuda:0', dtype=torch.float16) tensor(0.0703, device='cuda:0', dtype=torch.float16)
tensor(2.1953, device='cuda:0', dtype=torch.float16) tensor(0.0710, device='cuda:0', dtype=torch.float16)
tensor(1.7168, device='cuda:0', dtype=torch.float16) tensor(0.0684, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0124, device='cuda:0')
tensor(0.0190, device='cuda:0')
old_score: tensor(0.0701, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0289, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 9.980424165725708
Validation after dual ascent:
out_inf: tensor(5.6992, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
tensor(0.5342, device='cuda:0', dtype=torch.float16) tensor(0.0275, device='cuda:0', dtype=torch.float16)
tensor(0.7363, device='cuda:0', dtype=torch.float16) tensor(0.0340, device='cuda:0', dtype=torch.float16)
tensor(0.7148, device='cuda:0', dtype=torch.float16) tensor(0.0260, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.0078, device='cuda:0', dtype=torch.float16) tensor(0.3875, device='cuda:0', dtype=torch.float16)
tensor(2.7051, device='cuda:0', dtype=torch.float16) tensor(0.1942, device='cuda:0', dtype=torch.float16)
tensor(2.4961, device='cuda:0', dtype=torch.float16) tensor(0.1831, device='cuda:0', dtype=torch.float16)
tensor(2.5195, device='cuda:0', dtype=torch.float16) tensor(0.1954, device='cuda:0', dtype=torch.float16)
tensor(2.5625, device='cuda:0', dtype=torch.float16) tensor(0.1898, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0160, device='cuda:0')
tensor(0.0170, device='cuda:0')
old_score: tensor(0.1907, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0809, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.052197217941284
Validation after dual ascent:
out_inf: tensor(8.0078, device='cuda:0', dtype=torch.float16) tensor(0.3875, device='cuda:0', dtype=torch.float16)
tensor(1.7207, device='cuda:0', dtype=torch.float16) tensor(0.0832, device='cuda:0', dtype=torch.float16)
tensor(1.2754, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
tensor(1.4131, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(1.5791, device='cuda:0', dtype=torch.float16) tensor(0.0775, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.7695, device='cuda:0', dtype=torch.float16) tensor(0.2661, device='cuda:0', dtype=torch.float16)
tensor(2.3320, device='cuda:0', dtype=torch.float16) tensor(0.1542, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
tensor(2.2617, device='cuda:0', dtype=torch.float16) tensor(0.1533, device='cuda:0', dtype=torch.float16)
tensor(1.7871, device='cuda:0', dtype=torch.float16) tensor(0.1511, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0148, device='cuda:0')
tensor(0.1053, device='cuda:0')
old_score: tensor(0.1515, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0775, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.349651098251343
Validation after dual ascent:
out_inf: tensor(6.7695, device='cuda:0', dtype=torch.float16) tensor(0.2661, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.0796, device='cuda:0', dtype=torch.float16)
tensor(0.7964, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.8726, device='cuda:0', dtype=torch.float16) tensor(0.0742, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.6621, device='cuda:0', dtype=torch.float16) tensor(0.1095, device='cuda:0', dtype=torch.float16)
tensor(0.8813, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(0.8037, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(0.7119, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0634, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0140, device='cuda:0')
tensor(0.0157, device='cuda:0')
old_score: tensor(0.0641, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0392, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 69.4249312877655
Validation after dual ascent:
out_inf: tensor(2.6621, device='cuda:0', dtype=torch.float16) tensor(0.1095, device='cuda:0', dtype=torch.float16)
tensor(0.5010, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.4365, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.5049, device='cuda:0', dtype=torch.float16) tensor(0.0432, device='cuda:0', dtype=torch.float16)
tensor(0.4316, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.9375, device='cuda:0', dtype=torch.float16) tensor(0.8384, device='cuda:0', dtype=torch.float16)
tensor(4.1875, device='cuda:0', dtype=torch.float16) tensor(0.3623, device='cuda:0', dtype=torch.float16)
tensor(3.8281, device='cuda:0', dtype=torch.float16) tensor(0.3528, device='cuda:0', dtype=torch.float16)
tensor(4.4766, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(3.7969, device='cuda:0', dtype=torch.float16) tensor(0.3572, device='cuda:0', dtype=torch.float16)
tensor(0.0379, device='cuda:0')
old_score: tensor(0.3596, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1367, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.05684733390808
Validation after dual ascent:
out_inf: tensor(14.9375, device='cuda:0', dtype=torch.float16) tensor(0.8384, device='cuda:0', dtype=torch.float16)
tensor(1.7305, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(1.7227, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
tensor(2.2559, device='cuda:0', dtype=torch.float16) tensor(0.1301, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.0469, device='cuda:0', dtype=torch.float16) tensor(1.0029, device='cuda:0', dtype=torch.float16)
tensor(4.4766, device='cuda:0', dtype=torch.float16) tensor(0.3884, device='cuda:0', dtype=torch.float16)
tensor(4.1797, device='cuda:0', dtype=torch.float16) tensor(0.3831, device='cuda:0', dtype=torch.float16)
tensor(4.4609, device='cuda:0', dtype=torch.float16) tensor(0.3972, device='cuda:0', dtype=torch.float16)
tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3855, device='cuda:0', dtype=torch.float16)
tensor(0.0398, device='cuda:0')
old_score: tensor(0.3887, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1377, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.80218267440796
Validation after dual ascent:
out_inf: tensor(17.0469, device='cuda:0', dtype=torch.float16) tensor(1.0029, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.1406, device='cuda:0', dtype=torch.float16)
tensor(1.8301, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
tensor(1.9180, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
tensor(1.7412, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.5859, device='cuda:0', dtype=torch.float16) tensor(0.3384, device='cuda:0', dtype=torch.float16)
tensor(1.6816, device='cuda:0', dtype=torch.float16) tensor(0.2075, device='cuda:0', dtype=torch.float16)
tensor(1.7705, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.2096, device='cuda:0', dtype=torch.float16)
tensor(1.9268, device='cuda:0', dtype=torch.float16) tensor(0.2042, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0130, device='cuda:0')
tensor(0.1712, device='cuda:0')
old_score: tensor(0.2057, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1005, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.10551643371582
Validation after dual ascent:
out_inf: tensor(4.5859, device='cuda:0', dtype=torch.float16) tensor(0.3384, device='cuda:0', dtype=torch.float16)
tensor(0.9189, device='cuda:0', dtype=torch.float16) tensor(0.1027, device='cuda:0', dtype=torch.float16)
tensor(0.9858, device='cuda:0', dtype=torch.float16) tensor(0.0964, device='cuda:0', dtype=torch.float16)
tensor(1.0186, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
tensor(0.9346, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.3125, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.0569, device='cuda:0', dtype=torch.float16)
tensor(1.8457, device='cuda:0', dtype=torch.float16) tensor(0.0539, device='cuda:0', dtype=torch.float16)
tensor(1.9219, device='cuda:0', dtype=torch.float16) tensor(0.0590, device='cuda:0', dtype=torch.float16)
tensor(1.4219, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
tensor(0.0260, device='cuda:0')
old_score: tensor(0.0560, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0306, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.816068172454834
Validation after dual ascent:
out_inf: tensor(4.3125, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(0.8369, device='cuda:0', dtype=torch.float16) tensor(0.0304, device='cuda:0', dtype=torch.float16)
tensor(0.6875, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.8125, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.6982, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.3516, device='cuda:0', dtype=torch.float16) tensor(0.3928, device='cuda:0', dtype=torch.float16)
tensor(3.7969, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(2.9160, device='cuda:0', dtype=torch.float16) tensor(0.1932, device='cuda:0', dtype=torch.float16)
tensor(3.2480, device='cuda:0', dtype=torch.float16) tensor(0.2041, device='cuda:0', dtype=torch.float16)
tensor(3.3594, device='cuda:0', dtype=torch.float16) tensor(0.1975, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0161, device='cuda:0')
tensor(0.0185, device='cuda:0')
old_score: tensor(0.1992, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0837, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.525293350219727
Validation after dual ascent:
out_inf: tensor(9.3516, device='cuda:0', dtype=torch.float16) tensor(0.3928, device='cuda:0', dtype=torch.float16)
tensor(1.3047, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.0803, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
tensor(1.6270, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.9531, device='cuda:0', dtype=torch.float16) tensor(0.2668, device='cuda:0', dtype=torch.float16)
tensor(2.2383, device='cuda:0', dtype=torch.float16) tensor(0.1576, device='cuda:0', dtype=torch.float16)
tensor(2.2520, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(2.3066, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(2.1543, device='cuda:0', dtype=torch.float16) tensor(0.1539, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0164, device='cuda:0')
tensor(0.1239, device='cuda:0')
old_score: tensor(0.1550, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0793, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.12186336517334
Validation after dual ascent:
out_inf: tensor(6.9531, device='cuda:0', dtype=torch.float16) tensor(0.2668, device='cuda:0', dtype=torch.float16)
tensor(0.8677, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(0.8545, device='cuda:0', dtype=torch.float16) tensor(0.0761, device='cuda:0', dtype=torch.float16)
tensor(0.8452, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(0.7998, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.7695, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.0264, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.6973, device='cuda:0', dtype=torch.float16) tensor(0.0675, device='cuda:0', dtype=torch.float16)
tensor(0.7363, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0167, device='cuda:0')
tensor(0.0130, device='cuda:0')
old_score: tensor(0.0710, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0431, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 55.55788540840149
Validation after dual ascent:
out_inf: tensor(4.7695, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(0.5674, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.5098, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.5605, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.3125, device='cuda:0', dtype=torch.float16) tensor(0.8159, device='cuda:0', dtype=torch.float16)
tensor(4.2383, device='cuda:0', dtype=torch.float16) tensor(0.3542, device='cuda:0', dtype=torch.float16)
tensor(4.4883, device='cuda:0', dtype=torch.float16) tensor(0.3508, device='cuda:0', dtype=torch.float16)
tensor(4.3203, device='cuda:0', dtype=torch.float16) tensor(0.3633, device='cuda:0', dtype=torch.float16)
tensor(4.1406, device='cuda:0', dtype=torch.float16) tensor(0.3489, device='cuda:0', dtype=torch.float16)
tensor(0.0472, device='cuda:0')
old_score: tensor(0.3542, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1333, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.03594398498535
Validation after dual ascent:
out_inf: tensor(14.3125, device='cuda:0', dtype=torch.float16) tensor(0.8159, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1353, device='cuda:0', dtype=torch.float16)
tensor(1.5381, device='cuda:0', dtype=torch.float16) tensor(0.1292, device='cuda:0', dtype=torch.float16)
tensor(1.6162, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(1.5576, device='cuda:0', dtype=torch.float16) tensor(0.1265, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.5781, device='cuda:0', dtype=torch.float16) tensor(1.0771, device='cuda:0', dtype=torch.float16)
tensor(4.5625, device='cuda:0', dtype=torch.float16) tensor(0.3789, device='cuda:0', dtype=torch.float16)
tensor(4.3828, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(4.5938, device='cuda:0', dtype=torch.float16) tensor(0.3933, device='cuda:0', dtype=torch.float16)
tensor(4.9766, device='cuda:0', dtype=torch.float16) tensor(0.3770, device='cuda:0', dtype=torch.float16)
tensor(0.0529, device='cuda:0')
old_score: tensor(0.3818, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1346, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.31540846824646
Validation after dual ascent:
out_inf: tensor(18.5781, device='cuda:0', dtype=torch.float16) tensor(1.0771, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1367, device='cuda:0', dtype=torch.float16)
tensor(1.9199, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.8105, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.8047, device='cuda:0', dtype=torch.float16) tensor(0.3596, device='cuda:0', dtype=torch.float16)
tensor(1.8311, device='cuda:0', dtype=torch.float16) tensor(0.2135, device='cuda:0', dtype=torch.float16)
tensor(1.6709, device='cuda:0', dtype=torch.float16) tensor(0.2090, device='cuda:0', dtype=torch.float16)
tensor(1.7324, device='cuda:0', dtype=torch.float16) tensor(0.2146, device='cuda:0', dtype=torch.float16)
tensor(1.6816, device='cuda:0', dtype=torch.float16) tensor(0.2100, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0150, device='cuda:0')
tensor(0.1783, device='cuda:0')
old_score: tensor(0.2117, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1017, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.7458717823028564
Validation after dual ascent:
out_inf: tensor(3.8047, device='cuda:0', dtype=torch.float16) tensor(0.3596, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.1035, device='cuda:0', dtype=torch.float16)
tensor(1.0146, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(1.0127, device='cuda:0', dtype=torch.float16) tensor(0.1080, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.o_proj
Validation after prune:
out_inf: tensor(7.1094, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(1.8789, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(1.8340, device='cuda:0', dtype=torch.float16) tensor(0.0719, device='cuda:0', dtype=torch.float16)
tensor(1.9961, device='cuda:0', dtype=torch.float16) tensor(0.0629, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.0623, device='cuda:0', dtype=torch.float16)
tensor(0.0379, device='cuda:0')
old_score: tensor(0.0660, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0352, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.7596652507782
Validation after dual ascent:
out_inf: tensor(7.1094, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0342, device='cuda:0', dtype=torch.float16)
tensor(0.7578, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.7812, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
tensor(0.6504, device='cuda:0', dtype=torch.float16) tensor(0.0326, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.1484, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(2.9688, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(3.1719, device='cuda:0', dtype=torch.float16) tensor(0.1949, device='cuda:0', dtype=torch.float16)
tensor(3.0234, device='cuda:0', dtype=torch.float16) tensor(0.2052, device='cuda:0', dtype=torch.float16)
tensor(3.7148, device='cuda:0', dtype=torch.float16) tensor(0.1984, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0146, device='cuda:0')
tensor(0.0193, device='cuda:0')
old_score: tensor(0.2001, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0871, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.60891342163086
Validation after dual ascent:
out_inf: tensor(7.1484, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
tensor(1.5391, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.0832, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.4336, device='cuda:0', dtype=torch.float16) tensor(0.2700, device='cuda:0', dtype=torch.float16)
tensor(2.2637, device='cuda:0', dtype=torch.float16) tensor(0.1605, device='cuda:0', dtype=torch.float16)
tensor(2.4727, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
tensor(2.4570, device='cuda:0', dtype=torch.float16) tensor(0.1600, device='cuda:0', dtype=torch.float16)
tensor(2.2656, device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0180, device='cuda:0')
tensor(0.1431, device='cuda:0')
old_score: tensor(0.1586, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0822, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.795759439468384
Validation after dual ascent:
out_inf: tensor(6.4336, device='cuda:0', dtype=torch.float16) tensor(0.2700, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(0.8188, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0870, device='cuda:0', dtype=torch.float16)
tensor(0.9570, device='cuda:0', dtype=torch.float16) tensor(0.0785, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.1719, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(1.1504, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
tensor(0.8159, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.9575, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0113, device='cuda:0')
tensor(0.0241, device='cuda:0')
old_score: tensor(0.0678, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0425, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.99920463562012
Validation after dual ascent:
out_inf: tensor(4.1719, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(0.6465, device='cuda:0', dtype=torch.float16) tensor(0.0433, device='cuda:0', dtype=torch.float16)
tensor(0.5093, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
tensor(0.5498, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
tensor(0.6045, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.3906, device='cuda:0', dtype=torch.float16) tensor(0.8369, device='cuda:0', dtype=torch.float16)
tensor(4.1094, device='cuda:0', dtype=torch.float16) tensor(0.3545, device='cuda:0', dtype=torch.float16)
tensor(4.1562, device='cuda:0', dtype=torch.float16) tensor(0.3486, device='cuda:0', dtype=torch.float16)
tensor(4.5156, device='cuda:0', dtype=torch.float16) tensor(0.3628, device='cuda:0', dtype=torch.float16)
tensor(4.3164, device='cuda:0', dtype=torch.float16) tensor(0.3479, device='cuda:0', dtype=torch.float16)
tensor(0.0343, device='cuda:0')
old_score: tensor(0.3535, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1335, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.14246606826782
Validation after dual ascent:
out_inf: tensor(16.3906, device='cuda:0', dtype=torch.float16) tensor(0.8369, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1354, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(1.5986, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.7969, device='cuda:0', dtype=torch.float16) tensor(1.0596, device='cuda:0', dtype=torch.float16)
tensor(4.5312, device='cuda:0', dtype=torch.float16) tensor(0.3733, device='cuda:0', dtype=torch.float16)
tensor(4.3438, device='cuda:0', dtype=torch.float16) tensor(0.3696, device='cuda:0', dtype=torch.float16)
tensor(5.0781, device='cuda:0', dtype=torch.float16) tensor(0.3831, device='cuda:0', dtype=torch.float16)
tensor(4.4219, device='cuda:0', dtype=torch.float16) tensor(0.3701, device='cuda:0', dtype=torch.float16)
tensor(0.0377, device='cuda:0')
old_score: tensor(0.3740, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1343, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 27.826963186264038
Validation after dual ascent:
out_inf: tensor(18.7969, device='cuda:0', dtype=torch.float16) tensor(1.0596, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.5859, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.6973, device='cuda:0', dtype=torch.float16) tensor(0.3450, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.2113, device='cuda:0', dtype=torch.float16)
tensor(1.7100, device='cuda:0', dtype=torch.float16) tensor(0.2064, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.2098, device='cuda:0', dtype=torch.float16)
tensor(1.8867, device='cuda:0', dtype=torch.float16) tensor(0.2078, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0121, device='cuda:0')
tensor(0.1661, device='cuda:0')
old_score: tensor(0.2087, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1017, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.624150991439819
Validation after dual ascent:
out_inf: tensor(3.6973, device='cuda:0', dtype=torch.float16) tensor(0.3450, device='cuda:0', dtype=torch.float16)
tensor(0.9097, device='cuda:0', dtype=torch.float16) tensor(0.1036, device='cuda:0', dtype=torch.float16)
tensor(0.9692, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(0.9863, device='cuda:0', dtype=torch.float16) tensor(0.0972, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.o_proj
Validation after prune:
out_inf: tensor(11.6250, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.0857, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.0831, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.0689, device='cuda:0', dtype=torch.float16)
tensor(1.5117, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(0.0210, device='cuda:0')
old_score: tensor(0.0795, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0402, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.661506414413452
Validation after dual ascent:
out_inf: tensor(11.6250, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(0.7500, device='cuda:0', dtype=torch.float16) tensor(0.0407, device='cuda:0', dtype=torch.float16)
tensor(0.8906, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0404, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.7891, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(2.7930, device='cuda:0', dtype=torch.float16) tensor(0.1990, device='cuda:0', dtype=torch.float16)
tensor(2.8438, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
tensor(2.8301, device='cuda:0', dtype=torch.float16) tensor(0.2041, device='cuda:0', dtype=torch.float16)
tensor(2.7773, device='cuda:0', dtype=torch.float16) tensor(0.1958, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0143, device='cuda:0')
tensor(0.0193, device='cuda:0')
old_score: tensor(0.1978, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0887, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.598590612411499
Validation after dual ascent:
out_inf: tensor(7.7891, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(2.6250, device='cuda:0', dtype=torch.float16) tensor(0.0893, device='cuda:0', dtype=torch.float16)
tensor(1.5215, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.0960, device='cuda:0', dtype=torch.float16)
tensor(1.4414, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.1719, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.1604, device='cuda:0', dtype=torch.float16)
tensor(1.6758, device='cuda:0', dtype=torch.float16) tensor(0.1556, device='cuda:0', dtype=torch.float16)
tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.1630, device='cuda:0', dtype=torch.float16)
tensor(2.0195, device='cuda:0', dtype=torch.float16) tensor(0.1584, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0183, device='cuda:0')
tensor(0.1471, device='cuda:0')
old_score: tensor(0.1594, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0831, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.981600761413574
Validation after dual ascent:
out_inf: tensor(4.1719, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(1.3125, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.8232, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
tensor(0.8379, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(0.9043, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.down_proj
Validation after prune:
out_inf: tensor(6.2109, device='cuda:0', dtype=torch.float16) tensor(0.1166, device='cuda:0', dtype=torch.float16)
tensor(0.8682, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(0.7705, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(0.9375, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0700, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0100, device='cuda:0')
tensor(0.0162, device='cuda:0')
old_score: tensor(0.0694, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0423, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.238672494888306
Validation after dual ascent:
out_inf: tensor(6.2109, device='cuda:0', dtype=torch.float16) tensor(0.1166, device='cuda:0', dtype=torch.float16)
tensor(0.5464, device='cuda:0', dtype=torch.float16) tensor(0.0427, device='cuda:0', dtype=torch.float16)
tensor(0.4878, device='cuda:0', dtype=torch.float16) tensor(0.0390, device='cuda:0', dtype=torch.float16)
tensor(0.5708, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.5654, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(0.7998, device='cuda:0', dtype=torch.float16)
tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3445, device='cuda:0', dtype=torch.float16)
tensor(4.0078, device='cuda:0', dtype=torch.float16) tensor(0.3403, device='cuda:0', dtype=torch.float16)
tensor(4.8203, device='cuda:0', dtype=torch.float16) tensor(0.3606, device='cuda:0', dtype=torch.float16)
tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.3401, device='cuda:0', dtype=torch.float16)
tensor(0.0841, device='cuda:0')
old_score: tensor(0.3462, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1312, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.946913242340088
Validation after dual ascent:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(0.7998, device='cuda:0', dtype=torch.float16)
tensor(1.6963, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
tensor(1.6953, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.4902, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.0625, device='cuda:0', dtype=torch.float16) tensor(1.0107, device='cuda:0', dtype=torch.float16)
tensor(4.7109, device='cuda:0', dtype=torch.float16) tensor(0.3582, device='cuda:0', dtype=torch.float16)
tensor(4.3438, device='cuda:0', dtype=torch.float16) tensor(0.3550, device='cuda:0', dtype=torch.float16)
tensor(4.4531, device='cuda:0', dtype=torch.float16) tensor(0.3743, device='cuda:0', dtype=torch.float16)
tensor(4.4531, device='cuda:0', dtype=torch.float16) tensor(0.3557, device='cuda:0', dtype=torch.float16)
tensor(0.0762, device='cuda:0')
old_score: tensor(0.3606, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1313, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.005249500274658
Validation after dual ascent:
out_inf: tensor(19.0625, device='cuda:0', dtype=torch.float16) tensor(1.0107, device='cuda:0', dtype=torch.float16)
tensor(2.1250, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.7305, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.5566, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.6055, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(2.0293, device='cuda:0', dtype=torch.float16) tensor(0.2223, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.2174, device='cuda:0', dtype=torch.float16)
tensor(2.0918, device='cuda:0', dtype=torch.float16) tensor(0.2236, device='cuda:0', dtype=torch.float16)
tensor(2.2754, device='cuda:0', dtype=torch.float16) tensor(0.2184, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0154, device='cuda:0')
tensor(0.0646, device='cuda:0')
old_score: tensor(0.2203, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1062, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.719960689544678
Validation after dual ascent:
out_inf: tensor(5.6055, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(1.0596, device='cuda:0', dtype=torch.float16) tensor(0.1069, device='cuda:0', dtype=torch.float16)
tensor(0.9414, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.1140, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1006, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.o_proj
Validation after prune:
out_inf: tensor(7.2188, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.7441, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(1.7070, device='cuda:0', dtype=torch.float16) tensor(0.0930, device='cuda:0', dtype=torch.float16)
tensor(2.0020, device='cuda:0', dtype=torch.float16) tensor(0.0890, device='cuda:0', dtype=torch.float16)
tensor(2.2383, device='cuda:0', dtype=torch.float16) tensor(0.0828, device='cuda:0', dtype=torch.float16)
tensor(0.0368, device='cuda:0')
old_score: tensor(0.0898, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0495, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.709243297576904
Validation after dual ascent:
out_inf: tensor(7.2188, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.9062, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.0448, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.4883, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(2.7637, device='cuda:0', dtype=torch.float16) tensor(0.2021, device='cuda:0', dtype=torch.float16)
tensor(2.5059, device='cuda:0', dtype=torch.float16) tensor(0.1980, device='cuda:0', dtype=torch.float16)
tensor(2.8457, device='cuda:0', dtype=torch.float16) tensor(0.2072, device='cuda:0', dtype=torch.float16)
tensor(2.7852, device='cuda:0', dtype=torch.float16) tensor(0.1998, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0146, device='cuda:0')
tensor(0.0209, device='cuda:0')
old_score: tensor(0.2018, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0916, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.174218893051147
Validation after dual ascent:
out_inf: tensor(7.4883, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(1.2471, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
tensor(1.9648, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(1.4219, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.0866, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.5000, device='cuda:0', dtype=torch.float16) tensor(0.2693, device='cuda:0', dtype=torch.float16)
tensor(2.0332, device='cuda:0', dtype=torch.float16) tensor(0.1622, device='cuda:0', dtype=torch.float16)
tensor(1.9492, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(1.9355, device='cuda:0', dtype=torch.float16) tensor(0.1633, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0191, device='cuda:0')
tensor(0.1589, device='cuda:0')
old_score: tensor(0.1608, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0852, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.033020257949829
Validation after dual ascent:
out_inf: tensor(5.5000, device='cuda:0', dtype=torch.float16) tensor(0.2693, device='cuda:0', dtype=torch.float16)
tensor(0.8618, device='cuda:0', dtype=torch.float16) tensor(0.0849, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.0831, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.0805, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.4590, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(0.9136, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.9365, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0089, device='cuda:0')
tensor(0.0115, device='cuda:0')
old_score: tensor(0.0662, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0414, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 45.962313175201416
Validation after dual ascent:
out_inf: tensor(3.4590, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(0.6069, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.4585, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.5420, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.q_proj
Validation after prune:
out_inf: tensor(18.4531, device='cuda:0', dtype=torch.float16) tensor(0.8647, device='cuda:0', dtype=torch.float16)
tensor(4.3359, device='cuda:0', dtype=torch.float16) tensor(0.3625, device='cuda:0', dtype=torch.float16)
tensor(4.0859, device='cuda:0', dtype=torch.float16) tensor(0.3589, device='cuda:0', dtype=torch.float16)
tensor(4.2031, device='cuda:0', dtype=torch.float16) tensor(0.3789, device='cuda:0', dtype=torch.float16)
tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3591, device='cuda:0', dtype=torch.float16)
tensor(0.0910, device='cuda:0')
old_score: tensor(0.3650, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.81200122833252
Validation after dual ascent:
out_inf: tensor(18.4531, device='cuda:0', dtype=torch.float16) tensor(0.8647, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.9375, device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(4.6172, device='cuda:0', dtype=torch.float16) tensor(0.3721, device='cuda:0', dtype=torch.float16)
tensor(4.1250, device='cuda:0', dtype=torch.float16) tensor(0.3716, device='cuda:0', dtype=torch.float16)
tensor(4.5938, device='cuda:0', dtype=torch.float16) tensor(0.3899, device='cuda:0', dtype=torch.float16)
tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3716, device='cuda:0', dtype=torch.float16)
tensor(0.0910, device='cuda:0')
old_score: tensor(0.3765, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 30.147520065307617
Validation after dual ascent:
out_inf: tensor(20.9375, device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(2.0938, device='cuda:0', dtype=torch.float16) tensor(0.1372, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1356, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.7979, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.2422, device='cuda:0', dtype=torch.float16) tensor(0.3757, device='cuda:0', dtype=torch.float16)
tensor(2.4297, device='cuda:0', dtype=torch.float16) tensor(0.2300, device='cuda:0', dtype=torch.float16)
tensor(2.3945, device='cuda:0', dtype=torch.float16) tensor(0.2271, device='cuda:0', dtype=torch.float16)
tensor(1.8730, device='cuda:0', dtype=torch.float16) tensor(0.2324, device='cuda:0', dtype=torch.float16)
tensor(2.1211, device='cuda:0', dtype=torch.float16) tensor(0.2269, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0172, device='cuda:0')
tensor(0.0776, device='cuda:0')
old_score: tensor(0.2291, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1090, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 27.39205813407898
Validation after dual ascent:
out_inf: tensor(7.2422, device='cuda:0', dtype=torch.float16) tensor(0.3757, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.1067, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.o_proj
Validation after prune:
out_inf: tensor(11.5938, device='cuda:0', dtype=torch.float16) tensor(0.1716, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
tensor(1.1250, device='cuda:0', dtype=torch.float16) tensor(0.0908, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0852, device='cuda:0', dtype=torch.float16)
tensor(0.8496, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(0.0609, device='cuda:0')
old_score: tensor(0.0917, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0518, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.81540822982788
Validation after dual ascent:
out_inf: tensor(11.5938, device='cuda:0', dtype=torch.float16) tensor(0.1716, device='cuda:0', dtype=torch.float16)
tensor(0.5234, device='cuda:0', dtype=torch.float16) tensor(0.0495, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(0.5742, device='cuda:0', dtype=torch.float16) tensor(0.0523, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.3203, device='cuda:0', dtype=torch.float16) tensor(0.3540, device='cuda:0', dtype=torch.float16)
tensor(3.2090, device='cuda:0', dtype=torch.float16) tensor(0.1976, device='cuda:0', dtype=torch.float16)
tensor(3.2773, device='cuda:0', dtype=torch.float16) tensor(0.1915, device='cuda:0', dtype=torch.float16)
tensor(3.1875, device='cuda:0', dtype=torch.float16) tensor(0.1964, device='cuda:0', dtype=torch.float16)
tensor(3.3926, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0141, device='cuda:0')
tensor(0.0186, device='cuda:0')
old_score: tensor(0.1943, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0906, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.625207662582397
Validation after dual ascent:
out_inf: tensor(7.3203, device='cuda:0', dtype=torch.float16) tensor(0.3540, device='cuda:0', dtype=torch.float16)
tensor(1.8086, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(2.2812, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.8320, device='cuda:0', dtype=torch.float16) tensor(0.2688, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1613, device='cuda:0', dtype=torch.float16)
tensor(1.7090, device='cuda:0', dtype=torch.float16) tensor(0.1564, device='cuda:0', dtype=torch.float16)
tensor(1.8926, device='cuda:0', dtype=torch.float16) tensor(0.1600, device='cuda:0', dtype=torch.float16)
tensor(1.7188, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0177, device='cuda:0')
tensor(0.1404, device='cuda:0')
old_score: tensor(0.1587, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0836, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.39408564567566
Validation after dual ascent:
out_inf: tensor(4.8320, device='cuda:0', dtype=torch.float16) tensor(0.2688, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.8887, device='cuda:0', dtype=torch.float16) tensor(0.0818, device='cuda:0', dtype=torch.float16)
tensor(0.8345, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.9883, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(0.7393, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.6318, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(0.6768, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0647, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0090, device='cuda:0')
tensor(0.0120, device='cuda:0')
old_score: tensor(0.0642, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0402, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.828948974609375
Validation after dual ascent:
out_inf: tensor(1.9883, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(0.5015, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(0.4524, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
tensor(0.4185, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(0.4429, device='cuda:0', dtype=torch.float16) tensor(0.0378, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.5000, device='cuda:0', dtype=torch.float16) tensor(0.8574, device='cuda:0', dtype=torch.float16)
tensor(3.9453, device='cuda:0', dtype=torch.float16) tensor(0.3687, device='cuda:0', dtype=torch.float16)
tensor(3.8984, device='cuda:0', dtype=torch.float16) tensor(0.3652, device='cuda:0', dtype=torch.float16)
tensor(4.4844, device='cuda:0', dtype=torch.float16) tensor(0.3838, device='cuda:0', dtype=torch.float16)
tensor(3.5703, device='cuda:0', dtype=torch.float16) tensor(0.3633, device='cuda:0', dtype=torch.float16)
tensor(0.1968, device='cuda:0')
old_score: tensor(0.3701, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1438, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.94666838645935
Validation after dual ascent:
out_inf: tensor(16.5000, device='cuda:0', dtype=torch.float16) tensor(0.8574, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1406, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.7432, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(1.6934, device='cuda:0', dtype=torch.float16) tensor(0.1343, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.0029, device='cuda:0', dtype=torch.float16)
tensor(4.0469, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.3774, device='cuda:0', dtype=torch.float16)
tensor(4.3281, device='cuda:0', dtype=torch.float16) tensor(0.3940, device='cuda:0', dtype=torch.float16)
tensor(4.1484, device='cuda:0', dtype=torch.float16) tensor(0.3765, device='cuda:0', dtype=torch.float16)
tensor(0.2190, device='cuda:0')
old_score: tensor(0.3813, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1438, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.90138077735901
Validation after dual ascent:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.0029, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
tensor(1.6396, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.8545, device='cuda:0', dtype=torch.float16) tensor(0.1583, device='cuda:0', dtype=torch.float16)
tensor(1.6582, device='cuda:0', dtype=torch.float16) tensor(0.1345, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.4180, device='cuda:0', dtype=torch.float16) tensor(0.4133, device='cuda:0', dtype=torch.float16)
tensor(1.9766, device='cuda:0', dtype=torch.float16) tensor(0.2505, device='cuda:0', dtype=torch.float16)
tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.2479, device='cuda:0', dtype=torch.float16)
tensor(2.0117, device='cuda:0', dtype=torch.float16) tensor(0.2517, device='cuda:0', dtype=torch.float16)
tensor(2.0977, device='cuda:0', dtype=torch.float16) tensor(0.2463, device='cuda:0', dtype=torch.float16)
tensor(0.1339, device='cuda:0')
old_score: tensor(0.2490, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1207, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.89934182167053
Validation after dual ascent:
out_inf: tensor(4.4180, device='cuda:0', dtype=torch.float16) tensor(0.4133, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.1186, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(1.1807, device='cuda:0', dtype=torch.float16) tensor(0.1131, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.o_proj
Validation after prune:
out_inf: tensor(16.1094, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(1.8945, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
tensor(1.8984, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.0816, device='cuda:0', dtype=torch.float16)
tensor(2.0938, device='cuda:0', dtype=torch.float16) tensor(0.0848, device='cuda:0', dtype=torch.float16)
tensor(0.0685, device='cuda:0')
old_score: tensor(0.0891, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0522, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.508988618850708
Validation after dual ascent:
out_inf: tensor(16.1094, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(0.7188, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0550, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0545, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.3359, device='cuda:0', dtype=torch.float16) tensor(0.3772, device='cuda:0', dtype=torch.float16)
tensor(3.5664, device='cuda:0', dtype=torch.float16) tensor(0.2104, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.2089, device='cuda:0', dtype=torch.float16)
tensor(2.9336, device='cuda:0', dtype=torch.float16) tensor(0.2156, device='cuda:0', dtype=torch.float16)
tensor(3.0508, device='cuda:0', dtype=torch.float16) tensor(0.2079, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0155, device='cuda:0')
tensor(0.0236, device='cuda:0')
old_score: tensor(0.2107, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0957, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.086627721786499
Validation after dual ascent:
out_inf: tensor(9.3359, device='cuda:0', dtype=torch.float16) tensor(0.3772, device='cuda:0', dtype=torch.float16)
tensor(1.2373, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.0940, device='cuda:0', dtype=torch.float16)
tensor(1.4150, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
tensor(1.6797, device='cuda:0', dtype=torch.float16) tensor(0.0892, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.1875, device='cuda:0', dtype=torch.float16) tensor(0.2791, device='cuda:0', dtype=torch.float16)
tensor(2.0762, device='cuda:0', dtype=torch.float16) tensor(0.1693, device='cuda:0', dtype=torch.float16)
tensor(1.9766, device='cuda:0', dtype=torch.float16) tensor(0.1665, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1733, device='cuda:0', dtype=torch.float16)
tensor(2.0410, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0090, device='cuda:0')
tensor(0.0191, device='cuda:0')
old_score: tensor(0.1687, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0888, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.622528314590454
Validation after dual ascent:
out_inf: tensor(6.1875, device='cuda:0', dtype=torch.float16) tensor(0.2791, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0865, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0874, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
tensor(1.3164, device='cuda:0', dtype=torch.float16) tensor(0.0827, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.down_proj
Validation after prune:
out_inf: tensor(9.4844, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(0.6353, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.5947, device='cuda:0', dtype=torch.float16) tensor(0.0675, device='cuda:0', dtype=torch.float16)
tensor(0.6562, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0176, device='cuda:0')
tensor(0.0360, device='cuda:0')
old_score: tensor(0.0701, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0441, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.28865170478821
Validation after dual ascent:
out_inf: tensor(9.4844, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(0.4783, device='cuda:0', dtype=torch.float16) tensor(0.0434, device='cuda:0', dtype=torch.float16)
tensor(0.4639, device='cuda:0', dtype=torch.float16) tensor(0.0429, device='cuda:0', dtype=torch.float16)
tensor(0.4553, device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
tensor(0.5063, device='cuda:0', dtype=torch.float16) tensor(0.0407, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.2969, device='cuda:0', dtype=torch.float16) tensor(0.8066, device='cuda:0', dtype=torch.float16)
tensor(4.4961, device='cuda:0', dtype=torch.float16) tensor(0.3418, device='cuda:0', dtype=torch.float16)
tensor(4.2109, device='cuda:0', dtype=torch.float16) tensor(0.3428, device='cuda:0', dtype=torch.float16)
tensor(4.7578, device='cuda:0', dtype=torch.float16) tensor(0.3696, device='cuda:0', dtype=torch.float16)
tensor(3.9727, device='cuda:0', dtype=torch.float16) tensor(0.3367, device='cuda:0', dtype=torch.float16)
tensor(0.0793, device='cuda:0')
old_score: tensor(0.3479, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1355, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.955668926239014
Validation after dual ascent:
out_inf: tensor(17.2969, device='cuda:0', dtype=torch.float16) tensor(0.8066, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.1310, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
tensor(1.8193, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
tensor(1.8516, device='cuda:0', dtype=torch.float16) tensor(0.1250, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.5938, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(4.3516, device='cuda:0', dtype=torch.float16) tensor(0.3579, device='cuda:0', dtype=torch.float16)
tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.3584, device='cuda:0', dtype=torch.float16)
tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.3823, device='cuda:0', dtype=torch.float16)
tensor(3.4141, device='cuda:0', dtype=torch.float16) tensor(0.3540, device='cuda:0', dtype=torch.float16)
tensor(0.0890, device='cuda:0')
old_score: tensor(0.3633, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1349, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.961119174957275
Validation after dual ascent:
out_inf: tensor(18.5938, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(1.6465, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
tensor(1.9502, device='cuda:0', dtype=torch.float16) tensor(0.1332, device='cuda:0', dtype=torch.float16)
tensor(1.7148, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(1.6172, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.9492, device='cuda:0', dtype=torch.float16) tensor(0.3984, device='cuda:0', dtype=torch.float16)
tensor(2.2461, device='cuda:0', dtype=torch.float16) tensor(0.2399, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.2413, device='cuda:0', dtype=torch.float16)
tensor(2.2910, device='cuda:0', dtype=torch.float16) tensor(0.2493, device='cuda:0', dtype=torch.float16)
tensor(2.2090, device='cuda:0', dtype=torch.float16) tensor(0.2361, device='cuda:0', dtype=torch.float16)
tensor(0.0473, device='cuda:0')
old_score: tensor(0.2417, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1168, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.94059085845947
Validation after dual ascent:
out_inf: tensor(5.9492, device='cuda:0', dtype=torch.float16) tensor(0.3984, device='cuda:0', dtype=torch.float16)
tensor(1.1963, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.1221, device='cuda:0', dtype=torch.float16) tensor(0.1307, device='cuda:0', dtype=torch.float16)
tensor(1.1855, device='cuda:0', dtype=torch.float16) tensor(0.1079, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.o_proj
Validation after prune:
out_inf: tensor(15.3438, device='cuda:0', dtype=torch.float16) tensor(0.1991, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1172, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
tensor(1.3906, device='cuda:0', dtype=torch.float16) tensor(0.1142, device='cuda:0', dtype=torch.float16)
tensor(0.1123, device='cuda:0')
old_score: tensor(0.1154, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0646, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.88122224807739
Validation after dual ascent:
out_inf: tensor(15.3438, device='cuda:0', dtype=torch.float16) tensor(0.1991, device='cuda:0', dtype=torch.float16)
tensor(0.7383, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0647, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0615, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.8359, device='cuda:0', dtype=torch.float16) tensor(0.3765, device='cuda:0', dtype=torch.float16)
tensor(3.1016, device='cuda:0', dtype=torch.float16) tensor(0.2081, device='cuda:0', dtype=torch.float16)
tensor(3.3047, device='cuda:0', dtype=torch.float16) tensor(0.2122, device='cuda:0', dtype=torch.float16)
tensor(3.0234, device='cuda:0', dtype=torch.float16) tensor(0.2161, device='cuda:0', dtype=torch.float16)
tensor(3.1309, device='cuda:0', dtype=torch.float16) tensor(0.2075, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0161, device='cuda:0')
tensor(0.0240, device='cuda:0')
old_score: tensor(0.2111, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0975, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.650043964385986
Validation after dual ascent:
out_inf: tensor(8.8359, device='cuda:0', dtype=torch.float16) tensor(0.3765, device='cuda:0', dtype=torch.float16)
tensor(1.5156, device='cuda:0', dtype=torch.float16) tensor(0.0937, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.1090, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.0905, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.6641, device='cuda:0', dtype=torch.float16) tensor(0.2803, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.1708, device='cuda:0', dtype=torch.float16)
tensor(2.0918, device='cuda:0', dtype=torch.float16) tensor(0.1757, device='cuda:0', dtype=torch.float16)
tensor(1.9727, device='cuda:0', dtype=torch.float16) tensor(0.1666, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0096, device='cuda:0')
tensor(0.0197, device='cuda:0')
old_score: tensor(0.1707, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0905, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.352312326431274
Validation after dual ascent:
out_inf: tensor(4.6641, device='cuda:0', dtype=torch.float16) tensor(0.2803, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0868, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.0897, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(1.1592, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.down_proj
Validation after prune:
out_inf: tensor(5.8750, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(0.7358, device='cuda:0', dtype=torch.float16) tensor(0.0722, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.6699, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.6455, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0190, device='cuda:0')
tensor(0.0413, device='cuda:0')
old_score: tensor(0.0714, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0445, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.43852996826172
Validation after dual ascent:
out_inf: tensor(5.8750, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(0.5454, device='cuda:0', dtype=torch.float16) tensor(0.0432, device='cuda:0', dtype=torch.float16)
tensor(0.6631, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
tensor(0.4893, device='cuda:0', dtype=torch.float16) tensor(0.0511, device='cuda:0', dtype=torch.float16)
tensor(0.5171, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.1484, device='cuda:0', dtype=torch.float16) tensor(0.8008, device='cuda:0', dtype=torch.float16)
tensor(4.4609, device='cuda:0', dtype=torch.float16) tensor(0.3484, device='cuda:0', dtype=torch.float16)
tensor(4.5234, device='cuda:0', dtype=torch.float16) tensor(0.3489, device='cuda:0', dtype=torch.float16)
tensor(4.7344, device='cuda:0', dtype=torch.float16) tensor(0.3694, device='cuda:0', dtype=torch.float16)
tensor(4.0977, device='cuda:0', dtype=torch.float16) tensor(0.3430, device='cuda:0', dtype=torch.float16)
tensor(0.0236, device='cuda:0')
old_score: tensor(0.3523, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1425, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.737329721450806
Validation after dual ascent:
out_inf: tensor(15.1484, device='cuda:0', dtype=torch.float16) tensor(0.8008, device='cuda:0', dtype=torch.float16)
tensor(1.8262, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.7559, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.8340, device='cuda:0', dtype=torch.float16) tensor(0.1614, device='cuda:0', dtype=torch.float16)
tensor(1.7236, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.5000, device='cuda:0', dtype=torch.float16) tensor(0.9473, device='cuda:0', dtype=torch.float16)
tensor(4.1953, device='cuda:0', dtype=torch.float16) tensor(0.3604, device='cuda:0', dtype=torch.float16)
tensor(3.9531, device='cuda:0', dtype=torch.float16) tensor(0.3618, device='cuda:0', dtype=torch.float16)
tensor(4.3594, device='cuda:0', dtype=torch.float16) tensor(0.3828, device='cuda:0', dtype=torch.float16)
tensor(4.1250, device='cuda:0', dtype=torch.float16) tensor(0.3550, device='cuda:0', dtype=torch.float16)
tensor(0.0275, device='cuda:0')
old_score: tensor(0.3652, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1426, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.76265525817871
Validation after dual ascent:
out_inf: tensor(19.5000, device='cuda:0', dtype=torch.float16) tensor(0.9473, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.1365, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1417, device='cuda:0', dtype=torch.float16)
tensor(1.6777, device='cuda:0', dtype=torch.float16) tensor(0.1614, device='cuda:0', dtype=torch.float16)
tensor(1.8203, device='cuda:0', dtype=torch.float16) tensor(0.1307, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.1914, device='cuda:0', dtype=torch.float16) tensor(0.4197, device='cuda:0', dtype=torch.float16)
tensor(2.3340, device='cuda:0', dtype=torch.float16) tensor(0.2554, device='cuda:0', dtype=torch.float16)
tensor(2.2676, device='cuda:0', dtype=torch.float16) tensor(0.2578, device='cuda:0', dtype=torch.float16)
tensor(2.3613, device='cuda:0', dtype=torch.float16) tensor(0.2683, device='cuda:0', dtype=torch.float16)
tensor(2.0859, device='cuda:0', dtype=torch.float16) tensor(0.2517, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0152, device='cuda:0')
tensor(0.2704, device='cuda:0')
old_score: tensor(0.2583, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1277, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.536616563796997
Validation after dual ascent:
out_inf: tensor(5.1914, device='cuda:0', dtype=torch.float16) tensor(0.4197, device='cuda:0', dtype=torch.float16)
tensor(1.4316, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.3994, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(1.4482, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.3867, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(1.6133, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(1.8994, device='cuda:0', dtype=torch.float16) tensor(0.0997, device='cuda:0', dtype=torch.float16)
tensor(2.1465, device='cuda:0', dtype=torch.float16) tensor(0.0807, device='cuda:0', dtype=torch.float16)
tensor(1.8359, device='cuda:0', dtype=torch.float16) tensor(0.0952, device='cuda:0', dtype=torch.float16)
tensor(0.1012, device='cuda:0')
old_score: tensor(0.0912, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0471, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 24.614557027816772
Validation after dual ascent:
out_inf: tensor(5.3867, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.0478, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0502, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.7852, device='cuda:0', dtype=torch.float16) tensor(0.3975, device='cuda:0', dtype=torch.float16)
tensor(2.6484, device='cuda:0', dtype=torch.float16) tensor(0.2227, device='cuda:0', dtype=torch.float16)
tensor(2.6523, device='cuda:0', dtype=torch.float16) tensor(0.2290, device='cuda:0', dtype=torch.float16)
tensor(2.9258, device='cuda:0', dtype=torch.float16) tensor(0.2294, device='cuda:0', dtype=torch.float16)
tensor(3.3203, device='cuda:0', dtype=torch.float16) tensor(0.2207, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0185, device='cuda:0')
tensor(0.0269, device='cuda:0')
old_score: tensor(0.2255, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0984, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.31929612159729
Validation after dual ascent:
out_inf: tensor(7.7852, device='cuda:0', dtype=torch.float16) tensor(0.3975, device='cuda:0', dtype=torch.float16)
tensor(1.6543, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(1.4609, device='cuda:0', dtype=torch.float16) tensor(0.0977, device='cuda:0', dtype=torch.float16)
tensor(1.4629, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(2.6875, device='cuda:0', dtype=torch.float16) tensor(0.0907, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.6562, device='cuda:0', dtype=torch.float16) tensor(0.2922, device='cuda:0', dtype=torch.float16)
tensor(2.5898, device='cuda:0', dtype=torch.float16) tensor(0.1758, device='cuda:0', dtype=torch.float16)
tensor(2.6250, device='cuda:0', dtype=torch.float16) tensor(0.1776, device='cuda:0', dtype=torch.float16)
tensor(2.6094, device='cuda:0', dtype=torch.float16) tensor(0.1821, device='cuda:0', dtype=torch.float16)
tensor(2.6016, device='cuda:0', dtype=torch.float16) tensor(0.1730, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0110, device='cuda:0')
tensor(0.0216, device='cuda:0')
old_score: tensor(0.1771, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0916, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.361088991165161
Validation after dual ascent:
out_inf: tensor(7.6562, device='cuda:0', dtype=torch.float16) tensor(0.2922, device='cuda:0', dtype=torch.float16)
tensor(0.9492, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.9951, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
tensor(0.9893, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.1504, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(0.7080, device='cuda:0', dtype=torch.float16) tensor(0.0799, device='cuda:0', dtype=torch.float16)
tensor(0.8193, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
tensor(0.7881, device='cuda:0', dtype=torch.float16) tensor(0.0876, device='cuda:0', dtype=torch.float16)
tensor(1.0576, device='cuda:0', dtype=torch.float16) tensor(0.0773, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0159, device='cuda:0')
tensor(0.0362, device='cuda:0')
old_score: tensor(0.0826, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0469, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.029236316680908
Validation after dual ascent:
out_inf: tensor(3.1504, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(0.5596, device='cuda:0', dtype=torch.float16) tensor(0.0446, device='cuda:0', dtype=torch.float16)
tensor(0.6274, device='cuda:0', dtype=torch.float16) tensor(0.0461, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
tensor(0.9409, device='cuda:0', dtype=torch.float16) tensor(0.0423, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.5781, device='cuda:0', dtype=torch.float16) tensor(0.8682, device='cuda:0', dtype=torch.float16)
tensor(4.1328, device='cuda:0', dtype=torch.float16) tensor(0.3713, device='cuda:0', dtype=torch.float16)
tensor(4.0273, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(4.5039, device='cuda:0', dtype=torch.float16) tensor(0.3916, device='cuda:0', dtype=torch.float16)
tensor(3.8672, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(0.0502, device='cuda:0')
old_score: tensor(0.3760, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1443, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.139275789260864
Validation after dual ascent:
out_inf: tensor(16.5781, device='cuda:0', dtype=torch.float16) tensor(0.8682, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.1449, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1647, device='cuda:0', dtype=torch.float16)
tensor(1.8633, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19., device='cuda:0', dtype=torch.float16) tensor(1.0605, device='cuda:0', dtype=torch.float16)
tensor(4.6094, device='cuda:0', dtype=torch.float16) tensor(0.3821, device='cuda:0', dtype=torch.float16)
tensor(4.1406, device='cuda:0', dtype=torch.float16) tensor(0.3918, device='cuda:0', dtype=torch.float16)
tensor(4.7422, device='cuda:0', dtype=torch.float16) tensor(0.4058, device='cuda:0', dtype=torch.float16)
tensor(4.4297, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(0.0561, device='cuda:0')
old_score: tensor(0.3889, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1440, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.979124546051025
Validation after dual ascent:
out_inf: tensor(19., device='cuda:0', dtype=torch.float16) tensor(1.0605, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.6699, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.7939, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.8555, device='cuda:0', dtype=torch.float16) tensor(0.4382, device='cuda:0', dtype=torch.float16)
tensor(2.4004, device='cuda:0', dtype=torch.float16) tensor(0.2664, device='cuda:0', dtype=torch.float16)
tensor(2.4219, device='cuda:0', dtype=torch.float16) tensor(0.2756, device='cuda:0', dtype=torch.float16)
tensor(2.3086, device='cuda:0', dtype=torch.float16) tensor(0.2788, device='cuda:0', dtype=torch.float16)
tensor(2.4473, device='cuda:0', dtype=torch.float16) tensor(0.2649, device='cuda:0', dtype=torch.float16)
tensor(0.0369, device='cuda:0')
old_score: tensor(0.2715, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1307, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.847909212112427
Validation after dual ascent:
out_inf: tensor(5.8555, device='cuda:0', dtype=torch.float16) tensor(0.4382, device='cuda:0', dtype=torch.float16)
tensor(1.3867, device='cuda:0', dtype=torch.float16) tensor(0.1241, device='cuda:0', dtype=torch.float16)
tensor(1.3838, device='cuda:0', dtype=torch.float16) tensor(0.1315, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1482, device='cuda:0', dtype=torch.float16)
tensor(1.6963, device='cuda:0', dtype=torch.float16) tensor(0.1193, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.o_proj
Validation after prune:
out_inf: tensor(23.7812, device='cuda:0', dtype=torch.float16) tensor(0.2175, device='cuda:0', dtype=torch.float16)
tensor(2.8750, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(3.1953, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(2.8281, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(2.8047, device='cuda:0', dtype=torch.float16) tensor(0.1254, device='cuda:0', dtype=torch.float16)
tensor(0.0659, device='cuda:0')
old_score: tensor(0.1289, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0668, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.607264757156372
Validation after dual ascent:
out_inf: tensor(23.7812, device='cuda:0', dtype=torch.float16) tensor(0.2175, device='cuda:0', dtype=torch.float16)
tensor(1.1592, device='cuda:0', dtype=torch.float16) tensor(0.0611, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.0665, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.0606, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.6250, device='cuda:0', dtype=torch.float16) tensor(0.4246, device='cuda:0', dtype=torch.float16)
tensor(2.8398, device='cuda:0', dtype=torch.float16) tensor(0.2269, device='cuda:0', dtype=torch.float16)
tensor(4.2656, device='cuda:0', dtype=torch.float16) tensor(0.2386, device='cuda:0', dtype=torch.float16)
tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.2418, device='cuda:0', dtype=torch.float16)
tensor(2.6621, device='cuda:0', dtype=torch.float16) tensor(0.2256, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0143, device='cuda:0')
tensor(0.0147, device='cuda:0')
old_score: tensor(0.2333, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1007, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.556148529052734
Validation after dual ascent:
out_inf: tensor(7.6250, device='cuda:0', dtype=torch.float16) tensor(0.4246, device='cuda:0', dtype=torch.float16)
tensor(1.6973, device='cuda:0', dtype=torch.float16) tensor(0.0951, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(1.8896, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.8242, device='cuda:0', dtype=torch.float16) tensor(0.3140, device='cuda:0', dtype=torch.float16)
tensor(2.1035, device='cuda:0', dtype=torch.float16) tensor(0.1833, device='cuda:0', dtype=torch.float16)
tensor(2.3535, device='cuda:0', dtype=torch.float16) tensor(0.1874, device='cuda:0', dtype=torch.float16)
tensor(2.4102, device='cuda:0', dtype=torch.float16) tensor(0.1945, device='cuda:0', dtype=torch.float16)
tensor(2.1211, device='cuda:0', dtype=torch.float16) tensor(0.1798, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0137, device='cuda:0')
tensor(0.0247, device='cuda:0')
old_score: tensor(0.1862, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0939, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.122825622558594
Validation after dual ascent:
out_inf: tensor(5.8242, device='cuda:0', dtype=torch.float16) tensor(0.3140, device='cuda:0', dtype=torch.float16)
tensor(1.0557, device='cuda:0', dtype=torch.float16) tensor(0.0888, device='cuda:0', dtype=torch.float16)
tensor(0.9717, device='cuda:0', dtype=torch.float16) tensor(0.0937, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.2891, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
tensor(0.8877, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(0.8389, device='cuda:0', dtype=torch.float16) tensor(0.0852, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.9111, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0194, device='cuda:0')
tensor(0.0471, device='cuda:0')
old_score: tensor(0.0874, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0515, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 33.24868392944336
Validation after dual ascent:
out_inf: tensor(3.2891, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
tensor(0.8540, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
tensor(0.6816, device='cuda:0', dtype=torch.float16) tensor(0.0508, device='cuda:0', dtype=torch.float16)
tensor(0.6440, device='cuda:0', dtype=torch.float16) tensor(0.0606, device='cuda:0', dtype=torch.float16)
tensor(0.5034, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(0.8193, device='cuda:0', dtype=torch.float16)
tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.3608, device='cuda:0', dtype=torch.float16)
tensor(4.8125, device='cuda:0', dtype=torch.float16) tensor(0.3643, device='cuda:0', dtype=torch.float16)
tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.3823, device='cuda:0', dtype=torch.float16)
tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.3538, device='cuda:0', dtype=torch.float16)
tensor(0.3640, device='cuda:0')
old_score: tensor(0.3652, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1434, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.89079999923706
Validation after dual ascent:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(0.8193, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1644, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.4844, device='cuda:0', dtype=torch.float16) tensor(0.9512, device='cuda:0', dtype=torch.float16)
tensor(5.2422, device='cuda:0', dtype=torch.float16) tensor(0.3828, device='cuda:0', dtype=torch.float16)
tensor(5.2812, device='cuda:0', dtype=torch.float16) tensor(0.3914, device='cuda:0', dtype=torch.float16)
tensor(6.2734, device='cuda:0', dtype=torch.float16) tensor(0.4065, device='cuda:0', dtype=torch.float16)
tensor(4.5703, device='cuda:0', dtype=torch.float16) tensor(0.3757, device='cuda:0', dtype=torch.float16)
tensor(0.3558, device='cuda:0')
old_score: tensor(0.3892, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1443, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.888755559921265
Validation after dual ascent:
out_inf: tensor(17.4844, device='cuda:0', dtype=torch.float16) tensor(0.9512, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1443, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.1656, device='cuda:0', dtype=torch.float16)
tensor(2.1523, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.5469, device='cuda:0', dtype=torch.float16) tensor(0.4202, device='cuda:0', dtype=torch.float16)
tensor(2.0762, device='cuda:0', dtype=torch.float16) tensor(0.2571, device='cuda:0', dtype=torch.float16)
tensor(1.9785, device='cuda:0', dtype=torch.float16) tensor(0.2664, device='cuda:0', dtype=torch.float16)
tensor(2.3711, device='cuda:0', dtype=torch.float16) tensor(0.2708, device='cuda:0', dtype=torch.float16)
tensor(1.9863, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(0.2512, device='cuda:0')
old_score: tensor(0.2617, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1250, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.88398218154907
Validation after dual ascent:
out_inf: tensor(7.5469, device='cuda:0', dtype=torch.float16) tensor(0.4202, device='cuda:0', dtype=torch.float16)
tensor(1.3506, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(1.1230, device='cuda:0', dtype=torch.float16) tensor(0.1257, device='cuda:0', dtype=torch.float16)
tensor(1.4072, device='cuda:0', dtype=torch.float16) tensor(0.1431, device='cuda:0', dtype=torch.float16)
tensor(1.3105, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.8008, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(1.7852, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(1.3340, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(1.6191, device='cuda:0', dtype=torch.float16) tensor(0.0824, device='cuda:0', dtype=torch.float16)
tensor(0.0748, device='cuda:0')
old_score: tensor(0.0780, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0357, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.77892708778381
Validation after dual ascent:
out_inf: tensor(5.8008, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.7988, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.6719, device='cuda:0', dtype=torch.float16) tensor(0.4497, device='cuda:0', dtype=torch.float16)
tensor(3.9570, device='cuda:0', dtype=torch.float16) tensor(0.2411, device='cuda:0', dtype=torch.float16)
tensor(3.6875, device='cuda:0', dtype=torch.float16) tensor(0.2568, device='cuda:0', dtype=torch.float16)
tensor(4.7812, device='cuda:0', dtype=torch.float16) tensor(0.2542, device='cuda:0', dtype=torch.float16)
tensor(4.0195, device='cuda:0', dtype=torch.float16) tensor(0.2404, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0162, device='cuda:0')
tensor(0.0166, device='cuda:0')
old_score: tensor(0.2480, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1010, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 26.04975914955139
Validation after dual ascent:
out_inf: tensor(9.6719, device='cuda:0', dtype=torch.float16) tensor(0.4497, device='cuda:0', dtype=torch.float16)
tensor(2.1895, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(1.6807, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
tensor(1.9316, device='cuda:0', dtype=torch.float16) tensor(0.1156, device='cuda:0', dtype=torch.float16)
tensor(1.5234, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.1250, device='cuda:0', dtype=torch.float16) tensor(0.3416, device='cuda:0', dtype=torch.float16)
tensor(2.3828, device='cuda:0', dtype=torch.float16) tensor(0.1959, device='cuda:0', dtype=torch.float16)
tensor(2.4688, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(2.4316, device='cuda:0', dtype=torch.float16) tensor(0.2043, device='cuda:0', dtype=torch.float16)
tensor(2.5957, device='cuda:0', dtype=torch.float16) tensor(0.1930, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0165, device='cuda:0')
tensor(0.0282, device='cuda:0')
old_score: tensor(0.1987, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0946, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.391704320907593
Validation after dual ascent:
out_inf: tensor(6.1250, device='cuda:0', dtype=torch.float16) tensor(0.3416, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0895, device='cuda:0', dtype=torch.float16)
tensor(0.9795, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.6670, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0087, device='cuda:0')
tensor(0.0172, device='cuda:0')
old_score: tensor(0.1005, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0569, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 33.4848427772522
Validation after dual ascent:
out_inf: tensor(1.6670, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(0.6079, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
tensor(0.6978, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
tensor(0.7720, device='cuda:0', dtype=torch.float16) tensor(0.0664, device='cuda:0', dtype=torch.float16)
tensor(0.7275, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.1719, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(5.6719, device='cuda:0', dtype=torch.float16) tensor(0.3801, device='cuda:0', dtype=torch.float16)
tensor(5.1484, device='cuda:0', dtype=torch.float16) tensor(0.3875, device='cuda:0', dtype=torch.float16)
tensor(5.0938, device='cuda:0', dtype=torch.float16) tensor(0.3962, device='cuda:0', dtype=torch.float16)
tensor(4.8359, device='cuda:0', dtype=torch.float16) tensor(0.3755, device='cuda:0', dtype=torch.float16)
tensor(0.3799, device='cuda:0')
old_score: tensor(0.3848, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1445, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.49801850318909
Validation after dual ascent:
out_inf: tensor(16.1719, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(1.8477, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(2.0938, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.5527, device='cuda:0', dtype=torch.float16) tensor(0.1660, device='cuda:0', dtype=torch.float16)
tensor(1.8184, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.5312, device='cuda:0', dtype=torch.float16) tensor(1.0215, device='cuda:0', dtype=torch.float16)
tensor(6.0781, device='cuda:0', dtype=torch.float16) tensor(0.4006, device='cuda:0', dtype=torch.float16)
tensor(6.0625, device='cuda:0', dtype=torch.float16) tensor(0.4111, device='cuda:0', dtype=torch.float16)
tensor(6.2031, device='cuda:0', dtype=torch.float16) tensor(0.4214, device='cuda:0', dtype=torch.float16)
tensor(6.3125, device='cuda:0', dtype=torch.float16) tensor(0.3967, device='cuda:0', dtype=torch.float16)
tensor(0.4036, device='cuda:0')
old_score: tensor(0.4072, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1453, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.69914627075195
Validation after dual ascent:
out_inf: tensor(19.5312, device='cuda:0', dtype=torch.float16) tensor(1.0215, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
tensor(1.7646, device='cuda:0', dtype=torch.float16) tensor(0.1667, device='cuda:0', dtype=torch.float16)
tensor(1.8105, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.v_proj
Validation after prune:
out_inf: tensor(6.8047, device='cuda:0', dtype=torch.float16) tensor(0.4785, device='cuda:0', dtype=torch.float16)
tensor(2.6523, device='cuda:0', dtype=torch.float16) tensor(0.2864, device='cuda:0', dtype=torch.float16)
tensor(2.8105, device='cuda:0', dtype=torch.float16) tensor(0.2937, device='cuda:0', dtype=torch.float16)
tensor(2.6133, device='cuda:0', dtype=torch.float16) tensor(0.2964, device='cuda:0', dtype=torch.float16)
tensor(2.7402, device='cuda:0', dtype=torch.float16) tensor(0.2817, device='cuda:0', dtype=torch.float16)
tensor(0.3059, device='cuda:0')
old_score: tensor(0.2896, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1335, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.24282932281494
Validation after dual ascent:
out_inf: tensor(6.8047, device='cuda:0', dtype=torch.float16) tensor(0.4785, device='cuda:0', dtype=torch.float16)
tensor(1.5840, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.6621, device='cuda:0', dtype=torch.float16) tensor(0.1342, device='cuda:0', dtype=torch.float16)
tensor(1.5537, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
tensor(1.8232, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.o_proj
Validation after prune:
out_inf: tensor(12.6641, device='cuda:0', dtype=torch.float16) tensor(0.1843, device='cuda:0', dtype=torch.float16)
tensor(3.1367, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(3.1055, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
tensor(4.6328, device='cuda:0', dtype=torch.float16) tensor(0.1232, device='cuda:0', dtype=torch.float16)
tensor(3.5742, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(0.0927, device='cuda:0')
old_score: tensor(0.1165, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0544, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.766114711761475
Validation after dual ascent:
out_inf: tensor(12.6641, device='cuda:0', dtype=torch.float16) tensor(0.1843, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.0484, device='cuda:0', dtype=torch.float16)
tensor(1.2695, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.0496, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.3750, device='cuda:0', dtype=torch.float16) tensor(0.4631, device='cuda:0', dtype=torch.float16)
tensor(3.3242, device='cuda:0', dtype=torch.float16) tensor(0.2515, device='cuda:0', dtype=torch.float16)
tensor(5., device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(4.9883, device='cuda:0', dtype=torch.float16) tensor(0.2646, device='cuda:0', dtype=torch.float16)
tensor(4.0156, device='cuda:0', dtype=torch.float16) tensor(0.2510, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0172, device='cuda:0')
tensor(0.0177, device='cuda:0')
old_score: tensor(0.2593, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1038, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 26.0374276638031
Validation after dual ascent:
out_inf: tensor(8.3750, device='cuda:0', dtype=torch.float16) tensor(0.4631, device='cuda:0', dtype=torch.float16)
tensor(1.9609, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
tensor(1.7383, device='cuda:0', dtype=torch.float16) tensor(0.1042, device='cuda:0', dtype=torch.float16)
tensor(2.1133, device='cuda:0', dtype=torch.float16) tensor(0.1186, device='cuda:0', dtype=torch.float16)
tensor(2.5547, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.2930, device='cuda:0', dtype=torch.float16) tensor(0.3831, device='cuda:0', dtype=torch.float16)
tensor(3.9727, device='cuda:0', dtype=torch.float16) tensor(0.2148, device='cuda:0', dtype=torch.float16)
tensor(3.1094, device='cuda:0', dtype=torch.float16) tensor(0.2218, device='cuda:0', dtype=torch.float16)
tensor(4.1523, device='cuda:0', dtype=torch.float16) tensor(0.2245, device='cuda:0', dtype=torch.float16)
tensor(3.1641, device='cuda:0', dtype=torch.float16) tensor(0.2113, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0189, device='cuda:0')
tensor(0.0180, device='cuda:0')
old_score: tensor(0.2181, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0989, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.81788969039917
Validation after dual ascent:
out_inf: tensor(7.2930, device='cuda:0', dtype=torch.float16) tensor(0.3831, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(1.2227, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.5000, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(1.4824, device='cuda:0', dtype=torch.float16) tensor(0.0900, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
tensor(1.0713, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
tensor(1.4648, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.1218, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0096, device='cuda:0')
tensor(0.0220, device='cuda:0')
old_score: tensor(0.1262, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0692, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 47.09197473526001
Validation after dual ascent:
out_inf: tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
tensor(0.7900, device='cuda:0', dtype=torch.float16) tensor(0.0622, device='cuda:0', dtype=torch.float16)
tensor(0.7964, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
tensor(0.9492, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.0613, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.8516, device='cuda:0', dtype=torch.float16) tensor(0.8477, device='cuda:0', dtype=torch.float16)
tensor(4.9805, device='cuda:0', dtype=torch.float16) tensor(0.3660, device='cuda:0', dtype=torch.float16)
tensor(4.8164, device='cuda:0', dtype=torch.float16) tensor(0.3765, device='cuda:0', dtype=torch.float16)
tensor(5.1875, device='cuda:0', dtype=torch.float16) tensor(0.3906, device='cuda:0', dtype=torch.float16)
tensor(4.4766, device='cuda:0', dtype=torch.float16) tensor(0.3630, device='cuda:0', dtype=torch.float16)
tensor(0.0345, device='cuda:0')
old_score: tensor(0.3740, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1350, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.23091197013855
Validation after dual ascent:
out_inf: tensor(14.8516, device='cuda:0', dtype=torch.float16) tensor(0.8477, device='cuda:0', dtype=torch.float16)
tensor(2.4531, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1353, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1564, device='cuda:0', dtype=torch.float16)
tensor(1.4941, device='cuda:0', dtype=torch.float16) tensor(0.1223, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.9219, device='cuda:0', dtype=torch.float16) tensor(1.0674, device='cuda:0', dtype=torch.float16)
tensor(5.8203, device='cuda:0', dtype=torch.float16) tensor(0.3894, device='cuda:0', dtype=torch.float16)
tensor(5.0625, device='cuda:0', dtype=torch.float16) tensor(0.4033, device='cuda:0', dtype=torch.float16)
tensor(6., device='cuda:0', dtype=torch.float16) tensor(0.4182, device='cuda:0', dtype=torch.float16)
tensor(5.2969, device='cuda:0', dtype=torch.float16) tensor(0.3867, device='cuda:0', dtype=torch.float16)
tensor(0.0602, device='cuda:0')
old_score: tensor(0.3994, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1357, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.00436782836914
Validation after dual ascent:
out_inf: tensor(19.9219, device='cuda:0', dtype=torch.float16) tensor(1.0674, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(2.1250, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.8555, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(3.0625, device='cuda:0', dtype=torch.float16) tensor(0.2773, device='cuda:0', dtype=torch.float16)
tensor(2.7031, device='cuda:0', dtype=torch.float16) tensor(0.2886, device='cuda:0', dtype=torch.float16)
tensor(3.2656, device='cuda:0', dtype=torch.float16) tensor(0.2949, device='cuda:0', dtype=torch.float16)
tensor(3.0039, device='cuda:0', dtype=torch.float16) tensor(0.2754, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0188, device='cuda:0')
tensor(0.1058, device='cuda:0')
old_score: tensor(0.2842, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1304, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 18.303399085998535
Validation after dual ascent:
out_inf: tensor(5.8555, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1182, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.o_proj
Validation after prune:
out_inf: tensor(18.6875, device='cuda:0', dtype=torch.float16) tensor(0.2107, device='cuda:0', dtype=torch.float16)
tensor(4.4297, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(4.2578, device='cuda:0', dtype=torch.float16) tensor(0.1373, device='cuda:0', dtype=torch.float16)
tensor(6.4922, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(3.8828, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
tensor(0.1159, device='cuda:0')
old_score: tensor(0.1295, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0647, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.375776052474976
Validation after dual ascent:
out_inf: tensor(18.6875, device='cuda:0', dtype=torch.float16) tensor(0.2107, device='cuda:0', dtype=torch.float16)
tensor(1.2188, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
tensor(1.4102, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(1.5742, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.1797, device='cuda:0', dtype=torch.float16) tensor(0.4768, device='cuda:0', dtype=torch.float16)
tensor(5.0117, device='cuda:0', dtype=torch.float16) tensor(0.2539, device='cuda:0', dtype=torch.float16)
tensor(5.0859, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
tensor(4.2539, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(4.2227, device='cuda:0', dtype=torch.float16) tensor(0.2554, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0187, device='cuda:0')
tensor(0.0194, device='cuda:0')
old_score: tensor(0.2637, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1063, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.262738943099976
Validation after dual ascent:
out_inf: tensor(9.1797, device='cuda:0', dtype=torch.float16) tensor(0.4768, device='cuda:0', dtype=torch.float16)
tensor(2.3320, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(2.2031, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
tensor(2.5664, device='cuda:0', dtype=torch.float16) tensor(0.1214, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.4392, device='cuda:0', dtype=torch.float16)
tensor(6.6797, device='cuda:0', dtype=torch.float16) tensor(0.2352, device='cuda:0', dtype=torch.float16)
tensor(7.0703, device='cuda:0', dtype=torch.float16) tensor(0.2441, device='cuda:0', dtype=torch.float16)
tensor(6.3828, device='cuda:0', dtype=torch.float16) tensor(0.2478, device='cuda:0', dtype=torch.float16)
tensor(6.3750, device='cuda:0', dtype=torch.float16) tensor(0.2335, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0176, device='cuda:0')
tensor(0.0182, device='cuda:0')
old_score: tensor(0.2402, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1022, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.586316347122192
Validation after dual ascent:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.4392, device='cuda:0', dtype=torch.float16)
tensor(2.6406, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(3.0781, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(3.5469, device='cuda:0', dtype=torch.float16) tensor(0.1168, device='cuda:0', dtype=torch.float16)
tensor(4.0938, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.down_proj
Validation after prune:
out_inf: tensor(10.4375, device='cuda:0', dtype=torch.float16) tensor(0.2627, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.1683, device='cuda:0', dtype=torch.float16)
tensor(1.5508, device='cuda:0', dtype=torch.float16) tensor(0.1760, device='cuda:0', dtype=torch.float16)
tensor(1.7480, device='cuda:0', dtype=torch.float16) tensor(0.1843, device='cuda:0', dtype=torch.float16)
tensor(1.6309, device='cuda:0', dtype=torch.float16) tensor(0.1766, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0168, device='cuda:0')
tensor(0.0727, device='cuda:0')
old_score: tensor(0.1763, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0864, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 45.98963785171509
Validation after dual ascent:
out_inf: tensor(10.4375, device='cuda:0', dtype=torch.float16) tensor(0.2627, device='cuda:0', dtype=torch.float16)
tensor(0.9756, device='cuda:0', dtype=torch.float16) tensor(0.0783, device='cuda:0', dtype=torch.float16)
tensor(1.0889, device='cuda:0', dtype=torch.float16) tensor(0.0880, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0771, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.7344, device='cuda:0', dtype=torch.float16) tensor(0.8882, device='cuda:0', dtype=torch.float16)
tensor(5.2734, device='cuda:0', dtype=torch.float16) tensor(0.3799, device='cuda:0', dtype=torch.float16)
tensor(5.2422, device='cuda:0', dtype=torch.float16) tensor(0.3911, device='cuda:0', dtype=torch.float16)
tensor(5.3594, device='cuda:0', dtype=torch.float16) tensor(0.3970, device='cuda:0', dtype=torch.float16)
tensor(5.3125, device='cuda:0', dtype=torch.float16) tensor(0.3811, device='cuda:0', dtype=torch.float16)
tensor(0.0574, device='cuda:0')
old_score: tensor(0.3872, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1378, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 27.333611965179443
Validation after dual ascent:
out_inf: tensor(15.7344, device='cuda:0', dtype=torch.float16) tensor(0.8882, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
tensor(1.9688, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
tensor(1.8359, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.1254, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.0625, device='cuda:0', dtype=torch.float16) tensor(1.0273, device='cuda:0', dtype=torch.float16)
tensor(6.3867, device='cuda:0', dtype=torch.float16) tensor(0.4104, device='cuda:0', dtype=torch.float16)
tensor(6.1797, device='cuda:0', dtype=torch.float16) tensor(0.4214, device='cuda:0', dtype=torch.float16)
tensor(6.5391, device='cuda:0', dtype=torch.float16) tensor(0.4309, device='cuda:0', dtype=torch.float16)
tensor(6.0156, device='cuda:0', dtype=torch.float16) tensor(0.4084, device='cuda:0', dtype=torch.float16)
tensor(0.0728, device='cuda:0')
old_score: tensor(0.4177, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1398, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 20.973746061325073
Validation after dual ascent:
out_inf: tensor(18.0625, device='cuda:0', dtype=torch.float16) tensor(1.0273, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
tensor(1.5518, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
tensor(2.0469, device='cuda:0', dtype=torch.float16) tensor(0.1605, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.v_proj
Validation after prune:
out_inf: tensor(8.1562, device='cuda:0', dtype=torch.float16) tensor(0.5083, device='cuda:0', dtype=torch.float16)
tensor(2.8711, device='cuda:0', dtype=torch.float16) tensor(0.2991, device='cuda:0', dtype=torch.float16)
tensor(2.7344, device='cuda:0', dtype=torch.float16) tensor(0.3123, device='cuda:0', dtype=torch.float16)
tensor(2.8984, device='cuda:0', dtype=torch.float16) tensor(0.3145, device='cuda:0', dtype=torch.float16)
tensor(2.5508, device='cuda:0', dtype=torch.float16) tensor(0.2986, device='cuda:0', dtype=torch.float16)
tensor(0.0374, device='cuda:0')
old_score: tensor(0.3062, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1348, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.822163581848145
Validation after dual ascent:
out_inf: tensor(8.1562, device='cuda:0', dtype=torch.float16) tensor(0.5083, device='cuda:0', dtype=torch.float16)
tensor(1.3018, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(1.3232, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.3506, device='cuda:0', dtype=torch.float16) tensor(0.1542, device='cuda:0', dtype=torch.float16)
tensor(1.3643, device='cuda:0', dtype=torch.float16) tensor(0.1225, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.o_proj
Validation after prune:
out_inf: tensor(19.9531, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(2.7812, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
tensor(3.0156, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(3.4844, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(3.3906, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(0.1084, device='cuda:0')
old_score: tensor(0.1118, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0468, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.748630046844482
Validation after dual ascent:
out_inf: tensor(19.9531, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.8633, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0465, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(3.3496, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.gate_proj
Validation after prune:
out_inf: tensor(18.2031, device='cuda:0', dtype=torch.float16) tensor(0.5283, device='cuda:0', dtype=torch.float16)
tensor(22.1562, device='cuda:0', dtype=torch.float16) tensor(0.2659, device='cuda:0', dtype=torch.float16)
tensor(23.1875, device='cuda:0', dtype=torch.float16) tensor(0.2861, device='cuda:0', dtype=torch.float16)
tensor(25., device='cuda:0', dtype=torch.float16) tensor(0.2847, device='cuda:0', dtype=torch.float16)
tensor(20.9844, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(0.0274, device='cuda:0')
old_score: tensor(0.2764, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1049, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 75.24697613716125
Validation after dual ascent:
out_inf: tensor(18.2031, device='cuda:0', dtype=torch.float16) tensor(0.5283, device='cuda:0', dtype=torch.float16)
tensor(9.9531, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(9.7344, device='cuda:0', dtype=torch.float16) tensor(0.1055, device='cuda:0', dtype=torch.float16)
tensor(11.1875, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(9.6172, device='cuda:0', dtype=torch.float16) tensor(0.0951, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.up_proj
Validation after prune:
out_inf: tensor(18.5781, device='cuda:0', dtype=torch.float16) tensor(0.5142, device='cuda:0', dtype=torch.float16)
tensor(19.5000, device='cuda:0', dtype=torch.float16) tensor(0.2590, device='cuda:0', dtype=torch.float16)
tensor(22.1719, device='cuda:0', dtype=torch.float16) tensor(0.2705, device='cuda:0', dtype=torch.float16)
tensor(22.3750, device='cuda:0', dtype=torch.float16) tensor(0.2756, device='cuda:0', dtype=torch.float16)
tensor(17.2188, device='cuda:0', dtype=torch.float16) tensor(0.2617, device='cuda:0', dtype=torch.float16)
tensor(0.0265, device='cuda:0')
old_score: tensor(0.2666, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1003, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 83.63229727745056
Validation after dual ascent:
out_inf: tensor(18.5781, device='cuda:0', dtype=torch.float16) tensor(0.5142, device='cuda:0', dtype=torch.float16)
tensor(11.1250, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(9.5469, device='cuda:0', dtype=torch.float16) tensor(0.1012, device='cuda:0', dtype=torch.float16)
tensor(10.8594, device='cuda:0', dtype=torch.float16) tensor(0.1151, device='cuda:0', dtype=torch.float16)
tensor(9.4297, device='cuda:0', dtype=torch.float16) tensor(0.0911, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.down_proj
Validation after prune:
out_inf: tensor(460.5000, device='cuda:0', dtype=torch.float16) tensor(0.6050, device='cuda:0', dtype=torch.float16)
tensor(7.4883, device='cuda:0', dtype=torch.float16) tensor(0.4155, device='cuda:0', dtype=torch.float16)
tensor(7.2266, device='cuda:0', dtype=torch.float16) tensor(0.3979, device='cuda:0', dtype=torch.float16)
tensor(6.6914, device='cuda:0', dtype=torch.float16) tensor(0.3406, device='cuda:0', dtype=torch.float16)
tensor(7.0586, device='cuda:0', dtype=torch.float16) tensor(0.4639, device='cuda:0', dtype=torch.float16)
tensor(0.1992, device='cuda:0')
old_score: tensor(0.4045, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1302, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 212.87737727165222
Validation after dual ascent:
out_inf: tensor(460.5000, device='cuda:0', dtype=torch.float16) tensor(0.6050, device='cuda:0', dtype=torch.float16)
tensor(7.1641, device='cuda:0', dtype=torch.float16) tensor(0.1203, device='cuda:0', dtype=torch.float16)
tensor(6.8984, device='cuda:0', dtype=torch.float16) tensor(0.1317, device='cuda:0', dtype=torch.float16)
tensor(6.3828, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(6.7266, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.9141, device='cuda:0', dtype=torch.float16) tensor(0.9351, device='cuda:0', dtype=torch.float16)
tensor(6.9727, device='cuda:0', dtype=torch.float16) tensor(0.3938, device='cuda:0', dtype=torch.float16)
tensor(6.6328, device='cuda:0', dtype=torch.float16) tensor(0.3933, device='cuda:0', dtype=torch.float16)
tensor(7.0352, device='cuda:0', dtype=torch.float16) tensor(0.4075, device='cuda:0', dtype=torch.float16)
tensor(6.6914, device='cuda:0', dtype=torch.float16) tensor(0.3960, device='cuda:0', dtype=torch.float16)
tensor(0.0363, device='cuda:0')
old_score: tensor(0.39dataset loading complete
pruning layer 0 name self_attn.q_proj
Validation after prune:
out_inf: tensor(7.8555, device='cuda:0', dtype=torch.float16) tensor(0.6099, device='cuda:0', dtype=torch.float16)
tensor(0.3262, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.3262, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
tensor(0.3262, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.3152, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.k_proj
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0092, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.v_proj
Validation after prune:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.2474, device='cuda:0', dtype=torch.float16) tensor(0.0056, device='cuda:0', dtype=torch.float16)
tensor(0.2474, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
tensor(0.2474, device='cuda:0', dtype=torch.float16) tensor(0.0057, device='cuda:0', dtype=torch.float16)
tensor(0.2474, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.0413, device='cuda:0')
old_score: tensor(0.0058, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0025, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 26.849420070648193
Validation after dual ascent:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.2727, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.2727, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.3401, device='cuda:0', dtype=torch.float16) tensor(0.0027, device='cuda:0', dtype=torch.float16)
tensor(0.3154, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0160, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
tensor(0.0164, device='cuda:0', dtype=torch.float16) tensor(0.0009, device='cuda:0', dtype=torch.float16)
tensor(0.0208, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
tensor(0.0139, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0152, device='cuda:0')
tensor(0.0331, device='cuda:0')
old_score: tensor(0.0009, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0002, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.432039737701416
Validation after dual ascent:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0095, device='cuda:0', dtype=torch.float16) tensor(0.0002, device='cuda:0', dtype=torch.float16)
tensor(0.0088, device='cuda:0', dtype=torch.float16) tensor(0.0002, device='cuda:0', dtype=torch.float16)
tensor(0.0091, device='cuda:0', dtype=torch.float16) tensor(0.0002, device='cuda:0', dtype=torch.float16)
tensor(0.0105, device='cuda:0', dtype=torch.float16) tensor(0.0002, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.gate_proj
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.5762, device='cuda:0', dtype=torch.float16) tensor(0.0207, device='cuda:0', dtype=torch.float16)
tensor(0.5879, device='cuda:0', dtype=torch.float16) tensor(0.0215, device='cuda:0', dtype=torch.float16)
tensor(0.6289, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.5986, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
Converged at iteration 600
tensor(0.0195, device='cuda:0')
tensor(0.0204, device='cuda:0')
old_score: tensor(0.0214, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0091, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.958237648010254
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.3887, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
tensor(0.4214, device='cuda:0', dtype=torch.float16) tensor(0.0087, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0100, device='cuda:0', dtype=torch.float16)
tensor(0.4775, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.up_proj
Validation after prune:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.2471, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
tensor(0.2715, device='cuda:0', dtype=torch.float16) tensor(0.0174, device='cuda:0', dtype=torch.float16)
tensor(0.2803, device='cuda:0', dtype=torch.float16) tensor(0.0186, device='cuda:0', dtype=torch.float16)
tensor(0.2622, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
Converged at iteration 600
tensor(0.0187, device='cuda:0')
tensor(0.0192, device='cuda:0')
old_score: tensor(0.0175, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0089, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 45.222891092300415
Validation after dual ascent:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.1865, device='cuda:0', dtype=torch.float16) tensor(0.0086, device='cuda:0', dtype=torch.float16)
tensor(0.1899, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.2051, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.1973, device='cuda:0', dtype=torch.float16) tensor(0.0087, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0797, device='cuda:0', dtype=torch.float16) tensor(0.0027, device='cuda:0', dtype=torch.float16)
tensor(0.0834, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.1195, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
tensor(0.0801, device='cuda:0', dtype=torch.float16) tensor(0.0027, device='cuda:0', dtype=torch.float16)
tensor(0.0873, device='cuda:0')
old_score: tensor(0.0029, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0018, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 206.54685854911804
Validation after dual ascent:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0477, device='cuda:0', dtype=torch.float16) tensor(0.0017, device='cuda:0', dtype=torch.float16)
tensor(0.0865, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
tensor(0.0643, device='cuda:0', dtype=torch.float16) tensor(0.0021, device='cuda:0', dtype=torch.float16)
tensor(0.0498, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.q_proj
Validation after prune:
out_inf: tensor(9.4141, device='cuda:0', dtype=torch.float16) tensor(0.7593, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(1.2520, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(1.4111, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.k_proj
Validation after prune:
out_inf: tensor(7.5156, device='cuda:0', dtype=torch.float16) tensor(0.7549, device='cuda:0', dtype=torch.float16)
tensor(1.3359, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.0781, device='cuda:0', dtype=torch.float16)
tensor(1.2695, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(1.3730, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(0.0658, device='cuda:0')
old_score: tensor(0.0778, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0219, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 27.893927574157715
Validation after dual ascent:
out_inf: tensor(7.5156, device='cuda:0', dtype=torch.float16) tensor(0.7549, device='cuda:0', dtype=torch.float16)
tensor(1.3867, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
tensor(1.3965, device='cuda:0', dtype=torch.float16) tensor(0.0214, device='cuda:0', dtype=torch.float16)
tensor(1.5098, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.v_proj
Validation after prune:
out_inf: tensor(1.5615, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
tensor(0.3516, device='cuda:0', dtype=torch.float16) tensor(0.0187, device='cuda:0', dtype=torch.float16)
tensor(0.3633, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.5234, device='cuda:0', dtype=torch.float16) tensor(0.0183, device='cuda:0', dtype=torch.float16)
tensor(0.4336, device='cuda:0', dtype=torch.float16) tensor(0.0186, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0175, device='cuda:0')
tensor(0.0242, device='cuda:0')
old_score: tensor(0.0186, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0090, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.23909068107605
Validation after dual ascent:
out_inf: tensor(1.5615, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
tensor(0.3223, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.3462, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.3511, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.3672, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.4812, device='cuda:0', dtype=torch.float16) tensor(0.0100, device='cuda:0', dtype=torch.float16)
tensor(0.0412, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0283, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0643, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0508, device='cuda:0', dtype=torch.float16) tensor(0.0023, device='cuda:0', dtype=torch.float16)
Converged at iteration 600
tensor(0.0197, device='cuda:0')
tensor(0.0438, device='cuda:0')
old_score: tensor(0.0024, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0010, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 18.712284803390503
Validation after dual ascent:
out_inf: tensor(0.4812, device='cuda:0', dtype=torch.float16) tensor(0.0100, device='cuda:0', dtype=torch.float16)
tensor(0.0303, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0200, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0315, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0314, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.gate_proj
Validation after prune:
out_inf: tensor(42.1250, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(6.5625, device='cuda:0', dtype=torch.float16) tensor(0.0386, device='cuda:0', dtype=torch.float16)
tensor(6.4375, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
tensor(5.7500, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(6.6562, device='cuda:0', dtype=torch.float16) tensor(0.0394, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0194, device='cuda:0')
tensor(0.0278, device='cuda:0')
old_score: tensor(0.0398, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0200, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.81479573249817
Validation after dual ascent:
out_inf: tensor(42.1250, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(1.9141, device='cuda:0', dtype=torch.float16) tensor(0.0195, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.0194, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
tensor(1.8438, device='cuda:0', dtype=torch.float16) tensor(0.0198, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.up_proj
Validation after prune:
out_inf: tensor(36.7812, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(4.2188, device='cuda:0', dtype=torch.float16) tensor(0.0299, device='cuda:0', dtype=torch.float16)
tensor(4.1250, device='cuda:0', dtype=torch.float16) tensor(0.0301, device='cuda:0', dtype=torch.float16)
tensor(3.9531, device='cuda:0', dtype=torch.float16) tensor(0.0315, device='cuda:0', dtype=torch.float16)
tensor(4.3438, device='cuda:0', dtype=torch.float16) tensor(0.0298, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0145, device='cuda:0')
tensor(0.0231, device='cuda:0')
old_score: tensor(0.0303, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0186, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.718000173568726
Validation after dual ascent:
out_inf: tensor(36.7812, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(1.0469, device='cuda:0', dtype=torch.float16) tensor(0.0180, device='cuda:0', dtype=torch.float16)
tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.0197, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.0184, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.down_proj
Validation after prune:
out_inf: tensor(2526., device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(30.8438, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(30.2969, device='cuda:0', dtype=torch.float16) tensor(0.0061, device='cuda:0', dtype=torch.float16)
tensor(26.9062, device='cuda:0', dtype=torch.float16) tensor(0.0070, device='cuda:0', dtype=torch.float16)
tensor(30.4062, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
tensor(3.7156, device='cuda:0')
old_score: tensor(0.0065, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0083, device='cuda:0', dtype=torch.float16)
Not converged!
Dual ascent finished!
Time: 192.34363913536072
Validation after dual ascent:
out_inf: tensor(2526., device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(30.8438, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(30.2969, device='cuda:0', dtype=torch.float16) tensor(0.0061, device='cuda:0', dtype=torch.float16)
tensor(26.9062, device='cuda:0', dtype=torch.float16) tensor(0.0070, device='cuda:0', dtype=torch.float16)
tensor(30.4062, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.q_proj
Validation after prune:
out_inf: tensor(12.2812, device='cuda:0', dtype=torch.float16) tensor(0.8848, device='cuda:0', dtype=torch.float16)
tensor(2.0391, device='cuda:0', dtype=torch.float16) tensor(0.1626, device='cuda:0', dtype=torch.float16)
tensor(2.2891, device='cuda:0', dtype=torch.float16) tensor(0.1635, device='cuda:0', dtype=torch.float16)
tensor(1.9102, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
tensor(2.1230, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(0.0580, device='cuda:0')
old_score: tensor(0.1624, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0532, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.164695501327515
Validation after dual ascent:
out_inf: tensor(12.2812, device='cuda:0', dtype=torch.float16) tensor(0.8848, device='cuda:0', dtype=torch.float16)
tensor(1.0488, device='cuda:0', dtype=torch.float16) tensor(0.0520, device='cuda:0', dtype=torch.float16)
tensor(0.9902, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(1.1240, device='cuda:0', dtype=torch.float16) tensor(0.0567, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.k_proj
Validation after prune:
out_inf: tensor(13.0703, device='cuda:0', dtype=torch.float16) tensor(1.0117, device='cuda:0', dtype=torch.float16)
tensor(2.8184, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(2.7324, device='cuda:0', dtype=torch.float16) tensor(0.1626, device='cuda:0', dtype=torch.float16)
tensor(2.1367, device='cuda:0', dtype=torch.float16) tensor(0.1610, device='cuda:0', dtype=torch.float16)
tensor(2.7969, device='cuda:0', dtype=torch.float16) tensor(0.1620, device='cuda:0', dtype=torch.float16)
tensor(0.0641, device='cuda:0')
old_score: tensor(0.1622, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0541, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.495673179626465
Validation after dual ascent:
out_inf: tensor(13.0703, device='cuda:0', dtype=torch.float16) tensor(1.0117, device='cuda:0', dtype=torch.float16)
tensor(1.0391, device='cuda:0', dtype=torch.float16) tensor(0.0528, device='cuda:0', dtype=torch.float16)
tensor(1.1299, device='cuda:0', dtype=torch.float16) tensor(0.0524, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(1.1650, device='cuda:0', dtype=torch.float16) tensor(0.0534, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.5918, device='cuda:0', dtype=torch.float16) tensor(0.1292, device='cuda:0', dtype=torch.float16)
tensor(0.6538, device='cuda:0', dtype=torch.float16) tensor(0.0567, device='cuda:0', dtype=torch.float16)
tensor(0.7402, device='cuda:0', dtype=torch.float16) tensor(0.0564, device='cuda:0', dtype=torch.float16)
tensor(0.6655, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
tensor(0.6987, device='cuda:0', dtype=torch.float16) tensor(0.0564, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0115, device='cuda:0')
tensor(0.0642, device='cuda:0')
old_score: tensor(0.0563, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0302, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.1244142055511475
Validation after dual ascent:
out_inf: tensor(2.5918, device='cuda:0', dtype=torch.float16) tensor(0.1292, device='cuda:0', dtype=torch.float16)
tensor(0.3701, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(0.3755, device='cuda:0', dtype=torch.float16) tensor(0.0293, device='cuda:0', dtype=torch.float16)
tensor(0.3564, device='cuda:0', dtype=torch.float16) tensor(0.0321, device='cuda:0', dtype=torch.float16)
tensor(0.3838, device='cuda:0', dtype=torch.float16) tensor(0.0299, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.o_proj
Validation after prune:
out_inf: tensor(1.0342, device='cuda:0', dtype=torch.float16) tensor(0.0174, device='cuda:0', dtype=torch.float16)
tensor(0.2158, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.2283, device='cuda:0', dtype=torch.float16) tensor(0.0066, device='cuda:0', dtype=torch.float16)
tensor(0.1992, device='cuda:0', dtype=torch.float16) tensor(0.0073, device='cuda:0', dtype=torch.float16)
tensor(0.2255, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.0339, device='cuda:0')
old_score: tensor(0.0069, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0043, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.73466205596924
Validation after dual ascent:
out_inf: tensor(1.0342, device='cuda:0', dtype=torch.float16) tensor(0.0174, device='cuda:0', dtype=torch.float16)
tensor(0.2065, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.1383, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.1453, device='cuda:0', dtype=torch.float16) tensor(0.0047, device='cuda:0', dtype=torch.float16)
tensor(0.1748, device='cuda:0', dtype=torch.float16) tensor(0.0043, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.gate_proj
Validation after prune:
out_inf: tensor(2.6484, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(0.7637, device='cuda:0', dtype=torch.float16) tensor(0.0503, device='cuda:0', dtype=torch.float16)
tensor(0.8770, device='cuda:0', dtype=torch.float16) tensor(0.0500, device='cuda:0', dtype=torch.float16)
tensor(0.7676, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
tensor(1.0312, device='cuda:0', dtype=torch.float16) tensor(0.0510, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0143, device='cuda:0')
tensor(0.0195, device='cuda:0')
old_score: tensor(0.0514, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0311, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.60353684425354
Validation after dual ascent:
out_inf: tensor(2.6484, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(0.4453, device='cuda:0', dtype=torch.float16) tensor(0.0310, device='cuda:0', dtype=torch.float16)
tensor(0.6465, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(0.4453, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.4863, device='cuda:0', dtype=torch.float16) tensor(0.0309, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.up_proj
Validation after prune:
out_inf: tensor(2.2344, device='cuda:0', dtype=torch.float16) tensor(0.0978, device='cuda:0', dtype=torch.float16)
tensor(0.5605, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
tensor(0.5303, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.4502, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
tensor(0.5400, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0184, device='cuda:0')
tensor(0.0358, device='cuda:0')
old_score: tensor(0.0418, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0286, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.434634685516357
Validation after dual ascent:
out_inf: tensor(2.2344, device='cuda:0', dtype=torch.float16) tensor(0.0978, device='cuda:0', dtype=torch.float16)
tensor(0.2935, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
tensor(0.3320, device='cuda:0', dtype=torch.float16) tensor(0.0272, device='cuda:0', dtype=torch.float16)
tensor(0.3132, device='cuda:0', dtype=torch.float16) tensor(0.0301, device='cuda:0', dtype=torch.float16)
tensor(0.3125, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.4766, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.1445, device='cuda:0', dtype=torch.float16) tensor(0.0085, device='cuda:0', dtype=torch.float16)
tensor(0.1396, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.1494, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.1830, device='cuda:0', dtype=torch.float16) tensor(0.0087, device='cuda:0', dtype=torch.float16)
tensor(0.0912, device='cuda:0')
old_score: tensor(0.0089, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0070, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 175.64327764511108
Validation after dual ascent:
out_inf: tensor(3.4766, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.1068, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.1093, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.0879, device='cuda:0', dtype=torch.float16) tensor(0.0077, device='cuda:0', dtype=torch.float16)
tensor(0.1059, device='cuda:0', dtype=torch.float16) tensor(0.0070, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.3594, device='cuda:0', dtype=torch.float16) tensor(0.8740, device='cuda:0', dtype=torch.float16)
tensor(2.7148, device='cuda:0', dtype=torch.float16) tensor(0.2126, device='cuda:0', dtype=torch.float16)
tensor(2.5391, device='cuda:0', dtype=torch.float16) tensor(0.2147, device='cuda:0', dtype=torch.float16)
tensor(2.9492, device='cuda:0', dtype=torch.float16) tensor(0.2153, device='cuda:0', dtype=torch.float16)
tensor(2.6172, device='cuda:0', dtype=torch.float16) tensor(0.2141, device='cuda:0', dtype=torch.float16)
tensor(0.0997, device='cuda:0')
old_score: tensor(0.2141, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1007, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.81464862823486
Validation after dual ascent:
out_inf: tensor(17.3594, device='cuda:0', dtype=torch.float16) tensor(0.8740, device='cuda:0', dtype=torch.float16)
tensor(1.6943, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
tensor(1.6445, device='cuda:0', dtype=torch.float16) tensor(0.0970, device='cuda:0', dtype=torch.float16)
tensor(1.6973, device='cuda:0', dtype=torch.float16) tensor(0.1058, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.1012, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.k_proj
Validation after prune:
out_inf: tensor(16.8438, device='cuda:0', dtype=torch.float16) tensor(1.0488, device='cuda:0', dtype=torch.float16)
tensor(3.7656, device='cuda:0', dtype=torch.float16) tensor(0.2299, device='cuda:0', dtype=torch.float16)
tensor(3.6055, device='cuda:0', dtype=torch.float16) tensor(0.2308, device='cuda:0', dtype=torch.float16)
tensor(3.2578, device='cuda:0', dtype=torch.float16) tensor(0.2346, device='cuda:0', dtype=torch.float16)
tensor(3.1641, device='cuda:0', dtype=torch.float16) tensor(0.2296, device='cuda:0', dtype=torch.float16)
tensor(0.0519, device='cuda:0')
old_score: tensor(0.2312, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1033, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 33.17408037185669
Validation after dual ascent:
out_inf: tensor(16.8438, device='cuda:0', dtype=torch.float16) tensor(1.0488, device='cuda:0', dtype=torch.float16)
tensor(1.5205, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.0995, device='cuda:0', dtype=torch.float16)
tensor(1.5986, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.5664, device='cuda:0', dtype=torch.float16) tensor(0.1037, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.7051, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.8770, device='cuda:0', dtype=torch.float16) tensor(0.0900, device='cuda:0', dtype=torch.float16)
tensor(0.8428, device='cuda:0', dtype=torch.float16) tensor(0.0891, device='cuda:0', dtype=torch.float16)
tensor(0.9785, device='cuda:0', dtype=torch.float16) tensor(0.0911, device='cuda:0', dtype=torch.float16)
tensor(0.8555, device='cuda:0', dtype=torch.float16) tensor(0.0901, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0081, device='cuda:0')
tensor(0.1050, device='cuda:0')
old_score: tensor(0.0901, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0563, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.151118516921997
Validation after dual ascent:
out_inf: tensor(2.7051, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.5493, device='cuda:0', dtype=torch.float16) tensor(0.0556, device='cuda:0', dtype=torch.float16)
tensor(0.5356, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(0.5762, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.6587, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.o_proj
Validation after prune:
out_inf: tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.2300, device='cuda:0', dtype=torch.float16) tensor(0.0054, device='cuda:0', dtype=torch.float16)
tensor(0.2588, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.2402, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.2402, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.0349, device='cuda:0')
old_score: tensor(0.0061, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0039, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.41401815414429
Validation after dual ascent:
out_inf: tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.1504, device='cuda:0', dtype=torch.float16) tensor(0.0034, device='cuda:0', dtype=torch.float16)
tensor(0.1831, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.1401, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.2039, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.3906, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(1.5586, device='cuda:0', dtype=torch.float16) tensor(0.0641, device='cuda:0', dtype=torch.float16)
tensor(1.6211, device='cuda:0', dtype=torch.float16) tensor(0.0639, device='cuda:0', dtype=torch.float16)
tensor(1.7539, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0196, device='cuda:0')
tensor(0.0308, device='cuda:0')
old_score: tensor(0.0648, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0439, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.468259572982788
Validation after dual ascent:
out_inf: tensor(7.3906, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(0.7461, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
tensor(0.7397, device='cuda:0', dtype=torch.float16) tensor(0.0422, device='cuda:0', dtype=torch.float16)
tensor(0.6748, device='cuda:0', dtype=torch.float16) tensor(0.0466, device='cuda:0', dtype=torch.float16)
tensor(0.7773, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.up_proj
Validation after prune:
out_inf: tensor(2.3789, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
tensor(0.6660, device='cuda:0', dtype=torch.float16) tensor(0.0545, device='cuda:0', dtype=torch.float16)
tensor(0.7129, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(0.7383, device='cuda:0', dtype=torch.float16) tensor(0.0571, device='cuda:0', dtype=torch.float16)
tensor(0.7305, device='cuda:0', dtype=torch.float16) tensor(0.0550, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0088, device='cuda:0')
tensor(0.0234, device='cuda:0')
old_score: tensor(0.0552, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0405, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.464734315872192
Validation after dual ascent:
out_inf: tensor(2.3789, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
tensor(0.4124, device='cuda:0', dtype=torch.float16) tensor(0.0397, device='cuda:0', dtype=torch.float16)
tensor(0.4153, device='cuda:0', dtype=torch.float16) tensor(0.0389, device='cuda:0', dtype=torch.float16)
tensor(0.4475, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
tensor(0.4492, device='cuda:0', dtype=torch.float16) tensor(0.0405, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.1943, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.1488, device='cuda:0', dtype=torch.float16) tensor(0.0110, device='cuda:0', dtype=torch.float16)
tensor(0.1757, device='cuda:0', dtype=torch.float16) tensor(0.0108, device='cuda:0', dtype=torch.float16)
tensor(0.1743, device='cuda:0', dtype=torch.float16) tensor(0.0116, device='cuda:0', dtype=torch.float16)
tensor(0.1648, device='cuda:0', dtype=torch.float16) tensor(0.0113, device='cuda:0', dtype=torch.float16)
Converged at iteration 900
tensor(0.0189, device='cuda:0')
tensor(0.0509, device='cuda:0')
old_score: tensor(0.0112, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0093, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 188.8872218132019
Validation after dual ascent:
out_inf: tensor(1.1943, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.1171, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
tensor(0.1356, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
tensor(0.1105, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
tensor(0.1311, device='cuda:0', dtype=torch.float16) tensor(0.0095, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.8828, device='cuda:0', dtype=torch.float16) tensor(0.9072, device='cuda:0', dtype=torch.float16)
tensor(2.0781, device='cuda:0', dtype=torch.float16) tensor(0.2181, device='cuda:0', dtype=torch.float16)
tensor(2.1211, device='cuda:0', dtype=torch.float16) tensor(0.2169, device='cuda:0', dtype=torch.float16)
tensor(2.1953, device='cuda:0', dtype=torch.float16) tensor(0.2195, device='cuda:0', dtype=torch.float16)
tensor(2.0742, device='cuda:0', dtype=torch.float16) tensor(0.2179, device='cuda:0', dtype=torch.float16)
tensor(0.0991, device='cuda:0')
old_score: tensor(0.2180, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1047, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.47258758544922
Validation after dual ascent:
out_inf: tensor(15.8828, device='cuda:0', dtype=torch.float16) tensor(0.9072, device='cuda:0', dtype=torch.float16)
tensor(1.2920, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(1.4053, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(1.4629, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
tensor(1.4414, device='cuda:0', dtype=torch.float16) tensor(0.1049, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.1875, device='cuda:0', dtype=torch.float16) tensor(1.1348, device='cuda:0', dtype=torch.float16)
tensor(2.4824, device='cuda:0', dtype=torch.float16) tensor(0.2219, device='cuda:0', dtype=torch.float16)
tensor(2.5547, device='cuda:0', dtype=torch.float16) tensor(0.2198, device='cuda:0', dtype=torch.float16)
tensor(2.4375, device='cuda:0', dtype=torch.float16) tensor(0.2229, device='cuda:0', dtype=torch.float16)
tensor(2.5312, device='cuda:0', dtype=torch.float16) tensor(0.2212, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0199, device='cuda:0')
tensor(0.0645, device='cuda:0')
old_score: tensor(0.2216, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1047, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 27.36692452430725
Validation after dual ascent:
out_inf: tensor(20.1875, device='cuda:0', dtype=torch.float16) tensor(1.1348, device='cuda:0', dtype=torch.float16)
tensor(1.4004, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(1.3047, device='cuda:0', dtype=torch.float16) tensor(0.1020, device='cuda:0', dtype=torch.float16)
tensor(1.5342, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
tensor(1.5049, device='cuda:0', dtype=torch.float16) tensor(0.1049, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.0566, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.8501, device='cuda:0', dtype=torch.float16) tensor(0.0918, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0912, device='cuda:0', dtype=torch.float16)
tensor(0.8228, device='cuda:0', dtype=torch.float16) tensor(0.0928, device='cuda:0', dtype=torch.float16)
tensor(0.9473, device='cuda:0', dtype=torch.float16) tensor(0.0920, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0093, device='cuda:0')
tensor(0.1503, device='cuda:0')
old_score: tensor(0.0920, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0590, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.089026212692261
Validation after dual ascent:
out_inf: tensor(3.0566, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.5186, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
tensor(0.5591, device='cuda:0', dtype=torch.float16) tensor(0.0576, device='cuda:0', dtype=torch.float16)
tensor(0.5342, device='cuda:0', dtype=torch.float16) tensor(0.0613, device='cuda:0', dtype=torch.float16)
tensor(0.5249, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.o_proj
Validation after prune:
out_inf: tensor(2.6699, device='cuda:0', dtype=torch.float16) tensor(0.0195, device='cuda:0', dtype=torch.float16)
tensor(0.2764, device='cuda:0', dtype=torch.float16) tensor(0.0082, device='cuda:0', dtype=torch.float16)
tensor(0.2720, device='cuda:0', dtype=torch.float16) tensor(0.0082, device='cuda:0', dtype=torch.float16)
tensor(0.2705, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(0.2900, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.0297, device='cuda:0')
old_score: tensor(0.0081, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0059, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 32.644654750823975
Validation after dual ascent:
out_inf: tensor(2.6699, device='cuda:0', dtype=torch.float16) tensor(0.0195, device='cuda:0', dtype=torch.float16)
tensor(0.2070, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
tensor(0.2153, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.2139, device='cuda:0', dtype=torch.float16) tensor(0.0052, device='cuda:0', dtype=torch.float16)
tensor(0.2910, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.3125, device='cuda:0', dtype=torch.float16) tensor(0.1870, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.0815, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.0828, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0086, device='cuda:0')
tensor(0.0301, device='cuda:0')
old_score: tensor(0.0821, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0546, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.601556539535522
Validation after dual ascent:
out_inf: tensor(4.3125, device='cuda:0', dtype=torch.float16) tensor(0.1870, device='cuda:0', dtype=torch.float16)
tensor(0.6753, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.7417, device='cuda:0', dtype=torch.float16) tensor(0.0528, device='cuda:0', dtype=torch.float16)
tensor(0.7241, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.7256, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.3242, device='cuda:0', dtype=torch.float16) tensor(0.1440, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(0.7715, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
tensor(0.6543, device='cuda:0', dtype=torch.float16) tensor(0.0673, device='cuda:0', dtype=torch.float16)
tensor(0.7676, device='cuda:0', dtype=torch.float16) tensor(0.0662, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0072, device='cuda:0')
tensor(0.0269, device='cuda:0')
old_score: tensor(0.0661, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0491, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.498139142990112
Validation after dual ascent:
out_inf: tensor(3.3242, device='cuda:0', dtype=torch.float16) tensor(0.1440, device='cuda:0', dtype=torch.float16)
tensor(0.4727, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.4460, device='cuda:0', dtype=torch.float16) tensor(0.0474, device='cuda:0', dtype=torch.float16)
tensor(0.4453, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
tensor(0.4702, device='cuda:0', dtype=torch.float16) tensor(0.0491, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.down_proj
Validation after prune:
out_inf: tensor(7.4258, device='cuda:0', dtype=torch.float16) tensor(0.0369, device='cuda:0', dtype=torch.float16)
tensor(0.3970, device='cuda:0', dtype=torch.float16) tensor(0.0170, device='cuda:0', dtype=torch.float16)
tensor(0.4902, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
tensor(0.3560, device='cuda:0', dtype=torch.float16) tensor(0.0167, device='cuda:0', dtype=torch.float16)
tensor(0.3826, device='cuda:0', dtype=torch.float16) tensor(0.0176, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0179, device='cuda:0')
tensor(0.0447, device='cuda:0')
old_score: tensor(0.0170, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0139, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.52986979484558
Validation after dual ascent:
out_inf: tensor(7.4258, device='cuda:0', dtype=torch.float16) tensor(0.0369, device='cuda:0', dtype=torch.float16)
tensor(0.2251, device='cuda:0', dtype=torch.float16) tensor(0.0136, device='cuda:0', dtype=torch.float16)
tensor(0.2256, device='cuda:0', dtype=torch.float16) tensor(0.0137, device='cuda:0', dtype=torch.float16)
tensor(0.2234, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
tensor(0.2256, device='cuda:0', dtype=torch.float16) tensor(0.0145, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.0312, device='cuda:0', dtype=torch.float16) tensor(0.9028, device='cuda:0', dtype=torch.float16)
tensor(2.1133, device='cuda:0', dtype=torch.float16) tensor(0.2303, device='cuda:0', dtype=torch.float16)
tensor(2.2520, device='cuda:0', dtype=torch.float16) tensor(0.2288, device='cuda:0', dtype=torch.float16)
tensor(2.1973, device='cuda:0', dtype=torch.float16) tensor(0.2305, device='cuda:0', dtype=torch.float16)
tensor(1.9648, device='cuda:0', dtype=torch.float16) tensor(0.2292, device='cuda:0', dtype=torch.float16)
tensor(0.2639, device='cuda:0')
old_score: tensor(0.2297, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1113, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 33.01838564872742
Validation after dual ascent:
out_inf: tensor(17.0312, device='cuda:0', dtype=torch.float16) tensor(0.9028, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.1086, device='cuda:0', dtype=torch.float16)
tensor(1.1396, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(1.2607, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.2910, device='cuda:0', dtype=torch.float16) tensor(0.1120, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.4219, device='cuda:0', dtype=torch.float16) tensor(1.1221, device='cuda:0', dtype=torch.float16)
tensor(2.2188, device='cuda:0', dtype=torch.float16) tensor(0.2368, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.2350, device='cuda:0', dtype=torch.float16)
tensor(2.3281, device='cuda:0', dtype=torch.float16) tensor(0.2372, device='cuda:0', dtype=torch.float16)
tensor(2.5391, device='cuda:0', dtype=torch.float16) tensor(0.2356, device='cuda:0', dtype=torch.float16)
tensor(0.1459, device='cuda:0')
old_score: tensor(0.2361, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1140, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 28.431082010269165
Validation after dual ascent:
out_inf: tensor(19.4219, device='cuda:0', dtype=torch.float16) tensor(1.1221, device='cuda:0', dtype=torch.float16)
tensor(1.4580, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1183, device='cuda:0', dtype=torch.float16)
tensor(1.4287, device='cuda:0', dtype=torch.float16) tensor(0.1146, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.7168, device='cuda:0', dtype=torch.float16) tensor(0.2097, device='cuda:0', dtype=torch.float16)
tensor(0.8936, device='cuda:0', dtype=torch.float16) tensor(0.0991, device='cuda:0', dtype=torch.float16)
tensor(0.8135, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(0.7949, device='cuda:0', dtype=torch.float16) tensor(0.0991, device='cuda:0', dtype=torch.float16)
tensor(0.8564, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0117, device='cuda:0')
tensor(0.1409, device='cuda:0')
old_score: tensor(0.0989, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0632, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.601510047912598
Validation after dual ascent:
out_inf: tensor(2.7168, device='cuda:0', dtype=torch.float16) tensor(0.2097, device='cuda:0', dtype=torch.float16)
tensor(0.5146, device='cuda:0', dtype=torch.float16) tensor(0.0620, device='cuda:0', dtype=torch.float16)
tensor(0.5493, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(0.6704, device='cuda:0', dtype=torch.float16) tensor(0.0652, device='cuda:0', dtype=torch.float16)
tensor(0.5293, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.9453, device='cuda:0', dtype=torch.float16) tensor(0.0429, device='cuda:0', dtype=torch.float16)
tensor(0.4844, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.3545, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.4961, device='cuda:0', dtype=torch.float16) tensor(0.0176, device='cuda:0', dtype=torch.float16)
tensor(0.4248, device='cuda:0', dtype=torch.float16) tensor(0.0188, device='cuda:0', dtype=torch.float16)
tensor(0.0248, device='cuda:0')
old_score: tensor(0.0187, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0115, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 20.372684955596924
Validation after dual ascent:
out_inf: tensor(5.9453, device='cuda:0', dtype=torch.float16) tensor(0.0429, device='cuda:0', dtype=torch.float16)
tensor(0.2793, device='cuda:0', dtype=torch.float16) tensor(0.0116, device='cuda:0', dtype=torch.float16)
tensor(0.2773, device='cuda:0', dtype=torch.float16) tensor(0.0116, device='cuda:0', dtype=torch.float16)
tensor(0.2310, device='cuda:0', dtype=torch.float16) tensor(0.0113, device='cuda:0', dtype=torch.float16)
tensor(0.2798, device='cuda:0', dtype=torch.float16) tensor(0.0116, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.0625, device='cuda:0', dtype=torch.float16) tensor(0.2380, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.0940, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.0942, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(1.4316, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0067, device='cuda:0')
tensor(0.0367, device='cuda:0')
old_score: tensor(0.0936, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0551, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.231961488723755
Validation after dual ascent:
out_inf: tensor(5.0625, device='cuda:0', dtype=torch.float16) tensor(0.2380, device='cuda:0', dtype=torch.float16)
tensor(0.7383, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
tensor(0.8994, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0576, device='cuda:0', dtype=torch.float16)
tensor(0.7861, device='cuda:0', dtype=torch.float16) tensor(0.0556, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.0938, device='cuda:0', dtype=torch.float16) tensor(0.1663, device='cuda:0', dtype=torch.float16)
tensor(0.9824, device='cuda:0', dtype=torch.float16) tensor(0.0733, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.8789, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0049, device='cuda:0')
tensor(0.0315, device='cuda:0')
old_score: tensor(0.0735, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0491, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.462903738021851
Validation after dual ascent:
out_inf: tensor(4.0938, device='cuda:0', dtype=torch.float16) tensor(0.1663, device='cuda:0', dtype=torch.float16)
tensor(0.7188, device='cuda:0', dtype=torch.float16) tensor(0.0481, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.0472, device='cuda:0', dtype=torch.float16)
tensor(0.4487, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.4736, device='cuda:0', dtype=torch.float16) tensor(0.0496, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.3457, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.3755, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.4417, device='cuda:0', dtype=torch.float16) tensor(0.0249, device='cuda:0', dtype=torch.float16)
tensor(0.2686, device='cuda:0', dtype=torch.float16) tensor(0.0239, device='cuda:0', dtype=torch.float16)
tensor(0.4092, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0181, device='cuda:0')
tensor(0.0291, device='cuda:0')
old_score: tensor(0.0253, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0179, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 49.95436930656433
Validation after dual ascent:
out_inf: tensor(2.3457, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.2388, device='cuda:0', dtype=torch.float16) tensor(0.0181, device='cuda:0', dtype=torch.float16)
tensor(0.3413, device='cuda:0', dtype=torch.float16) tensor(0.0175, device='cuda:0', dtype=torch.float16)
tensor(0.2109, device='cuda:0', dtype=torch.float16) tensor(0.0174, device='cuda:0', dtype=torch.float16)
tensor(0.2205, device='cuda:0', dtype=torch.float16) tensor(0.0185, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.4141, device='cuda:0', dtype=torch.float16) tensor(0.8921, device='cuda:0', dtype=torch.float16)
tensor(3.3164, device='cuda:0', dtype=torch.float16) tensor(0.2517, device='cuda:0', dtype=torch.float16)
tensor(3.2656, device='cuda:0', dtype=torch.float16) tensor(0.2522, device='cuda:0', dtype=torch.float16)
tensor(3.2617, device='cuda:0', dtype=torch.float16) tensor(0.2522, device='cuda:0', dtype=torch.float16)
tensor(3.1484, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(0.1236, device='cuda:0')
old_score: tensor(0.2522, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1235, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.212932109832764
Validation after dual ascent:
out_inf: tensor(15.4141, device='cuda:0', dtype=torch.float16) tensor(0.8921, device='cuda:0', dtype=torch.float16)
tensor(1.7441, device='cuda:0', dtype=torch.float16) tensor(0.1228, device='cuda:0', dtype=torch.float16)
tensor(1.6758, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(1.8086, device='cuda:0', dtype=torch.float16) tensor(0.1248, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.0156, device='cuda:0', dtype=torch.float16) tensor(1.0391, device='cuda:0', dtype=torch.float16)
tensor(3.2188, device='cuda:0', dtype=torch.float16) tensor(0.2637, device='cuda:0', dtype=torch.float16)
tensor(3.1562, device='cuda:0', dtype=torch.float16) tensor(0.2625, device='cuda:0', dtype=torch.float16)
tensor(3.2422, device='cuda:0', dtype=torch.float16) tensor(0.2607, device='cuda:0', dtype=torch.float16)
tensor(3.0391, device='cuda:0', dtype=torch.float16) tensor(0.2617, device='cuda:0', dtype=torch.float16)
tensor(0.1316, device='cuda:0')
old_score: tensor(0.2622, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1246, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.235028505325317
Validation after dual ascent:
out_inf: tensor(18.0156, device='cuda:0', dtype=torch.float16) tensor(1.0391, device='cuda:0', dtype=torch.float16)
tensor(1.8613, device='cuda:0', dtype=torch.float16) tensor(0.1241, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1273, device='cuda:0', dtype=torch.float16)
tensor(1.8418, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.5527, device='cuda:0', dtype=torch.float16) tensor(0.2563, device='cuda:0', dtype=torch.float16)
tensor(1.0479, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(1.0146, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(0.0584, device='cuda:0')
old_score: tensor(0.1146, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0685, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.191903352737427
Validation after dual ascent:
out_inf: tensor(3.5527, device='cuda:0', dtype=torch.float16) tensor(0.2563, device='cuda:0', dtype=torch.float16)
tensor(0.6406, device='cuda:0', dtype=torch.float16) tensor(0.0682, device='cuda:0', dtype=torch.float16)
tensor(0.6299, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(0.6465, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(0.6631, device='cuda:0', dtype=torch.float16) tensor(0.0692, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.2891, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.5020, device='cuda:0', dtype=torch.float16) tensor(0.0202, device='cuda:0', dtype=torch.float16)
tensor(0.5859, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(0.6104, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(0.5820, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
Converged at iteration 800
tensor(0.0151, device='cuda:0')
tensor(0.0245, device='cuda:0')
old_score: tensor(0.0221, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0118, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.213824987411499
Validation after dual ascent:
out_inf: tensor(8.2891, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0108, device='cuda:0', dtype=torch.float16)
tensor(0.3418, device='cuda:0', dtype=torch.float16) tensor(0.0122, device='cuda:0', dtype=torch.float16)
tensor(0.2988, device='cuda:0', dtype=torch.float16) tensor(0.0130, device='cuda:0', dtype=torch.float16)
tensor(0.3594, device='cuda:0', dtype=torch.float16) tensor(0.0111, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.0156, device='cuda:0', dtype=torch.float16) tensor(0.2939, device='cuda:0', dtype=torch.float16)
tensor(1.2627, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
tensor(1.4541, device='cuda:0', dtype=torch.float16) tensor(0.1073, device='cuda:0', dtype=torch.float16)
tensor(1.5977, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
tensor(1.5088, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0085, device='cuda:0')
tensor(0.0319, device='cuda:0')
old_score: tensor(0.1073, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0570, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2237513065338135
Validation after dual ascent:
out_inf: tensor(4.0156, device='cuda:0', dtype=torch.float16) tensor(0.2939, device='cuda:0', dtype=torch.float16)
tensor(0.7451, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.8008, device='cuda:0', dtype=torch.float16) tensor(0.0550, device='cuda:0', dtype=torch.float16)
tensor(0.8379, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0556, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.3223, device='cuda:0', dtype=torch.float16) tensor(0.1771, device='cuda:0', dtype=torch.float16)
tensor(0.9629, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(0.8945, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(0.9648, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
tensor(0.9570, device='cuda:0', dtype=torch.float16) tensor(0.0755, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0059, device='cuda:0')
tensor(0.0269, device='cuda:0')
old_score: tensor(0.0771, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0497, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.226120233535767
Validation after dual ascent:
out_inf: tensor(3.3223, device='cuda:0', dtype=torch.float16) tensor(0.1771, device='cuda:0', dtype=torch.float16)
tensor(0.5078, device='cuda:0', dtype=torch.float16) tensor(0.0503, device='cuda:0', dtype=torch.float16)
tensor(0.5146, device='cuda:0', dtype=torch.float16) tensor(0.0480, device='cuda:0', dtype=torch.float16)
tensor(0.5020, device='cuda:0', dtype=torch.float16) tensor(0.0522, device='cuda:0', dtype=torch.float16)
tensor(0.5439, device='cuda:0', dtype=torch.float16) tensor(0.0485, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.down_proj
Validation after prune:
out_inf: tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0603, device='cuda:0', dtype=torch.float16)
tensor(0.4170, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
tensor(0.4316, device='cuda:0', dtype=torch.float16) tensor(0.0270, device='cuda:0', dtype=torch.float16)
tensor(0.4062, device='cuda:0', dtype=torch.float16) tensor(0.0258, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0094, device='cuda:0')
tensor(0.0154, device='cuda:0')
old_score: tensor(0.0264, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0177, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.526960134506226
Validation after dual ascent:
out_inf: tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0603, device='cuda:0', dtype=torch.float16)
tensor(0.2598, device='cuda:0', dtype=torch.float16) tensor(0.0183, device='cuda:0', dtype=torch.float16)
tensor(0.2025, device='cuda:0', dtype=torch.float16) tensor(0.0171, device='cuda:0', dtype=torch.float16)
tensor(0.2295, device='cuda:0', dtype=torch.float16) tensor(0.0187, device='cuda:0', dtype=torch.float16)
tensor(0.2266, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.q_proj
Validation after prune:
out_inf: tensor(20.5000, device='cuda:0', dtype=torch.float16) tensor(0.8823, device='cuda:0', dtype=torch.float16)
tensor(3.9375, device='cuda:0', dtype=torch.float16) tensor(0.2588, device='cuda:0', dtype=torch.float16)
tensor(3.8125, device='cuda:0', dtype=torch.float16) tensor(0.2590, device='cuda:0', dtype=torch.float16)
tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.2600, device='cuda:0', dtype=torch.float16)
tensor(4.0078, device='cuda:0', dtype=torch.float16) tensor(0.2583, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0185, device='cuda:0')
tensor(0.0437, device='cuda:0')
old_score: tensor(0.2588, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1245, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 9.934189081192017
Validation after dual ascent:
out_inf: tensor(20.5000, device='cuda:0', dtype=torch.float16) tensor(0.8823, device='cuda:0', dtype=torch.float16)
tensor(1.8477, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.8320, device='cuda:0', dtype=torch.float16) tensor(0.1222, device='cuda:0', dtype=torch.float16)
tensor(1.7588, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(1.8164, device='cuda:0', dtype=torch.float16) tensor(0.1231, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(1.0039, device='cuda:0', dtype=torch.float16)
tensor(3.4902, device='cuda:0', dtype=torch.float16) tensor(0.2646, device='cuda:0', dtype=torch.float16)
tensor(3.6406, device='cuda:0', dtype=torch.float16) tensor(0.2651, device='cuda:0', dtype=torch.float16)
tensor(3.5957, device='cuda:0', dtype=torch.float16) tensor(0.2673, device='cuda:0', dtype=torch.float16)
tensor(3.4609, device='cuda:0', dtype=torch.float16) tensor(0.2642, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0192, device='cuda:0')
tensor(0.0440, device='cuda:0')
old_score: tensor(0.2651, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1245, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 9.952974319458008
Validation after dual ascent:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(1.0039, device='cuda:0', dtype=torch.float16)
tensor(1.9512, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.6211, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
tensor(1.5820, device='cuda:0', dtype=torch.float16) tensor(0.1268, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.2266, device='cuda:0', dtype=torch.float16) tensor(0.2585, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1213, device='cuda:0', dtype=torch.float16)
tensor(0.9658, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
tensor(0.9863, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.1207, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0095, device='cuda:0')
tensor(0.1296, device='cuda:0')
old_score: tensor(0.1208, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0706, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2355048656463623
Validation after dual ascent:
out_inf: tensor(4.2266, device='cuda:0', dtype=torch.float16) tensor(0.2585, device='cuda:0', dtype=torch.float16)
tensor(0.6636, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.7197, device='cuda:0', dtype=torch.float16) tensor(0.0692, device='cuda:0', dtype=torch.float16)
tensor(0.7051, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.6333, device='cuda:0', dtype=torch.float16) tensor(0.0697, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.o_proj
Validation after prune:
out_inf: tensor(3.5137, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.7871, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
tensor(0.6797, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.8301, device='cuda:0', dtype=torch.float16) tensor(0.0293, device='cuda:0', dtype=torch.float16)
tensor(0.5840, device='cuda:0', dtype=torch.float16) tensor(0.0240, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0169, device='cuda:0')
tensor(0.0343, device='cuda:0')
old_score: tensor(0.0264, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0150, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.427874088287354
Validation after dual ascent:
out_inf: tensor(3.5137, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.3730, device='cuda:0', dtype=torch.float16) tensor(0.0144, device='cuda:0', dtype=torch.float16)
tensor(0.4209, device='cuda:0', dtype=torch.float16) tensor(0.0155, device='cuda:0', dtype=torch.float16)
tensor(0.4512, device='cuda:0', dtype=torch.float16) tensor(0.0173, device='cuda:0', dtype=torch.float16)
tensor(0.3789, device='cuda:0', dtype=torch.float16) tensor(0.0129, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.7891, device='cuda:0', dtype=torch.float16) tensor(0.3215, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.1182, device='cuda:0', dtype=torch.float16)
tensor(1.8672, device='cuda:0', dtype=torch.float16) tensor(0.1166, device='cuda:0', dtype=torch.float16)
tensor(1.7383, device='cuda:0', dtype=torch.float16) tensor(0.1176, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0087, device='cuda:0')
tensor(0.0374, device='cuda:0')
old_score: tensor(0.1176, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0610, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.199023723602295
Validation after dual ascent:
out_inf: tensor(4.7891, device='cuda:0', dtype=torch.float16) tensor(0.3215, device='cuda:0', dtype=torch.float16)
tensor(0.9346, device='cuda:0', dtype=torch.float16) tensor(0.0617, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0602, device='cuda:0', dtype=torch.float16)
tensor(0.8633, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.0599, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.0508, device='cuda:0', dtype=torch.float16) tensor(0.1943, device='cuda:0', dtype=torch.float16)
tensor(0.8340, device='cuda:0', dtype=torch.float16) tensor(0.0868, device='cuda:0', dtype=torch.float16)
tensor(0.9434, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(0.9473, device='cuda:0', dtype=torch.float16) tensor(0.0864, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0045, device='cuda:0')
tensor(0.0316, device='cuda:0')
old_score: tensor(0.0862, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0536, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.200162172317505
Validation after dual ascent:
out_inf: tensor(4.0508, device='cuda:0', dtype=torch.float16) tensor(0.1943, device='cuda:0', dtype=torch.float16)
tensor(0.5820, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
tensor(0.5293, device='cuda:0', dtype=torch.float16) tensor(0.0529, device='cuda:0', dtype=torch.float16)
tensor(0.4980, device='cuda:0', dtype=torch.float16) tensor(0.0545, device='cuda:0', dtype=torch.float16)
tensor(0.8672, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.8408, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.5547, device='cuda:0', dtype=torch.float16) tensor(0.0286, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(0.6396, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.5210, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0119, device='cuda:0')
tensor(0.0218, device='cuda:0')
old_score: tensor(0.0282, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0199, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.58685851097107
Validation after dual ascent:
out_inf: tensor(1.8408, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.2949, device='cuda:0', dtype=torch.float16) tensor(0.0202, device='cuda:0', dtype=torch.float16)
tensor(0.2349, device='cuda:0', dtype=torch.float16) tensor(0.0198, device='cuda:0', dtype=torch.float16)
tensor(0.2695, device='cuda:0', dtype=torch.float16) tensor(0.0207, device='cuda:0', dtype=torch.float16)
tensor(0.2275, device='cuda:0', dtype=torch.float16) tensor(0.0187, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.q_proj
Validation after prune:
out_inf: tensor(18.5469, device='cuda:0', dtype=torch.float16) tensor(0.8423, device='cuda:0', dtype=torch.float16)
tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.2556, device='cuda:0', dtype=torch.float16)
tensor(3.6641, device='cuda:0', dtype=torch.float16) tensor(0.2568, device='cuda:0', dtype=torch.float16)
tensor(4.8633, device='cuda:0', dtype=torch.float16) tensor(0.2583, device='cuda:0', dtype=torch.float16)
tensor(4.3594, device='cuda:0', dtype=torch.float16) tensor(0.2561, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0136, device='cuda:0')
tensor(0.0574, device='cuda:0')
old_score: tensor(0.2568, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1246, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.216179132461548
Validation after dual ascent:
out_inf: tensor(18.5469, device='cuda:0', dtype=torch.float16) tensor(0.8423, device='cuda:0', dtype=torch.float16)
tensor(1.9551, device='cuda:0', dtype=torch.float16) tensor(0.1257, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1241, device='cuda:0', dtype=torch.float16)
tensor(1.7588, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(1.9766, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.2188, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(3.1289, device='cuda:0', dtype=torch.float16) tensor(0.2642, device='cuda:0', dtype=torch.float16)
tensor(3.2656, device='cuda:0', dtype=torch.float16) tensor(0.2656, device='cuda:0', dtype=torch.float16)
tensor(3.2969, device='cuda:0', dtype=torch.float16) tensor(0.2659, device='cuda:0', dtype=torch.float16)
tensor(3.0820, device='cuda:0', dtype=torch.float16) tensor(0.2649, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0146, device='cuda:0')
tensor(0.0556, device='cuda:0')
old_score: tensor(0.2651, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1248, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.216200351715088
Validation after dual ascent:
out_inf: tensor(18.2188, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(1.6543, device='cuda:0', dtype=torch.float16) tensor(0.1260, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.1242, device='cuda:0', dtype=torch.float16)
tensor(1.6738, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.2671, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.1244, device='cuda:0', dtype=torch.float16)
tensor(1.1582, device='cuda:0', dtype=torch.float16) tensor(0.1236, device='cuda:0', dtype=torch.float16)
tensor(1.0137, device='cuda:0', dtype=torch.float16) tensor(0.1242, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.1240, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0186, device='cuda:0')
tensor(0.2237, device='cuda:0')
old_score: tensor(0.1241, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0730, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4891326427459717
Validation after dual ascent:
out_inf: tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.2671, device='cuda:0', dtype=torch.float16)
tensor(0.6948, device='cuda:0', dtype=torch.float16) tensor(0.0738, device='cuda:0', dtype=torch.float16)
tensor(0.6045, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.6333, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.6787, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.3867, device='cuda:0', dtype=torch.float16) tensor(0.0532, device='cuda:0', dtype=torch.float16)
tensor(0.4863, device='cuda:0', dtype=torch.float16) tensor(0.0269, device='cuda:0', dtype=torch.float16)
tensor(0.5508, device='cuda:0', dtype=torch.float16) tensor(0.0311, device='cuda:0', dtype=torch.float16)
tensor(0.6191, device='cuda:0', dtype=torch.float16) tensor(0.0337, device='cuda:0', dtype=torch.float16)
tensor(0.4785, device='cuda:0', dtype=torch.float16) tensor(0.0259, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0140, device='cuda:0')
tensor(0.0273, device='cuda:0')
old_score: tensor(0.0294, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0171, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.42666745185852
Validation after dual ascent:
out_inf: tensor(4.3867, device='cuda:0', dtype=torch.float16) tensor(0.0532, device='cuda:0', dtype=torch.float16)
tensor(0.3311, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.3574, device='cuda:0', dtype=torch.float16) tensor(0.0184, device='cuda:0', dtype=torch.float16)
tensor(0.4854, device='cuda:0', dtype=torch.float16) tensor(0.0195, device='cuda:0', dtype=torch.float16)
tensor(0.3042, device='cuda:0', dtype=torch.float16) tensor(0.0148, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.2935, device='cuda:0', dtype=torch.float16)
tensor(1.4746, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(1.7266, device='cuda:0', dtype=torch.float16) tensor(0.1115, device='cuda:0', dtype=torch.float16)
tensor(2.1719, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(1.9297, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0073, device='cuda:0')
tensor(0.0456, device='cuda:0')
old_score: tensor(0.1124, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0634, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.221639156341553
Validation after dual ascent:
out_inf: tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.2935, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0650, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0626, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.0636, device='cuda:0', dtype=torch.float16)
tensor(0.9443, device='cuda:0', dtype=torch.float16) tensor(0.0623, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.2034, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.0913, device='cuda:0', dtype=torch.float16)
tensor(1.0391, device='cuda:0', dtype=torch.float16) tensor(0.0899, device='cuda:0', dtype=torch.float16)
tensor(1.8984, device='cuda:0', dtype=torch.float16) tensor(0.0910, device='cuda:0', dtype=torch.float16)
tensor(1.4961, device='cuda:0', dtype=torch.float16) tensor(0.0905, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0049, device='cuda:0')
tensor(0.0403, device='cuda:0')
old_score: tensor(0.0907, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0574, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.200977563858032
Validation after dual ascent:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.2034, device='cuda:0', dtype=torch.float16)
tensor(0.5391, device='cuda:0', dtype=torch.float16) tensor(0.0589, device='cuda:0', dtype=torch.float16)
tensor(0.6523, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0576, device='cuda:0', dtype=torch.float16)
tensor(0.6074, device='cuda:0', dtype=torch.float16) tensor(0.0565, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.0957, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.6797, device='cuda:0', dtype=torch.float16) tensor(0.0300, device='cuda:0', dtype=torch.float16)
tensor(0.4697, device='cuda:0', dtype=torch.float16) tensor(0.0289, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0314, device='cuda:0', dtype=torch.float16)
tensor(0.4727, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0181, device='cuda:0')
tensor(0.0254, device='cuda:0')
old_score: tensor(0.0298, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0226, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 26.948941230773926
Validation after dual ascent:
out_inf: tensor(2.0957, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.3486, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(0.3760, device='cuda:0', dtype=torch.float16) tensor(0.0222, device='cuda:0', dtype=torch.float16)
tensor(0.4097, device='cuda:0', dtype=torch.float16) tensor(0.0237, device='cuda:0', dtype=torch.float16)
tensor(0.3193, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.0938, device='cuda:0', dtype=torch.float16) tensor(0.8584, device='cuda:0', dtype=torch.float16)
tensor(2.9375, device='cuda:0', dtype=torch.float16) tensor(0.2595, device='cuda:0', dtype=torch.float16)
tensor(2.8594, device='cuda:0', dtype=torch.float16) tensor(0.2588, device='cuda:0', dtype=torch.float16)
tensor(3.1270, device='cuda:0', dtype=torch.float16) tensor(0.2607, device='cuda:0', dtype=torch.float16)
tensor(3.0781, device='cuda:0', dtype=torch.float16) tensor(0.2605, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0193, device='cuda:0')
tensor(0.0806, device='cuda:0')
old_score: tensor(0.2600, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1321, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.002751350402832
Validation after dual ascent:
out_inf: tensor(17.0938, device='cuda:0', dtype=torch.float16) tensor(0.8584, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1339, device='cuda:0', dtype=torch.float16)
tensor(1.8262, device='cuda:0', dtype=torch.float16) tensor(0.1317, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.1332, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.1292, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.4062, device='cuda:0', dtype=torch.float16) tensor(1.0830, device='cuda:0', dtype=torch.float16)
tensor(2.8594, device='cuda:0', dtype=torch.float16) tensor(0.2722, device='cuda:0', dtype=torch.float16)
tensor(2.5820, device='cuda:0', dtype=torch.float16) tensor(0.2705, device='cuda:0', dtype=torch.float16)
tensor(2.7598, device='cuda:0', dtype=torch.float16) tensor(0.2729, device='cuda:0', dtype=torch.float16)
tensor(2.8320, device='cuda:0', dtype=torch.float16) tensor(0.2729, device='cuda:0', dtype=torch.float16)
tensor(0.0719, device='cuda:0')
old_score: tensor(0.2722, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1334, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.268234968185425
Validation after dual ascent:
out_inf: tensor(20.4062, device='cuda:0', dtype=torch.float16) tensor(1.0830, device='cuda:0', dtype=torch.float16)
tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.1356, device='cuda:0', dtype=torch.float16)
tensor(1.5273, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.5273, device='cuda:0', dtype=torch.float16) tensor(0.1345, device='cuda:0', dtype=torch.float16)
tensor(1.7393, device='cuda:0', dtype=torch.float16) tensor(0.1305, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.v_proj
Validation after prune:
out_inf: tensor(6.5352, device='cuda:0', dtype=torch.float16) tensor(0.2720, device='cuda:0', dtype=torch.float16)
tensor(0.9390, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(0.9331, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
tensor(1.0605, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(0.9897, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0149, device='cuda:0')
tensor(0.1672, device='cuda:0')
old_score: tensor(0.1262, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0767, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.256516933441162
Validation after dual ascent:
out_inf: tensor(6.5352, device='cuda:0', dtype=torch.float16) tensor(0.2720, device='cuda:0', dtype=torch.float16)
tensor(0.7241, device='cuda:0', dtype=torch.float16) tensor(0.0781, device='cuda:0', dtype=torch.float16)
tensor(0.6914, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(0.6572, device='cuda:0', dtype=torch.float16) tensor(0.0771, device='cuda:0', dtype=torch.float16)
tensor(0.6606, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.6172, device='cuda:0', dtype=torch.float16) tensor(0.0576, device='cuda:0', dtype=torch.float16)
tensor(0.7217, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
tensor(0.6641, device='cuda:0', dtype=torch.float16) tensor(0.0295, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0322, device='cuda:0', dtype=torch.float16)
tensor(0.5576, device='cuda:0', dtype=torch.float16) tensor(0.0265, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0122, device='cuda:0')
tensor(0.0284, device='cuda:0')
old_score: tensor(0.0291, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0188, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.505074739456177
Validation after dual ascent:
out_inf: tensor(4.6172, device='cuda:0', dtype=torch.float16) tensor(0.0576, device='cuda:0', dtype=torch.float16)
tensor(0.4854, device='cuda:0', dtype=torch.float16) tensor(0.0188, device='cuda:0', dtype=torch.float16)
tensor(0.4648, device='cuda:0', dtype=torch.float16) tensor(0.0188, device='cuda:0', dtype=torch.float16)
tensor(0.4170, device='cuda:0', dtype=torch.float16) tensor(0.0208, device='cuda:0', dtype=torch.float16)
tensor(0.4417, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.3281, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.1157, device='cuda:0', dtype=torch.float16)
tensor(1.8379, device='cuda:0', dtype=torch.float16) tensor(0.1150, device='cuda:0', dtype=torch.float16)
tensor(2.0586, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.7998, device='cuda:0', dtype=torch.float16) tensor(0.1137, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0082, device='cuda:0')
tensor(0.0637, device='cuda:0')
old_score: tensor(0.1150, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0662, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.26023530960083
Validation after dual ascent:
out_inf: tensor(5.3281, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(1.1279, device='cuda:0', dtype=torch.float16) tensor(0.0684, device='cuda:0', dtype=torch.float16)
tensor(1.1543, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
tensor(1.1523, device='cuda:0', dtype=torch.float16) tensor(0.0664, device='cuda:0', dtype=torch.float16)
tensor(1.0889, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.9141, device='cuda:0', dtype=torch.float16) tensor(0.2152, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
tensor(1.0479, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(1.0469, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(1.0078, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0059, device='cuda:0')
tensor(0.0562, device='cuda:0')
old_score: tensor(0.0944, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0610, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.252269268035889
Validation after dual ascent:
out_inf: tensor(3.9141, device='cuda:0', dtype=torch.float16) tensor(0.2152, device='cuda:0', dtype=torch.float16)
tensor(0.6562, device='cuda:0', dtype=torch.float16) tensor(0.0630, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0599, device='cuda:0', dtype=torch.float16)
tensor(0.5488, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(0.6128, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.1543, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.5889, device='cuda:0', dtype=torch.float16) tensor(0.0328, device='cuda:0', dtype=torch.float16)
tensor(0.5166, device='cuda:0', dtype=torch.float16) tensor(0.0320, device='cuda:0', dtype=torch.float16)
tensor(0.5469, device='cuda:0', dtype=torch.float16) tensor(0.0336, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0112, device='cuda:0')
tensor(0.0250, device='cuda:0')
old_score: tensor(0.0325, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0252, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.280375480651855
Validation after dual ascent:
out_inf: tensor(3.1543, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.3745, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
tensor(0.3730, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.3892, device='cuda:0', dtype=torch.float16) tensor(0.0260, device='cuda:0', dtype=torch.float16)
tensor(0.3354, device='cuda:0', dtype=torch.float16) tensor(0.0241, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.4531, device='cuda:0', dtype=torch.float16) tensor(0.8560, device='cuda:0', dtype=torch.float16)
tensor(3.2344, device='cuda:0', dtype=torch.float16) tensor(0.2654, device='cuda:0', dtype=torch.float16)
tensor(3.2969, device='cuda:0', dtype=torch.float16) tensor(0.2637, device='cuda:0', dtype=torch.float16)
tensor(3.3438, device='cuda:0', dtype=torch.float16) tensor(0.2651, device='cuda:0', dtype=torch.float16)
tensor(3.1016, device='cuda:0', dtype=torch.float16) tensor(0.2654, device='cuda:0', dtype=torch.float16)
tensor(0.0777, device='cuda:0')
old_score: tensor(0.2649, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1362, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.204893112182617
Validation after dual ascent:
out_inf: tensor(16.4531, device='cuda:0', dtype=torch.float16) tensor(0.8560, device='cuda:0', dtype=torch.float16)
tensor(1.8789, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(1.7188, device='cuda:0', dtype=torch.float16) tensor(0.1346, device='cuda:0', dtype=torch.float16)
tensor(1.6777, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.5771, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.4531, device='cuda:0', dtype=torch.float16) tensor(1.1152, device='cuda:0', dtype=torch.float16)
tensor(3.0820, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(2.7832, device='cuda:0', dtype=torch.float16) tensor(0.2776, device='cuda:0', dtype=torch.float16)
tensor(3.0156, device='cuda:0', dtype=torch.float16) tensor(0.2803, device='cuda:0', dtype=torch.float16)
tensor(3.0078, device='cuda:0', dtype=torch.float16) tensor(0.2822, device='cuda:0', dtype=torch.float16)
tensor(0.0797, device='cuda:0')
old_score: tensor(0.2800, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1381, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.244246006011963
Validation after dual ascent:
out_inf: tensor(18.4531, device='cuda:0', dtype=torch.float16) tensor(1.1152, device='cuda:0', dtype=torch.float16)
tensor(1.8105, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.9395, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(1.5459, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.1914, device='cuda:0', dtype=torch.float16) tensor(0.2832, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
tensor(1.0703, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
tensor(1.3184, device='cuda:0', dtype=torch.float16) tensor(0.1273, device='cuda:0', dtype=torch.float16)
tensor(1.1035, device='cuda:0', dtype=torch.float16) tensor(0.1283, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0161, device='cuda:0')
tensor(0.2275, device='cuda:0')
old_score: tensor(0.1277, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0790, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.25612473487854
Validation after dual ascent:
out_inf: tensor(7.1914, device='cuda:0', dtype=torch.float16) tensor(0.2832, device='cuda:0', dtype=torch.float16)
tensor(0.6675, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(0.6318, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(0.6733, device='cuda:0', dtype=torch.float16) tensor(0.0796, device='cuda:0', dtype=torch.float16)
tensor(0.7256, device='cuda:0', dtype=torch.float16) tensor(0.0774, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.o_proj
Validation after prune:
out_inf: tensor(7.9492, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.6875, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.6768, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.4795, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0098, device='cuda:0')
tensor(0.0151, device='cuda:0')
old_score: tensor(0.0365, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0238, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.001390218734741
Validation after dual ascent:
out_inf: tensor(7.9492, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.3662, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0233, device='cuda:0', dtype=torch.float16)
tensor(0.5127, device='cuda:0', dtype=torch.float16) tensor(0.0267, device='cuda:0', dtype=torch.float16)
tensor(0.3691, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.0781, device='cuda:0', dtype=torch.float16) tensor(0.3057, device='cuda:0', dtype=torch.float16)
tensor(1.7207, device='cuda:0', dtype=torch.float16) tensor(0.1159, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.8945, device='cuda:0', dtype=torch.float16) tensor(0.1150, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0078, device='cuda:0')
tensor(0.0555, device='cuda:0')
old_score: tensor(0.1146, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0659, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2489354610443115
Validation after dual ascent:
out_inf: tensor(6.0781, device='cuda:0', dtype=torch.float16) tensor(0.3057, device='cuda:0', dtype=torch.float16)
tensor(1.2354, device='cuda:0', dtype=torch.float16) tensor(0.0687, device='cuda:0', dtype=torch.float16)
tensor(1.2188, device='cuda:0', dtype=torch.float16) tensor(0.0636, device='cuda:0', dtype=torch.float16)
tensor(1.3574, device='cuda:0', dtype=torch.float16) tensor(0.0669, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.1172, device='cuda:0', dtype=torch.float16) tensor(0.2249, device='cuda:0', dtype=torch.float16)
tensor(1.5742, device='cuda:0', dtype=torch.float16) tensor(0.0977, device='cuda:0', dtype=torch.float16)
tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.0942, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0963, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0060, device='cuda:0')
tensor(0.0510, device='cuda:0')
old_score: tensor(0.0959, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0619, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.24386739730835
Validation after dual ascent:
out_inf: tensor(7.1172, device='cuda:0', dtype=torch.float16) tensor(0.2249, device='cuda:0', dtype=torch.float16)
tensor(0.6602, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.5439, device='cuda:0', dtype=torch.float16) tensor(0.0596, device='cuda:0', dtype=torch.float16)
tensor(0.7168, device='cuda:0', dtype=torch.float16) tensor(0.0628, device='cuda:0', dtype=torch.float16)
tensor(0.6768, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.7246, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.6221, device='cuda:0', dtype=torch.float16) tensor(0.0326, device='cuda:0', dtype=torch.float16)
tensor(0.6025, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
tensor(0.5811, device='cuda:0', dtype=torch.float16) tensor(0.0333, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0077, device='cuda:0')
tensor(0.0133, device='cuda:0')
old_score: tensor(0.0343, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0269, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.21357536315918
Validation after dual ascent:
out_inf: tensor(2.7246, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(0.4453, device='cuda:0', dtype=torch.float16) tensor(0.0284, device='cuda:0', dtype=torch.float16)
tensor(0.4463, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
tensor(0.3750, device='cuda:0', dtype=torch.float16) tensor(0.0281, device='cuda:0', dtype=torch.float16)
tensor(0.5029, device='cuda:0', dtype=torch.float16) tensor(0.0258, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.q_proj
Validation after prune:
out_inf: tensor(21.3281, device='cuda:0', dtype=torch.float16) tensor(0.8394, device='cuda:0', dtype=torch.float16)
tensor(4.0625, device='cuda:0', dtype=torch.float16) tensor(0.2654, device='cuda:0', dtype=torch.float16)
tensor(4.1367, device='cuda:0', dtype=torch.float16) tensor(0.2634, device='cuda:0', dtype=torch.float16)
tensor(4.4219, device='cuda:0', dtype=torch.float16) tensor(0.2656, device='cuda:0', dtype=torch.float16)
tensor(4.1406, device='cuda:0', dtype=torch.float16) tensor(0.2656, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0182, device='cuda:0')
tensor(0.1286, device='cuda:0')
old_score: tensor(0.2651, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1409, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.25221586227417
Validation after dual ascent:
out_inf: tensor(21.3281, device='cuda:0', dtype=torch.float16) tensor(0.8394, device='cuda:0', dtype=torch.float16)
tensor(2.5605, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(2.1602, device='cuda:0', dtype=torch.float16) tensor(0.1375, device='cuda:0', dtype=torch.float16)
tensor(2.4453, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1379, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.k_proj
Validation after prune:
out_inf: tensor(16.2812, device='cuda:0', dtype=torch.float16) tensor(1.0605, device='cuda:0', dtype=torch.float16)
tensor(3.1758, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(3.1094, device='cuda:0', dtype=torch.float16) tensor(0.2656, device='cuda:0', dtype=torch.float16)
tensor(3.5859, device='cuda:0', dtype=torch.float16) tensor(0.2700, device='cuda:0', dtype=torch.float16)
tensor(3.0234, device='cuda:0', dtype=torch.float16) tensor(0.2698, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0180, device='cuda:0')
tensor(0.1191, device='cuda:0')
old_score: tensor(0.2683, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1396, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.259089231491089
Validation after dual ascent:
out_inf: tensor(16.2812, device='cuda:0', dtype=torch.float16) tensor(1.0605, device='cuda:0', dtype=torch.float16)
tensor(1.8369, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.6982, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
tensor(1.7637, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(1.8984, device='cuda:0', dtype=torch.float16) tensor(0.1367, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.v_proj
Validation after prune:
out_inf: tensor(8.0859, device='cuda:0', dtype=torch.float16) tensor(0.3215, device='cuda:0', dtype=torch.float16)
tensor(1.2549, device='cuda:0', dtype=torch.float16) tensor(0.1431, device='cuda:0', dtype=torch.float16)
tensor(1.2607, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
tensor(1.2832, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0096, device='cuda:0')
tensor(0.2138, device='cuda:0')
old_score: tensor(0.1423, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0911, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2572946548461914
Validation after dual ascent:
out_inf: tensor(8.0859, device='cuda:0', dtype=torch.float16) tensor(0.3215, device='cuda:0', dtype=torch.float16)
tensor(0.8149, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
tensor(0.8076, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
tensor(0.8340, device='cuda:0', dtype=torch.float16) tensor(0.0918, device='cuda:0', dtype=torch.float16)
tensor(0.7583, device='cuda:0', dtype=torch.float16) tensor(0.0895, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.o_proj
Validation after prune:
out_inf: tensor(6.1328, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(0.8535, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.9009, device='cuda:0', dtype=torch.float16) tensor(0.0434, device='cuda:0', dtype=torch.float16)
tensor(0.8750, device='cuda:0', dtype=torch.float16) tensor(0.0519, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0135, device='cuda:0')
tensor(0.0129, device='cuda:0')
old_score: tensor(0.0434, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0256, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2491891384124756
Validation after dual ascent:
out_inf: tensor(6.1328, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
tensor(0.4990, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
tensor(0.4087, device='cuda:0', dtype=torch.float16) tensor(0.0210, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.1367, device='cuda:0', dtype=torch.float16) tensor(0.3223, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.1195, device='cuda:0', dtype=torch.float16)
tensor(1.9570, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(1.9336, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.1195, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0086, device='cuda:0')
tensor(0.0634, device='cuda:0')
old_score: tensor(0.1193, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0692, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.243208885192871
Validation after dual ascent:
out_inf: tensor(7.1367, device='cuda:0', dtype=torch.float16) tensor(0.3223, device='cuda:0', dtype=torch.float16)
tensor(1.2783, device='cuda:0', dtype=torch.float16) tensor(0.0719, device='cuda:0', dtype=torch.float16)
tensor(1.3076, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(1.4268, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(1.4873, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.1523, device='cuda:0', dtype=torch.float16) tensor(0.2310, device='cuda:0', dtype=torch.float16)
tensor(0.9785, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(0.9209, device='cuda:0', dtype=torch.float16) tensor(0.0994, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.1017, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.1006, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0067, device='cuda:0')
tensor(0.0595, device='cuda:0')
old_score: tensor(0.1009, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0656, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.242516756057739
Validation after dual ascent:
out_inf: tensor(4.1523, device='cuda:0', dtype=torch.float16) tensor(0.2310, device='cuda:0', dtype=torch.float16)
tensor(0.7266, device='cuda:0', dtype=torch.float16) tensor(0.0682, device='cuda:0', dtype=torch.float16)
tensor(0.7383, device='cuda:0', dtype=torch.float16) tensor(0.0625, device='cuda:0', dtype=torch.float16)
tensor(0.6396, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
tensor(0.6426, device='cuda:0', dtype=torch.float16) tensor(0.0641, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.5234, device='cuda:0', dtype=torch.float16) tensor(0.0835, device='cuda:0', dtype=torch.float16)
tensor(0.6162, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.7559, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.7676, device='cuda:0', dtype=torch.float16) tensor(0.0385, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0378, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0122, device='cuda:0')
tensor(0.0206, device='cuda:0')
old_score: tensor(0.0377, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0286, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.29812788963318
Validation after dual ascent:
out_inf: tensor(2.5234, device='cuda:0', dtype=torch.float16) tensor(0.0835, device='cuda:0', dtype=torch.float16)
tensor(0.4131, device='cuda:0', dtype=torch.float16) tensor(0.0294, device='cuda:0', dtype=torch.float16)
tensor(0.4678, device='cuda:0', dtype=torch.float16) tensor(0.0270, device='cuda:0', dtype=torch.float16)
tensor(0.4946, device='cuda:0', dtype=torch.float16) tensor(0.0300, device='cuda:0', dtype=torch.float16)
tensor(0.3965, device='cuda:0', dtype=torch.float16) tensor(0.0278, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.q_proj
Validation after prune:
out_inf: tensor(19.7500, device='cuda:0', dtype=torch.float16) tensor(0.8345, device='cuda:0', dtype=torch.float16)
tensor(3.6367, device='cuda:0', dtype=torch.float16) tensor(0.2734, device='cuda:0', dtype=torch.float16)
tensor(3.7812, device='cuda:0', dtype=torch.float16) tensor(0.2698, device='cuda:0', dtype=torch.float16)
tensor(3.3184, device='cuda:0', dtype=torch.float16) tensor(0.2734, device='cuda:0', dtype=torch.float16)
tensor(3.3809, device='cuda:0', dtype=torch.float16) tensor(0.2739, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0199, device='cuda:0')
tensor(0.0851, device='cuda:0')
old_score: tensor(0.2725, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1470, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.91526985168457
Validation after dual ascent:
out_inf: tensor(19.7500, device='cuda:0', dtype=torch.float16) tensor(0.8345, device='cuda:0', dtype=torch.float16)
tensor(2.0859, device='cuda:0', dtype=torch.float16) tensor(0.1522, device='cuda:0', dtype=torch.float16)
tensor(1.8828, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1523, device='cuda:0', dtype=torch.float16)
tensor(1.8252, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.0713, device='cuda:0', dtype=torch.float16)
tensor(2.8438, device='cuda:0', dtype=torch.float16) tensor(0.2854, device='cuda:0', dtype=torch.float16)
tensor(2.8906, device='cuda:0', dtype=torch.float16) tensor(0.2817, device='cuda:0', dtype=torch.float16)
tensor(3.0742, device='cuda:0', dtype=torch.float16) tensor(0.2883, device='cuda:0', dtype=torch.float16)
tensor(2.8086, device='cuda:0', dtype=torch.float16) tensor(0.2856, device='cuda:0', dtype=torch.float16)
tensor(0.0781, device='cuda:0')
old_score: tensor(0.2852, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1499, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.171258687973022
Validation after dual ascent:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.0713, device='cuda:0', dtype=torch.float16)
tensor(2.3086, device='cuda:0', dtype=torch.float16) tensor(0.1554, device='cuda:0', dtype=torch.float16)
tensor(1.6904, device='cuda:0', dtype=torch.float16) tensor(0.1440, device='cuda:0', dtype=torch.float16)
tensor(2.0703, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(1.9326, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.9688, device='cuda:0', dtype=torch.float16) tensor(0.3164, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
tensor(1.1211, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
tensor(1.3184, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(1.1504, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0155, device='cuda:0')
tensor(0.2200, device='cuda:0')
old_score: tensor(0.1418, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0911, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.241602659225464
Validation after dual ascent:
out_inf: tensor(5.9688, device='cuda:0', dtype=torch.float16) tensor(0.3164, device='cuda:0', dtype=torch.float16)
tensor(0.8721, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(0.7920, device='cuda:0', dtype=torch.float16) tensor(0.0873, device='cuda:0', dtype=torch.float16)
tensor(0.7466, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(0.7837, device='cuda:0', dtype=torch.float16) tensor(0.0886, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.o_proj
Validation after prune:
out_inf: tensor(6.0547, device='cuda:0', dtype=torch.float16) tensor(0.0883, device='cuda:0', dtype=torch.float16)
tensor(1.0020, device='cuda:0', dtype=torch.float16) tensor(0.0433, device='cuda:0', dtype=torch.float16)
tensor(1.6445, device='cuda:0', dtype=torch.float16) tensor(0.0461, device='cuda:0', dtype=torch.float16)
tensor(1.5117, device='cuda:0', dtype=torch.float16) tensor(0.0505, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.0408, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0070, device='cuda:0')
tensor(0.0187, device='cuda:0')
old_score: tensor(0.0452, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0266, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.7243735790252686
Validation after dual ascent:
out_inf: tensor(6.0547, device='cuda:0', dtype=torch.float16) tensor(0.0883, device='cuda:0', dtype=torch.float16)
tensor(0.4844, device='cuda:0', dtype=torch.float16) tensor(0.0262, device='cuda:0', dtype=torch.float16)
tensor(0.5000, device='cuda:0', dtype=torch.float16) tensor(0.0258, device='cuda:0', dtype=torch.float16)
tensor(0.7188, device='cuda:0', dtype=torch.float16) tensor(0.0311, device='cuda:0', dtype=torch.float16)
tensor(0.6992, device='cuda:0', dtype=torch.float16) tensor(0.0234, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.8906, device='cuda:0', dtype=torch.float16) tensor(0.3293, device='cuda:0', dtype=torch.float16)
tensor(1.9219, device='cuda:0', dtype=torch.float16) tensor(0.1209, device='cuda:0', dtype=torch.float16)
tensor(1.9121, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(1.8027, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(2.3105, device='cuda:0', dtype=torch.float16) tensor(0.1199, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0090, device='cuda:0')
tensor(0.0700, device='cuda:0')
old_score: tensor(0.1202, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0704, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2058234214782715
Validation after dual ascent:
out_inf: tensor(5.8906, device='cuda:0', dtype=torch.float16) tensor(0.3293, device='cuda:0', dtype=torch.float16)
tensor(1.2314, device='cuda:0', dtype=torch.float16) tensor(0.0733, device='cuda:0', dtype=torch.float16)
tensor(1.4746, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.7461, device='cuda:0', dtype=torch.float16) tensor(0.2386, device='cuda:0', dtype=torch.float16)
tensor(0.9883, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
tensor(0.9316, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.1058, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.1038, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0073, device='cuda:0')
tensor(0.0673, device='cuda:0')
old_score: tensor(0.1044, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0677, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.211811304092407
Validation after dual ascent:
out_inf: tensor(4.7461, device='cuda:0', dtype=torch.float16) tensor(0.2386, device='cuda:0', dtype=torch.float16)
tensor(0.7207, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.5439, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(0.6621, device='cuda:0', dtype=torch.float16) tensor(0.0708, device='cuda:0', dtype=torch.float16)
tensor(0.7080, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.0880, device='cuda:0', dtype=torch.float16)
tensor(0.6699, device='cuda:0', dtype=torch.float16) tensor(0.0397, device='cuda:0', dtype=torch.float16)
tensor(0.7461, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.7051, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0070, device='cuda:0')
tensor(0.0146, device='cuda:0')
old_score: tensor(0.0391, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0302, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.25280475616455
Validation after dual ascent:
out_inf: tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.0880, device='cuda:0', dtype=torch.float16)
tensor(0.5703, device='cuda:0', dtype=torch.float16) tensor(0.0315, device='cuda:0', dtype=torch.float16)
tensor(0.3477, device='cuda:0', dtype=torch.float16) tensor(0.0278, device='cuda:0', dtype=torch.float16)
tensor(0.5146, device='cuda:0', dtype=torch.float16) tensor(0.0324, device='cuda:0', dtype=torch.float16)
tensor(0.3984, device='cuda:0', dtype=torch.float16) tensor(0.0289, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.3750, device='cuda:0', dtype=torch.float16) tensor(0.8408, device='cuda:0', dtype=torch.float16)
tensor(3.4688, device='cuda:0', dtype=torch.float16) tensor(0.2683, device='cuda:0', dtype=torch.float16)
tensor(3.2422, device='cuda:0', dtype=torch.float16) tensor(0.2646, device='cuda:0', dtype=torch.float16)
tensor(3.3359, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(3.5547, device='cuda:0', dtype=torch.float16) tensor(0.2683, device='cuda:0', dtype=torch.float16)
tensor(0.1712, device='cuda:0')
old_score: tensor(0.2678, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1477, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.132237672805786
Validation after dual ascent:
out_inf: tensor(17.3750, device='cuda:0', dtype=torch.float16) tensor(0.8408, device='cuda:0', dtype=torch.float16)
tensor(1.9121, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
tensor(1.8418, device='cuda:0', dtype=torch.float16) tensor(0.1406, device='cuda:0', dtype=torch.float16)
tensor(1.8398, device='cuda:0', dtype=torch.float16) tensor(0.1541, device='cuda:0', dtype=torch.float16)
tensor(1.7959, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.0938, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(2.7109, device='cuda:0', dtype=torch.float16) tensor(0.2754, device='cuda:0', dtype=torch.float16)
tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.2715, device='cuda:0', dtype=torch.float16)
tensor(3.0664, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(2.8633, device='cuda:0', dtype=torch.float16) tensor(0.2761, device='cuda:0', dtype=torch.float16)
tensor(0.1778, device='cuda:0')
old_score: tensor(0.2756, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1486, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.166159391403198
Validation after dual ascent:
out_inf: tensor(19.0938, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(2.0293, device='cuda:0', dtype=torch.float16) tensor(0.1536, device='cuda:0', dtype=torch.float16)
tensor(1.8545, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(1.7646, device='cuda:0', dtype=torch.float16) tensor(0.1550, device='cuda:0', dtype=torch.float16)
tensor(1.7871, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.9922, device='cuda:0', dtype=torch.float16) tensor(0.3196, device='cuda:0', dtype=torch.float16)
tensor(1.1523, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.1250, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
tensor(1.1104, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
tensor(0.0777, device='cuda:0')
old_score: tensor(0.1469, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0939, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.14090609550476
Validation after dual ascent:
out_inf: tensor(4.9922, device='cuda:0', dtype=torch.float16) tensor(0.3196, device='cuda:0', dtype=torch.float16)
tensor(1.0664, device='cuda:0', dtype=torch.float16) tensor(0.0972, device='cuda:0', dtype=torch.float16)
tensor(0.8027, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(0.8228, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
tensor(0.8047, device='cuda:0', dtype=torch.float16) tensor(0.0913, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.8047, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(1.2832, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.0500, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0151, device='cuda:0')
tensor(0.0369, device='cuda:0')
old_score: tensor(0.0450, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0274, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.452916145324707
Validation after dual ascent:
out_inf: tensor(5.8047, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
tensor(0.5010, device='cuda:0', dtype=torch.float16) tensor(0.0275, device='cuda:0', dtype=torch.float16)
tensor(0.4434, device='cuda:0', dtype=torch.float16) tensor(0.0250, device='cuda:0', dtype=torch.float16)
tensor(0.6094, device='cuda:0', dtype=torch.float16) tensor(0.0318, device='cuda:0', dtype=torch.float16)
tensor(0.5820, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.1172, device='cuda:0', dtype=torch.float16) tensor(0.3538, device='cuda:0', dtype=torch.float16)
tensor(2.4434, device='cuda:0', dtype=torch.float16) tensor(0.1273, device='cuda:0', dtype=torch.float16)
tensor(1.8809, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
tensor(1.9531, device='cuda:0', dtype=torch.float16) tensor(0.1281, device='cuda:0', dtype=torch.float16)
tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0105, device='cuda:0')
tensor(0.0866, device='cuda:0')
old_score: tensor(0.1261, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0729, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.217331886291504
Validation after dual ascent:
out_inf: tensor(6.1172, device='cuda:0', dtype=torch.float16) tensor(0.3538, device='cuda:0', dtype=torch.float16)
tensor(1.5586, device='cuda:0', dtype=torch.float16) tensor(0.0763, device='cuda:0', dtype=torch.float16)
tensor(1.1504, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(1.2295, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(1.3418, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.7969, device='cuda:0', dtype=torch.float16) tensor(0.2563, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.1120, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.1070, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.1112, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1097, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0088, device='cuda:0')
tensor(0.0837, device='cuda:0')
old_score: tensor(0.1100, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0712, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.223585605621338
Validation after dual ascent:
out_inf: tensor(4.7969, device='cuda:0', dtype=torch.float16) tensor(0.2563, device='cuda:0', dtype=torch.float16)
tensor(0.6826, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.6611, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.8008, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.5430, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(0.8013, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
tensor(0.6367, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
tensor(0.7363, device='cuda:0', dtype=torch.float16) tensor(0.0463, device='cuda:0', dtype=torch.float16)
tensor(0.6943, device='cuda:0', dtype=torch.float16) tensor(0.0438, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0034, device='cuda:0')
tensor(0.0066, device='cuda:0')
old_score: tensor(0.0445, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0342, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.213990449905396
Validation after dual ascent:
out_inf: tensor(4.5430, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(0.4795, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(0.3398, device='cuda:0', dtype=torch.float16) tensor(0.0312, device='cuda:0', dtype=torch.float16)
tensor(0.4492, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.5010, device='cuda:0', dtype=torch.float16) tensor(0.0337, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.9453, device='cuda:0', dtype=torch.float16) tensor(0.8501, device='cuda:0', dtype=torch.float16)
tensor(3.6641, device='cuda:0', dtype=torch.float16) tensor(0.2808, device='cuda:0', dtype=torch.float16)
tensor(3.2012, device='cuda:0', dtype=torch.float16) tensor(0.2739, device='cuda:0', dtype=torch.float16)
tensor(3.7109, device='cuda:0', dtype=torch.float16) tensor(0.2805, device='cuda:0', dtype=torch.float16)
tensor(3.5469, device='cuda:0', dtype=torch.float16) tensor(0.2778, device='cuda:0', dtype=torch.float16)
tensor(0.0900, device='cuda:0')
old_score: tensor(0.2783, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1514, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.223871946334839
Validation after dual ascent:
out_inf: tensor(15.9453, device='cuda:0', dtype=torch.float16) tensor(0.8501, device='cuda:0', dtype=torch.float16)
tensor(1.9609, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(2.0977, device='cuda:0', dtype=torch.float16) tensor(0.1483, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.4844, device='cuda:0', dtype=torch.float16) tensor(1.1221, device='cuda:0', dtype=torch.float16)
tensor(2.6895, device='cuda:0', dtype=torch.float16) tensor(0.2935, device='cuda:0', dtype=torch.float16)
tensor(2.9160, device='cuda:0', dtype=torch.float16) tensor(0.2900, device='cuda:0', dtype=torch.float16)
tensor(3.0430, device='cuda:0', dtype=torch.float16) tensor(0.2947, device='cuda:0', dtype=torch.float16)
tensor(2.8672, device='cuda:0', dtype=torch.float16) tensor(0.2922, device='cuda:0', dtype=torch.float16)
tensor(0.0901, device='cuda:0')
old_score: tensor(0.2925, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1523, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.256711721420288
Validation after dual ascent:
out_inf: tensor(17.4844, device='cuda:0', dtype=torch.float16) tensor(1.1221, device='cuda:0', dtype=torch.float16)
tensor(1.7324, device='cuda:0', dtype=torch.float16) tensor(0.1578, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1443, device='cuda:0', dtype=torch.float16)
tensor(1.7256, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
tensor(1.9785, device='cuda:0', dtype=torch.float16) tensor(0.1492, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.5273, device='cuda:0', dtype=torch.float16) tensor(0.3188, device='cuda:0', dtype=torch.float16)
tensor(1.2529, device='cuda:0', dtype=torch.float16) tensor(0.1486, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.1895, device='cuda:0', dtype=torch.float16) tensor(0.1469, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0187, device='cuda:0')
tensor(0.2420, device='cuda:0')
old_score: tensor(0.1469, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0954, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2610855102539062
Validation after dual ascent:
out_inf: tensor(4.5273, device='cuda:0', dtype=torch.float16) tensor(0.3188, device='cuda:0', dtype=torch.float16)
tensor(0.8521, device='cuda:0', dtype=torch.float16) tensor(0.0990, device='cuda:0', dtype=torch.float16)
tensor(0.7754, device='cuda:0', dtype=torch.float16) tensor(0.0902, device='cuda:0', dtype=torch.float16)
tensor(0.8071, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(0.9624, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.9766, device='cuda:0', dtype=torch.float16) tensor(0.1015, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0523, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0491, device='cuda:0', dtype=torch.float16)
tensor(1.0488, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0461, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0120, device='cuda:0')
tensor(0.0112, device='cuda:0')
old_score: tensor(0.0505, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0310, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.509307384490967
Validation after dual ascent:
out_inf: tensor(8.9766, device='cuda:0', dtype=torch.float16) tensor(0.1015, device='cuda:0', dtype=torch.float16)
tensor(0.5508, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.4609, device='cuda:0', dtype=torch.float16) tensor(0.0280, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.1523, device='cuda:0', dtype=torch.float16) tensor(0.3542, device='cuda:0', dtype=torch.float16)
tensor(1.8945, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(2.3008, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(2.0547, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(2.2930, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0111, device='cuda:0')
tensor(0.0999, device='cuda:0')
old_score: tensor(0.1271, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0764, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.249049663543701
Validation after dual ascent:
out_inf: tensor(7.1523, device='cuda:0', dtype=torch.float16) tensor(0.3542, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.0806, device='cuda:0', dtype=torch.float16)
tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
tensor(1.3730, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
tensor(1.3545, device='cuda:0', dtype=torch.float16) tensor(0.0748, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.6523, device='cuda:0', dtype=torch.float16) tensor(0.2646, device='cuda:0', dtype=torch.float16)
tensor(1.0977, device='cuda:0', dtype=torch.float16) tensor(0.1149, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.1514, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0097, device='cuda:0')
tensor(0.0976, device='cuda:0')
old_score: tensor(0.1123, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0748, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.243805408477783
Validation after dual ascent:
out_inf: tensor(4.6523, device='cuda:0', dtype=torch.float16) tensor(0.2646, device='cuda:0', dtype=torch.float16)
tensor(0.7593, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(1.1445, device='cuda:0', dtype=torch.float16) tensor(0.0687, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0784, device='cuda:0', dtype=torch.float16)
tensor(0.9258, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.8633, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(0.6011, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
tensor(0.6543, device='cuda:0', dtype=torch.float16) tensor(0.0449, device='cuda:0', dtype=torch.float16)
tensor(0.5566, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(0.6523, device='cuda:0', dtype=torch.float16) tensor(0.0471, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0156, device='cuda:0')
tensor(0.0841, device='cuda:0')
old_score: tensor(0.0471, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0370, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.409772872924805
Validation after dual ascent:
out_inf: tensor(2.8633, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(0.4863, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0333, device='cuda:0', dtype=torch.float16)
tensor(0.4517, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.5615, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.7031, device='cuda:0', dtype=torch.float16) tensor(0.8325, device='cuda:0', dtype=torch.float16)
tensor(2.9609, device='cuda:0', dtype=torch.float16) tensor(0.2717, device='cuda:0', dtype=torch.float16)
tensor(2.8828, device='cuda:0', dtype=torch.float16) tensor(0.2646, device='cuda:0', dtype=torch.float16)
tensor(3.2656, device='cuda:0', dtype=torch.float16) tensor(0.2725, device='cuda:0', dtype=torch.float16)
tensor(2.9570, device='cuda:0', dtype=torch.float16) tensor(0.2703, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0170, device='cuda:0')
tensor(0.4243, device='cuda:0')
old_score: tensor(0.2698, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1514, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.002388000488281
Validation after dual ascent:
out_inf: tensor(17.7031, device='cuda:0', dtype=torch.float16) tensor(0.8325, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
tensor(1.6367, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.8896, device='cuda:0', dtype=torch.float16) tensor(0.1570, device='cuda:0', dtype=torch.float16)
tensor(1.7959, device='cuda:0', dtype=torch.float16) tensor(0.1488, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.k_proj
Validation after prune:
out_inf: tensor(16.6250, device='cuda:0', dtype=torch.float16) tensor(1.0840, device='cuda:0', dtype=torch.float16)
tensor(3.0469, device='cuda:0', dtype=torch.float16) tensor(0.2900, device='cuda:0', dtype=torch.float16)
tensor(3.0781, device='cuda:0', dtype=torch.float16) tensor(0.2839, device='cuda:0', dtype=torch.float16)
tensor(3.0703, device='cuda:0', dtype=torch.float16) tensor(0.2920, device='cuda:0', dtype=torch.float16)
tensor(3.1797, device='cuda:0', dtype=torch.float16) tensor(0.2898, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0175, device='cuda:0')
tensor(0.4290, device='cuda:0')
old_score: tensor(0.2891, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1547, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.004322290420532
Validation after dual ascent:
out_inf: tensor(16.6250, device='cuda:0', dtype=torch.float16) tensor(1.0840, device='cuda:0', dtype=torch.float16)
tensor(1.8809, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(1.7471, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.9707, device='cuda:0', dtype=torch.float16) tensor(0.1610, device='cuda:0', dtype=torch.float16)
tensor(1.6816, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.9023, device='cuda:0', dtype=torch.float16) tensor(0.3284, device='cuda:0', dtype=torch.float16)
tensor(1.2207, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.1582, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.3125, device='cuda:0', dtype=torch.float16) tensor(0.1514, device='cuda:0', dtype=torch.float16)
tensor(1.1699, device='cuda:0', dtype=torch.float16) tensor(0.1497, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0173, device='cuda:0')
tensor(0.4162, device='cuda:0')
old_score: tensor(0.1492, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1000, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5043768882751465
Validation after dual ascent:
out_inf: tensor(4.9023, device='cuda:0', dtype=torch.float16) tensor(0.3284, device='cuda:0', dtype=torch.float16)
tensor(0.8560, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
tensor(0.7393, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
tensor(0.7759, device='cuda:0', dtype=torch.float16) tensor(0.1034, device='cuda:0', dtype=torch.float16)
tensor(0.7871, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.5078, device='cuda:0', dtype=torch.float16) tensor(0.1073, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.0525, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0165, device='cuda:0')
tensor(0.0287, device='cuda:0')
old_score: tensor(0.0528, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0339, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4995932579040527
Validation after dual ascent:
out_inf: tensor(8.5078, device='cuda:0', dtype=torch.float16) tensor(0.1073, device='cuda:0', dtype=torch.float16)
tensor(0.6113, device='cuda:0', dtype=torch.float16) tensor(0.0345, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0318, device='cuda:0', dtype=torch.float16)
tensor(0.5732, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.5977, device='cuda:0', dtype=torch.float16) tensor(0.0323, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.1797, device='cuda:0', dtype=torch.float16) tensor(0.3743, device='cuda:0', dtype=torch.float16)
tensor(2.1914, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(2.0469, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
tensor(1.6768, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.1344, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0130, device='cuda:0')
tensor(0.1184, device='cuda:0')
old_score: tensor(0.1346, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0775, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.236894369125366
Validation after dual ascent:
out_inf: tensor(8.1797, device='cuda:0', dtype=torch.float16) tensor(0.3743, device='cuda:0', dtype=torch.float16)
tensor(1.4961, device='cuda:0', dtype=torch.float16) tensor(0.0822, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(1.2666, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(1.3965, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.9609, device='cuda:0', dtype=torch.float16) tensor(0.2769, device='cuda:0', dtype=torch.float16)
tensor(1.7695, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1137, device='cuda:0', dtype=torch.float16)
tensor(1.2520, device='cuda:0', dtype=torch.float16) tensor(0.1193, device='cuda:0', dtype=torch.float16)
tensor(1.5000, device='cuda:0', dtype=torch.float16) tensor(0.1172, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0114, device='cuda:0')
tensor(0.1134, device='cuda:0')
old_score: tensor(0.1174, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0759, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2394859790802
Validation after dual ascent:
out_inf: tensor(4.9609, device='cuda:0', dtype=torch.float16) tensor(0.2769, device='cuda:0', dtype=torch.float16)
tensor(0.7588, device='cuda:0', dtype=torch.float16) tensor(0.0805, device='cuda:0', dtype=torch.float16)
tensor(0.6895, device='cuda:0', dtype=torch.float16) tensor(0.0691, device='cuda:0', dtype=torch.float16)
tensor(0.8062, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.0743, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.3906, device='cuda:0', dtype=torch.float16) tensor(0.1171, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
tensor(0.6562, device='cuda:0', dtype=torch.float16) tensor(0.0510, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
tensor(0.6836, device='cuda:0', dtype=torch.float16) tensor(0.0527, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0188, device='cuda:0')
tensor(0.1047, device='cuda:0')
old_score: tensor(0.0532, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0407, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.351270198822021
Validation after dual ascent:
out_inf: tensor(4.3906, device='cuda:0', dtype=torch.float16) tensor(0.1171, device='cuda:0', dtype=torch.float16)
tensor(0.5703, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
tensor(0.5083, device='cuda:0', dtype=torch.float16) tensor(0.0371, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0426, device='cuda:0', dtype=torch.float16)
tensor(0.4565, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.q_proj
Validation after prune:
out_inf: tensor(20.3594, device='cuda:0', dtype=torch.float16) tensor(0.8203, device='cuda:0', dtype=torch.float16)
tensor(4.8203, device='cuda:0', dtype=torch.float16) tensor(0.2729, device='cuda:0', dtype=torch.float16)
tensor(4.2109, device='cuda:0', dtype=torch.float16) tensor(0.2637, device='cuda:0', dtype=torch.float16)
tensor(3.9531, device='cuda:0', dtype=torch.float16) tensor(0.2751, device='cuda:0', dtype=torch.float16)
tensor(3.6094, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0170, device='cuda:0')
tensor(0.4308, device='cuda:0')
old_score: tensor(0.2698, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1484, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.9980719089508057
Validation after dual ascent:
out_inf: tensor(20.3594, device='cuda:0', dtype=torch.float16) tensor(0.8203, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(1.9209, device='cuda:0', dtype=torch.float16) tensor(0.1377, device='cuda:0', dtype=torch.float16)
tensor(2.1875, device='cuda:0', dtype=torch.float16) tensor(0.1550, device='cuda:0', dtype=torch.float16)
tensor(1.9658, device='cuda:0', dtype=torch.float16) tensor(0.1447, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.4531, device='cuda:0', dtype=torch.float16) tensor(1.0820, device='cuda:0', dtype=torch.float16)
tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.2764, device='cuda:0', dtype=torch.float16)
tensor(2.8594, device='cuda:0', dtype=torch.float16) tensor(0.2717, device='cuda:0', dtype=torch.float16)
tensor(2.9141, device='cuda:0', dtype=torch.float16) tensor(0.2861, device='cuda:0', dtype=torch.float16)
tensor(2.6406, device='cuda:0', dtype=torch.float16) tensor(0.2737, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0176, device='cuda:0')
tensor(0.4107, device='cuda:0')
old_score: tensor(0.2769, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1499, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.004679441452026
Validation after dual ascent:
out_inf: tensor(17.4531, device='cuda:0', dtype=torch.float16) tensor(1.0820, device='cuda:0', dtype=torch.float16)
tensor(1.8408, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1387, device='cuda:0', dtype=torch.float16)
tensor(1.9297, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(1.8477, device='cuda:0', dtype=torch.float16) tensor(0.1458, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.8359, device='cuda:0', dtype=torch.float16) tensor(0.3345, device='cuda:0', dtype=torch.float16)
tensor(1.2227, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(1.4453, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.1571, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.1553, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0174, device='cuda:0')
tensor(0.4090, device='cuda:0')
old_score: tensor(0.1555, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1026, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5037810802459717
Validation after dual ascent:
out_inf: tensor(4.8359, device='cuda:0', dtype=torch.float16) tensor(0.3345, device='cuda:0', dtype=torch.float16)
tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.1086, device='cuda:0', dtype=torch.float16)
tensor(0.8750, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(0.8989, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.8672, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(0.9395, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.0633, device='cuda:0', dtype=torch.float16)
tensor(1.1934, device='cuda:0', dtype=torch.float16) tensor(0.0624, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0198, device='cuda:0')
tensor(0.1747, device='cuda:0')
old_score: tensor(0.0626, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0385, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7507307529449463
Validation after dual ascent:
out_inf: tensor(8.8672, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
tensor(0.5430, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(0.7148, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.6641, device='cuda:0', dtype=torch.float16) tensor(0.3948, device='cuda:0', dtype=torch.float16)
tensor(2.2578, device='cuda:0', dtype=torch.float16) tensor(0.1447, device='cuda:0', dtype=torch.float16)
tensor(1.9297, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
tensor(1.9961, device='cuda:0', dtype=torch.float16) tensor(0.1459, device='cuda:0', dtype=torch.float16)
tensor(1.9141, device='cuda:0', dtype=torch.float16) tensor(0.1414, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0132, device='cuda:0')
tensor(0.1144, device='cuda:0')
old_score: tensor(0.1426, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0798, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2323243618011475
Validation after dual ascent:
out_inf: tensor(7.6641, device='cuda:0', dtype=torch.float16) tensor(0.3948, device='cuda:0', dtype=torch.float16)
tensor(1.3496, device='cuda:0', dtype=torch.float16) tensor(0.0849, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
tensor(1.4111, device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
tensor(1.5117, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.3008, device='cuda:0', dtype=torch.float16) tensor(0.2905, device='cuda:0', dtype=torch.float16)
tensor(1.3984, device='cuda:0', dtype=torch.float16) tensor(0.1257, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.1180, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1250, device='cuda:0', dtype=torch.float16)
tensor(1.6113, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0111, device='cuda:0')
tensor(0.1094, device='cuda:0')
old_score: tensor(0.1226, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0775, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.233362674713135
Validation after dual ascent:
out_inf: tensor(5.3008, device='cuda:0', dtype=torch.float16) tensor(0.2905, device='cuda:0', dtype=torch.float16)
tensor(0.8555, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.7842, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0821, device='cuda:0', dtype=torch.float16)
tensor(1.1250, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.down_proj
Validation after prune:
out_inf: tensor(5.1602, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0607, device='cuda:0', dtype=torch.float16)
tensor(0.8125, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(0.7329, device='cuda:0', dtype=torch.float16) tensor(0.0620, device='cuda:0', dtype=torch.float16)
tensor(0.9819, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0027, device='cuda:0')
tensor(0.0122, device='cuda:0')
old_score: tensor(0.0596, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0441, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.21981644630432
Validation after dual ascent:
out_inf: tensor(5.1602, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
tensor(0.5801, device='cuda:0', dtype=torch.float16) tensor(0.0473, device='cuda:0', dtype=torch.float16)
tensor(0.4688, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
tensor(0.5459, device='cuda:0', dtype=torch.float16) tensor(0.0469, device='cuda:0', dtype=torch.float16)
tensor(0.8350, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.5312, device='cuda:0', dtype=torch.float16) tensor(0.8115, device='cuda:0', dtype=torch.float16)
tensor(3.2109, device='cuda:0', dtype=torch.float16) tensor(0.2742, device='cuda:0', dtype=torch.float16)
tensor(3.4375, device='cuda:0', dtype=torch.float16) tensor(0.2664, device='cuda:0', dtype=torch.float16)
tensor(3.5078, device='cuda:0', dtype=torch.float16) tensor(0.2771, device='cuda:0', dtype=torch.float16)
tensor(3.0898, device='cuda:0', dtype=torch.float16) tensor(0.2676, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0126, device='cuda:0')
tensor(0.0827, device='cuda:0')
old_score: tensor(0.2712, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1364, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.97992753982544
Validation after dual ascent:
out_inf: tensor(16.5312, device='cuda:0', dtype=torch.float16) tensor(0.8115, device='cuda:0', dtype=torch.float16)
tensor(1.6113, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(1.4385, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(1.7100, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(1.8018, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.0156, device='cuda:0', dtype=torch.float16) tensor(1.0166, device='cuda:0', dtype=torch.float16)
tensor(2.9805, device='cuda:0', dtype=torch.float16) tensor(0.2803, device='cuda:0', dtype=torch.float16)
tensor(3.1562, device='cuda:0', dtype=torch.float16) tensor(0.2744, device='cuda:0', dtype=torch.float16)
tensor(3.1016, device='cuda:0', dtype=torch.float16) tensor(0.2861, device='cuda:0', dtype=torch.float16)
tensor(3.0078, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0129, device='cuda:0')
tensor(0.0787, device='cuda:0')
old_score: tensor(0.2793, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1377, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.00256085395813
Validation after dual ascent:
out_inf: tensor(17.0156, device='cuda:0', dtype=torch.float16) tensor(1.0166, device='cuda:0', dtype=torch.float16)
tensor(1.7246, device='cuda:0', dtype=torch.float16) tensor(0.1470, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1248, device='cuda:0', dtype=torch.float16)
tensor(1.7725, device='cuda:0', dtype=torch.float16) tensor(0.1467, device='cuda:0', dtype=torch.float16)
tensor(1.6572, device='cuda:0', dtype=torch.float16) tensor(0.1326, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.9883, device='cuda:0', dtype=torch.float16) tensor(0.3379, device='cuda:0', dtype=torch.float16)
tensor(1.2588, device='cuda:0', dtype=torch.float16) tensor(0.1606, device='cuda:0', dtype=torch.float16)
tensor(1.1543, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(1.1475, device='cuda:0', dtype=torch.float16) tensor(0.1610, device='cuda:0', dtype=torch.float16)
tensor(1.1211, device='cuda:0', dtype=torch.float16) tensor(0.1566, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0144, device='cuda:0')
tensor(0.2326, device='cuda:0')
old_score: tensor(0.1582, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0961, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.254657745361328
Validation after dual ascent:
out_inf: tensor(3.9883, device='cuda:0', dtype=torch.float16) tensor(0.3379, device='cuda:0', dtype=torch.float16)
tensor(0.8911, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.8672, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.9058, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(0.9531, device='cuda:0', dtype=torch.float16) tensor(0.0928, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.5352, device='cuda:0', dtype=torch.float16) tensor(0.1128, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
tensor(1.4775, device='cuda:0', dtype=torch.float16) tensor(0.0546, device='cuda:0', dtype=torch.float16)
tensor(1.7246, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
tensor(1.1582, device='cuda:0', dtype=torch.float16) tensor(0.0525, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0143, device='cuda:0')
tensor(0.0127, device='cuda:0')
old_score: tensor(0.0542, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0309, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4975664615631104
Validation after dual ascent:
out_inf: tensor(5.5352, device='cuda:0', dtype=torch.float16) tensor(0.1128, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0321, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0278, device='cuda:0', dtype=torch.float16)
tensor(0.6641, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0284, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.8359, device='cuda:0', dtype=torch.float16) tensor(0.4277, device='cuda:0', dtype=torch.float16)
tensor(2.1523, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.8438, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.1466, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0136, device='cuda:0')
tensor(0.1267, device='cuda:0')
old_score: tensor(0.1477, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0846, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.243721008300781
Validation after dual ascent:
out_inf: tensor(6.8359, device='cuda:0', dtype=torch.float16) tensor(0.4277, device='cuda:0', dtype=torch.float16)
tensor(1.6465, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.0762, device='cuda:0', dtype=torch.float16)
tensor(1.7148, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(1.5156, device='cuda:0', dtype=torch.float16) tensor(0.0817, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.3008, device='cuda:0', dtype=torch.float16) tensor(0.2952, device='cuda:0', dtype=torch.float16)
tensor(1.6445, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1276, device='cuda:0', dtype=torch.float16)
tensor(1.2695, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0112, device='cuda:0')
tensor(0.1200, device='cuda:0')
old_score: tensor(0.1245, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0811, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2434587478637695
Validation after dual ascent:
out_inf: tensor(7.3008, device='cuda:0', dtype=torch.float16) tensor(0.2952, device='cuda:0', dtype=torch.float16)
tensor(2.4727, device='cuda:0', dtype=torch.float16) tensor(0.0868, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.8223, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
tensor(0.9121, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.0938, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
tensor(0.8701, device='cuda:0', dtype=torch.float16) tensor(0.0606, device='cuda:0', dtype=torch.float16)
tensor(0.6641, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.6582, device='cuda:0', dtype=torch.float16) tensor(0.0606, device='cuda:0', dtype=torch.float16)
tensor(0.7280, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0022, device='cuda:0')
tensor(0.0110, device='cuda:0')
old_score: tensor(0.0587, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0438, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.28249716758728
Validation after dual ascent:
out_inf: tensor(3.0938, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
tensor(0.7676, device='cuda:0', dtype=torch.float16) tensor(0.0477, device='cuda:0', dtype=torch.float16)
tensor(0.4756, device='cuda:0', dtype=torch.float16) tensor(0.0386, device='cuda:0', dtype=torch.float16)
tensor(0.5244, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.5767, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.4375, device='cuda:0', dtype=torch.float16) tensor(0.8306, device='cuda:0', dtype=torch.float16)
tensor(2.8164, device='cuda:0', dtype=torch.float16) tensor(0.2734, device='cuda:0', dtype=torch.float16)
tensor(2.5938, device='cuda:0', dtype=torch.float16) tensor(0.2656, device='cuda:0', dtype=torch.float16)
tensor(3.1875, device='cuda:0', dtype=torch.float16) tensor(0.2771, device='cuda:0', dtype=torch.float16)
tensor(2.9922, device='cuda:0', dtype=torch.float16) tensor(0.2676, device='cuda:0', dtype=torch.float16)
tensor(0.1315, device='cuda:0')
old_score: tensor(0.2710, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1404, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.194789171218872
Validation after dual ascent:
out_inf: tensor(14.4375, device='cuda:0', dtype=torch.float16) tensor(0.8306, device='cuda:0', dtype=torch.float16)
tensor(1.6367, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
tensor(1.4551, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(1.6826, device='cuda:0', dtype=torch.float16) tensor(0.1498, device='cuda:0', dtype=torch.float16)
tensor(1.7051, device='cuda:0', dtype=torch.float16) tensor(0.1350, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.4844, device='cuda:0', dtype=torch.float16) tensor(0.9932, device='cuda:0', dtype=torch.float16)
tensor(3.3164, device='cuda:0', dtype=torch.float16) tensor(0.2844, device='cuda:0', dtype=torch.float16)
tensor(2.9609, device='cuda:0', dtype=torch.float16) tensor(0.2793, device='cuda:0', dtype=torch.float16)
tensor(3.4375, device='cuda:0', dtype=torch.float16) tensor(0.2915, device='cuda:0', dtype=torch.float16)
tensor(3.1016, device='cuda:0', dtype=torch.float16) tensor(0.2783, device='cuda:0', dtype=torch.float16)
tensor(0.1480, device='cuda:0')
old_score: tensor(0.2832, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1417, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.235645294189453
Validation after dual ascent:
out_inf: tensor(19.4844, device='cuda:0', dtype=torch.float16) tensor(0.9932, device='cuda:0', dtype=torch.float16)
tensor(1.7266, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(1.7363, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.1515, device='cuda:0', dtype=torch.float16)
tensor(1.8457, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.8320, device='cuda:0', dtype=torch.float16) tensor(0.3545, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1729, device='cuda:0', dtype=torch.float16)
tensor(1.2871, device='cuda:0', dtype=torch.float16) tensor(0.1659, device='cuda:0', dtype=torch.float16)
tensor(1.3428, device='cuda:0', dtype=torch.float16) tensor(0.1746, device='cuda:0', dtype=torch.float16)
tensor(1.3857, device='cuda:0', dtype=torch.float16) tensor(0.1688, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0183, device='cuda:0')
tensor(0.0849, device='cuda:0')
old_score: tensor(0.1707, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1036, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.978393793106079
Validation after dual ascent:
out_inf: tensor(4.8320, device='cuda:0', dtype=torch.float16) tensor(0.3545, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
tensor(0.8926, device='cuda:0', dtype=torch.float16) tensor(0.1103, device='cuda:0', dtype=torch.float16)
tensor(0.9624, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(1.0703, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
tensor(1.2012, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(1.4863, device='cuda:0', dtype=torch.float16) tensor(0.0552, device='cuda:0', dtype=torch.float16)
tensor(1.1621, device='cuda:0', dtype=torch.float16) tensor(0.0492, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0076, device='cuda:0')
tensor(0.0183, device='cuda:0')
old_score: tensor(0.0519, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0339, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.7357141971588135
Validation after dual ascent:
out_inf: tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(0.8467, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
tensor(0.8579, device='cuda:0', dtype=torch.float16) tensor(0.0310, device='cuda:0', dtype=torch.float16)
tensor(0.8047, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
tensor(0.8408, device='cuda:0', dtype=torch.float16) tensor(0.0315, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.4375, device='cuda:0', dtype=torch.float16) tensor(0.4412, device='cuda:0', dtype=torch.float16)
tensor(2.1367, device='cuda:0', dtype=torch.float16) tensor(0.1594, device='cuda:0', dtype=torch.float16)
tensor(2.4961, device='cuda:0', dtype=torch.float16) tensor(0.1515, device='cuda:0', dtype=torch.float16)
tensor(2.5391, device='cuda:0', dtype=torch.float16) tensor(0.1594, device='cuda:0', dtype=torch.float16)
tensor(2.7383, device='cuda:0', dtype=torch.float16) tensor(0.1544, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0154, device='cuda:0')
tensor(0.1497, device='cuda:0')
old_score: tensor(0.1562, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0876, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.249088287353516
Validation after dual ascent:
out_inf: tensor(8.4375, device='cuda:0', dtype=torch.float16) tensor(0.4412, device='cuda:0', dtype=torch.float16)
tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(1.7070, device='cuda:0', dtype=torch.float16) tensor(0.0787, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.0843, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.2031, device='cuda:0', dtype=torch.float16) tensor(0.2964, device='cuda:0', dtype=torch.float16)
tensor(1.4980, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.1240, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.1327, device='cuda:0', dtype=torch.float16)
tensor(1.3867, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0127, device='cuda:0')
tensor(0.1389, device='cuda:0')
old_score: tensor(0.1287, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0829, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.245747804641724
Validation after dual ascent:
out_inf: tensor(6.2031, device='cuda:0', dtype=torch.float16) tensor(0.2964, device='cuda:0', dtype=torch.float16)
tensor(0.9033, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(1.7188, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.8071, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0798, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.down_proj
Validation after prune:
out_inf: tensor(5.3086, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(0.8428, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.8535, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(0.8125, device='cuda:0', dtype=torch.float16) tensor(0.0672, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0629, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0065, device='cuda:0')
tensor(0.0295, device='cuda:0')
old_score: tensor(0.0643, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0471, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.26821231842041
Validation after dual ascent:
out_inf: tensor(5.3086, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(0.5850, device='cuda:0', dtype=torch.float16) tensor(0.0510, device='cuda:0', dtype=torch.float16)
tensor(0.5332, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.5635, device='cuda:0', dtype=torch.float16) tensor(0.0506, device='cuda:0', dtype=torch.float16)
tensor(0.7251, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.5781, device='cuda:0', dtype=torch.float16) tensor(0.8213, device='cuda:0', dtype=torch.float16)
tensor(3.0703, device='cuda:0', dtype=torch.float16) tensor(0.2708, device='cuda:0', dtype=torch.float16)
tensor(2.9141, device='cuda:0', dtype=torch.float16) tensor(0.2654, device='cuda:0', dtype=torch.float16)
tensor(3.1875, device='cuda:0', dtype=torch.float16) tensor(0.2756, device='cuda:0', dtype=torch.float16)
tensor(3.2734, device='cuda:0', dtype=torch.float16) tensor(0.2632, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0182, device='cuda:0')
tensor(0.1659, device='cuda:0')
old_score: tensor(0.2686, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1360, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.238976716995239
Validation after dual ascent:
out_inf: tensor(14.5781, device='cuda:0', dtype=torch.float16) tensor(0.8213, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1454, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1236, device='cuda:0', dtype=torch.float16)
tensor(1.5195, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.0469, device='cuda:0', dtype=torch.float16) tensor(1.0752, device='cuda:0', dtype=torch.float16)
tensor(3.3047, device='cuda:0', dtype=torch.float16) tensor(0.2786, device='cuda:0', dtype=torch.float16)
tensor(2.8516, device='cuda:0', dtype=torch.float16) tensor(0.2747, device='cuda:0', dtype=torch.float16)
tensor(3.4531, device='cuda:0', dtype=torch.float16) tensor(0.2871, device='cuda:0', dtype=torch.float16)
tensor(3.4766, device='cuda:0', dtype=torch.float16) tensor(0.2725, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0186, device='cuda:0')
tensor(0.1517, device='cuda:0')
old_score: tensor(0.2783, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1370, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2473156452178955
Validation after dual ascent:
out_inf: tensor(20.0469, device='cuda:0', dtype=torch.float16) tensor(1.0752, device='cuda:0', dtype=torch.float16)
tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.1464, device='cuda:0', dtype=torch.float16)
tensor(1.4629, device='cuda:0', dtype=torch.float16) tensor(0.1240, device='cuda:0', dtype=torch.float16)
tensor(1.7754, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.4258, device='cuda:0', dtype=torch.float16) tensor(0.3730, device='cuda:0', dtype=torch.float16)
tensor(1.3896, device='cuda:0', dtype=torch.float16) tensor(0.1755, device='cuda:0', dtype=torch.float16)
tensor(1.4922, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(1.2607, device='cuda:0', dtype=torch.float16) tensor(0.1775, device='cuda:0', dtype=torch.float16)
tensor(1.2852, device='cuda:0', dtype=torch.float16) tensor(0.1709, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0123, device='cuda:0')
tensor(0.2847, device='cuda:0')
old_score: tensor(0.1733, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1054, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.249229907989502
Validation after dual ascent:
out_inf: tensor(4.4258, device='cuda:0', dtype=torch.float16) tensor(0.3730, device='cuda:0', dtype=torch.float16)
tensor(1.0605, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(0.9307, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.o_proj
Validation after prune:
out_inf: tensor(6.7852, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
tensor(1.3926, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(1.2754, device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.0511, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0187, device='cuda:0')
tensor(0.0252, device='cuda:0')
old_score: tensor(0.0530, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0346, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.979721307754517
Validation after dual ascent:
out_inf: tensor(6.7852, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.8789, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.7070, device='cuda:0', dtype=torch.float16) tensor(0.0326, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.5078, device='cuda:0', dtype=torch.float16) tensor(0.4285, device='cuda:0', dtype=torch.float16)
tensor(1.8828, device='cuda:0', dtype=torch.float16) tensor(0.1627, device='cuda:0', dtype=torch.float16)
tensor(2.1211, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(2.3086, device='cuda:0', dtype=torch.float16) tensor(0.1628, device='cuda:0', dtype=torch.float16)
tensor(2.5000, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0161, device='cuda:0')
tensor(0.1673, device='cuda:0')
old_score: tensor(0.1597, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0902, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.237902641296387
Validation after dual ascent:
out_inf: tensor(7.5078, device='cuda:0', dtype=torch.float16) tensor(0.4285, device='cuda:0', dtype=torch.float16)
tensor(1.4648, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(1.1680, device='cuda:0', dtype=torch.float16) tensor(0.0817, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(2.1133, device='cuda:0', dtype=torch.float16) tensor(0.0866, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.0078, device='cuda:0', dtype=torch.float16) tensor(0.3003, device='cuda:0', dtype=torch.float16)
tensor(1.7188, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.1283, device='cuda:0', dtype=torch.float16)
tensor(1.7070, device='cuda:0', dtype=torch.float16) tensor(0.1356, device='cuda:0', dtype=torch.float16)
tensor(1.5977, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0137, device='cuda:0')
tensor(0.1544, device='cuda:0')
old_score: tensor(0.1322, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0851, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.238577365875244
Validation after dual ascent:
out_inf: tensor(7.0078, device='cuda:0', dtype=torch.float16) tensor(0.3003, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.0912, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
tensor(1.0605, device='cuda:0', dtype=torch.float16) tensor(0.0903, device='cuda:0', dtype=torch.float16)
tensor(1.0488, device='cuda:0', dtype=torch.float16) tensor(0.0817, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.0781, device='cuda:0', dtype=torch.float16) tensor(0.1388, device='cuda:0', dtype=torch.float16)
tensor(0.8423, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(0.7847, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.7744, device='cuda:0', dtype=torch.float16) tensor(0.0659, device='cuda:0', dtype=torch.float16)
tensor(0.7969, device='cuda:0', dtype=torch.float16) tensor(0.0624, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0047, device='cuda:0')
tensor(0.0188, device='cuda:0')
old_score: tensor(0.0635, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0472, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.238327264785767
Validation after dual ascent:
out_inf: tensor(4.0781, device='cuda:0', dtype=torch.float16) tensor(0.1388, device='cuda:0', dtype=torch.float16)
tensor(0.5688, device='cuda:0', dtype=torch.float16) tensor(0.0505, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
tensor(0.7939, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.9531, device='cuda:0', dtype=torch.float16) tensor(0.8452, device='cuda:0', dtype=torch.float16)
tensor(3.0625, device='cuda:0', dtype=torch.float16) tensor(0.2708, device='cuda:0', dtype=torch.float16)
tensor(2.8652, device='cuda:0', dtype=torch.float16) tensor(0.2637, device='cuda:0', dtype=torch.float16)
tensor(3.1719, device='cuda:0', dtype=torch.float16) tensor(0.2766, device='cuda:0', dtype=torch.float16)
tensor(2.8770, device='cuda:0', dtype=torch.float16) tensor(0.2629, device='cuda:0', dtype=torch.float16)
tensor(0.1182, device='cuda:0')
old_score: tensor(0.2683, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1354, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.218705177307129
Validation after dual ascent:
out_inf: tensor(16.9531, device='cuda:0', dtype=torch.float16) tensor(0.8452, device='cuda:0', dtype=torch.float16)
tensor(1.5449, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.1232, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1445, device='cuda:0', dtype=torch.float16)
tensor(1.6748, device='cuda:0', dtype=torch.float16) tensor(0.1294, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.0938, device='cuda:0', dtype=torch.float16) tensor(1.0615, device='cuda:0', dtype=torch.float16)
tensor(3.2656, device='cuda:0', dtype=torch.float16) tensor(0.2761, device='cuda:0', dtype=torch.float16)
tensor(3.1875, device='cuda:0', dtype=torch.float16) tensor(0.2712, device='cuda:0', dtype=torch.float16)
tensor(3.1094, device='cuda:0', dtype=torch.float16) tensor(0.2817, device='cuda:0', dtype=torch.float16)
tensor(3.1016, device='cuda:0', dtype=torch.float16) tensor(0.2693, device='cuda:0', dtype=torch.float16)
tensor(0.1281, device='cuda:0')
old_score: tensor(0.2747, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1360, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.25413990020752
Validation after dual ascent:
out_inf: tensor(19.0938, device='cuda:0', dtype=torch.float16) tensor(1.0615, device='cuda:0', dtype=torch.float16)
tensor(1.5586, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
tensor(1.7754, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.0938, device='cuda:0', dtype=torch.float16) tensor(0.3591, device='cuda:0', dtype=torch.float16)
tensor(1.5391, device='cuda:0', dtype=torch.float16) tensor(0.1769, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1707, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1771, device='cuda:0', dtype=torch.float16)
tensor(1.4629, device='cuda:0', dtype=torch.float16) tensor(0.1714, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0165, device='cuda:0')
tensor(0.0751, device='cuda:0')
old_score: tensor(0.1741, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1037, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.974589347839355
Validation after dual ascent:
out_inf: tensor(4.0938, device='cuda:0', dtype=torch.float16) tensor(0.3591, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(1.1553, device='cuda:0', dtype=torch.float16) tensor(0.0942, device='cuda:0', dtype=torch.float16)
tensor(1.0322, device='cuda:0', dtype=torch.float16) tensor(0.1101, device='cuda:0', dtype=torch.float16)
tensor(0.9541, device='cuda:0', dtype=torch.float16) tensor(0.0994, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.o_proj
Validation after prune:
out_inf: tensor(12.3828, device='cuda:0', dtype=torch.float16) tensor(0.1548, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.0662, device='cuda:0', dtype=torch.float16)
tensor(1.4219, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(1.5312, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.0647, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0175, device='cuda:0')
tensor(0.0194, device='cuda:0')
old_score: tensor(0.0641, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0407, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.469432353973389
Validation after dual ascent:
out_inf: tensor(12.3828, device='cuda:0', dtype=torch.float16) tensor(0.1548, device='cuda:0', dtype=torch.float16)
tensor(0.8013, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.6406, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.9883, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.0391, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.gate_proj
Validation after prune:
out_inf: tensor(11.3281, device='cuda:0', dtype=torch.float16) tensor(0.4194, device='cuda:0', dtype=torch.float16)
tensor(2.9453, device='cuda:0', dtype=torch.float16) tensor(0.1619, device='cuda:0', dtype=torch.float16)
tensor(1.9023, device='cuda:0', dtype=torch.float16) tensor(0.1541, device='cuda:0', dtype=torch.float16)
tensor(2.2383, device='cuda:0', dtype=torch.float16) tensor(0.1635, device='cuda:0', dtype=torch.float16)
tensor(2.4141, device='cuda:0', dtype=torch.float16) tensor(0.1571, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0161, device='cuda:0')
tensor(0.1670, device='cuda:0')
old_score: tensor(0.1592, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0912, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.214653491973877
Validation after dual ascent:
out_inf: tensor(11.3281, device='cuda:0', dtype=torch.float16) tensor(0.4194, device='cuda:0', dtype=torch.float16)
tensor(3.3203, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.0827, device='cuda:0', dtype=torch.float16)
tensor(1.3105, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
tensor(1.9336, device='cuda:0', dtype=torch.float16) tensor(0.0864, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.2422, device='cuda:0', dtype=torch.float16) tensor(0.3003, device='cuda:0', dtype=torch.float16)
tensor(1.7070, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1377, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0137, device='cuda:0')
tensor(0.1540, device='cuda:0')
old_score: tensor(0.1333, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0853, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.214052200317383
Validation after dual ascent:
out_inf: tensor(5.2422, device='cuda:0', dtype=torch.float16) tensor(0.3003, device='cuda:0', dtype=torch.float16)
tensor(1.2168, device='cuda:0', dtype=torch.float16) tensor(0.0907, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.0774, device='cuda:0', dtype=torch.float16)
tensor(0.8564, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(1.0566, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.down_proj
Validation after prune:
out_inf: tensor(6.1797, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(0.8320, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.7065, device='cuda:0', dtype=torch.float16) tensor(0.0607, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0103, device='cuda:0')
tensor(0.0451, device='cuda:0')
old_score: tensor(0.0654, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0475, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.104702472686768
Validation after dual ascent:
out_inf: tensor(6.1797, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(0.6299, device='cuda:0', dtype=torch.float16) tensor(0.0511, device='cuda:0', dtype=torch.float16)
tensor(0.6670, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
tensor(0.5967, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(0.8491, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.q_proj
Validation after prune:
out_inf: tensor(18.3438, device='cuda:0', dtype=torch.float16) tensor(0.8149, device='cuda:0', dtype=torch.float16)
tensor(3.3203, device='cuda:0', dtype=torch.float16) tensor(0.2673, device='cuda:0', dtype=torch.float16)
tensor(3.0156, device='cuda:0', dtype=torch.float16) tensor(0.2595, device='cuda:0', dtype=torch.float16)
tensor(3.4297, device='cuda:0', dtype=torch.float16) tensor(0.2756, device='cuda:0', dtype=torch.float16)
tensor(3.0859, device='cuda:0', dtype=torch.float16) tensor(0.2571, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0195, device='cuda:0')
tensor(0.1384, device='cuda:0')
old_score: tensor(0.2649, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1332, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.243436574935913
Validation after dual ascent:
out_inf: tensor(18.3438, device='cuda:0', dtype=torch.float16) tensor(0.8149, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(1.4277, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1445, device='cuda:0', dtype=torch.float16)
tensor(1.8350, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.8281, device='cuda:0', dtype=torch.float16) tensor(1.0107, device='cuda:0', dtype=torch.float16)
tensor(3.6406, device='cuda:0', dtype=torch.float16) tensor(0.2681, device='cuda:0', dtype=torch.float16)
tensor(3.8203, device='cuda:0', dtype=torch.float16) tensor(0.2629, device='cuda:0', dtype=torch.float16)
tensor(3.9922, device='cuda:0', dtype=torch.float16) tensor(0.2788, device='cuda:0', dtype=torch.float16)
tensor(3.2266, device='cuda:0', dtype=torch.float16) tensor(0.2598, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0196, device='cuda:0')
tensor(0.1330, device='cuda:0')
old_score: tensor(0.2676, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1333, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.249975204467773
Validation after dual ascent:
out_inf: tensor(19.8281, device='cuda:0', dtype=torch.float16) tensor(1.0107, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(1.5840, device='cuda:0', dtype=torch.float16) tensor(0.1254, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.3945, device='cuda:0', dtype=torch.float16) tensor(0.3755, device='cuda:0', dtype=torch.float16)
tensor(1.5254, device='cuda:0', dtype=torch.float16) tensor(0.1851, device='cuda:0', dtype=torch.float16)
tensor(1.5820, device='cuda:0', dtype=torch.float16) tensor(0.1797, device='cuda:0', dtype=torch.float16)
tensor(1.6797, device='cuda:0', dtype=torch.float16) tensor(0.1884, device='cuda:0', dtype=torch.float16)
tensor(1.5537, device='cuda:0', dtype=torch.float16) tensor(0.1786, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0124, device='cuda:0')
tensor(0.2752, device='cuda:0')
old_score: tensor(0.1830, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1115, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2501423358917236
Validation after dual ascent:
out_inf: tensor(5.3945, device='cuda:0', dtype=torch.float16) tensor(0.3755, device='cuda:0', dtype=torch.float16)
tensor(1.1846, device='cuda:0', dtype=torch.float16) tensor(0.1181, device='cuda:0', dtype=torch.float16)
tensor(0.9746, device='cuda:0', dtype=torch.float16) tensor(0.1021, device='cuda:0', dtype=torch.float16)
tensor(1.0107, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
tensor(1.1592, device='cuda:0', dtype=torch.float16) tensor(0.1055, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.2422, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.0653, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(1.2754, device='cuda:0', dtype=torch.float16) tensor(0.0611, device='cuda:0', dtype=torch.float16)
tensor(1.4531, device='cuda:0', dtype=torch.float16) tensor(0.0595, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0142, device='cuda:0')
tensor(0.0313, device='cuda:0')
old_score: tensor(0.0643, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0446, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.461305141448975
Validation after dual ascent:
out_inf: tensor(8.2422, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.0453, device='cuda:0', dtype=torch.float16)
tensor(0.8438, device='cuda:0', dtype=torch.float16) tensor(0.0455, device='cuda:0', dtype=torch.float16)
tensor(0.8262, device='cuda:0', dtype=torch.float16) tensor(0.0474, device='cuda:0', dtype=torch.float16)
tensor(0.8477, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.4570, device='cuda:0', dtype=torch.float16) tensor(0.4131, device='cuda:0', dtype=torch.float16)
tensor(2.4805, device='cuda:0', dtype=torch.float16) tensor(0.1631, device='cuda:0', dtype=torch.float16)
tensor(1.8164, device='cuda:0', dtype=torch.float16) tensor(0.1578, device='cuda:0', dtype=torch.float16)
tensor(2.1797, device='cuda:0', dtype=torch.float16) tensor(0.1650, device='cuda:0', dtype=torch.float16)
tensor(2.1992, device='cuda:0', dtype=torch.float16) tensor(0.1591, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0167, device='cuda:0')
tensor(0.1791, device='cuda:0')
old_score: tensor(0.1613, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0936, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.23484206199646
Validation after dual ascent:
out_inf: tensor(7.4570, device='cuda:0', dtype=torch.float16) tensor(0.4131, device='cuda:0', dtype=torch.float16)
tensor(1.6992, device='cuda:0', dtype=torch.float16) tensor(0.0995, device='cuda:0', dtype=torch.float16)
tensor(1.9629, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(1.5000, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.0883, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.5586, device='cuda:0', dtype=torch.float16) tensor(0.2966, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
tensor(1.5312, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1301, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0141, device='cuda:0')
tensor(0.1630, device='cuda:0')
old_score: tensor(0.1338, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0870, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.199378728866577
Validation after dual ascent:
out_inf: tensor(5.5586, device='cuda:0', dtype=torch.float16) tensor(0.2966, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.0924, device='cuda:0', dtype=torch.float16)
tensor(1.2559, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.6914, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(0.7178, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0585, device='cuda:0', dtype=torch.float16)
tensor(0.6616, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0618, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0051, device='cuda:0')
tensor(0.0251, device='cuda:0')
old_score: tensor(0.0620, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0460, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.129767417907715
Validation after dual ascent:
out_inf: tensor(4.6914, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(0.5498, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
tensor(0.4885, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(0.4792, device='cuda:0', dtype=torch.float16) tensor(0.0501, device='cuda:0', dtype=torch.float16)
tensor(0.6758, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.q_proj
Validation after prune:
out_inf: tensor(18.6406, device='cuda:0', dtype=torch.float16) tensor(0.8721, device='cuda:0', dtype=torch.float16)
tensor(3., device='cuda:0', dtype=torch.float16) tensor(0.2791, device='cuda:0', dtype=torch.float16)
tensor(2.7344, device='cuda:0', dtype=torch.float16) tensor(0.2729, device='cuda:0', dtype=torch.float16)
tensor(2.9453, device='cuda:0', dtype=torch.float16) tensor(0.2891, device='cuda:0', dtype=torch.float16)
tensor(2.7891, device='cuda:0', dtype=torch.float16) tensor(0.2715, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0153, device='cuda:0')
tensor(0.1750, device='cuda:0')
old_score: tensor(0.2781, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1400, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.242669582366943
Validation after dual ascent:
out_inf: tensor(18.6406, device='cuda:0', dtype=torch.float16) tensor(0.8721, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.1530, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1310, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.k_proj
Validation after prune:
out_inf: tensor(21.2656, device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(3.1172, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(2.7188, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
tensor(3.6406, device='cuda:0', dtype=torch.float16) tensor(0.2925, device='cuda:0', dtype=torch.float16)
tensor(3.4141, device='cuda:0', dtype=torch.float16) tensor(0.2739, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0171, device='cuda:0')
tensor(0.1747, device='cuda:0')
old_score: tensor(0.2805, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1404, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.248923301696777
Validation after dual ascent:
out_inf: tensor(21.2656, device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(1.5195, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(1.5742, device='cuda:0', dtype=torch.float16) tensor(0.1536, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.6367, device='cuda:0', dtype=torch.float16) tensor(0.3911, device='cuda:0', dtype=torch.float16)
tensor(1.7305, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1870, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1948, device='cuda:0', dtype=torch.float16)
tensor(1.5586, device='cuda:0', dtype=torch.float16) tensor(0.1866, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0115, device='cuda:0')
tensor(0.3033, device='cuda:0')
old_score: tensor(0.1902, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1150, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2504830360412598
Validation after dual ascent:
out_inf: tensor(7.6367, device='cuda:0', dtype=torch.float16) tensor(0.3911, device='cuda:0', dtype=torch.float16)
tensor(1.2666, device='cuda:0', dtype=torch.float16) tensor(0.1207, device='cuda:0', dtype=torch.float16)
tensor(1.2227, device='cuda:0', dtype=torch.float16) tensor(0.1063, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
tensor(1.0732, device='cuda:0', dtype=torch.float16) tensor(0.1084, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.o_proj
Validation after prune:
out_inf: tensor(11.6875, device='cuda:0', dtype=torch.float16) tensor(0.1620, device='cuda:0', dtype=torch.float16)
tensor(0.7891, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.8125, device='cuda:0', dtype=torch.float16) tensor(0.0659, device='cuda:0', dtype=torch.float16)
tensor(0.7656, device='cuda:0', dtype=torch.float16) tensor(0.0716, device='cuda:0', dtype=torch.float16)
tensor(0.0193, device='cuda:0')
old_score: tensor(0.0706, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0492, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.11626124382019
Validation after dual ascent:
out_inf: tensor(11.6875, device='cuda:0', dtype=torch.float16) tensor(0.1620, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
tensor(0.7031, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.1641, device='cuda:0', dtype=torch.float16) tensor(0.4053, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.1620, device='cuda:0', dtype=torch.float16)
tensor(2.1602, device='cuda:0', dtype=torch.float16) tensor(0.1554, device='cuda:0', dtype=torch.float16)
tensor(2.5078, device='cuda:0', dtype=torch.float16) tensor(0.1620, device='cuda:0', dtype=torch.float16)
tensor(2.7656, device='cuda:0', dtype=torch.float16) tensor(0.1562, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0158, device='cuda:0')
tensor(0.1671, device='cuda:0')
old_score: tensor(0.1589, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0935, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.206484079360962
Validation after dual ascent:
out_inf: tensor(9.1641, device='cuda:0', dtype=torch.float16) tensor(0.4053, device='cuda:0', dtype=torch.float16)
tensor(1.7227, device='cuda:0', dtype=torch.float16) tensor(0.0982, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1021, device='cuda:0', dtype=torch.float16)
tensor(1.7227, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.8477, device='cuda:0', dtype=torch.float16) tensor(0.3010, device='cuda:0', dtype=torch.float16)
tensor(1.3301, device='cuda:0', dtype=torch.float16) tensor(0.1367, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.3594, device='cuda:0', dtype=torch.float16) tensor(0.1305, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0135, device='cuda:0')
tensor(0.1525, device='cuda:0')
old_score: tensor(0.1338, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0862, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2064409255981445
Validation after dual ascent:
out_inf: tensor(5.8477, device='cuda:0', dtype=torch.float16) tensor(0.3010, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.8252, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(0.8623, device='cuda:0', dtype=torch.float16) tensor(0.0806, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.4609, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(0.7085, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.6338, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(0.7930, device='cuda:0', dtype=torch.float16) tensor(0.0629, device='cuda:0', dtype=torch.float16)
tensor(0.6323, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0066, device='cuda:0')
tensor(0.0279, device='cuda:0')
old_score: tensor(0.0637, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0473, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.169553756713867
Validation after dual ascent:
out_inf: tensor(3.4609, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(0.6455, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.5718, device='cuda:0', dtype=torch.float16) tensor(0.0429, device='cuda:0', dtype=torch.float16)
tensor(0.5820, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
tensor(0.5977, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.7656, device='cuda:0', dtype=torch.float16) tensor(0.8486, device='cuda:0', dtype=torch.float16)
tensor(2.9062, device='cuda:0', dtype=torch.float16) tensor(0.2805, device='cuda:0', dtype=torch.float16)
tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.2727, device='cuda:0', dtype=torch.float16)
tensor(3.2578, device='cuda:0', dtype=torch.float16) tensor(0.2900, device='cuda:0', dtype=torch.float16)
tensor(2.7578, device='cuda:0', dtype=torch.float16) tensor(0.2712, device='cuda:0', dtype=torch.float16)
tensor(0.2658, device='cuda:0')
old_score: tensor(0.2786, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1442, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.235196590423584
Validation after dual ascent:
out_inf: tensor(16.7656, device='cuda:0', dtype=torch.float16) tensor(0.8486, device='cuda:0', dtype=torch.float16)
tensor(1.5596, device='cuda:0', dtype=torch.float16) tensor(0.1504, device='cuda:0', dtype=torch.float16)
tensor(1.6172, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.5859, device='cuda:0', dtype=torch.float16) tensor(0.1594, device='cuda:0', dtype=torch.float16)
tensor(1.6758, device='cuda:0', dtype=torch.float16) tensor(0.1337, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.6250, device='cuda:0', dtype=torch.float16) tensor(0.9907, device='cuda:0', dtype=torch.float16)
tensor(3.1094, device='cuda:0', dtype=torch.float16) tensor(0.2847, device='cuda:0', dtype=torch.float16)
tensor(3., device='cuda:0', dtype=torch.float16) tensor(0.2793, device='cuda:0', dtype=torch.float16)
tensor(3.1016, device='cuda:0', dtype=torch.float16) tensor(0.2935, device='cuda:0', dtype=torch.float16)
tensor(3.1250, device='cuda:0', dtype=torch.float16) tensor(0.2766, device='cuda:0', dtype=torch.float16)
tensor(0.2650, device='cuda:0')
old_score: tensor(0.2834, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1445, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.213825464248657
Validation after dual ascent:
out_inf: tensor(18.6250, device='cuda:0', dtype=torch.float16) tensor(0.9907, device='cuda:0', dtype=torch.float16)
tensor(1.5635, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.6133, device='cuda:0', dtype=torch.float16) tensor(0.1333, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1597, device='cuda:0', dtype=torch.float16)
tensor(1.7793, device='cuda:0', dtype=torch.float16) tensor(0.1340, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.6016, device='cuda:0', dtype=torch.float16) tensor(0.4280, device='cuda:0', dtype=torch.float16)
tensor(1.6367, device='cuda:0', dtype=torch.float16) tensor(0.2069, device='cuda:0', dtype=torch.float16)
tensor(1.6475, device='cuda:0', dtype=torch.float16) tensor(0.2007, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.2104, device='cuda:0', dtype=torch.float16)
tensor(1.5312, device='cuda:0', dtype=torch.float16) tensor(0.2003, device='cuda:0', dtype=torch.float16)
tensor(0.1708, device='cuda:0')
old_score: tensor(0.2046, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1219, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.164850950241089
Validation after dual ascent:
out_inf: tensor(5.6016, device='cuda:0', dtype=torch.float16) tensor(0.4280, device='cuda:0', dtype=torch.float16)
tensor(1.1465, device='cuda:0', dtype=torch.float16) tensor(0.1276, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1343, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.o_proj
Validation after prune:
out_inf: tensor(17.1094, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
tensor(1.5039, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.0775, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.0626, device='cuda:0', dtype=torch.float16)
tensor(1.9609, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(0.0172, device='cuda:0')
old_score: tensor(0.0702, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0489, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.13778018951416
Validation after dual ascent:
out_inf: tensor(17.1094, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
tensor(0.8164, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0501, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
tensor(0.9766, device='cuda:0', dtype=torch.float16) tensor(0.0473, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.5938, device='cuda:0', dtype=torch.float16) tensor(0.4150, device='cuda:0', dtype=torch.float16)
tensor(2.0234, device='cuda:0', dtype=torch.float16) tensor(0.1694, device='cuda:0', dtype=torch.float16)
tensor(1.9141, device='cuda:0', dtype=torch.float16) tensor(0.1656, device='cuda:0', dtype=torch.float16)
tensor(2.7031, device='cuda:0', dtype=torch.float16) tensor(0.1720, device='cuda:0', dtype=torch.float16)
tensor(2.3125, device='cuda:0', dtype=torch.float16) tensor(0.1644, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0180, device='cuda:0')
tensor(0.2009, device='cuda:0')
old_score: tensor(0.1678, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0977, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.228426218032837
Validation after dual ascent:
out_inf: tensor(8.5938, device='cuda:0', dtype=torch.float16) tensor(0.4150, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(1.5078, device='cuda:0', dtype=torch.float16) tensor(0.0903, device='cuda:0', dtype=torch.float16)
tensor(1.4375, device='cuda:0', dtype=torch.float16) tensor(0.1084, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.0904, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.2891, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.2852, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(1.4844, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0153, device='cuda:0')
tensor(0.1827, device='cuda:0')
old_score: tensor(0.1399, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0903, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.229252099990845
Validation after dual ascent:
out_inf: tensor(6.2891, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(0.9961, device='cuda:0', dtype=torch.float16) tensor(0.0940, device='cuda:0', dtype=torch.float16)
tensor(0.8198, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.8364, device='cuda:0', dtype=torch.float16) tensor(0.1004, device='cuda:0', dtype=torch.float16)
tensor(0.9551, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.down_proj
Validation after prune:
out_inf: tensor(10.0547, device='cuda:0', dtype=torch.float16) tensor(0.1470, device='cuda:0', dtype=torch.float16)
tensor(0.7969, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(0.5874, device='cuda:0', dtype=torch.float16) tensor(0.0634, device='cuda:0', dtype=torch.float16)
tensor(0.6919, device='cuda:0', dtype=torch.float16) tensor(0.0695, device='cuda:0', dtype=torch.float16)
tensor(0.6680, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0104, device='cuda:0')
tensor(0.0540, device='cuda:0')
old_score: tensor(0.0674, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0507, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.151352882385254
Validation after dual ascent:
out_inf: tensor(10.0547, device='cuda:0', dtype=torch.float16) tensor(0.1470, device='cuda:0', dtype=torch.float16)
tensor(0.6865, device='cuda:0', dtype=torch.float16) tensor(0.0537, device='cuda:0', dtype=torch.float16)
tensor(0.6362, device='cuda:0', dtype=torch.float16) tensor(0.0461, device='cuda:0', dtype=torch.float16)
tensor(0.5903, device='cuda:0', dtype=torch.float16) tensor(0.0558, device='cuda:0', dtype=torch.float16)
tensor(0.5571, device='cuda:0', dtype=torch.float16) tensor(0.0471, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.5156, device='cuda:0', dtype=torch.float16) tensor(0.8130, device='cuda:0', dtype=torch.float16)
tensor(3.2188, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(2.8555, device='cuda:0', dtype=torch.float16) tensor(0.2632, device='cuda:0', dtype=torch.float16)
tensor(3.0859, device='cuda:0', dtype=torch.float16) tensor(0.2793, device='cuda:0', dtype=torch.float16)
tensor(2.8945, device='cuda:0', dtype=torch.float16) tensor(0.2568, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0157, device='cuda:0')
tensor(0.0698, device='cuda:0')
old_score: tensor(0.2668, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1357, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.996769666671753
Validation after dual ascent:
out_inf: tensor(17.5156, device='cuda:0', dtype=torch.float16) tensor(0.8130, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
tensor(1.6270, device='cuda:0', dtype=torch.float16) tensor(0.1260, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(1.8223, device='cuda:0', dtype=torch.float16) tensor(0.1246, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.2969, device='cuda:0', dtype=torch.float16) tensor(1.0205, device='cuda:0', dtype=torch.float16)
tensor(2.7188, device='cuda:0', dtype=torch.float16) tensor(0.2705, device='cuda:0', dtype=torch.float16)
tensor(2.8906, device='cuda:0', dtype=torch.float16) tensor(0.2690, device='cuda:0', dtype=torch.float16)
tensor(2.8281, device='cuda:0', dtype=torch.float16) tensor(0.2839, device='cuda:0', dtype=torch.float16)
tensor(2.5859, device='cuda:0', dtype=torch.float16) tensor(0.2629, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0168, device='cuda:0')
tensor(0.0723, device='cuda:0')
old_score: tensor(0.2715, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1351, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.025771141052246
Validation after dual ascent:
out_inf: tensor(19.2969, device='cuda:0', dtype=torch.float16) tensor(1.0205, device='cuda:0', dtype=torch.float16)
tensor(1.6182, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(1.8076, device='cuda:0', dtype=torch.float16) tensor(0.1254, device='cuda:0', dtype=torch.float16)
tensor(1.5928, device='cuda:0', dtype=torch.float16) tensor(0.1514, device='cuda:0', dtype=torch.float16)
tensor(1.5840, device='cuda:0', dtype=torch.float16) tensor(0.1240, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.4128, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.2019, device='cuda:0', dtype=torch.float16)
tensor(1.5908, device='cuda:0', dtype=torch.float16) tensor(0.1978, device='cuda:0', dtype=torch.float16)
tensor(1.5537, device='cuda:0', dtype=torch.float16) tensor(0.2073, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1945, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0171, device='cuda:0')
tensor(0.3209, device='cuda:0')
old_score: tensor(0.2003, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1227, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2548751831054688
Validation after dual ascent:
out_inf: tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.4128, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.1266, device='cuda:0', dtype=torch.float16)
tensor(1.2480, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(1.1846, device='cuda:0', dtype=torch.float16) tensor(0.1139, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.o_proj
Validation after prune:
out_inf: tensor(15.1406, device='cuda:0', dtype=torch.float16) tensor(0.1986, device='cuda:0', dtype=torch.float16)
tensor(1.1211, device='cuda:0', dtype=torch.float16) tensor(0.0880, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.0908, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(0.0232, device='cuda:0')
old_score: tensor(0.0873, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0587, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.123260974884033
Validation after dual ascent:
out_inf: tensor(15.1406, device='cuda:0', dtype=torch.float16) tensor(0.1986, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.0554, device='cuda:0', dtype=torch.float16)
tensor(0.8047, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.0556, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.gate_proj
Validation after prune:
out_inf: tensor(12.9922, device='cuda:0', dtype=torch.float16) tensor(0.4155, device='cuda:0', dtype=torch.float16)
tensor(3.0234, device='cuda:0', dtype=torch.float16) tensor(0.1687, device='cuda:0', dtype=torch.float16)
tensor(1.8203, device='cuda:0', dtype=torch.float16) tensor(0.1682, device='cuda:0', dtype=torch.float16)
tensor(2.1641, device='cuda:0', dtype=torch.float16) tensor(0.1713, device='cuda:0', dtype=torch.float16)
tensor(2.1211, device='cuda:0', dtype=torch.float16) tensor(0.1638, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0180, device='cuda:0')
tensor(0.2017, device='cuda:0')
old_score: tensor(0.1680, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0989, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.217921257019043
Validation after dual ascent:
out_inf: tensor(12.9922, device='cuda:0', dtype=torch.float16) tensor(0.4155, device='cuda:0', dtype=torch.float16)
tensor(2.0391, device='cuda:0', dtype=torch.float16) tensor(0.1017, device='cuda:0', dtype=torch.float16)
tensor(1.6621, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(1.4004, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.0916, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.2578, device='cuda:0', dtype=torch.float16) tensor(0.3103, device='cuda:0', dtype=torch.float16)
tensor(1.4902, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.1469, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.1368, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0155, device='cuda:0')
tensor(0.1850, device='cuda:0')
old_score: tensor(0.1418, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0918, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.217199087142944
Validation after dual ascent:
out_inf: tensor(5.2578, device='cuda:0', dtype=torch.float16) tensor(0.3103, device='cuda:0', dtype=torch.float16)
tensor(0.8926, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
tensor(0.8926, device='cuda:0', dtype=torch.float16) tensor(0.1019, device='cuda:0', dtype=torch.float16)
tensor(0.9438, device='cuda:0', dtype=torch.float16) tensor(0.0850, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.9336, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(1.0537, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
tensor(0.7305, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.7104, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0148, device='cuda:0')
tensor(0.0669, device='cuda:0')
old_score: tensor(0.0700, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0520, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.159934282302856
Validation after dual ascent:
out_inf: tensor(4.9336, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(0.6592, device='cuda:0', dtype=torch.float16) tensor(0.0471, device='cuda:0', dtype=torch.float16)
tensor(0.6670, device='cuda:0', dtype=torch.float16) tensor(0.0574, device='cuda:0', dtype=torch.float16)
tensor(0.6084, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.q_proj
Validation after prune:
out_inf: tensor(13.6953, device='cuda:0', dtype=torch.float16) tensor(0.8110, device='cuda:0', dtype=torch.float16)
tensor(2.8281, device='cuda:0', dtype=torch.float16) tensor(0.2742, device='cuda:0', dtype=torch.float16)
tensor(2.9062, device='cuda:0', dtype=torch.float16) tensor(0.2703, device='cuda:0', dtype=torch.float16)
tensor(3.1406, device='cuda:0', dtype=torch.float16) tensor(0.2849, device='cuda:0', dtype=torch.float16)
tensor(2.7891, device='cuda:0', dtype=torch.float16) tensor(0.2654, device='cuda:0', dtype=torch.float16)
tensor(0.1008, device='cuda:0')
old_score: tensor(0.2737, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1454, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.231212854385376
Validation after dual ascent:
out_inf: tensor(13.6953, device='cuda:0', dtype=torch.float16) tensor(0.8110, device='cuda:0', dtype=torch.float16)
tensor(1.7070, device='cuda:0', dtype=torch.float16) tensor(0.1487, device='cuda:0', dtype=torch.float16)
tensor(1.7607, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.8672, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(1.5820, device='cuda:0', dtype=torch.float16) tensor(0.1332, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.0625, device='cuda:0', dtype=torch.float16) tensor(0.9487, device='cuda:0', dtype=torch.float16)
tensor(2.6406, device='cuda:0', dtype=torch.float16) tensor(0.2769, device='cuda:0', dtype=torch.float16)
tensor(2.6328, device='cuda:0', dtype=torch.float16) tensor(0.2751, device='cuda:0', dtype=torch.float16)
tensor(2.8516, device='cuda:0', dtype=torch.float16) tensor(0.2900, device='cuda:0', dtype=torch.float16)
tensor(2.4766, device='cuda:0', dtype=torch.float16) tensor(0.2681, device='cuda:0', dtype=torch.float16)
tensor(0.1068, device='cuda:0')
old_score: tensor(0.2773, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1455, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.185642719268799
Validation after dual ascent:
out_inf: tensor(18.0625, device='cuda:0', dtype=torch.float16) tensor(0.9487, device='cuda:0', dtype=torch.float16)
tensor(1.6572, device='cuda:0', dtype=torch.float16) tensor(0.1490, device='cuda:0', dtype=torch.float16)
tensor(1.7725, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(1.6104, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.7422, device='cuda:0', dtype=torch.float16) tensor(0.4421, device='cuda:0', dtype=torch.float16)
tensor(1.8945, device='cuda:0', dtype=torch.float16) tensor(0.2167, device='cuda:0', dtype=torch.float16)
tensor(1.6963, device='cuda:0', dtype=torch.float16) tensor(0.2140, device='cuda:0', dtype=torch.float16)
tensor(1.7080, device='cuda:0', dtype=torch.float16) tensor(0.2242, device='cuda:0', dtype=torch.float16)
tensor(1.7090, device='cuda:0', dtype=torch.float16) tensor(0.2076, device='cuda:0', dtype=torch.float16)
tensor(0.0795, device='cuda:0')
old_score: tensor(0.2156, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1296, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.16776180267334
Validation after dual ascent:
out_inf: tensor(4.7422, device='cuda:0', dtype=torch.float16) tensor(0.4421, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
tensor(1.4004, device='cuda:0', dtype=torch.float16) tensor(0.1216, device='cuda:0', dtype=torch.float16)
tensor(1.4502, device='cuda:0', dtype=torch.float16) tensor(0.1454, device='cuda:0', dtype=torch.float16)
tensor(1.2529, device='cuda:0', dtype=torch.float16) tensor(0.1188, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
tensor(1.1816, device='cuda:0', dtype=torch.float16) tensor(0.0623, device='cuda:0', dtype=torch.float16)
tensor(1.3174, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(1.6309, device='cuda:0', dtype=torch.float16) tensor(0.0597, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
tensor(0.0257, device='cuda:0')
old_score: tensor(0.0664, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0435, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.136940240859985
Validation after dual ascent:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
tensor(0.6270, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.8564, device='cuda:0', dtype=torch.float16) tensor(0.0450, device='cuda:0', dtype=torch.float16)
tensor(0.6113, device='cuda:0', dtype=torch.float16) tensor(0.0422, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.6328, device='cuda:0', dtype=torch.float16) tensor(0.4390, device='cuda:0', dtype=torch.float16)
tensor(2.4160, device='cuda:0', dtype=torch.float16) tensor(0.1797, device='cuda:0', dtype=torch.float16)
tensor(2.1016, device='cuda:0', dtype=torch.float16) tensor(0.1832, device='cuda:0', dtype=torch.float16)
tensor(2.1406, device='cuda:0', dtype=torch.float16) tensor(0.1818, device='cuda:0', dtype=torch.float16)
tensor(2.3008, device='cuda:0', dtype=torch.float16) tensor(0.1758, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0086, device='cuda:0')
tensor(0.0261, device='cuda:0')
old_score: tensor(0.1801, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1019, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.19150710105896
Validation after dual ascent:
out_inf: tensor(7.6328, device='cuda:0', dtype=torch.float16) tensor(0.4390, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.1044, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.1139, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.7383, device='cuda:0', dtype=torch.float16) tensor(0.3252, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.1498, device='cuda:0', dtype=torch.float16)
tensor(1.7012, device='cuda:0', dtype=torch.float16) tensor(0.1478, device='cuda:0', dtype=torch.float16)
tensor(1.9102, device='cuda:0', dtype=torch.float16) tensor(0.1539, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0172, device='cuda:0')
tensor(0.2097, device='cuda:0')
old_score: tensor(0.1487, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0948, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.226678371429443
Validation after dual ascent:
out_inf: tensor(7.7383, device='cuda:0', dtype=torch.float16) tensor(0.3252, device='cuda:0', dtype=torch.float16)
tensor(0.9766, device='cuda:0', dtype=torch.float16) tensor(0.0972, device='cuda:0', dtype=torch.float16)
tensor(1.0371, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
tensor(0.9302, device='cuda:0', dtype=torch.float16) tensor(0.1060, device='cuda:0', dtype=torch.float16)
tensor(0.9561, device='cuda:0', dtype=torch.float16) tensor(0.0870, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.8125, device='cuda:0', dtype=torch.float16) tensor(0.1677, device='cuda:0', dtype=torch.float16)
tensor(0.9116, device='cuda:0', dtype=torch.float16) tensor(0.0819, device='cuda:0', dtype=torch.float16)
tensor(0.7646, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
tensor(0.8730, device='cuda:0', dtype=torch.float16) tensor(0.0828, device='cuda:0', dtype=torch.float16)
tensor(0.8076, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0183, device='cuda:0')
tensor(0.1264, device='cuda:0')
old_score: tensor(0.0812, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0571, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.078052759170532
Validation after dual ascent:
out_inf: tensor(4.8125, device='cuda:0', dtype=torch.float16) tensor(0.1677, device='cuda:0', dtype=torch.float16)
tensor(0.7979, device='cuda:0', dtype=torch.float16) tensor(0.0590, device='cuda:0', dtype=torch.float16)
tensor(0.7349, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
tensor(0.6885, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.7734, device='cuda:0', dtype=torch.float16) tensor(0.8750, device='cuda:0', dtype=torch.float16)
tensor(3.0625, device='cuda:0', dtype=torch.float16) tensor(0.2839, device='cuda:0', dtype=torch.float16)
tensor(2.9219, device='cuda:0', dtype=torch.float16) tensor(0.2830, device='cuda:0', dtype=torch.float16)
tensor(3.2422, device='cuda:0', dtype=torch.float16) tensor(0.2905, device='cuda:0', dtype=torch.float16)
tensor(3., device='cuda:0', dtype=torch.float16) tensor(0.2747, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0141, device='cuda:0')
tensor(0.0597, device='cuda:0')
old_score: tensor(0.2830, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1450, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.994317531585693
Validation after dual ascent:
out_inf: tensor(15.7734, device='cuda:0', dtype=torch.float16) tensor(0.8750, device='cuda:0', dtype=torch.float16)
tensor(1.6621, device='cuda:0', dtype=torch.float16) tensor(0.1476, device='cuda:0', dtype=torch.float16)
tensor(1.9219, device='cuda:0', dtype=torch.float16) tensor(0.1376, device='cuda:0', dtype=torch.float16)
tensor(2.1484, device='cuda:0', dtype=torch.float16) tensor(0.1625, device='cuda:0', dtype=torch.float16)
tensor(1.8115, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.3594, device='cuda:0', dtype=torch.float16) tensor(1.0566, device='cuda:0', dtype=torch.float16)
tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.2910, device='cuda:0', dtype=torch.float16)
tensor(3.2227, device='cuda:0', dtype=torch.float16) tensor(0.2913, device='cuda:0', dtype=torch.float16)
tensor(3.0547, device='cuda:0', dtype=torch.float16) tensor(0.2988, device='cuda:0', dtype=torch.float16)
tensor(3.0625, device='cuda:0', dtype=torch.float16) tensor(0.2815, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0177, device='cuda:0')
tensor(0.0743, device='cuda:0')
old_score: tensor(0.2905, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1449, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.980499505996704
Validation after dual ascent:
out_inf: tensor(19.3594, device='cuda:0', dtype=torch.float16) tensor(1.0566, device='cuda:0', dtype=torch.float16)
tensor(2.1504, device='cuda:0', dtype=torch.float16) tensor(0.1476, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.1372, device='cuda:0', dtype=torch.float16)
tensor(1.6680, device='cuda:0', dtype=torch.float16) tensor(0.1625, device='cuda:0', dtype=torch.float16)
tensor(1.5967, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.7461, device='cuda:0', dtype=torch.float16) tensor(0.4578, device='cuda:0', dtype=torch.float16)
tensor(1.9805, device='cuda:0', dtype=torch.float16) tensor(0.2222, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.2239, device='cuda:0', dtype=torch.float16)
tensor(2.0859, device='cuda:0', dtype=torch.float16) tensor(0.2278, device='cuda:0', dtype=torch.float16)
tensor(1.7129, device='cuda:0', dtype=torch.float16) tensor(0.2162, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0180, device='cuda:0')
tensor(0.3306, device='cuda:0')
old_score: tensor(0.2225, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1367, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.242227077484131
Validation after dual ascent:
out_inf: tensor(7.7461, device='cuda:0', dtype=torch.float16) tensor(0.4578, device='cuda:0', dtype=torch.float16)
tensor(1.3271, device='cuda:0', dtype=torch.float16) tensor(0.1388, device='cuda:0', dtype=torch.float16)
tensor(1.3672, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
tensor(1.3770, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(1.3662, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.o_proj
Validation after prune:
out_inf: tensor(26.0156, device='cuda:0', dtype=torch.float16) tensor(0.2164, device='cuda:0', dtype=torch.float16)
tensor(2.3594, device='cuda:0', dtype=torch.float16) tensor(0.0998, device='cuda:0', dtype=torch.float16)
tensor(2.5469, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(2.1328, device='cuda:0', dtype=torch.float16) tensor(0.1006, device='cuda:0', dtype=torch.float16)
tensor(1.9922, device='cuda:0', dtype=torch.float16) tensor(0.0994, device='cuda:0', dtype=torch.float16)
tensor(0.0238, device='cuda:0')
old_score: tensor(0.1003, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0630, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.102510213851929
Validation after dual ascent:
out_inf: tensor(26.0156, device='cuda:0', dtype=torch.float16) tensor(0.2164, device='cuda:0', dtype=torch.float16)
tensor(0.8906, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(1.2344, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.8906, device='cuda:0', dtype=torch.float16) tensor(0.4580, device='cuda:0', dtype=torch.float16)
tensor(2.2656, device='cuda:0', dtype=torch.float16) tensor(0.1797, device='cuda:0', dtype=torch.float16)
tensor(3.2969, device='cuda:0', dtype=torch.float16) tensor(0.1868, device='cuda:0', dtype=torch.float16)
tensor(2.2773, device='cuda:0', dtype=torch.float16) tensor(0.1827, device='cuda:0', dtype=torch.float16)
tensor(1.9756, device='cuda:0', dtype=torch.float16) tensor(0.1771, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0099, device='cuda:0')
tensor(0.0269, device='cuda:0')
old_score: tensor(0.1816, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1025, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.179730415344238
Validation after dual ascent:
out_inf: tensor(8.8906, device='cuda:0', dtype=torch.float16) tensor(0.4580, device='cuda:0', dtype=torch.float16)
tensor(1.9277, device='cuda:0', dtype=torch.float16) tensor(0.1040, device='cuda:0', dtype=torch.float16)
tensor(1.5820, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
tensor(1.4844, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.0664, device='cuda:0', dtype=torch.float16) tensor(0.3428, device='cuda:0', dtype=torch.float16)
tensor(1.6758, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(1.4961, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.1466, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0179, device='cuda:0')
tensor(0.2160, device='cuda:0')
old_score: tensor(0.1521, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0956, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.224219560623169
Validation after dual ascent:
out_inf: tensor(7.0664, device='cuda:0', dtype=torch.float16) tensor(0.3428, device='cuda:0', dtype=torch.float16)
tensor(0.9834, device='cuda:0', dtype=torch.float16) tensor(0.0970, device='cuda:0', dtype=torch.float16)
tensor(0.9399, device='cuda:0', dtype=torch.float16) tensor(0.0908, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(0.9692, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.3477, device='cuda:0', dtype=torch.float16) tensor(0.1788, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.0874, device='cuda:0', dtype=torch.float16)
tensor(1.1279, device='cuda:0', dtype=torch.float16) tensor(0.0850, device='cuda:0', dtype=torch.float16)
tensor(0.8564, device='cuda:0', dtype=torch.float16) tensor(0.0829, device='cuda:0', dtype=torch.float16)
tensor(0.9375, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0130, device='cuda:0')
tensor(0.0730, device='cuda:0')
old_score: tensor(0.0845, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0611, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.08870220184326
Validation after dual ascent:
out_inf: tensor(4.3477, device='cuda:0', dtype=torch.float16) tensor(0.1788, device='cuda:0', dtype=torch.float16)
tensor(0.8770, device='cuda:0', dtype=torch.float16) tensor(0.0642, device='cuda:0', dtype=torch.float16)
tensor(1.0244, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
tensor(0.6982, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(0.6577, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.0312, device='cuda:0', dtype=torch.float16) tensor(0.8306, device='cuda:0', dtype=torch.float16)
tensor(3.5000, device='cuda:0', dtype=torch.float16) tensor(0.2810, device='cuda:0', dtype=torch.float16)
tensor(3.1250, device='cuda:0', dtype=torch.float16) tensor(0.2793, device='cuda:0', dtype=torch.float16)
tensor(3.3359, device='cuda:0', dtype=torch.float16) tensor(0.2883, device='cuda:0', dtype=torch.float16)
tensor(3.3203, device='cuda:0', dtype=torch.float16) tensor(0.2715, device='cuda:0', dtype=torch.float16)
tensor(0.0770, device='cuda:0')
old_score: tensor(0.2800, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1460, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.219757556915283
Validation after dual ascent:
out_inf: tensor(16.0312, device='cuda:0', dtype=torch.float16) tensor(0.8306, device='cuda:0', dtype=torch.float16)
tensor(1.7646, device='cuda:0', dtype=torch.float16) tensor(0.1476, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.1389, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
tensor(1.5576, device='cuda:0', dtype=torch.float16) tensor(0.1335, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.0938, device='cuda:0', dtype=torch.float16) tensor(0.9653, device='cuda:0', dtype=torch.float16)
tensor(4.4766, device='cuda:0', dtype=torch.float16) tensor(0.2917, device='cuda:0', dtype=torch.float16)
tensor(3.7812, device='cuda:0', dtype=torch.float16) tensor(0.2957, device='cuda:0', dtype=torch.float16)
tensor(4.1328, device='cuda:0', dtype=torch.float16) tensor(0.3015, device='cuda:0', dtype=torch.float16)
tensor(3.6328, device='cuda:0', dtype=torch.float16) tensor(0.2844, device='cuda:0', dtype=torch.float16)
tensor(0.0868, device='cuda:0')
old_score: tensor(0.2932, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1473, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.257564306259155
Validation after dual ascent:
out_inf: tensor(18.0938, device='cuda:0', dtype=torch.float16) tensor(0.9653, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1488, device='cuda:0', dtype=torch.float16)
tensor(1.6953, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
tensor(2.3594, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(1.9688, device='cuda:0', dtype=torch.float16) tensor(0.1348, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.v_proj
Validation after prune:
out_inf: tensor(8.7891, device='cuda:0', dtype=torch.float16) tensor(0.4438, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.2157, device='cuda:0', dtype=torch.float16)
tensor(1.7070, device='cuda:0', dtype=torch.float16) tensor(0.2173, device='cuda:0', dtype=torch.float16)
tensor(2.0391, device='cuda:0', dtype=torch.float16) tensor(0.2207, device='cuda:0', dtype=torch.float16)
tensor(1.6543, device='cuda:0', dtype=torch.float16) tensor(0.2084, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0150, device='cuda:0')
tensor(0.0695, device='cuda:0')
old_score: tensor(0.2156, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1288, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.937839269638062
Validation after dual ascent:
out_inf: tensor(8.7891, device='cuda:0', dtype=torch.float16) tensor(0.4438, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.3457, device='cuda:0', dtype=torch.float16) tensor(0.1227, device='cuda:0', dtype=torch.float16)
tensor(1.2656, device='cuda:0', dtype=torch.float16) tensor(0.1443, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.7930, device='cuda:0', dtype=torch.float16) tensor(0.1180, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(0.9043, device='cuda:0', dtype=torch.float16) tensor(0.0500, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.0618, device='cuda:0', dtype=torch.float16)
Converged at iteration 950
tensor(0.0139, device='cuda:0')
tensor(0.0336, device='cuda:0')
old_score: tensor(0.0576, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0348, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.38532304763794
Validation after dual ascent:
out_inf: tensor(5.7930, device='cuda:0', dtype=torch.float16) tensor(0.1180, device='cuda:0', dtype=torch.float16)
tensor(0.8906, device='cuda:0', dtype=torch.float16) tensor(0.0346, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
tensor(0.6055, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.2031, device='cuda:0', dtype=torch.float16) tensor(0.4827, device='cuda:0', dtype=torch.float16)
tensor(2.3438, device='cuda:0', dtype=torch.float16) tensor(0.1908, device='cuda:0', dtype=torch.float16)
tensor(2.5156, device='cuda:0', dtype=torch.float16) tensor(0.2009, device='cuda:0', dtype=torch.float16)
tensor(3.0508, device='cuda:0', dtype=torch.float16) tensor(0.1931, device='cuda:0', dtype=torch.float16)
tensor(2.9297, device='cuda:0', dtype=torch.float16) tensor(0.1876, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0111, device='cuda:0')
tensor(0.0338, device='cuda:0')
old_score: tensor(0.1931, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1050, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.18795657157898
Validation after dual ascent:
out_inf: tensor(9.2031, device='cuda:0', dtype=torch.float16) tensor(0.4827, device='cuda:0', dtype=torch.float16)
tensor(1.6348, device='cuda:0', dtype=torch.float16) tensor(0.1065, device='cuda:0', dtype=torch.float16)
tensor(2.0195, device='cuda:0', dtype=torch.float16) tensor(0.0997, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
tensor(1.7188, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.4414, device='cuda:0', dtype=torch.float16) tensor(0.3706, device='cuda:0', dtype=torch.float16)
tensor(1.6191, device='cuda:0', dtype=torch.float16) tensor(0.1630, device='cuda:0', dtype=torch.float16)
tensor(1.7148, device='cuda:0', dtype=torch.float16) tensor(0.1656, device='cuda:0', dtype=torch.float16)
tensor(1.8320, device='cuda:0', dtype=torch.float16) tensor(0.1652, device='cuda:0', dtype=torch.float16)
tensor(1.9102, device='cuda:0', dtype=torch.float16) tensor(0.1570, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0071, device='cuda:0')
tensor(0.0303, device='cuda:0')
old_score: tensor(0.1626, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0984, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.188936471939087
Validation after dual ascent:
out_inf: tensor(7.4414, device='cuda:0', dtype=torch.float16) tensor(0.3706, device='cuda:0', dtype=torch.float16)
tensor(1.1182, device='cuda:0', dtype=torch.float16) tensor(0.1000, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.0935, device='cuda:0', dtype=torch.float16)
tensor(1.0488, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
tensor(1.1494, device='cuda:0', dtype=torch.float16) tensor(0.0901, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.4375, device='cuda:0', dtype=torch.float16) tensor(0.1981, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(1.0371, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.0982, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0155, device='cuda:0')
tensor(0.0939, device='cuda:0')
old_score: tensor(0.0973, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0684, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.07828640937805
Validation after dual ascent:
out_inf: tensor(2.4375, device='cuda:0', dtype=torch.float16) tensor(0.1981, device='cuda:0', dtype=torch.float16)
tensor(0.7686, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.8237, device='cuda:0', dtype=torch.float16) tensor(0.0652, device='cuda:0', dtype=torch.float16)
tensor(0.9048, device='cuda:0', dtype=torch.float16) tensor(0.0752, device='cuda:0', dtype=torch.float16)
tensor(0.7368, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.3516, device='cuda:0', dtype=torch.float16) tensor(0.8696, device='cuda:0', dtype=torch.float16)
tensor(3.8438, device='cuda:0', dtype=torch.float16) tensor(0.2913, device='cuda:0', dtype=torch.float16)
tensor(3.4688, device='cuda:0', dtype=torch.float16) tensor(0.2922, device='cuda:0', dtype=torch.float16)
tensor(3.6719, device='cuda:0', dtype=torch.float16) tensor(0.2957, device='cuda:0', dtype=torch.float16)
tensor(3.5312, device='cuda:0', dtype=torch.float16) tensor(0.2830, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0139, device='cuda:0')
tensor(0.0578, device='cuda:0')
old_score: tensor(0.2905, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1470, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.008337497711182
Validation after dual ascent:
out_inf: tensor(15.3516, device='cuda:0', dtype=torch.float16) tensor(0.8696, device='cuda:0', dtype=torch.float16)
tensor(1.6465, device='cuda:0', dtype=torch.float16) tensor(0.1484, device='cuda:0', dtype=torch.float16)
tensor(1.8945, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
tensor(1.8438, device='cuda:0', dtype=torch.float16) tensor(0.1652, device='cuda:0', dtype=torch.float16)
tensor(1.5049, device='cuda:0', dtype=torch.float16) tensor(0.1342, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.3438, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(4.7031, device='cuda:0', dtype=torch.float16) tensor(0.3025, device='cuda:0', dtype=torch.float16)
tensor(4.3281, device='cuda:0', dtype=torch.float16) tensor(0.3052, device='cuda:0', dtype=torch.float16)
tensor(4.4688, device='cuda:0', dtype=torch.float16) tensor(0.3118, device='cuda:0', dtype=torch.float16)
tensor(4.9922, device='cuda:0', dtype=torch.float16) tensor(0.2947, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0190, device='cuda:0')
tensor(0.0804, device='cuda:0')
old_score: tensor(0.3035, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1482, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.018832683563232
Validation after dual ascent:
out_inf: tensor(20.3438, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(2.0625, device='cuda:0', dtype=torch.float16) tensor(0.1495, device='cuda:0', dtype=torch.float16)
tensor(1.8438, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(2.0781, device='cuda:0', dtype=torch.float16) tensor(0.1665, device='cuda:0', dtype=torch.float16)
tensor(1.7979, device='cuda:0', dtype=torch.float16) tensor(0.1354, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.v_proj
Validation after prune:
out_inf: tensor(6.4531, device='cuda:0', dtype=torch.float16) tensor(0.4968, device='cuda:0', dtype=torch.float16)
tensor(1.9121, device='cuda:0', dtype=torch.float16) tensor(0.2335, device='cuda:0', dtype=torch.float16)
tensor(2.0625, device='cuda:0', dtype=torch.float16) tensor(0.2375, device='cuda:0', dtype=torch.float16)
tensor(1.9668, device='cuda:0', dtype=torch.float16) tensor(0.2378, device='cuda:0', dtype=torch.float16)
tensor(2.0215, device='cuda:0', dtype=torch.float16) tensor(0.2275, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0184, device='cuda:0')
tensor(0.2261, device='cuda:0')
old_score: tensor(0.2341, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1388, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.246460437774658
Validation after dual ascent:
out_inf: tensor(6.4531, device='cuda:0', dtype=torch.float16) tensor(0.4968, device='cuda:0', dtype=torch.float16)
tensor(1.4746, device='cuda:0', dtype=torch.float16) tensor(0.1399, device='cuda:0', dtype=torch.float16)
tensor(1.3457, device='cuda:0', dtype=torch.float16) tensor(0.1326, device='cuda:0', dtype=torch.float16)
tensor(1.3584, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(1.4150, device='cuda:0', dtype=torch.float16) tensor(0.1273, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.o_proj
Validation after prune:
out_inf: tensor(9.9062, device='cuda:0', dtype=torch.float16) tensor(0.1676, device='cuda:0', dtype=torch.float16)
tensor(2.0742, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
tensor(2.5156, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
tensor(2.5742, device='cuda:0', dtype=torch.float16) tensor(0.0893, device='cuda:0', dtype=torch.float16)
tensor(2.1836, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.0358, device='cuda:0')
old_score: tensor(0.0868, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0518, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.109150171279907
Validation after dual ascent:
out_inf: tensor(9.9062, device='cuda:0', dtype=torch.float16) tensor(0.1676, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.0458, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.0582, device='cuda:0', dtype=torch.float16)
tensor(1.5273, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.gate_proj
Validation after prune:
out_inf: tensor(10.1484, device='cuda:0', dtype=torch.float16) tensor(0.5068, device='cuda:0', dtype=torch.float16)
tensor(2.7422, device='cuda:0', dtype=torch.float16) tensor(0.2002, device='cuda:0', dtype=torch.float16)
tensor(2.8320, device='cuda:0', dtype=torch.float16) tensor(0.2135, device='cuda:0', dtype=torch.float16)
tensor(3.2305, device='cuda:0', dtype=torch.float16) tensor(0.2024, device='cuda:0', dtype=torch.float16)
tensor(3.1367, device='cuda:0', dtype=torch.float16) tensor(0.1982, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0118, device='cuda:0')
tensor(0.0435, device='cuda:0')
old_score: tensor(0.2036, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1080, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.18939733505249
Validation after dual ascent:
out_inf: tensor(10.1484, device='cuda:0', dtype=torch.float16) tensor(0.5068, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.1096, device='cuda:0', dtype=torch.float16)
tensor(2.4062, device='cuda:0', dtype=torch.float16) tensor(0.1029, device='cuda:0', dtype=torch.float16)
tensor(1.6797, device='cuda:0', dtype=torch.float16) tensor(0.1203, device='cuda:0', dtype=torch.float16)
tensor(2.0664, device='cuda:0', dtype=torch.float16) tensor(0.0991, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.up_proj
Validation after prune:
out_inf: tensor(10.5547, device='cuda:0', dtype=torch.float16) tensor(0.4141, device='cuda:0', dtype=torch.float16)
tensor(3.0234, device='cuda:0', dtype=torch.float16) tensor(0.1760, device='cuda:0', dtype=torch.float16)
tensor(2.5039, device='cuda:0', dtype=torch.float16) tensor(0.1801, device='cuda:0', dtype=torch.float16)
tensor(3.3672, device='cuda:0', dtype=torch.float16) tensor(0.1790, device='cuda:0', dtype=torch.float16)
tensor(2.4609, device='cuda:0', dtype=torch.float16) tensor(0.1704, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0091, device='cuda:0')
tensor(0.0399, device='cuda:0')
old_score: tensor(0.1764, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1028, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.1900475025177
Validation after dual ascent:
out_inf: tensor(10.5547, device='cuda:0', dtype=torch.float16) tensor(0.4141, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
tensor(1.1162, device='cuda:0', dtype=torch.float16) tensor(0.0979, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.down_proj
Validation after prune:
out_inf: tensor(7.4805, device='cuda:0', dtype=torch.float16) tensor(0.2358, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
tensor(1.1035, device='cuda:0', dtype=torch.float16) tensor(0.1225, device='cuda:0', dtype=torch.float16)
tensor(1.2607, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1158, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0056, device='cuda:0')
tensor(0.0342, device='cuda:0')
old_score: tensor(0.1205, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0815, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.942175149917603
Validation after dual ascent:
out_inf: tensor(7.4805, device='cuda:0', dtype=torch.float16) tensor(0.2358, device='cuda:0', dtype=torch.float16)
tensor(0.8467, device='cuda:0', dtype=torch.float16) tensor(0.0803, device='cuda:0', dtype=torch.float16)
tensor(0.9253, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.3281, device='cuda:0', dtype=torch.float16) tensor(0.8535, device='cuda:0', dtype=torch.float16)
tensor(3.7891, device='cuda:0', dtype=torch.float16) tensor(0.2788, device='cuda:0', dtype=torch.float16)
tensor(3.6484, device='cuda:0', dtype=torch.float16) tensor(0.2839, device='cuda:0', dtype=torch.float16)
tensor(3.6172, device='cuda:0', dtype=torch.float16) tensor(0.2871, device='cuda:0', dtype=torch.float16)
tensor(3.5664, device='cuda:0', dtype=torch.float16) tensor(0.2722, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0182, device='cuda:0')
tensor(0.1051, device='cuda:0')
old_score: tensor(0.2805, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1388, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.7494189739227295
Validation after dual ascent:
out_inf: tensor(14.3281, device='cuda:0', dtype=torch.float16) tensor(0.8535, device='cuda:0', dtype=torch.float16)
tensor(1.8262, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1326, device='cuda:0', dtype=torch.float16)
tensor(1.7969, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.1265, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.6250, device='cuda:0', dtype=torch.float16) tensor(1.0723, device='cuda:0', dtype=torch.float16)
tensor(3.9062, device='cuda:0', dtype=torch.float16) tensor(0.2922, device='cuda:0', dtype=torch.float16)
tensor(3.8125, device='cuda:0', dtype=torch.float16) tensor(0.2969, device='cuda:0', dtype=torch.float16)
tensor(4.0234, device='cuda:0', dtype=torch.float16) tensor(0.2993, device='cuda:0', dtype=torch.float16)
tensor(3.5625, device='cuda:0', dtype=torch.float16) tensor(0.2839, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0188, device='cuda:0')
tensor(0.0995, device='cuda:0')
old_score: tensor(0.2930, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1396, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.757772922515869
Validation after dual ascent:
out_inf: tensor(20.6250, device='cuda:0', dtype=torch.float16) tensor(1.0723, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1406, device='cuda:0', dtype=torch.float16)
tensor(1.7012, device='cuda:0', dtype=torch.float16) tensor(0.1334, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.1575, device='cuda:0', dtype=torch.float16)
tensor(1.7227, device='cuda:0', dtype=torch.float16) tensor(0.1271, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.2812, device='cuda:0', dtype=torch.float16) tensor(0.4763, device='cuda:0', dtype=torch.float16)
tensor(2.1406, device='cuda:0', dtype=torch.float16) tensor(0.2281, device='cuda:0', dtype=torch.float16)
tensor(2.0195, device='cuda:0', dtype=torch.float16) tensor(0.2344, device='cuda:0', dtype=torch.float16)
tensor(2.2109, device='cuda:0', dtype=torch.float16) tensor(0.2350, device='cuda:0', dtype=torch.float16)
tensor(1.8242, device='cuda:0', dtype=torch.float16) tensor(0.2228, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0087, device='cuda:0')
tensor(0.2109, device='cuda:0')
old_score: tensor(0.2300, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1361, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2567217350006104
Validation after dual ascent:
out_inf: tensor(7.2812, device='cuda:0', dtype=torch.float16) tensor(0.4763, device='cuda:0', dtype=torch.float16)
tensor(1.3574, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
tensor(1.3213, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.1244, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.o_proj
Validation after prune:
out_inf: tensor(18.1719, device='cuda:0', dtype=torch.float16) tensor(0.2028, device='cuda:0', dtype=torch.float16)
tensor(2.6250, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
tensor(2.7812, device='cuda:0', dtype=torch.float16) tensor(0.1041, device='cuda:0', dtype=torch.float16)
tensor(3.6719, device='cuda:0', dtype=torch.float16) tensor(0.0930, device='cuda:0', dtype=torch.float16)
tensor(2.4219, device='cuda:0', dtype=torch.float16) tensor(0.0877, device='cuda:0', dtype=torch.float16)
tensor(0.0351, device='cuda:0')
old_score: tensor(0.0941, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0599, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.191696643829346
Validation after dual ascent:
out_inf: tensor(18.1719, device='cuda:0', dtype=torch.float16) tensor(0.2028, device='cuda:0', dtype=torch.float16)
tensor(1.6914, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.0627, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.gate_proj
Validation after prune:
out_inf: tensor(11.5703, device='cuda:0', dtype=torch.float16) tensor(0.5127, device='cuda:0', dtype=torch.float16)
tensor(3.3828, device='cuda:0', dtype=torch.float16) tensor(0.2028, device='cuda:0', dtype=torch.float16)
tensor(3.7109, device='cuda:0', dtype=torch.float16) tensor(0.2158, device='cuda:0', dtype=torch.float16)
tensor(3.4219, device='cuda:0', dtype=torch.float16) tensor(0.2061, device='cuda:0', dtype=torch.float16)
tensor(3.3594, device='cuda:0', dtype=torch.float16) tensor(0.2017, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0126, device='cuda:0')
tensor(0.0498, device='cuda:0')
old_score: tensor(0.2065, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1109, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.200434684753418
Validation after dual ascent:
out_inf: tensor(11.5703, device='cuda:0', dtype=torch.float16) tensor(0.5127, device='cuda:0', dtype=torch.float16)
tensor(2.0703, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(2.0234, device='cuda:0', dtype=torch.float16) tensor(0.1060, device='cuda:0', dtype=torch.float16)
tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.1232, device='cuda:0', dtype=torch.float16)
tensor(2.8984, device='cuda:0', dtype=torch.float16) tensor(0.1024, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.up_proj
Validation after prune:
out_inf: tensor(9.1250, device='cuda:0', dtype=torch.float16) tensor(0.4692, device='cuda:0', dtype=torch.float16)
tensor(4.4297, device='cuda:0', dtype=torch.float16) tensor(0.1885, device='cuda:0', dtype=torch.float16)
tensor(5.2891, device='cuda:0', dtype=torch.float16) tensor(0.1948, device='cuda:0', dtype=torch.float16)
tensor(4.9688, device='cuda:0', dtype=torch.float16) tensor(0.1923, device='cuda:0', dtype=torch.float16)
tensor(4.8789, device='cuda:0', dtype=torch.float16) tensor(0.1853, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0120, device='cuda:0')
tensor(0.0467, device='cuda:0')
old_score: tensor(0.1902, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1066, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.182141304016113
Validation after dual ascent:
out_inf: tensor(9.1250, device='cuda:0', dtype=torch.float16) tensor(0.4692, device='cuda:0', dtype=torch.float16)
tensor(3.0234, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
tensor(3.3965, device='cuda:0', dtype=torch.float16) tensor(0.1020, device='cuda:0', dtype=torch.float16)
tensor(3.1895, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(3.1172, device='cuda:0', dtype=torch.float16) tensor(0.0984, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.down_proj
Validation after prune:
out_inf: tensor(8.4297, device='cuda:0', dtype=torch.float16) tensor(0.3054, device='cuda:0', dtype=torch.float16)
tensor(1.3857, device='cuda:0', dtype=torch.float16) tensor(0.1558, device='cuda:0', dtype=torch.float16)
tensor(1.4775, device='cuda:0', dtype=torch.float16) tensor(0.1619, device='cuda:0', dtype=torch.float16)
tensor(1.3721, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.1602, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0172, device='cuda:0')
tensor(0.2421, device='cuda:0')
old_score: tensor(0.1587, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0998, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.913772583007812
Validation after dual ascent:
out_inf: tensor(8.4297, device='cuda:0', dtype=torch.float16) tensor(0.3054, device='cuda:0', dtype=torch.float16)
tensor(1.2510, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.0987, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.0923, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.9062, device='cuda:0', dtype=torch.float16) tensor(0.8877, device='cuda:0', dtype=torch.float16)
tensor(4.1172, device='cuda:0', dtype=torch.float16) tensor(0.2861, device='cuda:0', dtype=torch.float16)
tensor(3.7109, device='cuda:0', dtype=torch.float16) tensor(0.2883, device='cuda:0', dtype=torch.float16)
tensor(3.9219, device='cuda:0', dtype=torch.float16) tensor(0.2927, device='cuda:0', dtype=torch.float16)
tensor(3.6875, device='cuda:0', dtype=torch.float16) tensor(0.2808, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0128, device='cuda:0')
tensor(0.0325, device='cuda:0')
old_score: tensor(0.2871, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1431, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.254114151000977
Validation after dual ascent:
out_inf: tensor(15.9062, device='cuda:0', dtype=torch.float16) tensor(0.8877, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.6123, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(2.0938, device='cuda:0', dtype=torch.float16) tensor(0.1600, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.6250, device='cuda:0', dtype=torch.float16) tensor(1.0312, device='cuda:0', dtype=torch.float16)
tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.3040, device='cuda:0', dtype=torch.float16)
tensor(4.2656, device='cuda:0', dtype=torch.float16) tensor(0.3093, device='cuda:0', dtype=torch.float16)
tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(4.1328, device='cuda:0', dtype=torch.float16) tensor(0.3000, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0140, device='cuda:0')
tensor(0.0341, device='cuda:0')
old_score: tensor(0.3064, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1451, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.254560232162476
Validation after dual ascent:
out_inf: tensor(19.6250, device='cuda:0', dtype=torch.float16) tensor(1.0312, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(1.6074, device='cuda:0', dtype=torch.float16) tensor(0.1389, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.1626, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.v_proj
Validation after prune:
out_inf: tensor(9.5469, device='cuda:0', dtype=torch.float16) tensor(0.5273, device='cuda:0', dtype=torch.float16)
tensor(2.4062, device='cuda:0', dtype=torch.float16) tensor(0.2455, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.2498, device='cuda:0', dtype=torch.float16)
tensor(2.5273, device='cuda:0', dtype=torch.float16) tensor(0.2499, device='cuda:0', dtype=torch.float16)
tensor(2.1680, device='cuda:0', dtype=torch.float16) tensor(0.2413, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0103, device='cuda:0')
tensor(0.1158, device='cuda:0')
old_score: tensor(0.2466, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1412, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.261422872543335
Validation after dual ascent:
out_inf: tensor(9.5469, device='cuda:0', dtype=torch.float16) tensor(0.5273, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
tensor(1.3848, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
tensor(1.5020, device='cuda:0', dtype=torch.float16) tensor(0.1576, device='cuda:0', dtype=torch.float16)
tensor(1.2959, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.o_proj
Validation after prune:
out_inf: tensor(20.0156, device='cuda:0', dtype=torch.float16) tensor(0.1768, device='cuda:0', dtype=torch.float16)
tensor(2.0156, device='cuda:0', dtype=torch.float16) tensor(0.0783, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.0874, device='cuda:0', dtype=torch.float16)
tensor(2.5391, device='cuda:0', dtype=torch.float16) tensor(0.0786, device='cuda:0', dtype=torch.float16)
tensor(1.8516, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
tensor(0.0452, device='cuda:0')
old_score: tensor(0.0822, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0468, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.118730545043945
Validation after dual ascent:
out_inf: tensor(20.0156, device='cuda:0', dtype=torch.float16) tensor(0.1768, device='cuda:0', dtype=torch.float16)
tensor(0.9766, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.0450, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.gate_proj
Validation after prune:
out_inf: tensor(19.3281, device='cuda:0', dtype=torch.float16) tensor(0.5649, device='cuda:0', dtype=torch.float16)
tensor(17.7500, device='cuda:0', dtype=torch.float16) tensor(0.2111, device='cuda:0', dtype=torch.float16)
tensor(19.0781, device='cuda:0', dtype=torch.float16) tensor(0.2244, device='cuda:0', dtype=torch.float16)
tensor(18.2188, device='cuda:0', dtype=torch.float16) tensor(0.2168, device='cuda:0', dtype=torch.float16)
tensor(16.7188, device='cuda:0', dtype=torch.float16) tensor(0.2097, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0188, device='cuda:0')
tensor(0.0481, device='cuda:0')
old_score: tensor(0.2156, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1106, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.185292720794678
Validation after dual ascent:
out_inf: tensor(19.3281, device='cuda:0', dtype=torch.float16) tensor(0.5649, device='cuda:0', dtype=torch.float16)
tensor(8.4531, device='cuda:0', dtype=torch.float16) tensor(0.1114, device='cuda:0', dtype=torch.float16)
tensor(7.4766, device='cuda:0', dtype=torch.float16) tensor(0.1057, device='cuda:0', dtype=torch.float16)
tensor(7.6562, device='cuda:0', dtype=torch.float16) tensor(0.1240, device='cuda:0', dtype=torch.float16)
tensor(7.4688, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.up_proj
Validation after prune:
out_inf: tensor(19.6406, device='cuda:0', dtype=torch.float16) tensor(0.5527, device='cuda:0', dtype=torch.float16)
tensor(17.0469, device='cuda:0', dtype=torch.float16) tensor(0.2052, device='cuda:0', dtype=torch.float16)
tensor(17.3438, device='cuda:0', dtype=torch.float16) tensor(0.2119, device='cuda:0', dtype=torch.float16)
tensor(16.4688, device='cuda:0', dtype=torch.float16) tensor(0.2109, device='cuda:0', dtype=torch.float16)
tensor(15.7031, device='cuda:0', dtype=torch.float16) tensor(0.2028, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0184, device='cuda:0')
tensor(0.0457, device='cuda:0')
old_score: tensor(0.2076, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1058, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.190969705581665
Validation after dual ascent:
out_inf: tensor(19.6406, device='cuda:0', dtype=torch.float16) tensor(0.5527, device='cuda:0', dtype=torch.float16)
tensor(9.9609, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(9.6953, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
tensor(9.8438, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(9.7578, device='cuda:0', dtype=torch.float16) tensor(0.0972, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.down_proj
Validation after prune:
out_inf: tensor(510.7500, device='cuda:0', dtype=torch.float16) tensor(0.5659, device='cuda:0', dtype=torch.float16)
tensor(8.3359, device='cuda:0', dtype=torch.float16) tensor(0.2952, device='cuda:0', dtype=torch.float16)
tensor(7.8906, device='cuda:0', dtype=torch.float16) tensor(0.3088, device='cuda:0', dtype=torch.float16)
tensor(7.5898, device='cuda:0', dtype=torch.float16) tensor(0.2561, device='cuda:0', dtype=torch.float16)
tensor(8.0234, device='cuda:0', dtype=torch.float16) tensor(0.3518, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0199, device='cuda:0')
tensor(0.4880, device='cuda:0')
old_score: tensor(0.3030, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1516, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 51.32277965545654
Validation after dual ascent:
out_inf: tensor(510.7500, device='cuda:0', dtype=torch.float16) tensor(0.5659, device='cuda:0', dtype=torch.float16)
tensor(8.2812, device='cuda:0', dtype=torch.float16) tensor(0.1447, device='cuda:0', dtype=torch.float16)
tensor(7.8281, device='cuda:0', dtype=torch.float16) tensor(0.1478, device='cuda:0', dtype=torch.float16)
tensor(7.5312, device='cuda:0', dtype=torch.float16) tensor(0.1470, device='cuda:0', dtype=torch.float16)
tensor(7.9648, device='cuda:0', dtype=torch.float16) tensor(0.1667, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.8359, device='cuda:0', dtype=torch.float16) tensor(0.9106, device='cuda:0', dtype=torch.float16)
tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.2781, device='cuda:0', dtype=torch.float16)
tensor(4.7383, device='cuda:0', dtype=torch.float16) tensor(0.2793, device='cuda:0', dtype=torch.float16)
tensor(5.2188, device='cuda:0', dtype=torch.float16) tensor(0.2834, device='cuda:0', dtype=torch.float16)
tensor(5.1875, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0193, device='cuda:0')
tensor(0.0278, device='cuda:0')
old_score: tensor(0.2793, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1168, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.00934910774231
Validation after dual ascent:
out_inf: tensor(14.8359, device='cuda:0', dtype=torch.float16) tensor(0.9106, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1168, device='cuda:0', dtype=torch.float16)
tensor(1.4951, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(1.6172, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1061, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.6094, device='cuda:0', dtype=torch.float16) tensor(1.1416, device='cuda:0', dtype=torch.float16)
tensor(5.5469, device='cuda:0', dtype=torch.float16) tensor(0.3035, device='cuda:0', dtype=torch.float16)
tensor(5.2188, device='cuda:0', dtype=torch.float16) tensor(0.3035, device='cuda:0', dtype=torch.float16)
tensor(5.7891, device='cuda:0', dtype=torch.float16) tensor(0.3096, device='cuda:0', dtype=torch.float16)
tensor(5.4062, device='cuda:0', dtype=torch.float16) tensor(0.3044, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0141, device='cuda:0')
tensor(0.0197, device='cuda:0')
old_score: tensor(0.3052, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1202, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.760737180709839
Validation after dual ascent:
out_inf: tensor(20.6094, device='cuda:0', dtype=torch.float16) tensor(1.1416, device='cuda:0', dtype=torch.float16)
tensor(1.9551, device='cuda:0', dtype=torch.float16) tensor(0.1205, device='cuda:0', dtype=torch.float16)
tensor(1.9297, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(1.8262, device='cuda:0', dtype=torch.float16) tensor(0.1368, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.1090, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.3828, device='cuda:0', dtype=torch.float16) tensor(0.4087, device='cuda:0', dtype=torch.float16)
tensor(1.9570, device='cuda:0', dtype=torch.float16) tensor(0.1868, device='cuda:0', dtype=torch.float16)
tensor(1.5049, device='cuda:0', dtype=torch.float16) tensor(0.1902, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.1914, device='cuda:0', dtype=torch.float16)
tensor(1.8945, device='cuda:0', dtype=torch.float16) tensor(0.1836, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0156, device='cuda:0')
tensor(0.2158, device='cuda:0')
old_score: tensor(0.1880, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1039, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.510690689086914
Validation after dual ascent:
out_inf: tensor(7.3828, device='cuda:0', dtype=torch.float16) tensor(0.4087, device='cuda:0', dtype=torch.float16)
tensor(1.0312, device='cuda:0', dtype=torch.float16) tensor(0.1042, device='cuda:0', dtype=torch.float16)
tensor(1.0078, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.1533, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(1.0381, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.o_proj
Validation after prune:
out_inf: tensor(133.2500, device='cuda:0', dtype=torch.float16) tensor(0.2620, device='cuda:0', dtype=torch.float16)
tensor(2.8438, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.1059, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.1006, device='cuda:0', dtype=torch.float16)
tensor(2.6719, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0154, device='cuda:0')
tensor(0.0206, device='cuda:0')
old_score: tensor(0.1078, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0528, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2420551776885986
Validation after dual ascent:
out_inf: tensor(133.2500, device='cuda:0', dtype=torch.float16) tensor(0.2620, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.0519, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.0524, device='cuda:0', dtype=torch.float16)
pruning layer 31 name mlp.gate_proj
Validation after prune:
out_inf: tensor(29.2812, device='cuda:0', dtype=torch.float16) tensor(0.6392, device='cuda:0', dtype=torch.float16)
tensor(7.4375, device='cuda:0', dtype=torch.float16) tensor(0.2245, device='cuda:0', dtype=torch.float16)
tensor(8.1250, device='cuda:0', dtype=torch.float16) tensor(0.2340, device='cuda:0', dtype=torch.float16)
tensor(8.0938, device='cuda:0', dtype=torch.float16) tensor(0.2285, device='cuda:0', dtype=torch.float16)
tensor(9.1406, device='cuda:0', dtype=torch.float16) tensor(0.2272, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0161, device='cuda:0')
tensor(0.0178, device='cuda:0')
old_score: tensor(0.2285, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0999, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.15401029586792
Validation after dual ascent:
out_inf: tensor(29.2812, device='cuda:0', dtype=torch.float16) tensor(0.6392, device='cuda:0', dtype=torch.float16)
tensor(2.3320, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(2.3320, device='cuda:0', dtype=torch.float16) tensor(0.1126, device='cuda:0', dtype=torch.float16)
tensor(2.5156, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
pruning layer 31 name mlp.up_proj
Validation after prune:
out_inf: tensor(34.7188, device='cuda:0', dtype=torch.float16) tensor(0.6704, device='cuda:0', dtype=torch.float16)
tensor(12.8125, device='cuda:0', dtype=torch.float16) tensor(0.2225, device='cuda:0', dtype=torch.float16)
tensor(13.4531, device='cuda:0', dtype=torch.float16) tensor(0.2303, device='cuda:0', dtype=torch.float16)
tensor(13.0938, device='cuda:0', dtype=torch.float16) tensor(0.2291, device='cuda:0', dtype=torch.float16)
tensor(14.0469, device='cuda:0', dtype=torch.float16) tensor(0.2242, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0151, device='cuda:0')
tensor(0.0166, device='cuda:0')
old_score: tensor(0.2266, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0948, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.131158113479614
Validation after dual ascent:
out_inf: tensor(34.7188, device='cuda:0', dtype=torch.float16) tensor(0.6704, device='cuda:0', dtype=torch.float16)
tensor(2.7578, device='cuda:0', dtype=torch.float16) tensor(0.0951, device='cuda:0', dtype=torch.float16)
tensor(2.8516, device='cuda:0', dtype=torch.float16) tensor(0.0908, device='cuda:0', dtype=torch.float16)
tensor(3.7188, device='cuda:0', dtype=torch.float16) tensor(0.1070, device='cuda:0', dtype=torch.float16)
tensor(2.7500, device='cuda:0', dtype=torch.float16) tensor(0.0864, device='cuda:0', dtype=torch.float16)
pruning layer 31 name mlp.down_proj
Validation after prune:
out_inf: tensor(137.2500, device='cuda:0', dtype=torch.float16) tensor(1.8311, device='cuda:0', dtype=torch.float16)
tensor(9.1172, device='cuda:0', dtype=torch.float16) tensor(0.9712, device='cuda:0', dtype=torch.float16)
tensor(8.0469, device='cuda:0', dtype=torch.float16) tensor(0.9297, device='cuda:0', dtype=torch.float16)
tensor(8.6562, device='cuda:0', dtype=torch.float16) tensor(0.7876, device='cuda:0', dtype=torch.float16)
tensor(9.9453, device='cuda:0', dtype=torch.float16) tensor(1.1807, device='cuda:0', dtype=torch.float16)
tensor(1.5336, device='cuda:0')
old_score: tensor(0.9668, device='cuda:0', dtype=torch.float16) new_score: tensor(0.4727, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.50784730911255
Validation after dual ascent:
out_inf: tensor(137.2500, device='cuda:0', dtype=torch.float16) tensor(1.8311, device='cuda:0', dtype=torch.float16)
tensor(5.1172, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(5.3984, device='cuda:0', dtype=torch.float16) tensor(0.4253, device='cuda:0', dtype=torch.float16)
tensor(4.6016, device='cuda:0', dtype=torch.float16) tensor(0.4158, device='cuda:0', dtype=torch.float16)
tensor(5.0078, device='cuda:0', dtype=torch.float16) tensor(0.5889, device='cuda:0', dtype=torch.float16)
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  3.19it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.04it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.88it/s]
{'model.embed_tokens': 0, 'model.layers.0': 0, 'model.layers.1': 0, 'model.layers.2': 0, 'model.layers.3': 0, 'model.layers.4': 0, 'model.layers.5': 0, 'model.layers.6': 0, 'model.layers.7': 0, 'model.layers.8': 0, 'model.layers.9': 0, 'model.layers.10': 0, 'model.layers.11': 0, 'model.layers.12': 0, 'model.layers.13': 0, 'model.layers.14': 0, 'model.layers.15': 0, 'model.layers.16': 0, 'model.layers.17': 0, 'model.layers.18': 0, 'model.layers.19': 0, 'model.layers.20': 0, 'model.layers.21': 0, 'model.layers.22': 0, 'model.layers.23': 0, 'model.layers.24': 0, 'model.layers.25': 0, 'model.layers.26': 0, 'model.layers.27': 1, 'model.layers.28': 1, 'model.layers.29': 1, 'model.layers.30': 1, 'model.layers.31': 1, 'model.norm': 1, 'model.rotary_emb': 1, 'lm_head': 1}
use device  1
******************************
layer 0 sparsity 0.699950
layer 1 sparsity 0.699950
layer 2 sparsity 0.699950
layer 3 sparsity 0.699950
layer 4 sparsity 0.699950
layer 5 sparsity 0.699950
layer 6 sparsity 0.699950
layer 7 sparsity 0.699950
layer 8 sparsity 0.699950
layer 9 sparsity 0.699950
layer 10 sparsity 0.699950
layer 11 sparsity 0.699950
layer 12 sparsity 0.699950
layer 13 sparsity 0.699950
layer 14 sparsity 0.699950
layer 15 sparsity 0.699950
layer 16 sparsity 0.699950
layer 17 sparsity 0.699950
layer 18 sparsity 0.699950
layer 19 sparsity 0.699950
layer 20 sparsity 0.699950
layer 21 sparsity 0.699950
layer 22 sparsity 0.699950
layer 23 sparsity 0.699950
layer 24 sparsity 0.699950
layer 25 sparsity 0.699950
layer 26 sparsity 0.699950
layer 27 sparsity 0.699950
layer 28 sparsity 0.699950
layer 29 sparsity 0.699950
layer 30 sparsity 0.699950
layer 31 sparsity 0.699950
sparsity sanity check 0.6999
******************************
evaluating on wikitext2
nsamples 83
sample 0
sample 50
wikitext perplexity 602.8880615234375
magnitude_dual	0.6999	602.8881	256
Namespace(model='/h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf', seed=0, nsamples=256, dual_theld=0.03, n_batch=8, sparsity_ratio=0.7, epsilon=0.02, n_flod=1, sparsity_type='unstructured', prune_method='magnitude_dual', cache_dir='llm_weights', use_variant=False, save='/h3cstore_ns/jcxie/LISA/nips2024/log', save_model=None, exclude='gate_proj', ww_metric='alpha_peak', ww_metric_cache='/h3cstore_ns/jcxie/LISA/wanda-main/data/llama2-7b-hf', wanda_scale=0.01, ww_epsilon=0.02, mapping_type='block_wise', dual_sp_theld=0.0, Hyper_m=3, Lamda=0.2, eval_zero_shot=0, save_ckpt=0)
2025-04-24 16:16:19.942762: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-24 16:16:20.099724: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-24 16:16:20.104972: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 16:16:20.104995: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2025-04-24 16:16:21.474394: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 16:16:21.474555: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 16:16:21.474576: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
torch 2.3.1+cu121
transformers 4.47.1
accelerate 0.29.1
# of gpus:  2
loading llm model /h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  5.57it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.97it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.90it/s]
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
model.embed_tokens.weight torch.Size([32000, 4096])
model.layers.0.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.0.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.0.input_layernorm.weight torch.Size([4096])
model.layers.0.post_attention_layernorm.weight torch.Size([4096])
model.layers.1.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.1.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.1.input_layernorm.weight torch.Size([4096])
model.layers.1.post_attention_layernorm.weight torch.Size([4096])
model.layers.2.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.2.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.2.input_layernorm.weight torch.Size([4096])
model.layers.2.post_attention_layernorm.weight torch.Size([4096])
model.layers.3.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.3.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.3.input_layernorm.weight torch.Size([4096])
model.layers.3.post_attention_layernorm.weight torch.Size([4096])
model.layers.4.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.4.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.4.input_layernorm.weight torch.Size([4096])
model.layers.4.post_attention_layernorm.weight torch.Size([4096])
model.layers.5.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.5.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.5.input_layernorm.weight torch.Size([4096])
model.layers.5.post_attention_layernorm.weight torch.Size([4096])
model.layers.6.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.6.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.6.input_layernorm.weight torch.Size([4096])
model.layers.6.post_attention_layernorm.weight torch.Size([4096])
model.layers.7.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.7.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.7.input_layernorm.weight torch.Size([4096])
model.layers.7.post_attention_layernorm.weight torch.Size([4096])
model.layers.8.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.8.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.8.input_layernorm.weight torch.Size([4096])
model.layers.8.post_attention_layernorm.weight torch.Size([4096])
model.layers.9.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.9.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.9.input_layernorm.weight torch.Size([4096])
model.layers.9.post_attention_layernorm.weight torch.Size([4096])
model.layers.10.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.10.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.10.input_layernorm.weight torch.Size([4096])
model.layers.10.post_attention_layernorm.weight torch.Size([4096])
model.layers.11.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.11.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.11.input_layernorm.weight torch.Size([4096])
model.layers.11.post_attention_layernorm.weight torch.Size([4096])
model.layers.12.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.12.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.12.input_layernorm.weight torch.Size([4096])
model.layers.12.post_attention_layernorm.weight torch.Size([4096])
model.layers.13.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.13.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.13.input_layernorm.weight torch.Size([4096])
model.layers.13.post_attention_layernorm.weight torch.Size([4096])
model.layers.14.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.14.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.14.input_layernorm.weight torch.Size([4096])
model.layers.14.post_attention_layernorm.weight torch.Size([4096])
model.layers.15.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.15.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.15.input_layernorm.weight torch.Size([4096])
model.layers.15.post_attention_layernorm.weight torch.Size([4096])
model.layers.16.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.16.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.16.input_layernorm.weight torch.Size([4096])
model.layers.16.post_attention_layernorm.weight torch.Size([4096])
model.layers.17.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.17.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.17.input_layernorm.weight torch.Size([4096])
model.layers.17.post_attention_layernorm.weight torch.Size([4096])
model.layers.18.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.18.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.18.input_layernorm.weight torch.Size([4096])
model.layers.18.post_attention_layernorm.weight torch.Size([4096])
model.layers.19.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.19.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.19.input_layernorm.weight torch.Size([4096])
model.layers.19.post_attention_layernorm.weight torch.Size([4096])
model.layers.20.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.20.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.20.input_layernorm.weight torch.Size([4096])
model.layers.20.post_attention_layernorm.weight torch.Size([4096])
model.layers.21.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.21.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.21.input_layernorm.weight torch.Size([4096])
model.layers.21.post_attention_layernorm.weight torch.Size([4096])
model.layers.22.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.22.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.22.input_layernorm.weight torch.Size([4096])
model.layers.22.post_attention_layernorm.weight torch.Size([4096])
model.layers.23.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.23.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.23.input_layernorm.weight torch.Size([4096])
model.layers.23.post_attention_layernorm.weight torch.Size([4096])
model.layers.24.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.24.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.24.input_layernorm.weight torch.Size([4096])
model.layers.24.post_attention_layernorm.weight torch.Size([4096])
model.layers.25.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.25.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.25.input_layernorm.weight torch.Size([4096])
model.layers.25.post_attention_layernorm.weight torch.Size([4096])
model.layers.26.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.26.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.26.input_layernorm.weight torch.Size([4096])
model.layers.26.post_attention_layernorm.weight torch.Size([4096])
model.layers.27.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.27.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.27.input_layernorm.weight torch.Size([4096])
model.layers.27.post_attention_layernorm.weight torch.Size([4096])
model.layers.28.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.28.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.28.input_layernorm.weight torch.Size([4096])
model.layers.28.post_attention_layernorm.weight torch.Size([4096])
model.layers.29.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.29.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.29.input_layernorm.weight torch.Size([4096])
model.layers.29.post_attention_layernorm.weight torch.Size([4096])
model.layers.30.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.30.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.30.input_layernorm.weight torch.Size([4096])
model.layers.30.post_attention_layernorm.weight torch.Size([4096])
model.layers.31.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.31.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.31.input_layernorm.weight torch.Size([4096])
model.layers.31.post_attention_layernorm.weight torch.Size([4096])
model.norm.weight torch.Size([4096])
lm_head.weight torch.Size([32000, 4096])
use device  cpu
loading calibdation data
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<02:25,  1.75it/s]  1%|          | 2/256 [00:01<02:14,  1.89it/s]  2%|▏         | 4/256 [00:01<01:08,  3.69it/s]  2%|▏         | 5/256 [00:01<01:22,  3.05it/s]  2%|▏         | 6/256 [00:01<01:06,  3.79it/s]  3%|▎         | 7/256 [00:02<01:44,  2.39it/s]  3%|▎         | 8/256 [00:02<01:22,  3.02it/s]  4%|▎         | 9/256 [00:02<01:05,  3.80it/s]  4%|▍         | 11/256 [00:03<00:44,  5.55it/s]  5%|▍         | 12/256 [00:03<00:40,  5.96it/s]  5%|▌         | 13/256 [00:04<01:28,  2.74it/s]  5%|▌         | 14/256 [00:04<01:26,  2.80it/s]  6%|▌         | 15/256 [00:04<01:14,  3.22it/s]  6%|▋         | 16/256 [00:04<01:05,  3.67it/s]  7%|▋         | 18/256 [00:05<01:07,  3.52it/s]  8%|▊         | 20/256 [00:05<00:51,  4.60it/s]  8%|▊         | 21/256 [00:05<00:45,  5.16it/s]  9%|▊         | 22/256 [00:06<00:49,  4.73it/s]  9%|▉         | 24/256 [00:06<00:42,  5.43it/s] 10%|▉         | 25/256 [00:06<00:40,  5.66it/s] 10%|█         | 26/256 [00:06<00:53,  4.32it/s] 11%|█         | 28/256 [00:07<00:44,  5.18it/s] 11%|█▏        | 29/256 [00:07<00:45,  5.01it/s] 12%|█▏        | 31/256 [00:07<00:37,  5.92it/s] 12%|█▎        | 32/256 [00:07<00:45,  4.91it/s] 13%|█▎        | 33/256 [00:08<00:56,  3.92it/s] 13%|█▎        | 34/256 [00:08<01:02,  3.55it/s] 14%|█▎        | 35/256 [00:09<01:09,  3.16it/s] 14%|█▍        | 36/256 [00:09<01:20,  2.72it/s] 14%|█▍        | 37/256 [00:09<01:14,  2.93it/s] 15%|█▍        | 38/256 [00:10<01:08,  3.17it/s] 16%|█▌        | 40/256 [00:10<01:03,  3.41it/s] 16%|█▋        | 42/256 [00:10<00:44,  4.85it/s] 17%|█▋        | 43/256 [00:10<00:39,  5.45it/s] 17%|█▋        | 44/256 [00:11<00:38,  5.50it/s] 18%|█▊        | 45/256 [00:11<00:34,  6.18it/s] 18%|█▊        | 46/256 [00:11<00:32,  6.41it/s] 18%|█▊        | 47/256 [00:11<00:34,  6.14it/s] 19%|█▉        | 48/256 [00:11<00:38,  5.34it/s] 19%|█▉        | 49/256 [00:11<00:34,  5.94it/s] 20%|█▉        | 50/256 [00:12<00:50,  4.07it/s] 21%|██        | 53/256 [00:13<00:49,  4.14it/s] 21%|██        | 54/256 [00:13<00:47,  4.22it/s] 21%|██▏       | 55/256 [00:13<00:41,  4.86it/s] 22%|██▏       | 56/256 [00:13<00:48,  4.15it/s] 22%|██▏       | 57/256 [00:13<00:44,  4.51it/s] 23%|██▎       | 58/256 [00:14<00:49,  4.02it/s] 23%|██▎       | 59/256 [00:14<00:43,  4.58it/s] 23%|██▎       | 60/256 [00:14<00:46,  4.23it/s] 24%|██▍       | 61/256 [00:14<00:54,  3.59it/s] 24%|██▍       | 62/256 [00:15<00:59,  3.27it/s] 25%|██▍       | 63/256 [00:15<00:51,  3.73it/s] 25%|██▌       | 64/256 [00:15<00:42,  4.52it/s] 25%|██▌       | 65/256 [00:16<01:08,  2.80it/s] 26%|██▌       | 67/256 [00:16<00:43,  4.33it/s] 27%|██▋       | 68/256 [00:16<00:42,  4.44it/s] 27%|██▋       | 69/256 [00:16<00:43,  4.26it/s] 28%|██▊       | 71/256 [00:17<00:33,  5.49it/s] 29%|██▊       | 73/256 [00:17<00:26,  6.80it/s] 29%|██▉       | 74/256 [00:17<00:26,  6.84it/s] 29%|██▉       | 75/256 [00:17<00:32,  5.62it/s] 30%|██▉       | 76/256 [00:18<00:44,  4.04it/s] 30%|███       | 78/256 [00:18<00:30,  5.77it/s] 31%|███       | 79/256 [00:18<00:38,  4.59it/s] 31%|███▏      | 80/256 [00:19<00:48,  3.60it/s] 32%|███▏      | 81/256 [00:19<00:53,  3.27it/s] 32%|███▏      | 82/256 [00:19<00:44,  3.93it/s] 32%|███▏      | 83/256 [00:20<00:54,  3.19it/s] 33%|███▎      | 84/256 [00:20<00:51,  3.34it/s] 33%|███▎      | 85/256 [00:20<00:47,  3.61it/s] 34%|███▎      | 86/256 [00:20<00:44,  3.85it/s] 34%|███▍      | 87/256 [00:21<01:02,  2.71it/s] 34%|███▍      | 88/256 [00:21<01:03,  2.63it/s] 35%|███▍      | 89/256 [00:22<00:59,  2.82it/s] 35%|███▌      | 90/256 [00:22<00:59,  2.79it/s] 36%|███▌      | 91/256 [00:22<00:57,  2.87it/s] 36%|███▌      | 92/256 [00:23<00:48,  3.40it/s] 36%|███▋      | 93/256 [00:23<00:42,  3.82it/s] 37%|███▋      | 94/256 [00:23<00:51,  3.14it/s] 37%|███▋      | 95/256 [00:24<01:06,  2.43it/s] 38%|███▊      | 96/256 [00:24<00:53,  3.01it/s] 38%|███▊      | 97/256 [00:24<00:56,  2.82it/s] 38%|███▊      | 98/256 [00:25<00:47,  3.32it/s] 39%|███▊      | 99/256 [00:25<00:45,  3.43it/s] 39%|███▉      | 100/256 [00:25<00:43,  3.60it/s] 39%|███▉      | 101/256 [00:26<01:15,  2.05it/s] 40%|███▉      | 102/256 [00:26<01:05,  2.36it/s] 41%|████      | 104/256 [00:27<00:41,  3.66it/s] 41%|████▏     | 106/256 [00:27<00:34,  4.40it/s] 42%|████▏     | 107/256 [00:27<00:34,  4.38it/s] 42%|████▏     | 108/256 [00:28<00:57,  2.59it/s] 43%|████▎     | 110/256 [00:28<00:37,  3.87it/s] 43%|████▎     | 111/256 [00:28<00:38,  3.76it/s] 44%|████▍     | 112/256 [00:29<00:43,  3.30it/s] 44%|████▍     | 113/256 [00:29<00:44,  3.21it/s] 45%|████▍     | 114/256 [00:29<00:40,  3.49it/s] 45%|████▍     | 115/256 [00:30<00:38,  3.62it/s] 45%|████▌     | 116/256 [00:30<00:54,  2.56it/s] 46%|████▌     | 118/256 [00:31<00:38,  3.59it/s] 47%|████▋     | 120/256 [00:31<00:27,  4.99it/s] 47%|████▋     | 121/256 [00:31<00:24,  5.47it/s] 48%|████▊     | 122/256 [00:32<00:39,  3.38it/s] 48%|████▊     | 123/256 [00:32<00:41,  3.17it/s] 48%|████▊     | 124/256 [00:33<00:53,  2.47it/s] 49%|████▉     | 125/256 [00:34<01:22,  1.58it/s] 49%|████▉     | 126/256 [00:34<01:09,  1.87it/s] 50%|████▉     | 127/256 [00:35<01:15,  1.72it/s] 50%|█████     | 129/256 [00:35<00:45,  2.79it/s] 51%|█████     | 130/256 [00:35<00:41,  3.00it/s] 51%|█████     | 131/256 [00:35<00:40,  3.11it/s] 52%|█████▏    | 132/256 [00:36<00:38,  3.26it/s] 52%|█████▏    | 133/256 [00:36<00:46,  2.65it/s] 52%|█████▏    | 134/256 [00:37<00:45,  2.68it/s] 53%|█████▎    | 135/256 [00:37<00:36,  3.31it/s] 53%|█████▎    | 136/256 [00:37<00:36,  3.31it/s] 54%|█████▎    | 137/256 [00:37<00:30,  3.94it/s] 54%|█████▍    | 138/256 [00:37<00:26,  4.45it/s] 54%|█████▍    | 139/256 [00:38<00:24,  4.78it/s] 55%|█████▍    | 140/256 [00:38<00:23,  5.04it/s] 55%|█████▌    | 141/256 [00:38<00:19,  5.80it/s] 55%|█████▌    | 142/256 [00:38<00:17,  6.45it/s] 56%|█████▌    | 143/256 [00:38<00:16,  6.66it/s] 57%|█████▋    | 145/256 [00:39<00:37,  2.95it/s] 57%|█████▋    | 146/256 [00:40<00:40,  2.70it/s] 57%|█████▋    | 147/256 [00:40<00:36,  2.96it/s] 58%|█████▊    | 148/256 [00:40<00:37,  2.90it/s] 59%|█████▊    | 150/256 [00:41<00:29,  3.62it/s] 59%|█████▉    | 151/256 [00:41<00:24,  4.21it/s] 59%|█████▉    | 152/256 [00:41<00:28,  3.66it/s] 60%|█████▉    | 153/256 [00:41<00:25,  4.03it/s] 60%|██████    | 154/256 [00:42<00:29,  3.45it/s] 61%|██████    | 155/256 [00:42<00:26,  3.79it/s] 61%|██████    | 156/256 [00:42<00:22,  4.51it/s] 61%|██████▏   | 157/256 [00:42<00:27,  3.62it/s] 62%|██████▏   | 158/256 [00:43<00:23,  4.13it/s] 62%|██████▏   | 159/256 [00:44<00:41,  2.32it/s] 62%|██████▎   | 160/256 [00:44<00:32,  2.97it/s] 63%|██████▎   | 162/256 [00:45<00:37,  2.54it/s] 64%|██████▎   | 163/256 [00:45<00:32,  2.84it/s] 64%|██████▍   | 164/256 [00:45<00:27,  3.37it/s] 65%|██████▍   | 166/256 [00:45<00:22,  3.96it/s] 65%|██████▌   | 167/256 [00:46<00:24,  3.56it/s] 66%|██████▌   | 168/256 [00:46<00:27,  3.15it/s] 66%|██████▌   | 169/256 [00:47<00:31,  2.78it/s] 66%|██████▋   | 170/256 [00:47<00:30,  2.77it/s] 67%|██████▋   | 171/256 [00:47<00:24,  3.46it/s] 67%|██████▋   | 172/256 [00:47<00:21,  3.93it/s] 68%|██████▊   | 173/256 [00:47<00:20,  4.05it/s] 68%|██████▊   | 174/256 [00:48<00:29,  2.80it/s] 68%|██████▊   | 175/256 [00:49<00:42,  1.93it/s] 69%|██████▉   | 176/256 [00:49<00:35,  2.23it/s] 69%|██████▉   | 177/256 [00:49<00:29,  2.71it/s] 70%|██████▉   | 179/256 [00:50<00:19,  3.93it/s] 70%|███████   | 180/256 [00:51<00:37,  2.02it/s] 71%|███████   | 181/256 [00:51<00:29,  2.53it/s] 71%|███████   | 182/256 [00:52<00:37,  1.95it/s] 72%|███████▏  | 184/256 [00:53<00:35,  2.05it/s] 73%|███████▎  | 186/256 [00:53<00:23,  2.94it/s] 73%|███████▎  | 187/256 [00:54<00:27,  2.51it/s] 73%|███████▎  | 188/256 [00:54<00:23,  2.86it/s] 74%|███████▍  | 189/256 [00:54<00:23,  2.87it/s] 74%|███████▍  | 190/256 [00:54<00:21,  3.12it/s] 75%|███████▍  | 191/256 [00:55<00:18,  3.43it/s] 75%|███████▌  | 192/256 [00:55<00:21,  2.91it/s] 75%|███████▌  | 193/256 [00:55<00:20,  3.03it/s] 77%|███████▋  | 196/256 [00:56<00:13,  4.56it/s] 77%|███████▋  | 197/256 [00:56<00:15,  3.89it/s] 78%|███████▊  | 199/256 [00:56<00:11,  4.89it/s] 79%|███████▊  | 201/256 [00:57<00:09,  5.54it/s] 79%|███████▉  | 202/256 [00:57<00:11,  4.59it/s] 80%|███████▉  | 204/256 [00:57<00:08,  5.84it/s] 80%|████████  | 206/256 [00:57<00:06,  7.23it/s] 81%|████████  | 207/256 [00:57<00:06,  7.56it/s] 81%|████████▏ | 208/256 [00:58<00:07,  6.63it/s] 82%|████████▏ | 210/256 [00:58<00:05,  8.79it/s] 83%|████████▎ | 212/256 [00:58<00:05,  8.46it/s] 83%|████████▎ | 213/256 [00:58<00:05,  7.54it/s] 84%|████████▎ | 214/256 [00:59<00:07,  5.76it/s] 84%|████████▍ | 215/256 [00:59<00:08,  4.59it/s] 84%|████████▍ | 216/256 [00:59<00:08,  4.45it/s] 85%|████████▌ | 218/256 [00:59<00:07,  5.26it/s] 86%|████████▌ | 219/256 [01:00<00:14,  2.58it/s] 86%|████████▌ | 220/256 [01:01<00:11,  3.03it/s] 86%|████████▋ | 221/256 [01:01<00:11,  2.95it/s] 87%|████████▋ | 222/256 [01:01<00:11,  2.92it/s] 87%|████████▋ | 223/256 [01:02<00:11,  2.78it/s] 88%|████████▊ | 224/256 [01:03<00:23,  1.35it/s] 88%|████████▊ | 225/256 [01:04<00:22,  1.38it/s] 88%|████████▊ | 226/256 [01:04<00:16,  1.79it/s] 89%|████████▊ | 227/256 [01:05<00:13,  2.14it/s] 89%|████████▉ | 228/256 [01:05<00:12,  2.28it/s] 89%|████████▉ | 229/256 [01:06<00:18,  1.42it/s] 90%|████████▉ | 230/256 [01:06<00:13,  1.89it/s] 90%|█████████ | 231/256 [01:07<00:12,  1.95it/s] 91%|█████████ | 232/256 [01:07<00:10,  2.22it/s] 91%|█████████ | 233/256 [01:07<00:08,  2.70it/s] 92%|█████████▏| 235/256 [01:08<00:05,  3.76it/s] 92%|█████████▏| 236/256 [01:08<00:05,  3.63it/s] 93%|█████████▎| 237/256 [01:08<00:04,  3.97it/s] 93%|█████████▎| 238/256 [01:08<00:03,  4.62it/s] 93%|█████████▎| 239/256 [01:08<00:03,  4.53it/s] 94%|█████████▍| 241/256 [01:09<00:02,  5.77it/s] 95%|█████████▍| 242/256 [01:10<00:04,  2.86it/s] 95%|█████████▌| 244/256 [01:10<00:02,  4.37it/s] 96%|█████████▌| 245/256 [01:10<00:02,  4.31it/s] 96%|█████████▌| 246/256 [01:10<00:02,  4.76it/s] 97%|█████████▋| 248/256 [01:10<00:01,  6.40it/s] 97%|█████████▋| 249/256 [01:11<00:01,  3.90it/s] 98%|█████████▊| 251/256 [01:11<00:00,  5.45it/s] 98%|█████████▊| 252/256 [01:12<00:01,  3.42it/s] 99%|█████████▉| 253/256 [01:12<00:01,  2.88it/s]100%|█████████▉| 255/256 [01:13<00:00,  3.02it/s]100%|██████████| 256/256 [01:13<00:00,  3.09it/s]100%|██████████| 256/256 [01:13<00:00,  3.48it/s]
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
dataset loading complete
pruning layer 0 name self_attn.q_proj
Validation after prune:
out_inf: tensor(7.8555, device='cuda:0', dtype=torch.float16) tensor(0.6099, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.k_proj
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.3340, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.3340, device='cuda:0', dtype=torch.float16) tensor(0.0142, device='cuda:0', dtype=torch.float16)
tensor(0.3284, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.3340, device='cuda:0', dtype=torch.float16) tensor(0.0142, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.v_proj
Validation after prune:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.3101, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.3101, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.3101, device='cuda:0', dtype=torch.float16) tensor(0.0066, device='cuda:0', dtype=torch.float16)
tensor(0.2783, device='cuda:0', dtype=torch.float16) tensor(0.0067, device='cuda:0', dtype=torch.float16)
tensor(0.0506, device='cuda:0')
old_score: tensor(0.0066, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0033, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.0461106300354
Validation after dual ascent:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.2795, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.2795, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.2795, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.3340, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
pruning layer 0 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0218, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0225, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
tensor(0.0210, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0199, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0145, device='cuda:0')
tensor(0.0368, device='cuda:0')
old_score: tensor(0.0011, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0003, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.183104038238525
Validation after dual ascent:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0133, device='cuda:0', dtype=torch.float16) tensor(0.0002, device='cuda:0', dtype=torch.float16)
tensor(0.0124, device='cuda:0', dtype=torch.float16) tensor(0.0003, device='cuda:0', dtype=torch.float16)
tensor(0.0133, device='cuda:0', dtype=torch.float16) tensor(0.0003, device='cuda:0', dtype=torch.float16)
tensor(0.0154, device='cuda:0', dtype=torch.float16) tensor(0.0003, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.gate_proj
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.8921, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
tensor(0.9072, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.8789, device='cuda:0', dtype=torch.float16) tensor(0.0268, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0189, device='cuda:0')
tensor(0.0194, device='cuda:0')
old_score: tensor(0.0275, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0134, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 29.800256490707397
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.6846, device='cuda:0', dtype=torch.float16) tensor(0.0130, device='cuda:0', dtype=torch.float16)
tensor(0.6494, device='cuda:0', dtype=torch.float16) tensor(0.0129, device='cuda:0', dtype=torch.float16)
tensor(0.7471, device='cuda:0', dtype=torch.float16) tensor(0.0146, device='cuda:0', dtype=torch.float16)
tensor(0.6631, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.up_proj
Validation after prune:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.3994, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
tensor(0.4023, device='cuda:0', dtype=torch.float16) tensor(0.0228, device='cuda:0', dtype=torch.float16)
tensor(0.4497, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
tensor(0.4097, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
Converged at iteration 700
tensor(0.0194, device='cuda:0')
tensor(0.0204, device='cuda:0')
old_score: tensor(0.0228, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0129, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 27.78886651992798
Validation after dual ascent:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.2964, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.3130, device='cuda:0', dtype=torch.float16) tensor(0.0124, device='cuda:0', dtype=torch.float16)
tensor(0.3159, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.3115, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
pruning layer 0 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.2686, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.2708, device='cuda:0', dtype=torch.float16) tensor(0.0037, device='cuda:0', dtype=torch.float16)
tensor(0.3062, device='cuda:0', dtype=torch.float16) tensor(0.0042, device='cuda:0', dtype=torch.float16)
tensor(0.2371, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.1112, device='cuda:0')
old_score: tensor(0.0038, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0026, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.26018857955933
Validation after dual ascent:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0784, device='cuda:0', dtype=torch.float16) tensor(0.0023, device='cuda:0', dtype=torch.float16)
tensor(0.1149, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.0962, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0768, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.q_proj
Validation after prune:
out_inf: tensor(9.1641, device='cuda:0', dtype=torch.float16) tensor(0.7344, device='cuda:0', dtype=torch.float16)
tensor(1.7959, device='cuda:0', dtype=torch.float16) tensor(0.1070, device='cuda:0', dtype=torch.float16)
tensor(1.7676, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
tensor(1.8027, device='cuda:0', dtype=torch.float16) tensor(0.1063, device='cuda:0', dtype=torch.float16)
tensor(0.0634, device='cuda:0')
old_score: tensor(0.1073, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0342, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.137938737869263
Validation after dual ascent:
out_inf: tensor(9.1641, device='cuda:0', dtype=torch.float16) tensor(0.7344, device='cuda:0', dtype=torch.float16)
tensor(1.4766, device='cuda:0', dtype=torch.float16) tensor(0.0330, device='cuda:0', dtype=torch.float16)
tensor(1.4355, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(1.4951, device='cuda:0', dtype=torch.float16) tensor(0.0365, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.0336, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.k_proj
Validation after prune:
out_inf: tensor(7.3672, device='cuda:0', dtype=torch.float16) tensor(0.7319, device='cuda:0', dtype=torch.float16)
tensor(1.7793, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1137, device='cuda:0', dtype=torch.float16)
tensor(1.8398, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(0.0627, device='cuda:0')
old_score: tensor(0.1132, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0339, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.176161050796509
Validation after dual ascent:
out_inf: tensor(7.3672, device='cuda:0', dtype=torch.float16) tensor(0.7319, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.0328, device='cuda:0', dtype=torch.float16)
tensor(1.1572, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(1.2822, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(1.6338, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.v_proj
Validation after prune:
out_inf: tensor(1.5693, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0228, device='cuda:0', dtype=torch.float16)
tensor(0.5469, device='cuda:0', dtype=torch.float16) tensor(0.0234, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.6064, device='cuda:0', dtype=torch.float16) tensor(0.0228, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0161, device='cuda:0')
tensor(0.0219, device='cuda:0')
old_score: tensor(0.0228, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0125, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.405218839645386
Validation after dual ascent:
out_inf: tensor(1.5693, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.3750, device='cuda:0', dtype=torch.float16) tensor(0.0122, device='cuda:0', dtype=torch.float16)
tensor(0.3804, device='cuda:0', dtype=torch.float16) tensor(0.0123, device='cuda:0', dtype=torch.float16)
tensor(0.3770, device='cuda:0', dtype=torch.float16) tensor(0.0133, device='cuda:0', dtype=torch.float16)
tensor(0.4346, device='cuda:0', dtype=torch.float16) tensor(0.0123, device='cuda:0', dtype=torch.float16)
pruning layer 1 name self_attn.o_proj
Validation after prune:
out_inf: tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.0613, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0811, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.0661, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0658, device='cuda:0', dtype=torch.float16) tensor(0.0034, device='cuda:0', dtype=torch.float16)
tensor(0.0203, device='cuda:0')
old_score: tensor(0.0035, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0015, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.105969429016113
Validation after dual ascent:
out_inf: tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.0490, device='cuda:0', dtype=torch.float16) tensor(0.0014, device='cuda:0', dtype=torch.float16)
tensor(0.0566, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0488, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0516, device='cuda:0', dtype=torch.float16) tensor(0.0014, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.gate_proj
Validation after prune:
out_inf: tensor(39.2500, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(11.4219, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(11.3750, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(10.3594, device='cuda:0', dtype=torch.float16) tensor(0.0546, device='cuda:0', dtype=torch.float16)
tensor(12.0469, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0152, device='cuda:0')
tensor(0.0216, device='cuda:0')
old_score: tensor(0.0517, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0280, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.86783194541931
Validation after dual ascent:
out_inf: tensor(39.2500, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(3.3320, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(3.1055, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(3.2812, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(3.3125, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.up_proj
Validation after prune:
out_inf: tensor(35.0625, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(7.5625, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(7.5781, device='cuda:0', dtype=torch.float16) tensor(0.0390, device='cuda:0', dtype=torch.float16)
tensor(6.8906, device='cuda:0', dtype=torch.float16) tensor(0.0411, device='cuda:0', dtype=torch.float16)
tensor(8.2031, device='cuda:0', dtype=torch.float16) tensor(0.0386, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0177, device='cuda:0')
tensor(0.0290, device='cuda:0')
old_score: tensor(0.0394, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0258, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.061526536941528
Validation after dual ascent:
out_inf: tensor(35.0625, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
tensor(2.5469, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
pruning layer 1 name mlp.down_proj
Validation after prune:
out_inf: tensor(2254., device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(27.4688, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(27.2344, device='cuda:0', dtype=torch.float16) tensor(0.0078, device='cuda:0', dtype=torch.float16)
tensor(24.4375, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
tensor(27.3125, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
tensor(0.7235, device='cuda:0')
old_score: tensor(0.0083, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0072, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.07877135276794
Validation after dual ascent:
out_inf: tensor(2254., device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(7.4531, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(7.2500, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(6.6641, device='cuda:0', dtype=torch.float16) tensor(0.0079, device='cuda:0', dtype=torch.float16)
tensor(6.7500, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.q_proj
Validation after prune:
out_inf: tensor(13.2344, device='cuda:0', dtype=torch.float16) tensor(0.9023, device='cuda:0', dtype=torch.float16)
tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.2295, device='cuda:0', dtype=torch.float16)
tensor(3.3633, device='cuda:0', dtype=torch.float16) tensor(0.2307, device='cuda:0', dtype=torch.float16)
tensor(2.8906, device='cuda:0', dtype=torch.float16) tensor(0.2281, device='cuda:0', dtype=torch.float16)
tensor(3.1602, device='cuda:0', dtype=torch.float16) tensor(0.2324, device='cuda:0', dtype=torch.float16)
tensor(0.1695, device='cuda:0')
old_score: tensor(0.2302, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0768, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.194765567779541
Validation after dual ascent:
out_inf: tensor(13.2344, device='cuda:0', dtype=torch.float16) tensor(0.9023, device='cuda:0', dtype=torch.float16)
tensor(1.3145, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(1.3535, device='cuda:0', dtype=torch.float16) tensor(0.0755, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.0817, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.k_proj
Validation after prune:
out_inf: tensor(14.4531, device='cuda:0', dtype=torch.float16) tensor(1.0146, device='cuda:0', dtype=torch.float16)
tensor(3.2305, device='cuda:0', dtype=torch.float16) tensor(0.2371, device='cuda:0', dtype=torch.float16)
tensor(3.0723, device='cuda:0', dtype=torch.float16) tensor(0.2374, device='cuda:0', dtype=torch.float16)
tensor(3.1738, device='cuda:0', dtype=torch.float16) tensor(0.2349, device='cuda:0', dtype=torch.float16)
tensor(3.1719, device='cuda:0', dtype=torch.float16) tensor(0.2380, device='cuda:0', dtype=torch.float16)
tensor(0.1800, device='cuda:0')
old_score: tensor(0.2368, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0784, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.221711158752441
Validation after dual ascent:
out_inf: tensor(14.4531, device='cuda:0', dtype=torch.float16) tensor(1.0146, device='cuda:0', dtype=torch.float16)
tensor(1.6797, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
tensor(1.7246, device='cuda:0', dtype=torch.float16) tensor(0.0771, device='cuda:0', dtype=torch.float16)
tensor(1.4668, device='cuda:0', dtype=torch.float16) tensor(0.0834, device='cuda:0', dtype=torch.float16)
tensor(1.5791, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.0508, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(0.9717, device='cuda:0', dtype=torch.float16) tensor(0.0710, device='cuda:0', dtype=torch.float16)
tensor(1.2021, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0705, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.0734, device='cuda:0')
old_score: tensor(0.0712, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0413, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.108967304229736
Validation after dual ascent:
out_inf: tensor(3.0508, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(0.4563, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
tensor(0.4883, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.4927, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
tensor(0.4744, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
pruning layer 2 name self_attn.o_proj
Validation after prune:
out_inf: tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.0178, device='cuda:0', dtype=torch.float16)
tensor(0.3521, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.3237, device='cuda:0', dtype=torch.float16) tensor(0.0083, device='cuda:0', dtype=torch.float16)
tensor(0.3494, device='cuda:0', dtype=torch.float16) tensor(0.0093, device='cuda:0', dtype=torch.float16)
tensor(0.3037, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(0.0441, device='cuda:0')
old_score: tensor(0.0086, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0057, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.16025424003601
Validation after dual ascent:
out_inf: tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.0178, device='cuda:0', dtype=torch.float16)
tensor(0.1832, device='cuda:0', dtype=torch.float16) tensor(0.0056, device='cuda:0', dtype=torch.float16)
tensor(0.1827, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
tensor(0.2302, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.1779, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.gate_proj
Validation after prune:
out_inf: tensor(2.6719, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
tensor(1.4629, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(1.8223, device='cuda:0', dtype=torch.float16) tensor(0.0662, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0158, device='cuda:0')
tensor(0.0239, device='cuda:0')
old_score: tensor(0.0674, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0425, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.04175615310669
Validation after dual ascent:
out_inf: tensor(2.6719, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(0.6143, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(0.8438, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(0.6714, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
tensor(0.7490, device='cuda:0', dtype=torch.float16) tensor(0.0423, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.up_proj
Validation after prune:
out_inf: tensor(2.5273, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(1.0186, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.0523, device='cuda:0', dtype=torch.float16)
tensor(0.7148, device='cuda:0', dtype=torch.float16) tensor(0.0567, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0182, device='cuda:0')
tensor(0.0207, device='cuda:0')
old_score: tensor(0.0536, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.09992265701294
Validation after dual ascent:
out_inf: tensor(2.5273, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.3811, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.5479, device='cuda:0', dtype=torch.float16) tensor(0.0373, device='cuda:0', dtype=torch.float16)
tensor(0.4229, device='cuda:0', dtype=torch.float16) tensor(0.0417, device='cuda:0', dtype=torch.float16)
tensor(0.4370, device='cuda:0', dtype=torch.float16) tensor(0.0385, device='cuda:0', dtype=torch.float16)
pruning layer 2 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.5957, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.1379, device='cuda:0', dtype=torch.float16) tensor(0.0104, device='cuda:0', dtype=torch.float16)
tensor(0.1873, device='cuda:0', dtype=torch.float16) tensor(0.0103, device='cuda:0', dtype=torch.float16)
tensor(0.2158, device='cuda:0', dtype=torch.float16) tensor(0.0124, device='cuda:0', dtype=torch.float16)
tensor(0.1626, device='cuda:0', dtype=torch.float16) tensor(0.0107, device='cuda:0', dtype=torch.float16)
tensor(0.1231, device='cuda:0')
old_score: tensor(0.0109, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0090, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.49255585670471
Validation after dual ascent:
out_inf: tensor(3.5957, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.1211, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.1111, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.1311, device='cuda:0', dtype=torch.float16) tensor(0.0102, device='cuda:0', dtype=torch.float16)
tensor(0.1329, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.5312, device='cuda:0', dtype=torch.float16) tensor(0.8906, device='cuda:0', dtype=torch.float16)
tensor(3.5273, device='cuda:0', dtype=torch.float16) tensor(0.2891, device='cuda:0', dtype=torch.float16)
tensor(3.5371, device='cuda:0', dtype=torch.float16) tensor(0.2913, device='cuda:0', dtype=torch.float16)
tensor(3.7129, device='cuda:0', dtype=torch.float16) tensor(0.2917, device='cuda:0', dtype=torch.float16)
tensor(3.6816, device='cuda:0', dtype=torch.float16) tensor(0.2900, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0169, device='cuda:0')
tensor(0.0504, device='cuda:0')
old_score: tensor(0.2905, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1340, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.979748249053955
Validation after dual ascent:
out_inf: tensor(17.5312, device='cuda:0', dtype=torch.float16) tensor(0.8906, device='cuda:0', dtype=torch.float16)
tensor(2.1953, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(2.0879, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
tensor(2.1465, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
tensor(1.9980, device='cuda:0', dtype=torch.float16) tensor(0.1333, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.k_proj
Validation after prune:
out_inf: tensor(16.3594, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(4.6289, device='cuda:0', dtype=torch.float16) tensor(0.3083, device='cuda:0', dtype=torch.float16)
tensor(4.5156, device='cuda:0', dtype=torch.float16) tensor(0.3101, device='cuda:0', dtype=torch.float16)
tensor(4.2617, device='cuda:0', dtype=torch.float16) tensor(0.3159, device='cuda:0', dtype=torch.float16)
tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.3086, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0186, device='cuda:0')
tensor(0.0483, device='cuda:0')
old_score: tensor(0.3105, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1371, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.007870435714722
Validation after dual ascent:
out_inf: tensor(16.3594, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(2.0352, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
tensor(2.0977, device='cuda:0', dtype=torch.float16) tensor(0.1461, device='cuda:0', dtype=torch.float16)
tensor(2.1484, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.5977, device='cuda:0', dtype=torch.float16) tensor(0.1875, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.1088, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1115, device='cuda:0', dtype=torch.float16)
tensor(1.1670, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0113, device='cuda:0')
tensor(0.2155, device='cuda:0')
old_score: tensor(0.1099, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0739, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2449567317962646
Validation after dual ascent:
out_inf: tensor(2.5977, device='cuda:0', dtype=torch.float16) tensor(0.1875, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.6895, device='cuda:0', dtype=torch.float16) tensor(0.0725, device='cuda:0', dtype=torch.float16)
tensor(0.7197, device='cuda:0', dtype=torch.float16) tensor(0.0780, device='cuda:0', dtype=torch.float16)
tensor(0.7964, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
pruning layer 3 name self_attn.o_proj
Validation after prune:
out_inf: tensor(1.2393, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
tensor(0.3057, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.3809, device='cuda:0', dtype=torch.float16) tensor(0.0073, device='cuda:0', dtype=torch.float16)
tensor(0.4326, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.3276, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.0480, device='cuda:0')
old_score: tensor(0.0069, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0046, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.238965034484863
Validation after dual ascent:
out_inf: tensor(1.2393, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
tensor(0.1768, device='cuda:0', dtype=torch.float16) tensor(0.0042, device='cuda:0', dtype=torch.float16)
tensor(0.1953, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
tensor(0.2148, device='cuda:0', dtype=torch.float16) tensor(0.0046, device='cuda:0', dtype=torch.float16)
tensor(0.1970, device='cuda:0', dtype=torch.float16) tensor(0.0046, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.1914, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(2.0879, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
tensor(2.1309, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(2.0430, device='cuda:0', dtype=torch.float16) tensor(0.0799, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0197, device='cuda:0')
tensor(0.0216, device='cuda:0')
old_score: tensor(0.0805, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0558, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.799938201904297
Validation after dual ascent:
out_inf: tensor(5.1914, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(1.1270, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0545, device='cuda:0', dtype=torch.float16)
tensor(0.9932, device='cuda:0', dtype=torch.float16) tensor(0.0603, device='cuda:0', dtype=torch.float16)
tensor(1.2949, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.up_proj
Validation after prune:
out_inf: tensor(2.6113, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(1.1865, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0138, device='cuda:0')
tensor(0.0313, device='cuda:0')
old_score: tensor(0.0676, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0513, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.213183403015137
Validation after dual ascent:
out_inf: tensor(2.6113, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(0.6035, device='cuda:0', dtype=torch.float16) tensor(0.0490, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0501, device='cuda:0', dtype=torch.float16)
tensor(0.5190, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(0.5791, device='cuda:0', dtype=torch.float16) tensor(0.0508, device='cuda:0', dtype=torch.float16)
pruning layer 3 name mlp.down_proj
Validation after prune:
out_inf: tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0220, device='cuda:0', dtype=torch.float16)
tensor(0.2046, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.1953, device='cuda:0', dtype=torch.float16) tensor(0.0131, device='cuda:0', dtype=torch.float16)
tensor(0.2239, device='cuda:0', dtype=torch.float16) tensor(0.0138, device='cuda:0', dtype=torch.float16)
tensor(0.2886, device='cuda:0', dtype=torch.float16) tensor(0.0134, device='cuda:0', dtype=torch.float16)
tensor(0.0991, device='cuda:0')
old_score: tensor(0.0133, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0112, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.51244592666626
Validation after dual ascent:
out_inf: tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0220, device='cuda:0', dtype=torch.float16)
tensor(0.1322, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
tensor(0.1423, device='cuda:0', dtype=torch.float16) tensor(0.0110, device='cuda:0', dtype=torch.float16)
tensor(0.1686, device='cuda:0', dtype=torch.float16) tensor(0.0119, device='cuda:0', dtype=torch.float16)
tensor(0.1831, device='cuda:0', dtype=torch.float16) tensor(0.0113, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.8125, device='cuda:0', dtype=torch.float16) tensor(0.9263, device='cuda:0', dtype=torch.float16)
tensor(3.1484, device='cuda:0', dtype=torch.float16) tensor(0.2966, device='cuda:0', dtype=torch.float16)
tensor(2.7656, device='cuda:0', dtype=torch.float16) tensor(0.2930, device='cuda:0', dtype=torch.float16)
tensor(2.6914, device='cuda:0', dtype=torch.float16) tensor(0.2986, device='cuda:0', dtype=torch.float16)
tensor(2.8789, device='cuda:0', dtype=torch.float16) tensor(0.2944, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0169, device='cuda:0')
tensor(0.0636, device='cuda:0')
old_score: tensor(0.2959, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1371, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.994687557220459
Validation after dual ascent:
out_inf: tensor(16.8125, device='cuda:0', dtype=torch.float16) tensor(0.9263, device='cuda:0', dtype=torch.float16)
tensor(1.8164, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(1.6660, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
tensor(1.7002, device='cuda:0', dtype=torch.float16) tensor(0.1458, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.8281, device='cuda:0', dtype=torch.float16) tensor(1.1436, device='cuda:0', dtype=torch.float16)
tensor(3.0840, device='cuda:0', dtype=torch.float16) tensor(0.3064, device='cuda:0', dtype=torch.float16)
tensor(3.2656, device='cuda:0', dtype=torch.float16) tensor(0.3035, device='cuda:0', dtype=torch.float16)
tensor(3.3359, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(3.0801, device='cuda:0', dtype=torch.float16) tensor(0.3044, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0187, device='cuda:0')
tensor(0.0569, device='cuda:0')
old_score: tensor(0.3054, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1370, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.016129493713379
Validation after dual ascent:
out_inf: tensor(20.8281, device='cuda:0', dtype=torch.float16) tensor(1.1436, device='cuda:0', dtype=torch.float16)
tensor(2.0273, device='cuda:0', dtype=torch.float16) tensor(0.1307, device='cuda:0', dtype=torch.float16)
tensor(1.7598, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.8770, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.9941, device='cuda:0', dtype=torch.float16) tensor(0.1859, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.1109, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(1.0811, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(1.1533, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0131, device='cuda:0')
tensor(0.2590, device='cuda:0')
old_score: tensor(0.1121, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0757, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.244851589202881
Validation after dual ascent:
out_inf: tensor(2.9941, device='cuda:0', dtype=torch.float16) tensor(0.1859, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.7661, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
tensor(0.7427, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
tensor(0.7593, device='cuda:0', dtype=torch.float16) tensor(0.0751, device='cuda:0', dtype=torch.float16)
pruning layer 4 name self_attn.o_proj
Validation after prune:
out_inf: tensor(3.1035, device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
tensor(0.3301, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.4360, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.2939, device='cuda:0', dtype=torch.float16) tensor(0.0077, device='cuda:0', dtype=torch.float16)
tensor(0.4365, device='cuda:0', dtype=torch.float16) tensor(0.0094, device='cuda:0', dtype=torch.float16)
tensor(0.0479, device='cuda:0')
old_score: tensor(0.0086, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0060, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.23584794998169
Validation after dual ascent:
out_inf: tensor(3.1035, device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
tensor(0.2002, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.4399, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.1943, device='cuda:0', dtype=torch.float16) tensor(0.0054, device='cuda:0', dtype=torch.float16)
tensor(0.2661, device='cuda:0', dtype=torch.float16) tensor(0.0067, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.1738, device='cuda:0', dtype=torch.float16)
tensor(1.8926, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
tensor(1.7754, device='cuda:0', dtype=torch.float16) tensor(0.1024, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(1.8496, device='cuda:0', dtype=torch.float16) tensor(0.1029, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0111, device='cuda:0')
tensor(0.0542, device='cuda:0')
old_score: tensor(0.1019, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0691, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.201737403869629
Validation after dual ascent:
out_inf: tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.1738, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.9795, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.8374, device='cuda:0', dtype=torch.float16) tensor(0.0734, device='cuda:0', dtype=torch.float16)
tensor(0.9307, device='cuda:0', dtype=torch.float16) tensor(0.0688, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.2969, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(1.0996, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(1.1973, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0087, device='cuda:0')
tensor(0.0471, device='cuda:0')
old_score: tensor(0.0824, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0618, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.20642876625061
Validation after dual ascent:
out_inf: tensor(3.2969, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(0.7188, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
tensor(0.6914, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(0.6299, device='cuda:0', dtype=torch.float16) tensor(0.0657, device='cuda:0', dtype=torch.float16)
tensor(0.6875, device='cuda:0', dtype=torch.float16) tensor(0.0616, device='cuda:0', dtype=torch.float16)
pruning layer 4 name mlp.down_proj
Validation after prune:
out_inf: tensor(7.7539, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.4302, device='cuda:0', dtype=torch.float16) tensor(0.0199, device='cuda:0', dtype=torch.float16)
tensor(0.5249, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
tensor(0.4705, device='cuda:0', dtype=torch.float16) tensor(0.0204, device='cuda:0', dtype=torch.float16)
tensor(0.3940, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
Converged at iteration 800
tensor(0.0197, device='cuda:0')
tensor(0.0231, device='cuda:0')
old_score: tensor(0.0207, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0166, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 80.83489656448364
Validation after dual ascent:
out_inf: tensor(7.7539, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.3267, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.3271, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
tensor(0.3237, device='cuda:0', dtype=torch.float16) tensor(0.0167, device='cuda:0', dtype=torch.float16)
tensor(0.3293, device='cuda:0', dtype=torch.float16) tensor(0.0171, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.5625, device='cuda:0', dtype=torch.float16) tensor(0.9492, device='cuda:0', dtype=torch.float16)
tensor(3.0547, device='cuda:0', dtype=torch.float16) tensor(0.3220, device='cuda:0', dtype=torch.float16)
tensor(3.1641, device='cuda:0', dtype=torch.float16) tensor(0.3198, device='cuda:0', dtype=torch.float16)
tensor(3.0449, device='cuda:0', dtype=torch.float16) tensor(0.3210, device='cuda:0', dtype=torch.float16)
tensor(3.1309, device='cuda:0', dtype=torch.float16) tensor(0.3191, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0199, device='cuda:0')
tensor(0.0549, device='cuda:0')
old_score: tensor(0.3206, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1390, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 9.990613460540771
Validation after dual ascent:
out_inf: tensor(17.5625, device='cuda:0', dtype=torch.float16) tensor(0.9492, device='cuda:0', dtype=torch.float16)
tensor(1.5254, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
tensor(1.6348, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(1.7207, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
tensor(1.7324, device='cuda:0', dtype=torch.float16) tensor(0.1379, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.4531, device='cuda:0', dtype=torch.float16) tensor(1.1543, device='cuda:0', dtype=torch.float16)
tensor(3.1602, device='cuda:0', dtype=torch.float16) tensor(0.3330, device='cuda:0', dtype=torch.float16)
tensor(2.9609, device='cuda:0', dtype=torch.float16) tensor(0.3289, device='cuda:0', dtype=torch.float16)
tensor(3., device='cuda:0', dtype=torch.float16) tensor(0.3330, device='cuda:0', dtype=torch.float16)
tensor(3.5430, device='cuda:0', dtype=torch.float16) tensor(0.3296, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0180, device='cuda:0')
tensor(0.0424, device='cuda:0')
old_score: tensor(0.3311, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1423, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.013386487960815
Validation after dual ascent:
out_inf: tensor(19.4531, device='cuda:0', dtype=torch.float16) tensor(1.1543, device='cuda:0', dtype=torch.float16)
tensor(1.7314, device='cuda:0', dtype=torch.float16) tensor(0.1370, device='cuda:0', dtype=torch.float16)
tensor(1.6699, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(1.8828, device='cuda:0', dtype=torch.float16) tensor(0.1489, device='cuda:0', dtype=torch.float16)
tensor(1.6660, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.v_proj
Validation after prune:
out_inf: tensor(2.5059, device='cuda:0', dtype=torch.float16) tensor(0.2069, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.1228, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1228, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0113, device='cuda:0')
tensor(0.2011, device='cuda:0')
old_score: tensor(0.1224, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0772, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.24542236328125
Validation after dual ascent:
out_inf: tensor(2.5059, device='cuda:0', dtype=torch.float16) tensor(0.2069, device='cuda:0', dtype=torch.float16)
tensor(0.6587, device='cuda:0', dtype=torch.float16) tensor(0.0748, device='cuda:0', dtype=torch.float16)
tensor(0.6426, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(0.7227, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
tensor(0.7124, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
pruning layer 5 name self_attn.o_proj
Validation after prune:
out_inf: tensor(2.2480, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.5845, device='cuda:0', dtype=torch.float16) tensor(0.0213, device='cuda:0', dtype=torch.float16)
tensor(0.6187, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.5679, device='cuda:0', dtype=torch.float16) tensor(0.0221, device='cuda:0', dtype=torch.float16)
tensor(0.7373, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.0422, device='cuda:0')
old_score: tensor(0.0221, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0129, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.181536197662354
Validation after dual ascent:
out_inf: tensor(2.2480, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.2932, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
tensor(0.4043, device='cuda:0', dtype=torch.float16) tensor(0.0134, device='cuda:0', dtype=torch.float16)
tensor(0.3433, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.3682, device='cuda:0', dtype=torch.float16) tensor(0.0131, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.6289, device='cuda:0', dtype=torch.float16) tensor(0.2196, device='cuda:0', dtype=torch.float16)
tensor(2.0781, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(2.0020, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(1.8750, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(2.1914, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0105, device='cuda:0')
tensor(0.0493, device='cuda:0')
old_score: tensor(0.1192, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0659, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.198866844177246
Validation after dual ascent:
out_inf: tensor(4.6289, device='cuda:0', dtype=torch.float16) tensor(0.2196, device='cuda:0', dtype=torch.float16)
tensor(0.8486, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
tensor(1.0879, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(1.0762, device='cuda:0', dtype=torch.float16) tensor(0.0657, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.1094, device='cuda:0', dtype=torch.float16) tensor(0.1660, device='cuda:0', dtype=torch.float16)
tensor(1.3379, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(1.6855, device='cuda:0', dtype=torch.float16) tensor(0.0932, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0082, device='cuda:0')
tensor(0.0416, device='cuda:0')
old_score: tensor(0.0932, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0585, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.201828956604004
Validation after dual ascent:
out_inf: tensor(4.1094, device='cuda:0', dtype=torch.float16) tensor(0.1660, device='cuda:0', dtype=torch.float16)
tensor(1.0479, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
tensor(1.1553, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.5488, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.5908, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
pruning layer 5 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.6582, device='cuda:0', dtype=torch.float16) tensor(0.0619, device='cuda:0', dtype=torch.float16)
tensor(0.4663, device='cuda:0', dtype=torch.float16) tensor(0.0352, device='cuda:0', dtype=torch.float16)
tensor(0.4434, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.4067, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
tensor(0.4697, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0077, device='cuda:0')
tensor(0.0182, device='cuda:0')
old_score: tensor(0.0353, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0206, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 85.50632238388062
Validation after dual ascent:
out_inf: tensor(3.6582, device='cuda:0', dtype=torch.float16) tensor(0.0619, device='cuda:0', dtype=torch.float16)
tensor(0.2759, device='cuda:0', dtype=torch.float16) tensor(0.0202, device='cuda:0', dtype=torch.float16)
tensor(0.2427, device='cuda:0', dtype=torch.float16) tensor(0.0209, device='cuda:0', dtype=torch.float16)
tensor(0.2374, device='cuda:0', dtype=torch.float16) tensor(0.0204, device='cuda:0', dtype=torch.float16)
tensor(0.2827, device='cuda:0', dtype=torch.float16) tensor(0.0207, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.2656, device='cuda:0', dtype=torch.float16) tensor(0.8906, device='cuda:0', dtype=torch.float16)
tensor(4.2734, device='cuda:0', dtype=torch.float16) tensor(0.3401, device='cuda:0', dtype=torch.float16)
tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3398, device='cuda:0', dtype=torch.float16)
tensor(3.9141, device='cuda:0', dtype=torch.float16) tensor(0.3381, device='cuda:0', dtype=torch.float16)
tensor(4.3867, device='cuda:0', dtype=torch.float16) tensor(0.3394, device='cuda:0', dtype=torch.float16)
tensor(0.1792, device='cuda:0')
old_score: tensor(0.3394, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1388, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.240321397781372
Validation after dual ascent:
out_inf: tensor(14.2656, device='cuda:0', dtype=torch.float16) tensor(0.8906, device='cuda:0', dtype=torch.float16)
tensor(2.1992, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(2.2090, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(2.0195, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(2.3145, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.1875, device='cuda:0', dtype=torch.float16) tensor(1.0117, device='cuda:0', dtype=torch.float16)
tensor(4.4180, device='cuda:0', dtype=torch.float16) tensor(0.3562, device='cuda:0', dtype=torch.float16)
tensor(4.5312, device='cuda:0', dtype=torch.float16) tensor(0.3589, device='cuda:0', dtype=torch.float16)
tensor(4.4062, device='cuda:0', dtype=torch.float16) tensor(0.3557, device='cuda:0', dtype=torch.float16)
tensor(4.1289, device='cuda:0', dtype=torch.float16) tensor(0.3560, device='cuda:0', dtype=torch.float16)
tensor(0.1660, device='cuda:0')
old_score: tensor(0.3564, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1399, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.263896703720093
Validation after dual ascent:
out_inf: tensor(17.1875, device='cuda:0', dtype=torch.float16) tensor(1.0117, device='cuda:0', dtype=torch.float16)
tensor(2.2891, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.9297, device='cuda:0', dtype=torch.float16) tensor(0.1409, device='cuda:0', dtype=torch.float16)
tensor(2.4004, device='cuda:0', dtype=torch.float16) tensor(0.1414, device='cuda:0', dtype=torch.float16)
tensor(2.0820, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.8594, device='cuda:0', dtype=torch.float16) tensor(0.2615, device='cuda:0', dtype=torch.float16)
tensor(1.5010, device='cuda:0', dtype=torch.float16) tensor(0.1459, device='cuda:0', dtype=torch.float16)
tensor(1.4238, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(1.3184, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.3887, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0192, device='cuda:0')
tensor(0.0835, device='cuda:0')
old_score: tensor(0.1448, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0752, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.011637449264526
Validation after dual ascent:
out_inf: tensor(3.8594, device='cuda:0', dtype=torch.float16) tensor(0.2615, device='cuda:0', dtype=torch.float16)
tensor(0.7129, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(0.7788, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(0.6851, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
pruning layer 6 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.2734, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.0280, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.0315, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.0352, device='cuda:0')
old_score: tensor(0.0291, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0102, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.158545732498169
Validation after dual ascent:
out_inf: tensor(8.2734, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
tensor(0.3750, device='cuda:0', dtype=torch.float16) tensor(0.0093, device='cuda:0', dtype=torch.float16)
tensor(0.3506, device='cuda:0', dtype=torch.float16) tensor(0.0109, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0108, device='cuda:0', dtype=torch.float16)
tensor(0.3730, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.2722, device='cuda:0', dtype=torch.float16)
tensor(2.0605, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(2.0586, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(2.2969, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(1.8828, device='cuda:0', dtype=torch.float16) tensor(0.1399, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0176, device='cuda:0')
tensor(0.0317, device='cuda:0')
old_score: tensor(0.1394, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0573, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.208969831466675
Validation after dual ascent:
out_inf: tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.2722, device='cuda:0', dtype=torch.float16)
tensor(1.2061, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.9922, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.7539, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
tensor(0.7710, device='cuda:0', dtype=torch.float16) tensor(0.0559, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.7168, device='cuda:0', dtype=torch.float16) tensor(0.1761, device='cuda:0', dtype=torch.float16)
tensor(1.5684, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.0954, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.0993, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0119, device='cuda:0')
tensor(0.0258, device='cuda:0')
old_score: tensor(0.0970, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0499, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.205341339111328
Validation after dual ascent:
out_inf: tensor(3.7168, device='cuda:0', dtype=torch.float16) tensor(0.1761, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0492, device='cuda:0', dtype=torch.float16)
tensor(0.5127, device='cuda:0', dtype=torch.float16) tensor(0.0504, device='cuda:0', dtype=torch.float16)
tensor(0.5273, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
pruning layer 6 name mlp.down_proj
Validation after prune:
out_inf: tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.9385, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
tensor(0.8896, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
tensor(1.0459, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
tensor(0.0647, device='cuda:0')
old_score: tensor(0.0379, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0173, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 99.9749059677124
Validation after dual ascent:
out_inf: tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.2456, device='cuda:0', dtype=torch.float16) tensor(0.0172, device='cuda:0', dtype=torch.float16)
tensor(0.2869, device='cuda:0', dtype=torch.float16) tensor(0.0174, device='cuda:0', dtype=torch.float16)
tensor(0.2178, device='cuda:0', dtype=torch.float16) tensor(0.0179, device='cuda:0', dtype=torch.float16)
tensor(0.2598, device='cuda:0', dtype=torch.float16) tensor(0.0166, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.4688, device='cuda:0', dtype=torch.float16) tensor(0.8745, device='cuda:0', dtype=torch.float16)
tensor(5.1016, device='cuda:0', dtype=torch.float16) tensor(0.3477, device='cuda:0', dtype=torch.float16)
tensor(6.2109, device='cuda:0', dtype=torch.float16) tensor(0.3484, device='cuda:0', dtype=torch.float16)
tensor(4.8164, device='cuda:0', dtype=torch.float16) tensor(0.3503, device='cuda:0', dtype=torch.float16)
tensor(5.2148, device='cuda:0', dtype=torch.float16) tensor(0.3486, device='cuda:0', dtype=torch.float16)
tensor(0.1660, device='cuda:0')
old_score: tensor(0.3489, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1273, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.227948427200317
Validation after dual ascent:
out_inf: tensor(16.4688, device='cuda:0', dtype=torch.float16) tensor(0.8745, device='cuda:0', dtype=torch.float16)
tensor(1.9863, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
tensor(1.9531, device='cuda:0', dtype=torch.float16) tensor(0.1334, device='cuda:0', dtype=torch.float16)
tensor(2.0410, device='cuda:0', dtype=torch.float16) tensor(0.1287, device='cuda:0', dtype=torch.float16)
tensor(2.0469, device='cuda:0', dtype=torch.float16) tensor(0.1252, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.k_proj
Validation after prune:
out_inf: tensor(16.2344, device='cuda:0', dtype=torch.float16) tensor(0.9790, device='cuda:0', dtype=torch.float16)
tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.3594, device='cuda:0', dtype=torch.float16)
tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3611, device='cuda:0', dtype=torch.float16)
tensor(4.2578, device='cuda:0', dtype=torch.float16) tensor(0.3655, device='cuda:0', dtype=torch.float16)
tensor(4.3828, device='cuda:0', dtype=torch.float16) tensor(0.3601, device='cuda:0', dtype=torch.float16)
tensor(0.1452, device='cuda:0')
old_score: tensor(0.3616, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1268, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.251970529556274
Validation after dual ascent:
out_inf: tensor(16.2344, device='cuda:0', dtype=torch.float16) tensor(0.9790, device='cuda:0', dtype=torch.float16)
tensor(1.6768, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(1.9170, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1281, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.1247, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.8438, device='cuda:0', dtype=torch.float16) tensor(0.2627, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.1500, device='cuda:0', dtype=torch.float16)
tensor(1.3604, device='cuda:0', dtype=torch.float16) tensor(0.1489, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.1498, device='cuda:0', dtype=torch.float16)
tensor(0.0596, device='cuda:0')
old_score: tensor(0.1497, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0698, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.228748798370361
Validation after dual ascent:
out_inf: tensor(4.8438, device='cuda:0', dtype=torch.float16) tensor(0.2627, device='cuda:0', dtype=torch.float16)
tensor(0.7046, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.7290, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.7690, device='cuda:0', dtype=torch.float16) tensor(0.0704, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
pruning layer 7 name self_attn.o_proj
Validation after prune:
out_inf: tensor(3.6582, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.7910, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(1.0420, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(0.9238, device='cuda:0', dtype=torch.float16) tensor(0.0284, device='cuda:0', dtype=torch.float16)
tensor(0.0355, device='cuda:0')
old_score: tensor(0.0296, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0125, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.097300052642822
Validation after dual ascent:
out_inf: tensor(3.6582, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.3379, device='cuda:0', dtype=torch.float16) tensor(0.0109, device='cuda:0', dtype=torch.float16)
tensor(0.4082, device='cuda:0', dtype=torch.float16) tensor(0.0136, device='cuda:0', dtype=torch.float16)
tensor(0.5469, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.3018, device='cuda:0', dtype=torch.float16) tensor(0.0113, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.5742, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(2.5859, device='cuda:0', dtype=torch.float16) tensor(0.1578, device='cuda:0', dtype=torch.float16)
tensor(2.6875, device='cuda:0', dtype=torch.float16) tensor(0.1575, device='cuda:0', dtype=torch.float16)
tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(2.6328, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0163, device='cuda:0')
tensor(0.0387, device='cuda:0')
old_score: tensor(0.1576, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0621, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2162463665008545
Validation after dual ascent:
out_inf: tensor(4.5742, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(1.1621, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(1.2324, device='cuda:0', dtype=torch.float16) tensor(0.0650, device='cuda:0', dtype=torch.float16)
tensor(0.9736, device='cuda:0', dtype=torch.float16) tensor(0.0630, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.2461, device='cuda:0', dtype=torch.float16) tensor(0.1907, device='cuda:0', dtype=torch.float16)
tensor(1.2686, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(1.3135, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
tensor(1.3096, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(1.3193, device='cuda:0', dtype=torch.float16) tensor(0.1092, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0085, device='cuda:0')
tensor(0.0313, device='cuda:0')
old_score: tensor(0.1090, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0545, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.206064939498901
Validation after dual ascent:
out_inf: tensor(3.2461, device='cuda:0', dtype=torch.float16) tensor(0.1907, device='cuda:0', dtype=torch.float16)
tensor(0.6812, device='cuda:0', dtype=torch.float16) tensor(0.0524, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
tensor(0.5771, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
tensor(0.7295, device='cuda:0', dtype=torch.float16) tensor(0.0534, device='cuda:0', dtype=torch.float16)
pruning layer 7 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.2793, device='cuda:0', dtype=torch.float16) tensor(0.0644, device='cuda:0', dtype=torch.float16)
tensor(0.6895, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.7285, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0365, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
Converged at iteration 900
tensor(0.0165, device='cuda:0')
tensor(0.0385, device='cuda:0')
old_score: tensor(0.0357, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0194, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 90.35739541053772
Validation after dual ascent:
out_inf: tensor(2.2793, device='cuda:0', dtype=torch.float16) tensor(0.0644, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0185, device='cuda:0', dtype=torch.float16)
tensor(0.2822, device='cuda:0', dtype=torch.float16) tensor(0.0205, device='cuda:0', dtype=torch.float16)
tensor(0.2627, device='cuda:0', dtype=torch.float16) tensor(0.0199, device='cuda:0', dtype=torch.float16)
tensor(0.2568, device='cuda:0', dtype=torch.float16) tensor(0.0189, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.3438, device='cuda:0', dtype=torch.float16) tensor(0.8506, device='cuda:0', dtype=torch.float16)
tensor(5.5938, device='cuda:0', dtype=torch.float16) tensor(0.3438, device='cuda:0', dtype=torch.float16)
tensor(5.5469, device='cuda:0', dtype=torch.float16) tensor(0.3452, device='cuda:0', dtype=torch.float16)
tensor(5.5469, device='cuda:0', dtype=torch.float16) tensor(0.3484, device='cuda:0', dtype=torch.float16)
tensor(5.9766, device='cuda:0', dtype=torch.float16) tensor(0.3450, device='cuda:0', dtype=torch.float16)
tensor(0.1022, device='cuda:0')
old_score: tensor(0.3455, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1342, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.227338314056396
Validation after dual ascent:
out_inf: tensor(17.3438, device='cuda:0', dtype=torch.float16) tensor(0.8506, device='cuda:0', dtype=torch.float16)
tensor(2.4727, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(2.3203, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(2.5352, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
tensor(2.4512, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.9531, device='cuda:0', dtype=torch.float16) tensor(1.0322, device='cuda:0', dtype=torch.float16)
tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.3638, device='cuda:0', dtype=torch.float16)
tensor(4.2305, device='cuda:0', dtype=torch.float16) tensor(0.3643, device='cuda:0', dtype=torch.float16)
tensor(4.1875, device='cuda:0', dtype=torch.float16) tensor(0.3633, device='cuda:0', dtype=torch.float16)
tensor(4.0234, device='cuda:0', dtype=torch.float16) tensor(0.3640, device='cuda:0', dtype=torch.float16)
tensor(0.0932, device='cuda:0')
old_score: tensor(0.3640, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1340, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.25570821762085
Validation after dual ascent:
out_inf: tensor(17.9531, device='cuda:0', dtype=torch.float16) tensor(1.0322, device='cuda:0', dtype=torch.float16)
tensor(1.7598, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(2.0664, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
tensor(1.8311, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(1.8018, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.2603, device='cuda:0', dtype=torch.float16)
tensor(1.3857, device='cuda:0', dtype=torch.float16) tensor(0.1533, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(1.4473, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.1530, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0161, device='cuda:0')
tensor(0.0964, device='cuda:0')
old_score: tensor(0.1533, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0757, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.251795768737793
Validation after dual ascent:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.2603, device='cuda:0', dtype=torch.float16)
tensor(0.7568, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.8340, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
tensor(0.7690, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
tensor(0.7676, device='cuda:0', dtype=torch.float16) tensor(0.0741, device='cuda:0', dtype=torch.float16)
pruning layer 8 name self_attn.o_proj
Validation after prune:
out_inf: tensor(3.6543, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0290, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
tensor(0.8320, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(0.0305, device='cuda:0')
old_score: tensor(0.0330, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0156, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.177865266799927
Validation after dual ascent:
out_inf: tensor(3.6543, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.3574, device='cuda:0', dtype=torch.float16) tensor(0.0133, device='cuda:0', dtype=torch.float16)
tensor(0.3926, device='cuda:0', dtype=torch.float16) tensor(0.0176, device='cuda:0', dtype=torch.float16)
tensor(0.4492, device='cuda:0', dtype=torch.float16) tensor(0.0180, device='cuda:0', dtype=torch.float16)
tensor(0.3672, device='cuda:0', dtype=torch.float16) tensor(0.0137, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.gate_proj
Validation after prune:
out_inf: tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(2.5469, device='cuda:0', dtype=torch.float16) tensor(0.1431, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(2.3867, device='cuda:0', dtype=torch.float16) tensor(0.1439, device='cuda:0', dtype=torch.float16)
tensor(2.1367, device='cuda:0', dtype=torch.float16) tensor(0.1439, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0116, device='cuda:0')
tensor(0.0501, device='cuda:0')
old_score: tensor(0.1438, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0676, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.208237648010254
Validation after dual ascent:
out_inf: tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(1.6992, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(0.9600, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(0.9883, device='cuda:0', dtype=torch.float16) tensor(0.0675, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.9570, device='cuda:0', dtype=torch.float16) tensor(0.1995, device='cuda:0', dtype=torch.float16)
tensor(2.3242, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.6641, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.5801, device='cuda:0', dtype=torch.float16) tensor(0.1146, device='cuda:0', dtype=torch.float16)
tensor(1.6211, device='cuda:0', dtype=torch.float16) tensor(0.1153, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0080, device='cuda:0')
tensor(0.0434, device='cuda:0')
old_score: tensor(0.1152, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0610, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.20604133605957
Validation after dual ascent:
out_inf: tensor(7.9570, device='cuda:0', dtype=torch.float16) tensor(0.1995, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0596, device='cuda:0', dtype=torch.float16)
tensor(0.6768, device='cuda:0', dtype=torch.float16) tensor(0.0631, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0609, device='cuda:0', dtype=torch.float16)
tensor(0.7139, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
pruning layer 8 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.3008, device='cuda:0', dtype=torch.float16) tensor(0.0620, device='cuda:0', dtype=torch.float16)
tensor(0.7251, device='cuda:0', dtype=torch.float16) tensor(0.0360, device='cuda:0', dtype=torch.float16)
tensor(0.7314, device='cuda:0', dtype=torch.float16) tensor(0.0371, device='cuda:0', dtype=torch.float16)
tensor(0.6787, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(1.0029, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0148, device='cuda:0')
tensor(0.0321, device='cuda:0')
old_score: tensor(0.0366, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0235, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 65.96558570861816
Validation after dual ascent:
out_inf: tensor(3.3008, device='cuda:0', dtype=torch.float16) tensor(0.0620, device='cuda:0', dtype=torch.float16)
tensor(0.3535, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.6685, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.4062, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
tensor(0.9067, device='cuda:0', dtype=torch.float16) tensor(0.0230, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.6328, device='cuda:0', dtype=torch.float16) tensor(0.8716, device='cuda:0', dtype=torch.float16)
tensor(3.7656, device='cuda:0', dtype=torch.float16) tensor(0.3499, device='cuda:0', dtype=torch.float16)
tensor(3.9727, device='cuda:0', dtype=torch.float16) tensor(0.3496, device='cuda:0', dtype=torch.float16)
tensor(3.8184, device='cuda:0', dtype=torch.float16) tensor(0.3557, device='cuda:0', dtype=torch.float16)
tensor(4.1953, device='cuda:0', dtype=torch.float16) tensor(0.3508, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0190, device='cuda:0')
tensor(0.0575, device='cuda:0')
old_score: tensor(0.3513, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1442, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.248515844345093
Validation after dual ascent:
out_inf: tensor(15.6328, device='cuda:0', dtype=torch.float16) tensor(0.8716, device='cuda:0', dtype=torch.float16)
tensor(1.7139, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(2.0078, device='cuda:0', dtype=torch.float16) tensor(0.1493, device='cuda:0', dtype=torch.float16)
tensor(1.9961, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(1.6914, device='cuda:0', dtype=torch.float16) tensor(0.1420, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.7344, device='cuda:0', dtype=torch.float16) tensor(1.0928, device='cuda:0', dtype=torch.float16)
tensor(3.8203, device='cuda:0', dtype=torch.float16) tensor(0.3779, device='cuda:0', dtype=torch.float16)
tensor(3.5859, device='cuda:0', dtype=torch.float16) tensor(0.3750, device='cuda:0', dtype=torch.float16)
tensor(3.5000, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(3.5820, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(0.0248, device='cuda:0')
old_score: tensor(0.3772, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1455, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.238571166992188
Validation after dual ascent:
out_inf: tensor(18.7344, device='cuda:0', dtype=torch.float16) tensor(1.0928, device='cuda:0', dtype=torch.float16)
tensor(1.6729, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(2.1074, device='cuda:0', dtype=torch.float16) tensor(0.1510, device='cuda:0', dtype=torch.float16)
tensor(1.9209, device='cuda:0', dtype=torch.float16) tensor(0.1462, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.v_proj
Validation after prune:
out_inf: tensor(6.5547, device='cuda:0', dtype=torch.float16) tensor(0.2642, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(1.4580, device='cuda:0', dtype=torch.float16) tensor(0.1562, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(1.5371, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0185, device='cuda:0')
tensor(0.2499, device='cuda:0')
old_score: tensor(0.1561, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0823, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.502800703048706
Validation after dual ascent:
out_inf: tensor(6.5547, device='cuda:0', dtype=torch.float16) tensor(0.2642, device='cuda:0', dtype=torch.float16)
tensor(0.7051, device='cuda:0', dtype=torch.float16) tensor(0.0805, device='cuda:0', dtype=torch.float16)
tensor(0.6851, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
tensor(0.6758, device='cuda:0', dtype=torch.float16) tensor(0.0812, device='cuda:0', dtype=torch.float16)
pruning layer 9 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.2617, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.8418, device='cuda:0', dtype=torch.float16) tensor(0.0305, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0318, device='cuda:0', dtype=torch.float16)
tensor(1.0977, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.7393, device='cuda:0', dtype=torch.float16) tensor(0.0286, device='cuda:0', dtype=torch.float16)
tensor(0.0222, device='cuda:0')
old_score: tensor(0.0315, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0171, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.191291332244873
Validation after dual ascent:
out_inf: tensor(4.2617, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.4014, device='cuda:0', dtype=torch.float16) tensor(0.0162, device='cuda:0', dtype=torch.float16)
tensor(0.4473, device='cuda:0', dtype=torch.float16) tensor(0.0171, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.3643, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.1016, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(2.3711, device='cuda:0', dtype=torch.float16) tensor(0.1467, device='cuda:0', dtype=torch.float16)
tensor(2.1250, device='cuda:0', dtype=torch.float16) tensor(0.1493, device='cuda:0', dtype=torch.float16)
tensor(2.6758, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(2.3672, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0120, device='cuda:0')
tensor(0.0715, device='cuda:0')
old_score: tensor(0.1466, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0709, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2378928661346436
Validation after dual ascent:
out_inf: tensor(5.1016, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.0704, device='cuda:0', dtype=torch.float16)
tensor(1.4268, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
tensor(1.0322, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
tensor(1.4785, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.0742, device='cuda:0', dtype=torch.float16) tensor(0.2070, device='cuda:0', dtype=torch.float16)
tensor(1.5137, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.4238, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.7949, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
tensor(1.5508, device='cuda:0', dtype=torch.float16) tensor(0.1180, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0088, device='cuda:0')
tensor(0.0621, device='cuda:0')
old_score: tensor(0.1184, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0651, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.20123291015625
Validation after dual ascent:
out_inf: tensor(4.0742, device='cuda:0', dtype=torch.float16) tensor(0.2070, device='cuda:0', dtype=torch.float16)
tensor(1.0791, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
tensor(0.6680, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(0.9434, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.6885, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
pruning layer 9 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.9980, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.7314, device='cuda:0', dtype=torch.float16) tensor(0.0387, device='cuda:0', dtype=torch.float16)
tensor(0.7061, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.7520, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0192, device='cuda:0')
tensor(0.0440, device='cuda:0')
old_score: tensor(0.0391, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0263, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.39384913444519
Validation after dual ascent:
out_inf: tensor(1.9980, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.4556, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
tensor(0.3591, device='cuda:0', dtype=torch.float16) tensor(0.0270, device='cuda:0', dtype=torch.float16)
tensor(0.3176, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.3604, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.4844, device='cuda:0', dtype=torch.float16) tensor(0.8755, device='cuda:0', dtype=torch.float16)
tensor(4.0820, device='cuda:0', dtype=torch.float16) tensor(0.3594, device='cuda:0', dtype=torch.float16)
tensor(4.5234, device='cuda:0', dtype=torch.float16) tensor(0.3518, device='cuda:0', dtype=torch.float16)
tensor(4.7344, device='cuda:0', dtype=torch.float16) tensor(0.3545, device='cuda:0', dtype=torch.float16)
tensor(4.1797, device='cuda:0', dtype=torch.float16) tensor(0.3547, device='cuda:0', dtype=torch.float16)
tensor(0.1294, device='cuda:0')
old_score: tensor(0.3550, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1484, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.213218688964844
Validation after dual ascent:
out_inf: tensor(16.4844, device='cuda:0', dtype=torch.float16) tensor(0.8755, device='cuda:0', dtype=torch.float16)
tensor(1.9893, device='cuda:0', dtype=torch.float16) tensor(0.1464, device='cuda:0', dtype=torch.float16)
tensor(2.0176, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.8008, device='cuda:0', dtype=torch.float16) tensor(0.1486, device='cuda:0', dtype=torch.float16)
tensor(1.8213, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.1396, device='cuda:0', dtype=torch.float16)
tensor(3.8906, device='cuda:0', dtype=torch.float16) tensor(0.3955, device='cuda:0', dtype=torch.float16)
tensor(3.7109, device='cuda:0', dtype=torch.float16) tensor(0.3894, device='cuda:0', dtype=torch.float16)
tensor(3.7539, device='cuda:0', dtype=torch.float16) tensor(0.3918, device='cuda:0', dtype=torch.float16)
tensor(3.8301, device='cuda:0', dtype=torch.float16) tensor(0.3926, device='cuda:0', dtype=torch.float16)
tensor(0.1382, device='cuda:0')
old_score: tensor(0.3923, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1505, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.237988710403442
Validation after dual ascent:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.1396, device='cuda:0', dtype=torch.float16)
tensor(2.0098, device='cuda:0', dtype=torch.float16) tensor(0.1483, device='cuda:0', dtype=torch.float16)
tensor(1.7705, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.1505, device='cuda:0', dtype=torch.float16)
tensor(1.8066, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.1172, device='cuda:0', dtype=torch.float16) tensor(0.2781, device='cuda:0', dtype=torch.float16)
tensor(1.3955, device='cuda:0', dtype=torch.float16) tensor(0.1603, device='cuda:0', dtype=torch.float16)
tensor(1.3857, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(1.5146, device='cuda:0', dtype=torch.float16) tensor(0.1583, device='cuda:0', dtype=torch.float16)
tensor(1.3857, device='cuda:0', dtype=torch.float16) tensor(0.1591, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0171, device='cuda:0')
tensor(0.0793, device='cuda:0')
old_score: tensor(0.1589, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0839, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.956960916519165
Validation after dual ascent:
out_inf: tensor(7.1172, device='cuda:0', dtype=torch.float16) tensor(0.2781, device='cuda:0', dtype=torch.float16)
tensor(0.7397, device='cuda:0', dtype=torch.float16) tensor(0.0829, device='cuda:0', dtype=torch.float16)
tensor(0.7402, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(0.9121, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(0.7070, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
pruning layer 10 name self_attn.o_proj
Validation after prune:
out_inf: tensor(6.7656, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.9277, device='cuda:0', dtype=torch.float16) tensor(0.0432, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0395, device='cuda:0', dtype=torch.float16)
Converged at iteration 700
tensor(0.0128, device='cuda:0')
tensor(0.0238, device='cuda:0')
old_score: tensor(0.0426, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0245, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.65816617012024
Validation after dual ascent:
out_inf: tensor(6.7656, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.4043, device='cuda:0', dtype=torch.float16) tensor(0.0245, device='cuda:0', dtype=torch.float16)
tensor(0.4609, device='cuda:0', dtype=torch.float16) tensor(0.0240, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.3638, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.3242, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(2.6250, device='cuda:0', dtype=torch.float16) tensor(0.1466, device='cuda:0', dtype=torch.float16)
tensor(2.5098, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(2.5996, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(2.7363, device='cuda:0', dtype=torch.float16) tensor(0.1454, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0114, device='cuda:0')
tensor(0.0620, device='cuda:0')
old_score: tensor(0.1458, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0701, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.205127716064453
Validation after dual ascent:
out_inf: tensor(6.3242, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(1.3965, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(1.4590, device='cuda:0', dtype=torch.float16) tensor(0.0694, device='cuda:0', dtype=torch.float16)
tensor(1.4639, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.up_proj
Validation after prune:
out_inf: tensor(3.2949, device='cuda:0', dtype=torch.float16) tensor(0.2148, device='cuda:0', dtype=torch.float16)
tensor(1.3906, device='cuda:0', dtype=torch.float16) tensor(0.1209, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1188, device='cuda:0', dtype=torch.float16)
tensor(1.4902, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0087, device='cuda:0')
tensor(0.0556, device='cuda:0')
old_score: tensor(0.1196, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0655, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.207992315292358
Validation after dual ascent:
out_inf: tensor(3.2949, device='cuda:0', dtype=torch.float16) tensor(0.2148, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.0653, device='cuda:0', dtype=torch.float16)
tensor(0.6890, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.6660, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
tensor(0.7021, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
pruning layer 10 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.6533, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.8281, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.7783, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(0.8857, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0145, device='cuda:0')
tensor(0.0331, device='cuda:0')
old_score: tensor(0.0415, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0281, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.39337873458862
Validation after dual ascent:
out_inf: tensor(1.6533, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.3721, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
tensor(0.3613, device='cuda:0', dtype=torch.float16) tensor(0.0277, device='cuda:0', dtype=torch.float16)
tensor(0.3979, device='cuda:0', dtype=torch.float16) tensor(0.0286, device='cuda:0', dtype=torch.float16)
tensor(0.4932, device='cuda:0', dtype=torch.float16) tensor(0.0278, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.q_proj
Validation after prune:
out_inf: tensor(19.3281, device='cuda:0', dtype=torch.float16) tensor(0.8667, device='cuda:0', dtype=torch.float16)
tensor(5.7656, device='cuda:0', dtype=torch.float16) tensor(0.3589, device='cuda:0', dtype=torch.float16)
tensor(5.4453, device='cuda:0', dtype=torch.float16) tensor(0.3550, device='cuda:0', dtype=torch.float16)
tensor(5.8242, device='cuda:0', dtype=torch.float16) tensor(0.3596, device='cuda:0', dtype=torch.float16)
tensor(6.2891, device='cuda:0', dtype=torch.float16) tensor(0.3579, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0173, device='cuda:0')
tensor(0.0961, device='cuda:0')
old_score: tensor(0.3579, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1536, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.246730089187622
Validation after dual ascent:
out_inf: tensor(19.3281, device='cuda:0', dtype=torch.float16) tensor(0.8667, device='cuda:0', dtype=torch.float16)
tensor(2.7422, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(2.5195, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(2.9531, device='cuda:0', dtype=torch.float16) tensor(0.1533, device='cuda:0', dtype=torch.float16)
tensor(3.6250, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.1045, device='cuda:0', dtype=torch.float16)
tensor(4.5547, device='cuda:0', dtype=torch.float16) tensor(0.3792, device='cuda:0', dtype=torch.float16)
tensor(4.4609, device='cuda:0', dtype=torch.float16) tensor(0.3740, device='cuda:0', dtype=torch.float16)
tensor(4.9609, device='cuda:0', dtype=torch.float16) tensor(0.3794, device='cuda:0', dtype=torch.float16)
tensor(4.2578, device='cuda:0', dtype=torch.float16) tensor(0.3806, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0195, device='cuda:0')
tensor(0.0911, device='cuda:0')
old_score: tensor(0.3784, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1525, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.251436233520508
Validation after dual ascent:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.1045, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(1.9668, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(2.2812, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(2.0234, device='cuda:0', dtype=torch.float16) tensor(0.1514, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.9531, device='cuda:0', dtype=torch.float16) tensor(0.3196, device='cuda:0', dtype=torch.float16)
tensor(1.6494, device='cuda:0', dtype=torch.float16) tensor(0.1788, device='cuda:0', dtype=torch.float16)
tensor(1.6777, device='cuda:0', dtype=torch.float16) tensor(0.1775, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1785, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1793, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0093, device='cuda:0')
tensor(0.1781, device='cuda:0')
old_score: tensor(0.1786, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0975, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.248361587524414
Validation after dual ascent:
out_inf: tensor(7.9531, device='cuda:0', dtype=torch.float16) tensor(0.3196, device='cuda:0', dtype=torch.float16)
tensor(0.8691, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(0.8506, device='cuda:0', dtype=torch.float16) tensor(0.0987, device='cuda:0', dtype=torch.float16)
tensor(0.8774, device='cuda:0', dtype=torch.float16) tensor(0.0968, device='cuda:0', dtype=torch.float16)
tensor(0.8403, device='cuda:0', dtype=torch.float16) tensor(0.0973, device='cuda:0', dtype=torch.float16)
pruning layer 11 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.7617, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(1.0029, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(1.2090, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.8438, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0131, device='cuda:0')
tensor(0.0261, device='cuda:0')
old_score: tensor(0.0491, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0240, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.443315505981445
Validation after dual ascent:
out_inf: tensor(4.7617, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(0.4961, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
tensor(0.6797, device='cuda:0', dtype=torch.float16) tensor(0.0237, device='cuda:0', dtype=torch.float16)
tensor(0.6572, device='cuda:0', dtype=torch.float16) tensor(0.0307, device='cuda:0', dtype=torch.float16)
tensor(0.6191, device='cuda:0', dtype=torch.float16) tensor(0.0200, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.0625, device='cuda:0', dtype=torch.float16) tensor(0.3018, device='cuda:0', dtype=torch.float16)
tensor(2.5840, device='cuda:0', dtype=torch.float16) tensor(0.1549, device='cuda:0', dtype=torch.float16)
tensor(2.5938, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(2.8496, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(2.3047, device='cuda:0', dtype=torch.float16) tensor(0.1538, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0130, device='cuda:0')
tensor(0.0707, device='cuda:0')
old_score: tensor(0.1536, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0744, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.221429109573364
Validation after dual ascent:
out_inf: tensor(6.0625, device='cuda:0', dtype=torch.float16) tensor(0.3018, device='cuda:0', dtype=torch.float16)
tensor(1.8740, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.0752, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.0725, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.3047, device='cuda:0', dtype=torch.float16) tensor(0.2249, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1285, device='cuda:0', dtype=torch.float16)
tensor(1.4570, device='cuda:0', dtype=torch.float16) tensor(0.1268, device='cuda:0', dtype=torch.float16)
tensor(1.4902, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0098, device='cuda:0')
tensor(0.0648, device='cuda:0')
old_score: tensor(0.1274, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0704, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.19402551651001
Validation after dual ascent:
out_inf: tensor(4.3047, device='cuda:0', dtype=torch.float16) tensor(0.2249, device='cuda:0', dtype=torch.float16)
tensor(0.8359, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(0.6396, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
pruning layer 11 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.4717, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.8066, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0462, device='cuda:0', dtype=torch.float16)
tensor(1.0566, device='cuda:0', dtype=torch.float16) tensor(0.0463, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0111, device='cuda:0')
tensor(0.0198, device='cuda:0')
old_score: tensor(0.0471, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0301, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.31635904312134
Validation after dual ascent:
out_inf: tensor(1.4717, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.5459, device='cuda:0', dtype=torch.float16) tensor(0.0300, device='cuda:0', dtype=torch.float16)
tensor(0.4990, device='cuda:0', dtype=torch.float16) tensor(0.0300, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0313, device='cuda:0', dtype=torch.float16)
tensor(0.4756, device='cuda:0', dtype=torch.float16) tensor(0.0292, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.q_proj
Validation after prune:
out_inf: tensor(21.4688, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(4.9297, device='cuda:0', dtype=torch.float16) tensor(0.3647, device='cuda:0', dtype=torch.float16)
tensor(4.8906, device='cuda:0', dtype=torch.float16) tensor(0.3618, device='cuda:0', dtype=torch.float16)
tensor(4.6484, device='cuda:0', dtype=torch.float16) tensor(0.3682, device='cuda:0', dtype=torch.float16)
tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(0.1241, device='cuda:0')
old_score: tensor(0.3650, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1591, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.224153518676758
Validation after dual ascent:
out_inf: tensor(21.4688, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(2.0742, device='cuda:0', dtype=torch.float16) tensor(0.1570, device='cuda:0', dtype=torch.float16)
tensor(2.0469, device='cuda:0', dtype=torch.float16) tensor(0.1605, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.1653, device='cuda:0', dtype=torch.float16)
tensor(2.0371, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.1094, device='cuda:0', dtype=torch.float16) tensor(1.0986, device='cuda:0', dtype=torch.float16)
tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.3962, device='cuda:0', dtype=torch.float16)
tensor(4.2031, device='cuda:0', dtype=torch.float16) tensor(0.3931, device='cuda:0', dtype=torch.float16)
tensor(4.6250, device='cuda:0', dtype=torch.float16) tensor(0.3984, device='cuda:0', dtype=torch.float16)
tensor(4.3125, device='cuda:0', dtype=torch.float16) tensor(0.3953, device='cuda:0', dtype=torch.float16)
tensor(0.1325, device='cuda:0')
old_score: tensor(0.3958, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1624, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.20466136932373
Validation after dual ascent:
out_inf: tensor(17.1094, device='cuda:0', dtype=torch.float16) tensor(1.0986, device='cuda:0', dtype=torch.float16)
tensor(2.1113, device='cuda:0', dtype=torch.float16) tensor(0.1603, device='cuda:0', dtype=torch.float16)
tensor(1.9863, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
tensor(1.9629, device='cuda:0', dtype=torch.float16) tensor(0.1686, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1570, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.6875, device='cuda:0', dtype=torch.float16) tensor(0.3149, device='cuda:0', dtype=torch.float16)
tensor(1.5146, device='cuda:0', dtype=torch.float16) tensor(0.1788, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1772, device='cuda:0', dtype=torch.float16)
tensor(1.5381, device='cuda:0', dtype=torch.float16) tensor(0.1787, device='cuda:0', dtype=torch.float16)
tensor(1.5234, device='cuda:0', dtype=torch.float16) tensor(0.1787, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0169, device='cuda:0')
tensor(0.0799, device='cuda:0')
old_score: tensor(0.1783, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0958, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.92071795463562
Validation after dual ascent:
out_inf: tensor(5.6875, device='cuda:0', dtype=torch.float16) tensor(0.3149, device='cuda:0', dtype=torch.float16)
tensor(0.8525, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(0.8838, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0993, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
pruning layer 12 name self_attn.o_proj
Validation after prune:
out_inf: tensor(6.4766, device='cuda:0', dtype=torch.float16) tensor(0.0876, device='cuda:0', dtype=torch.float16)
tensor(1.7227, device='cuda:0', dtype=torch.float16) tensor(0.0532, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0169, device='cuda:0')
tensor(0.0333, device='cuda:0')
old_score: tensor(0.0555, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0252, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.428395986557007
Validation after dual ascent:
out_inf: tensor(6.4766, device='cuda:0', dtype=torch.float16) tensor(0.0876, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0230, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0259, device='cuda:0', dtype=torch.float16)
tensor(0.6777, device='cuda:0', dtype=torch.float16) tensor(0.0294, device='cuda:0', dtype=torch.float16)
tensor(0.6553, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.gate_proj
Validation after prune:
out_inf: tensor(5.0547, device='cuda:0', dtype=torch.float16) tensor(0.3169, device='cuda:0', dtype=torch.float16)
tensor(2.3516, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
tensor(2.1172, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(2.2734, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(2.4219, device='cuda:0', dtype=torch.float16) tensor(0.1593, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0143, device='cuda:0')
tensor(0.0696, device='cuda:0')
old_score: tensor(0.1578, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0734, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.213439464569092
Validation after dual ascent:
out_inf: tensor(5.0547, device='cuda:0', dtype=torch.float16) tensor(0.3169, device='cuda:0', dtype=torch.float16)
tensor(1.4854, device='cuda:0', dtype=torch.float16) tensor(0.0734, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(1.4580, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.2322, device='cuda:0', dtype=torch.float16)
tensor(1.5410, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.4473, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.4609, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0103, device='cuda:0')
tensor(0.0650, device='cuda:0')
old_score: tensor(0.1318, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0705, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2051355838775635
Validation after dual ascent:
out_inf: tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.2322, device='cuda:0', dtype=torch.float16)
tensor(0.7930, device='cuda:0', dtype=torch.float16) tensor(0.0705, device='cuda:0', dtype=torch.float16)
tensor(0.6660, device='cuda:0', dtype=torch.float16) tensor(0.0703, device='cuda:0', dtype=torch.float16)
tensor(0.7168, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
tensor(0.7368, device='cuda:0', dtype=torch.float16) tensor(0.0678, device='cuda:0', dtype=torch.float16)
pruning layer 12 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.4014, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.8809, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.7910, device='cuda:0', dtype=torch.float16) tensor(0.0495, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0125, device='cuda:0')
tensor(0.0264, device='cuda:0')
old_score: tensor(0.0494, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0307, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.35653376579285
Validation after dual ascent:
out_inf: tensor(1.4014, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.4436, device='cuda:0', dtype=torch.float16) tensor(0.0306, device='cuda:0', dtype=torch.float16)
tensor(0.5107, device='cuda:0', dtype=torch.float16) tensor(0.0302, device='cuda:0', dtype=torch.float16)
tensor(0.4707, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.3672, device='cuda:0', dtype=torch.float16) tensor(0.0292, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.1719, device='cuda:0', dtype=torch.float16) tensor(0.8594, device='cuda:0', dtype=torch.float16)
tensor(4.5547, device='cuda:0', dtype=torch.float16) tensor(0.3586, device='cuda:0', dtype=torch.float16)
tensor(4.8516, device='cuda:0', dtype=torch.float16) tensor(0.3574, device='cuda:0', dtype=torch.float16)
tensor(4.3398, device='cuda:0', dtype=torch.float16) tensor(0.3645, device='cuda:0', dtype=torch.float16)
tensor(4.5430, device='cuda:0', dtype=torch.float16) tensor(0.3594, device='cuda:0', dtype=torch.float16)
tensor(0.1961, device='cuda:0')
old_score: tensor(0.3599, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1560, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.229140996932983
Validation after dual ascent:
out_inf: tensor(16.1719, device='cuda:0', dtype=torch.float16) tensor(0.8594, device='cuda:0', dtype=torch.float16)
tensor(2.1406, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(1.9805, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(2.1934, device='cuda:0', dtype=torch.float16) tensor(0.1628, device='cuda:0', dtype=torch.float16)
tensor(2.1660, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.2969, device='cuda:0', dtype=torch.float16) tensor(1.0381, device='cuda:0', dtype=torch.float16)
tensor(4.4844, device='cuda:0', dtype=torch.float16) tensor(0.3821, device='cuda:0', dtype=torch.float16)
tensor(3.8906, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3882, device='cuda:0', dtype=torch.float16)
tensor(4.1836, device='cuda:0', dtype=torch.float16) tensor(0.3816, device='cuda:0', dtype=torch.float16)
tensor(0.1959, device='cuda:0')
old_score: tensor(0.3826, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1566, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.205619096755981
Validation after dual ascent:
out_inf: tensor(18.2969, device='cuda:0', dtype=torch.float16) tensor(1.0381, device='cuda:0', dtype=torch.float16)
tensor(1.9365, device='cuda:0', dtype=torch.float16) tensor(0.1553, device='cuda:0', dtype=torch.float16)
tensor(1.9570, device='cuda:0', dtype=torch.float16) tensor(0.1571, device='cuda:0', dtype=torch.float16)
tensor(2.5293, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(2.1289, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.8477, device='cuda:0', dtype=torch.float16) tensor(0.3113, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.1841, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1832, device='cuda:0', dtype=torch.float16)
tensor(1.7764, device='cuda:0', dtype=torch.float16) tensor(0.1853, device='cuda:0', dtype=torch.float16)
tensor(1.5127, device='cuda:0', dtype=torch.float16) tensor(0.1836, device='cuda:0', dtype=torch.float16)
tensor(0.1217, device='cuda:0')
old_score: tensor(0.1841, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0976, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.149884223937988
Validation after dual ascent:
out_inf: tensor(4.8477, device='cuda:0', dtype=torch.float16) tensor(0.3113, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.0968, device='cuda:0', dtype=torch.float16)
tensor(0.8560, device='cuda:0', dtype=torch.float16) tensor(0.0979, device='cuda:0', dtype=torch.float16)
tensor(0.9922, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
pruning layer 13 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.6641, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
tensor(1.0391, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
tensor(2.3203, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(2.1680, device='cuda:0', dtype=torch.float16) tensor(0.0589, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.0494, device='cuda:0', dtype=torch.float16)
tensor(0.0211, device='cuda:0')
old_score: tensor(0.0544, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0246, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.116893768310547
Validation after dual ascent:
out_inf: tensor(5.6641, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
tensor(0.5742, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
tensor(0.5781, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.5664, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.4141, device='cuda:0', dtype=torch.float16) tensor(0.3215, device='cuda:0', dtype=torch.float16)
tensor(2.9336, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
tensor(2.3398, device='cuda:0', dtype=torch.float16) tensor(0.1642, device='cuda:0', dtype=torch.float16)
tensor(2.6699, device='cuda:0', dtype=torch.float16) tensor(0.1658, device='cuda:0', dtype=torch.float16)
tensor(2.6055, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0154, device='cuda:0')
tensor(0.0849, device='cuda:0')
old_score: tensor(0.1646, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0748, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.216864347457886
Validation after dual ascent:
out_inf: tensor(6.4141, device='cuda:0', dtype=torch.float16) tensor(0.3215, device='cuda:0', dtype=torch.float16)
tensor(1.5078, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.0774, device='cuda:0', dtype=torch.float16)
tensor(1.5605, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.7969, device='cuda:0', dtype=torch.float16) tensor(0.2432, device='cuda:0', dtype=torch.float16)
tensor(1.6777, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(1.5400, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
tensor(1.5176, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0118, device='cuda:0')
tensor(0.0805, device='cuda:0')
old_score: tensor(0.1382, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0729, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.213565826416016
Validation after dual ascent:
out_inf: tensor(4.7969, device='cuda:0', dtype=torch.float16) tensor(0.2432, device='cuda:0', dtype=torch.float16)
tensor(0.8291, device='cuda:0', dtype=torch.float16) tensor(0.0743, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0704, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
tensor(0.8301, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
pruning layer 13 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.6758, device='cuda:0', dtype=torch.float16) tensor(0.0935, device='cuda:0', dtype=torch.float16)
tensor(0.7827, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
tensor(0.9307, device='cuda:0', dtype=torch.float16) tensor(0.0559, device='cuda:0', dtype=torch.float16)
tensor(0.9629, device='cuda:0', dtype=torch.float16) tensor(0.0564, device='cuda:0', dtype=torch.float16)
tensor(0.8882, device='cuda:0', dtype=torch.float16) tensor(0.0551, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0129, device='cuda:0')
tensor(0.0231, device='cuda:0')
old_score: tensor(0.0555, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0338, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.501221895217896
Validation after dual ascent:
out_inf: tensor(2.6758, device='cuda:0', dtype=torch.float16) tensor(0.0935, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0344, device='cuda:0', dtype=torch.float16)
tensor(0.3965, device='cuda:0', dtype=torch.float16) tensor(0.0321, device='cuda:0', dtype=torch.float16)
tensor(0.4453, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
tensor(0.3672, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.4375, device='cuda:0', dtype=torch.float16) tensor(0.8486, device='cuda:0', dtype=torch.float16)
tensor(4.6328, device='cuda:0', dtype=torch.float16) tensor(0.3704, device='cuda:0', dtype=torch.float16)
tensor(4.3438, device='cuda:0', dtype=torch.float16) tensor(0.3672, device='cuda:0', dtype=torch.float16)
tensor(5.1562, device='cuda:0', dtype=torch.float16) tensor(0.3792, device='cuda:0', dtype=torch.float16)
tensor(5.3828, device='cuda:0', dtype=torch.float16) tensor(0.3713, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0188, device='cuda:0')
tensor(0.0339, device='cuda:0')
old_score: tensor(0.3718, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1562, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.000773191452026
Validation after dual ascent:
out_inf: tensor(16.4375, device='cuda:0', dtype=torch.float16) tensor(0.8486, device='cuda:0', dtype=torch.float16)
tensor(2.0430, device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
tensor(1.9961, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(2.3262, device='cuda:0', dtype=torch.float16) tensor(0.1637, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.3125, device='cuda:0', dtype=torch.float16) tensor(1.1279, device='cuda:0', dtype=torch.float16)
tensor(4.1016, device='cuda:0', dtype=torch.float16) tensor(0.4028, device='cuda:0', dtype=torch.float16)
tensor(3.7344, device='cuda:0', dtype=torch.float16) tensor(0.3962, device='cuda:0', dtype=torch.float16)
tensor(4.3281, device='cuda:0', dtype=torch.float16) tensor(0.4087, device='cuda:0', dtype=torch.float16)
tensor(4.5938, device='cuda:0', dtype=torch.float16) tensor(0.4033, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0196, device='cuda:0')
tensor(0.0379, device='cuda:0')
old_score: tensor(0.4026, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1572, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.993868350982666
Validation after dual ascent:
out_inf: tensor(17.3125, device='cuda:0', dtype=torch.float16) tensor(1.1279, device='cuda:0', dtype=torch.float16)
tensor(1.9023, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(1.7676, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(2.0781, device='cuda:0', dtype=torch.float16) tensor(0.1644, device='cuda:0', dtype=torch.float16)
tensor(1.7529, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3086, device='cuda:0', dtype=torch.float16)
tensor(1.5244, device='cuda:0', dtype=torch.float16) tensor(0.1829, device='cuda:0', dtype=torch.float16)
tensor(1.6318, device='cuda:0', dtype=torch.float16) tensor(0.1799, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1832, device='cuda:0', dtype=torch.float16)
tensor(1.6436, device='cuda:0', dtype=torch.float16) tensor(0.1819, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0092, device='cuda:0')
tensor(0.1382, device='cuda:0')
old_score: tensor(0.1819, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0963, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2399606704711914
Validation after dual ascent:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3086, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
tensor(0.7974, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.9482, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
pruning layer 14 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.1719, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(1.8008, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(1.9277, device='cuda:0', dtype=torch.float16) tensor(0.0601, device='cuda:0', dtype=torch.float16)
tensor(2.2422, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(1.8398, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0147, device='cuda:0')
tensor(0.0215, device='cuda:0')
old_score: tensor(0.0578, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0275, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.9296393394470215
Validation after dual ascent:
out_inf: tensor(8.1719, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.4980, device='cuda:0', dtype=torch.float16) tensor(0.0274, device='cuda:0', dtype=torch.float16)
tensor(0.4336, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.8262, device='cuda:0', dtype=torch.float16) tensor(0.0309, device='cuda:0', dtype=torch.float16)
tensor(0.4297, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.3276, device='cuda:0', dtype=torch.float16)
tensor(3.5586, device='cuda:0', dtype=torch.float16) tensor(0.1674, device='cuda:0', dtype=torch.float16)
tensor(3.1074, device='cuda:0', dtype=torch.float16) tensor(0.1652, device='cuda:0', dtype=torch.float16)
tensor(3.1172, device='cuda:0', dtype=torch.float16) tensor(0.1665, device='cuda:0', dtype=torch.float16)
tensor(3.7363, device='cuda:0', dtype=torch.float16) tensor(0.1676, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0163, device='cuda:0')
tensor(0.0969, device='cuda:0')
old_score: tensor(0.1666, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0770, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.207620859146118
Validation after dual ascent:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.3276, device='cuda:0', dtype=torch.float16)
tensor(1.8076, device='cuda:0', dtype=torch.float16) tensor(0.0794, device='cuda:0', dtype=torch.float16)
tensor(1.6768, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(1.4248, device='cuda:0', dtype=torch.float16) tensor(0.0803, device='cuda:0', dtype=torch.float16)
tensor(1.7773, device='cuda:0', dtype=torch.float16) tensor(0.0749, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.5430, device='cuda:0', dtype=torch.float16) tensor(0.2489, device='cuda:0', dtype=torch.float16)
tensor(2.0273, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(1.7852, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0128, device='cuda:0')
tensor(0.0924, device='cuda:0')
old_score: tensor(0.1403, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0751, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.19560170173645
Validation after dual ascent:
out_inf: tensor(4.5430, device='cuda:0', dtype=torch.float16) tensor(0.2489, device='cuda:0', dtype=torch.float16)
tensor(0.8320, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.7363, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.8203, device='cuda:0', dtype=torch.float16) tensor(0.0784, device='cuda:0', dtype=torch.float16)
tensor(0.8994, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
pruning layer 14 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.7803, device='cuda:0', dtype=torch.float16) tensor(0.0976, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.8750, device='cuda:0', dtype=torch.float16) tensor(0.0558, device='cuda:0', dtype=torch.float16)
tensor(0.9082, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0182, device='cuda:0')
tensor(0.0186, device='cuda:0')
old_score: tensor(0.0568, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0359, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 36.54832673072815
Validation after dual ascent:
out_inf: tensor(1.7803, device='cuda:0', dtype=torch.float16) tensor(0.0976, device='cuda:0', dtype=torch.float16)
tensor(0.4751, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
tensor(0.4688, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(0.4375, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.q_proj
Validation after prune:
out_inf: tensor(18.2812, device='cuda:0', dtype=torch.float16) tensor(0.8560, device='cuda:0', dtype=torch.float16)
tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.3674, device='cuda:0', dtype=torch.float16)
tensor(4.8555, device='cuda:0', dtype=torch.float16) tensor(0.3618, device='cuda:0', dtype=torch.float16)
tensor(5.0195, device='cuda:0', dtype=torch.float16) tensor(0.3706, device='cuda:0', dtype=torch.float16)
tensor(4.8906, device='cuda:0', dtype=torch.float16) tensor(0.3657, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0191, device='cuda:0')
tensor(0.2167, device='cuda:0')
old_score: tensor(0.3662, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1532, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.747153997421265
Validation after dual ascent:
out_inf: tensor(18.2812, device='cuda:0', dtype=torch.float16) tensor(0.8560, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.1558, device='cuda:0', dtype=torch.float16)
tensor(1.9209, device='cuda:0', dtype=torch.float16) tensor(0.1479, device='cuda:0', dtype=torch.float16)
tensor(2.2148, device='cuda:0', dtype=torch.float16) tensor(0.1609, device='cuda:0', dtype=torch.float16)
tensor(1.8955, device='cuda:0', dtype=torch.float16) tensor(0.1482, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.8125, device='cuda:0', dtype=torch.float16) tensor(1.1123, device='cuda:0', dtype=torch.float16)
tensor(4.4141, device='cuda:0', dtype=torch.float16) tensor(0.4053, device='cuda:0', dtype=torch.float16)
tensor(4.0078, device='cuda:0', dtype=torch.float16) tensor(0.3982, device='cuda:0', dtype=torch.float16)
tensor(5.1758, device='cuda:0', dtype=torch.float16) tensor(0.4082, device='cuda:0', dtype=torch.float16)
tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.4053, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0195, device='cuda:0')
tensor(0.1219, device='cuda:0')
old_score: tensor(0.4043, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1562, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2518346309661865
Validation after dual ascent:
out_inf: tensor(17.8125, device='cuda:0', dtype=torch.float16) tensor(1.1123, device='cuda:0', dtype=torch.float16)
tensor(1.9492, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(1.8516, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.8926, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.8174, device='cuda:0', dtype=torch.float16) tensor(0.1511, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.9062, device='cuda:0', dtype=torch.float16) tensor(0.3184, device='cuda:0', dtype=torch.float16)
tensor(1.6494, device='cuda:0', dtype=torch.float16) tensor(0.1880, device='cuda:0', dtype=torch.float16)
tensor(1.4590, device='cuda:0', dtype=torch.float16) tensor(0.1818, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.1869, device='cuda:0', dtype=torch.float16)
tensor(1.4326, device='cuda:0', dtype=torch.float16) tensor(0.1851, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0085, device='cuda:0')
tensor(0.1722, device='cuda:0')
old_score: tensor(0.1854, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0992, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2508161067962646
Validation after dual ascent:
out_inf: tensor(4.9062, device='cuda:0', dtype=torch.float16) tensor(0.3184, device='cuda:0', dtype=torch.float16)
tensor(0.8286, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
tensor(0.8760, device='cuda:0', dtype=torch.float16) tensor(0.1038, device='cuda:0', dtype=torch.float16)
tensor(0.8452, device='cuda:0', dtype=torch.float16) tensor(0.0963, device='cuda:0', dtype=torch.float16)
pruning layer 15 name self_attn.o_proj
Validation after prune:
out_inf: tensor(9.3203, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.0613, device='cuda:0', dtype=torch.float16)
tensor(1.9043, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.0595, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0186, device='cuda:0')
tensor(0.0409, device='cuda:0')
old_score: tensor(0.0624, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0342, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.415200471878052
Validation after dual ascent:
out_inf: tensor(9.3203, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(0.5957, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(0.5645, device='cuda:0', dtype=torch.float16) tensor(0.0329, device='cuda:0', dtype=torch.float16)
tensor(0.6387, device='cuda:0', dtype=torch.float16) tensor(0.0394, device='cuda:0', dtype=torch.float16)
tensor(0.6094, device='cuda:0', dtype=torch.float16) tensor(0.0314, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.8086, device='cuda:0', dtype=torch.float16) tensor(0.3452, device='cuda:0', dtype=torch.float16)
tensor(3.1758, device='cuda:0', dtype=torch.float16) tensor(0.1754, device='cuda:0', dtype=torch.float16)
tensor(2.6738, device='cuda:0', dtype=torch.float16) tensor(0.1719, device='cuda:0', dtype=torch.float16)
tensor(2.6973, device='cuda:0', dtype=torch.float16) tensor(0.1742, device='cuda:0', dtype=torch.float16)
tensor(3.6211, device='cuda:0', dtype=torch.float16) tensor(0.1754, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0184, device='cuda:0')
tensor(0.1158, device='cuda:0')
old_score: tensor(0.1742, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0786, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.201220512390137
Validation after dual ascent:
out_inf: tensor(6.8086, device='cuda:0', dtype=torch.float16) tensor(0.3452, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(1.5244, device='cuda:0', dtype=torch.float16) tensor(0.0752, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.0815, device='cuda:0', dtype=torch.float16)
tensor(1.4922, device='cuda:0', dtype=torch.float16) tensor(0.0763, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.2632, device='cuda:0', dtype=torch.float16)
tensor(2.1484, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(2.0410, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(2.3398, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(2.1602, device='cuda:0', dtype=torch.float16) tensor(0.1490, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0150, device='cuda:0')
tensor(0.1092, device='cuda:0')
old_score: tensor(0.1479, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0768, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.198086261749268
Validation after dual ascent:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.2632, device='cuda:0', dtype=torch.float16)
tensor(0.8413, device='cuda:0', dtype=torch.float16) tensor(0.0794, device='cuda:0', dtype=torch.float16)
tensor(0.7910, device='cuda:0', dtype=torch.float16) tensor(0.0736, device='cuda:0', dtype=torch.float16)
tensor(0.7764, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
pruning layer 15 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.4688, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0650, device='cuda:0', dtype=torch.float16)
tensor(0.7939, device='cuda:0', dtype=torch.float16) tensor(0.0624, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0642, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0112, device='cuda:0')
tensor(0.0140, device='cuda:0')
old_score: tensor(0.0638, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0411, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 36.588531732559204
Validation after dual ascent:
out_inf: tensor(3.4688, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(0.5171, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.5557, device='cuda:0', dtype=torch.float16) tensor(0.0393, device='cuda:0', dtype=torch.float16)
tensor(0.5332, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.4954, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.5625, device='cuda:0', dtype=torch.float16) tensor(0.8296, device='cuda:0', dtype=torch.float16)
tensor(6.3906, device='cuda:0', dtype=torch.float16) tensor(0.3591, device='cuda:0', dtype=torch.float16)
tensor(6.8125, device='cuda:0', dtype=torch.float16) tensor(0.3481, device='cuda:0', dtype=torch.float16)
tensor(6.2969, device='cuda:0', dtype=torch.float16) tensor(0.3643, device='cuda:0', dtype=torch.float16)
tensor(6.1250, device='cuda:0', dtype=torch.float16) tensor(0.3530, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0193, device='cuda:0')
tensor(0.2185, device='cuda:0')
old_score: tensor(0.3560, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1489, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.7473015785217285
Validation after dual ascent:
out_inf: tensor(16.5625, device='cuda:0', dtype=torch.float16) tensor(0.8296, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.1527, device='cuda:0', dtype=torch.float16)
tensor(1.9648, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
tensor(2.1680, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(2.9375, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.6562, device='cuda:0', dtype=torch.float16) tensor(1.0938, device='cuda:0', dtype=torch.float16)
tensor(4.3594, device='cuda:0', dtype=torch.float16) tensor(0.3821, device='cuda:0', dtype=torch.float16)
tensor(3.9141, device='cuda:0', dtype=torch.float16) tensor(0.3789, device='cuda:0', dtype=torch.float16)
tensor(3.9062, device='cuda:0', dtype=torch.float16) tensor(0.3960, device='cuda:0', dtype=torch.float16)
tensor(3.9766, device='cuda:0', dtype=torch.float16) tensor(0.3809, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0199, device='cuda:0')
tensor(0.1167, device='cuda:0')
old_score: tensor(0.3843, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1509, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.253955841064453
Validation after dual ascent:
out_inf: tensor(17.6562, device='cuda:0', dtype=torch.float16) tensor(1.0938, device='cuda:0', dtype=torch.float16)
tensor(1.8174, device='cuda:0', dtype=torch.float16) tensor(0.1548, device='cuda:0', dtype=torch.float16)
tensor(1.9326, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.8770, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(1.7207, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.7227, device='cuda:0', dtype=torch.float16) tensor(0.3228, device='cuda:0', dtype=torch.float16)
tensor(2.1426, device='cuda:0', dtype=torch.float16) tensor(0.1940, device='cuda:0', dtype=torch.float16)
tensor(1.6348, device='cuda:0', dtype=torch.float16) tensor(0.1886, device='cuda:0', dtype=torch.float16)
tensor(2.3770, device='cuda:0', dtype=torch.float16) tensor(0.1910, device='cuda:0', dtype=torch.float16)
tensor(1.9629, device='cuda:0', dtype=torch.float16) tensor(0.1915, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0110, device='cuda:0')
tensor(0.1700, device='cuda:0')
old_score: tensor(0.1913, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1008, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2500619888305664
Validation after dual ascent:
out_inf: tensor(4.7227, device='cuda:0', dtype=torch.float16) tensor(0.3228, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
tensor(0.9590, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
tensor(0.9951, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
pruning layer 16 name self_attn.o_proj
Validation after prune:
out_inf: tensor(8.1484, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.0734, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0762, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0190, device='cuda:0')
tensor(0.0295, device='cuda:0')
old_score: tensor(0.0770, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0378, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.452206373214722
Validation after dual ascent:
out_inf: tensor(8.1484, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.0391, device='cuda:0', dtype=torch.float16)
tensor(0.5898, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
tensor(0.6641, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
tensor(0.6172, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.gate_proj
Validation after prune:
out_inf: tensor(6.2773, device='cuda:0', dtype=torch.float16) tensor(0.3569, device='cuda:0', dtype=torch.float16)
tensor(2.6973, device='cuda:0', dtype=torch.float16) tensor(0.1849, device='cuda:0', dtype=torch.float16)
tensor(2.9785, device='cuda:0', dtype=torch.float16) tensor(0.1777, device='cuda:0', dtype=torch.float16)
tensor(2.9180, device='cuda:0', dtype=torch.float16) tensor(0.1862, device='cuda:0', dtype=torch.float16)
tensor(2.8105, device='cuda:0', dtype=torch.float16) tensor(0.1812, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0197, device='cuda:0')
tensor(0.1098, device='cuda:0')
old_score: tensor(0.1825, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0795, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.195176839828491
Validation after dual ascent:
out_inf: tensor(6.2773, device='cuda:0', dtype=torch.float16) tensor(0.3569, device='cuda:0', dtype=torch.float16)
tensor(1.4316, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(1.7559, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(1.9160, device='cuda:0', dtype=torch.float16) tensor(0.0763, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.7031, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.1481, device='cuda:0', dtype=torch.float16)
tensor(2.0293, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0152, device='cuda:0')
tensor(0.1036, device='cuda:0')
old_score: tensor(0.1509, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0770, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.1966552734375
Validation after dual ascent:
out_inf: tensor(4.7031, device='cuda:0', dtype=torch.float16) tensor(0.2678, device='cuda:0', dtype=torch.float16)
tensor(0.8633, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
tensor(0.8018, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
pruning layer 16 name mlp.down_proj
Validation after prune:
out_inf: tensor(5.2500, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.0710, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.0680, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.0748, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.0692, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0112, device='cuda:0')
tensor(0.0139, device='cuda:0')
old_score: tensor(0.0707, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0418, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 36.52790808677673
Validation after dual ascent:
out_inf: tensor(5.2500, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(0.4307, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0393, device='cuda:0', dtype=torch.float16)
tensor(0.6543, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.4248, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(0.8140, device='cuda:0', dtype=torch.float16)
tensor(4.3281, device='cuda:0', dtype=torch.float16) tensor(0.3582, device='cuda:0', dtype=torch.float16)
tensor(4.2461, device='cuda:0', dtype=torch.float16) tensor(0.3511, device='cuda:0', dtype=torch.float16)
tensor(4.7422, device='cuda:0', dtype=torch.float16) tensor(0.3638, device='cuda:0', dtype=torch.float16)
tensor(4.2422, device='cuda:0', dtype=torch.float16) tensor(0.3511, device='cuda:0', dtype=torch.float16)
tensor(0.0328, device='cuda:0')
old_score: tensor(0.3560, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1329, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.214282989501953
Validation after dual ascent:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(0.8140, device='cuda:0', dtype=torch.float16)
tensor(1.6289, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.7158, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
tensor(1.6650, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
tensor(1.5342, device='cuda:0', dtype=torch.float16) tensor(0.1266, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.0244, device='cuda:0', dtype=torch.float16)
tensor(4.5156, device='cuda:0', dtype=torch.float16) tensor(0.3850, device='cuda:0', dtype=torch.float16)
tensor(4.3594, device='cuda:0', dtype=torch.float16) tensor(0.3804, device='cuda:0', dtype=torch.float16)
tensor(4.7188, device='cuda:0', dtype=torch.float16) tensor(0.3901, device='cuda:0', dtype=torch.float16)
tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.3804, device='cuda:0', dtype=torch.float16)
tensor(0.0374, device='cuda:0')
old_score: tensor(0.3843, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1343, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.160739183425903
Validation after dual ascent:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1.0244, device='cuda:0', dtype=torch.float16)
tensor(1.9238, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1294, device='cuda:0', dtype=torch.float16)
tensor(1.7363, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3193, device='cuda:0', dtype=torch.float16)
tensor(1.6230, device='cuda:0', dtype=torch.float16) tensor(0.1935, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1868, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.1926, device='cuda:0', dtype=torch.float16)
tensor(1.6289, device='cuda:0', dtype=torch.float16) tensor(0.1896, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0109, device='cuda:0')
tensor(0.1289, device='cuda:0')
old_score: tensor(0.1907, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0913, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2329277992248535
Validation after dual ascent:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.3193, device='cuda:0', dtype=torch.float16)
tensor(0.7988, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(0.9634, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(0.8809, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.0873, device='cuda:0', dtype=torch.float16)
pruning layer 17 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.6992, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(1.9824, device='cuda:0', dtype=torch.float16) tensor(0.0707, device='cuda:0', dtype=torch.float16)
tensor(1.8887, device='cuda:0', dtype=torch.float16) tensor(0.0703, device='cuda:0', dtype=torch.float16)
tensor(2.1953, device='cuda:0', dtype=torch.float16) tensor(0.0710, device='cuda:0', dtype=torch.float16)
tensor(1.7168, device='cuda:0', dtype=torch.float16) tensor(0.0684, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0124, device='cuda:0')
tensor(0.0190, device='cuda:0')
old_score: tensor(0.0701, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0289, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.936485767364502
Validation after dual ascent:
out_inf: tensor(5.6992, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
tensor(0.5342, device='cuda:0', dtype=torch.float16) tensor(0.0275, device='cuda:0', dtype=torch.float16)
tensor(0.7363, device='cuda:0', dtype=torch.float16) tensor(0.0340, device='cuda:0', dtype=torch.float16)
tensor(0.7148, device='cuda:0', dtype=torch.float16) tensor(0.0260, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.0078, device='cuda:0', dtype=torch.float16) tensor(0.3875, device='cuda:0', dtype=torch.float16)
tensor(2.7051, device='cuda:0', dtype=torch.float16) tensor(0.1942, device='cuda:0', dtype=torch.float16)
tensor(2.4961, device='cuda:0', dtype=torch.float16) tensor(0.1831, device='cuda:0', dtype=torch.float16)
tensor(2.5195, device='cuda:0', dtype=torch.float16) tensor(0.1954, device='cuda:0', dtype=torch.float16)
tensor(2.5625, device='cuda:0', dtype=torch.float16) tensor(0.1898, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0160, device='cuda:0')
tensor(0.0170, device='cuda:0')
old_score: tensor(0.1907, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0809, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.176685094833374
Validation after dual ascent:
out_inf: tensor(8.0078, device='cuda:0', dtype=torch.float16) tensor(0.3875, device='cuda:0', dtype=torch.float16)
tensor(1.7207, device='cuda:0', dtype=torch.float16) tensor(0.0832, device='cuda:0', dtype=torch.float16)
tensor(1.2754, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
tensor(1.4131, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(1.5791, device='cuda:0', dtype=torch.float16) tensor(0.0775, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.7695, device='cuda:0', dtype=torch.float16) tensor(0.2661, device='cuda:0', dtype=torch.float16)
tensor(2.3320, device='cuda:0', dtype=torch.float16) tensor(0.1542, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
tensor(2.2617, device='cuda:0', dtype=torch.float16) tensor(0.1533, device='cuda:0', dtype=torch.float16)
tensor(1.7871, device='cuda:0', dtype=torch.float16) tensor(0.1511, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0148, device='cuda:0')
tensor(0.1053, device='cuda:0')
old_score: tensor(0.1515, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0775, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.210177659988403
Validation after dual ascent:
out_inf: tensor(6.7695, device='cuda:0', dtype=torch.float16) tensor(0.2661, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.0796, device='cuda:0', dtype=torch.float16)
tensor(0.7964, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.8726, device='cuda:0', dtype=torch.float16) tensor(0.0742, device='cuda:0', dtype=torch.float16)
pruning layer 17 name mlp.down_proj
Validation after prune:
out_inf: tensor(2.6621, device='cuda:0', dtype=torch.float16) tensor(0.1095, device='cuda:0', dtype=torch.float16)
tensor(0.8813, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(0.8037, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(0.7119, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0634, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0140, device='cuda:0')
tensor(0.0157, device='cuda:0')
old_score: tensor(0.0641, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0392, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 36.61790156364441
Validation after dual ascent:
out_inf: tensor(2.6621, device='cuda:0', dtype=torch.float16) tensor(0.1095, device='cuda:0', dtype=torch.float16)
tensor(0.5010, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.4365, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.5049, device='cuda:0', dtype=torch.float16) tensor(0.0432, device='cuda:0', dtype=torch.float16)
tensor(0.4316, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.9375, device='cuda:0', dtype=torch.float16) tensor(0.8384, device='cuda:0', dtype=torch.float16)
tensor(4.1875, device='cuda:0', dtype=torch.float16) tensor(0.3623, device='cuda:0', dtype=torch.float16)
tensor(3.8281, device='cuda:0', dtype=torch.float16) tensor(0.3528, device='cuda:0', dtype=torch.float16)
tensor(4.4766, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(3.7969, device='cuda:0', dtype=torch.float16) tensor(0.3572, device='cuda:0', dtype=torch.float16)
tensor(0.0379, device='cuda:0')
old_score: tensor(0.3596, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1367, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.212813377380371
Validation after dual ascent:
out_inf: tensor(14.9375, device='cuda:0', dtype=torch.float16) tensor(0.8384, device='cuda:0', dtype=torch.float16)
tensor(1.7305, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(1.7227, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
tensor(2.2559, device='cuda:0', dtype=torch.float16) tensor(0.1301, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.0469, device='cuda:0', dtype=torch.float16) tensor(1.0029, device='cuda:0', dtype=torch.float16)
tensor(4.4766, device='cuda:0', dtype=torch.float16) tensor(0.3884, device='cuda:0', dtype=torch.float16)
tensor(4.1797, device='cuda:0', dtype=torch.float16) tensor(0.3831, device='cuda:0', dtype=torch.float16)
tensor(4.4609, device='cuda:0', dtype=torch.float16) tensor(0.3972, device='cuda:0', dtype=torch.float16)
tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3855, device='cuda:0', dtype=torch.float16)
tensor(0.0398, device='cuda:0')
old_score: tensor(0.3887, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1377, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.16554880142212
Validation after dual ascent:
out_inf: tensor(17.0469, device='cuda:0', dtype=torch.float16) tensor(1.0029, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.1406, device='cuda:0', dtype=torch.float16)
tensor(1.8301, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
tensor(1.9180, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
tensor(1.7412, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.5859, device='cuda:0', dtype=torch.float16) tensor(0.3384, device='cuda:0', dtype=torch.float16)
tensor(1.6816, device='cuda:0', dtype=torch.float16) tensor(0.2075, device='cuda:0', dtype=torch.float16)
tensor(1.7705, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.2096, device='cuda:0', dtype=torch.float16)
tensor(1.9268, device='cuda:0', dtype=torch.float16) tensor(0.2042, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0130, device='cuda:0')
tensor(0.1712, device='cuda:0')
old_score: tensor(0.2057, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1005, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.232224941253662
Validation after dual ascent:
out_inf: tensor(4.5859, device='cuda:0', dtype=torch.float16) tensor(0.3384, device='cuda:0', dtype=torch.float16)
tensor(0.9189, device='cuda:0', dtype=torch.float16) tensor(0.1027, device='cuda:0', dtype=torch.float16)
tensor(0.9858, device='cuda:0', dtype=torch.float16) tensor(0.0964, device='cuda:0', dtype=torch.float16)
tensor(1.0186, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
tensor(0.9346, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
pruning layer 18 name self_attn.o_proj
Validation after prune:
out_inf: tensor(4.3125, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.0569, device='cuda:0', dtype=torch.float16)
tensor(1.8457, device='cuda:0', dtype=torch.float16) tensor(0.0539, device='cuda:0', dtype=torch.float16)
tensor(1.9219, device='cuda:0', dtype=torch.float16) tensor(0.0590, device='cuda:0', dtype=torch.float16)
tensor(1.4219, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
tensor(0.0260, device='cuda:0')
old_score: tensor(0.0560, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0306, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.117988586425781
Validation after dual ascent:
out_inf: tensor(4.3125, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(0.8369, device='cuda:0', dtype=torch.float16) tensor(0.0304, device='cuda:0', dtype=torch.float16)
tensor(0.6875, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.8125, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.6982, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.3516, device='cuda:0', dtype=torch.float16) tensor(0.3928, device='cuda:0', dtype=torch.float16)
tensor(3.7969, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(2.9160, device='cuda:0', dtype=torch.float16) tensor(0.1932, device='cuda:0', dtype=torch.float16)
tensor(3.2480, device='cuda:0', dtype=torch.float16) tensor(0.2041, device='cuda:0', dtype=torch.float16)
tensor(3.3594, device='cuda:0', dtype=torch.float16) tensor(0.1975, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0161, device='cuda:0')
tensor(0.0185, device='cuda:0')
old_score: tensor(0.1992, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0837, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.181050300598145
Validation after dual ascent:
out_inf: tensor(9.3516, device='cuda:0', dtype=torch.float16) tensor(0.3928, device='cuda:0', dtype=torch.float16)
tensor(1.3047, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.0803, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
tensor(1.6270, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.9531, device='cuda:0', dtype=torch.float16) tensor(0.2668, device='cuda:0', dtype=torch.float16)
tensor(2.2383, device='cuda:0', dtype=torch.float16) tensor(0.1576, device='cuda:0', dtype=torch.float16)
tensor(2.2520, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(2.3066, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(2.1543, device='cuda:0', dtype=torch.float16) tensor(0.1539, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0164, device='cuda:0')
tensor(0.1239, device='cuda:0')
old_score: tensor(0.1550, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0793, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2152323722839355
Validation after dual ascent:
out_inf: tensor(6.9531, device='cuda:0', dtype=torch.float16) tensor(0.2668, device='cuda:0', dtype=torch.float16)
tensor(0.8677, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(0.8545, device='cuda:0', dtype=torch.float16) tensor(0.0761, device='cuda:0', dtype=torch.float16)
tensor(0.8452, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(0.7998, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
pruning layer 18 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.7695, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.0264, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.6973, device='cuda:0', dtype=torch.float16) tensor(0.0675, device='cuda:0', dtype=torch.float16)
tensor(0.7363, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0167, device='cuda:0')
tensor(0.0130, device='cuda:0')
old_score: tensor(0.0710, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0431, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 26.83701252937317
Validation after dual ascent:
out_inf: tensor(4.7695, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(0.5674, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.5098, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.5605, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.3125, device='cuda:0', dtype=torch.float16) tensor(0.8159, device='cuda:0', dtype=torch.float16)
tensor(4.2383, device='cuda:0', dtype=torch.float16) tensor(0.3542, device='cuda:0', dtype=torch.float16)
tensor(4.4883, device='cuda:0', dtype=torch.float16) tensor(0.3508, device='cuda:0', dtype=torch.float16)
tensor(4.3203, device='cuda:0', dtype=torch.float16) tensor(0.3633, device='cuda:0', dtype=torch.float16)
tensor(4.1406, device='cuda:0', dtype=torch.float16) tensor(0.3489, device='cuda:0', dtype=torch.float16)
tensor(0.0472, device='cuda:0')
old_score: tensor(0.3542, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1333, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.187037706375122
Validation after dual ascent:
out_inf: tensor(14.3125, device='cuda:0', dtype=torch.float16) tensor(0.8159, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1353, device='cuda:0', dtype=torch.float16)
tensor(1.5381, device='cuda:0', dtype=torch.float16) tensor(0.1292, device='cuda:0', dtype=torch.float16)
tensor(1.6162, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(1.5576, device='cuda:0', dtype=torch.float16) tensor(0.1265, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.5781, device='cuda:0', dtype=torch.float16) tensor(1.0771, device='cuda:0', dtype=torch.float16)
tensor(4.5625, device='cuda:0', dtype=torch.float16) tensor(0.3789, device='cuda:0', dtype=torch.float16)
tensor(4.3828, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(4.5938, device='cuda:0', dtype=torch.float16) tensor(0.3933, device='cuda:0', dtype=torch.float16)
tensor(4.9766, device='cuda:0', dtype=torch.float16) tensor(0.3770, device='cuda:0', dtype=torch.float16)
tensor(0.0529, device='cuda:0')
old_score: tensor(0.3818, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1346, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.157381772994995
Validation after dual ascent:
out_inf: tensor(18.5781, device='cuda:0', dtype=torch.float16) tensor(1.0771, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1367, device='cuda:0', dtype=torch.float16)
tensor(1.9199, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.8105, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.8047, device='cuda:0', dtype=torch.float16) tensor(0.3596, device='cuda:0', dtype=torch.float16)
tensor(1.8311, device='cuda:0', dtype=torch.float16) tensor(0.2135, device='cuda:0', dtype=torch.float16)
tensor(1.6709, device='cuda:0', dtype=torch.float16) tensor(0.2090, device='cuda:0', dtype=torch.float16)
tensor(1.7324, device='cuda:0', dtype=torch.float16) tensor(0.2146, device='cuda:0', dtype=torch.float16)
tensor(1.6816, device='cuda:0', dtype=torch.float16) tensor(0.2100, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0150, device='cuda:0')
tensor(0.1783, device='cuda:0')
old_score: tensor(0.2117, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1017, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2312886714935303
Validation after dual ascent:
out_inf: tensor(3.8047, device='cuda:0', dtype=torch.float16) tensor(0.3596, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.1035, device='cuda:0', dtype=torch.float16)
tensor(1.0146, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(1.0127, device='cuda:0', dtype=torch.float16) tensor(0.1080, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
pruning layer 19 name self_attn.o_proj
Validation after prune:
out_inf: tensor(7.1094, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(1.8789, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(1.8340, device='cuda:0', dtype=torch.float16) tensor(0.0719, device='cuda:0', dtype=torch.float16)
tensor(1.9961, device='cuda:0', dtype=torch.float16) tensor(0.0629, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.0623, device='cuda:0', dtype=torch.float16)
tensor(0.0379, device='cuda:0')
old_score: tensor(0.0660, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0352, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.100473880767822
Validation after dual ascent:
out_inf: tensor(7.1094, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0342, device='cuda:0', dtype=torch.float16)
tensor(0.7578, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.7812, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
tensor(0.6504, device='cuda:0', dtype=torch.float16) tensor(0.0326, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.1484, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(2.9688, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(3.1719, device='cuda:0', dtype=torch.float16) tensor(0.1949, device='cuda:0', dtype=torch.float16)
tensor(3.0234, device='cuda:0', dtype=torch.float16) tensor(0.2052, device='cuda:0', dtype=torch.float16)
tensor(3.7148, device='cuda:0', dtype=torch.float16) tensor(0.1984, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0146, device='cuda:0')
tensor(0.0193, device='cuda:0')
old_score: tensor(0.2001, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0871, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.166791200637817
Validation after dual ascent:
out_inf: tensor(7.1484, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
tensor(1.5391, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.0832, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.4336, device='cuda:0', dtype=torch.float16) tensor(0.2700, device='cuda:0', dtype=torch.float16)
tensor(2.2637, device='cuda:0', dtype=torch.float16) tensor(0.1605, device='cuda:0', dtype=torch.float16)
tensor(2.4727, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
tensor(2.4570, device='cuda:0', dtype=torch.float16) tensor(0.1600, device='cuda:0', dtype=torch.float16)
tensor(2.2656, device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0180, device='cuda:0')
tensor(0.1431, device='cuda:0')
old_score: tensor(0.1586, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0822, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.215756416320801
Validation after dual ascent:
out_inf: tensor(6.4336, device='cuda:0', dtype=torch.float16) tensor(0.2700, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(0.8188, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0870, device='cuda:0', dtype=torch.float16)
tensor(0.9570, device='cuda:0', dtype=torch.float16) tensor(0.0785, device='cuda:0', dtype=torch.float16)
pruning layer 19 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.1719, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(1.1504, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
tensor(0.8159, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.9575, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0113, device='cuda:0')
tensor(0.0241, device='cuda:0')
old_score: tensor(0.0678, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0425, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.957589864730835
Validation after dual ascent:
out_inf: tensor(4.1719, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(0.6465, device='cuda:0', dtype=torch.float16) tensor(0.0433, device='cuda:0', dtype=torch.float16)
tensor(0.5093, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
tensor(0.5498, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
tensor(0.6045, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.3906, device='cuda:0', dtype=torch.float16) tensor(0.8369, device='cuda:0', dtype=torch.float16)
tensor(4.1094, device='cuda:0', dtype=torch.float16) tensor(0.3545, device='cuda:0', dtype=torch.float16)
tensor(4.1562, device='cuda:0', dtype=torch.float16) tensor(0.3486, device='cuda:0', dtype=torch.float16)
tensor(4.5156, device='cuda:0', dtype=torch.float16) tensor(0.3628, device='cuda:0', dtype=torch.float16)
tensor(4.3164, device='cuda:0', dtype=torch.float16) tensor(0.3479, device='cuda:0', dtype=torch.float16)
tensor(0.0343, device='cuda:0')
old_score: tensor(0.3535, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1335, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.182576894760132
Validation after dual ascent:
out_inf: tensor(16.3906, device='cuda:0', dtype=torch.float16) tensor(0.8369, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1354, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(1.5986, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.7969, device='cuda:0', dtype=torch.float16) tensor(1.0596, device='cuda:0', dtype=torch.float16)
tensor(4.5312, device='cuda:0', dtype=torch.float16) tensor(0.3733, device='cuda:0', dtype=torch.float16)
tensor(4.3438, device='cuda:0', dtype=torch.float16) tensor(0.3696, device='cuda:0', dtype=torch.float16)
tensor(5.0781, device='cuda:0', dtype=torch.float16) tensor(0.3831, device='cuda:0', dtype=torch.float16)
tensor(4.4219, device='cuda:0', dtype=torch.float16) tensor(0.3701, device='cuda:0', dtype=torch.float16)
tensor(0.0377, device='cuda:0')
old_score: tensor(0.3740, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1343, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.160094738006592
Validation after dual ascent:
out_inf: tensor(18.7969, device='cuda:0', dtype=torch.float16) tensor(1.0596, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.5859, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.v_proj
Validation after prune:
out_inf: tensor(3.6973, device='cuda:0', dtype=torch.float16) tensor(0.3450, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.2113, device='cuda:0', dtype=torch.float16)
tensor(1.7100, device='cuda:0', dtype=torch.float16) tensor(0.2064, device='cuda:0', dtype=torch.float16)
tensor(1.8848, device='cuda:0', dtype=torch.float16) tensor(0.2098, device='cuda:0', dtype=torch.float16)
tensor(1.8867, device='cuda:0', dtype=torch.float16) tensor(0.2078, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0121, device='cuda:0')
tensor(0.1661, device='cuda:0')
old_score: tensor(0.2087, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1017, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.235401153564453
Validation after dual ascent:
out_inf: tensor(3.6973, device='cuda:0', dtype=torch.float16) tensor(0.3450, device='cuda:0', dtype=torch.float16)
tensor(0.9097, device='cuda:0', dtype=torch.float16) tensor(0.1036, device='cuda:0', dtype=torch.float16)
tensor(0.9692, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(0.9863, device='cuda:0', dtype=torch.float16) tensor(0.0972, device='cuda:0', dtype=torch.float16)
pruning layer 20 name self_attn.o_proj
Validation after prune:
out_inf: tensor(11.6250, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.0857, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.0831, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.0689, device='cuda:0', dtype=torch.float16)
tensor(1.5117, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(0.0210, device='cuda:0')
old_score: tensor(0.0795, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0402, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.103368282318115
Validation after dual ascent:
out_inf: tensor(11.6250, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(0.7500, device='cuda:0', dtype=torch.float16) tensor(0.0407, device='cuda:0', dtype=torch.float16)
tensor(0.8906, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0404, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.7891, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(2.7930, device='cuda:0', dtype=torch.float16) tensor(0.1990, device='cuda:0', dtype=torch.float16)
tensor(2.8438, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
tensor(2.8301, device='cuda:0', dtype=torch.float16) tensor(0.2041, device='cuda:0', dtype=torch.float16)
tensor(2.7773, device='cuda:0', dtype=torch.float16) tensor(0.1958, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0143, device='cuda:0')
tensor(0.0193, device='cuda:0')
old_score: tensor(0.1978, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0887, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.183739185333252
Validation after dual ascent:
out_inf: tensor(7.7891, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(2.6250, device='cuda:0', dtype=torch.float16) tensor(0.0893, device='cuda:0', dtype=torch.float16)
tensor(1.5215, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.0960, device='cuda:0', dtype=torch.float16)
tensor(1.4414, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.1719, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.1604, device='cuda:0', dtype=torch.float16)
tensor(1.6758, device='cuda:0', dtype=torch.float16) tensor(0.1556, device='cuda:0', dtype=torch.float16)
tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.1630, device='cuda:0', dtype=torch.float16)
tensor(2.0195, device='cuda:0', dtype=torch.float16) tensor(0.1584, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0183, device='cuda:0')
tensor(0.1471, device='cuda:0')
old_score: tensor(0.1594, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0831, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.214043855667114
Validation after dual ascent:
out_inf: tensor(4.1719, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(1.3125, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.8232, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
tensor(0.8379, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(0.9043, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
pruning layer 20 name mlp.down_proj
Validation after prune:
out_inf: tensor(6.2109, device='cuda:0', dtype=torch.float16) tensor(0.1166, device='cuda:0', dtype=torch.float16)
tensor(0.8682, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(0.7705, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(0.9375, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0700, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0100, device='cuda:0')
tensor(0.0162, device='cuda:0')
old_score: tensor(0.0694, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0423, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.91468071937561
Validation after dual ascent:
out_inf: tensor(6.2109, device='cuda:0', dtype=torch.float16) tensor(0.1166, device='cuda:0', dtype=torch.float16)
tensor(0.5464, device='cuda:0', dtype=torch.float16) tensor(0.0427, device='cuda:0', dtype=torch.float16)
tensor(0.4878, device='cuda:0', dtype=torch.float16) tensor(0.0390, device='cuda:0', dtype=torch.float16)
tensor(0.5708, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.5654, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(0.7998, device='cuda:0', dtype=torch.float16)
tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3445, device='cuda:0', dtype=torch.float16)
tensor(4.0078, device='cuda:0', dtype=torch.float16) tensor(0.3403, device='cuda:0', dtype=torch.float16)
tensor(4.8203, device='cuda:0', dtype=torch.float16) tensor(0.3606, device='cuda:0', dtype=torch.float16)
tensor(4.5391, device='cuda:0', dtype=torch.float16) tensor(0.3401, device='cuda:0', dtype=torch.float16)
tensor(0.0841, device='cuda:0')
old_score: tensor(0.3462, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1312, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.18096923828125
Validation after dual ascent:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(0.7998, device='cuda:0', dtype=torch.float16)
tensor(1.6963, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
tensor(1.6953, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.4902, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.0625, device='cuda:0', dtype=torch.float16) tensor(1.0107, device='cuda:0', dtype=torch.float16)
tensor(4.7109, device='cuda:0', dtype=torch.float16) tensor(0.3582, device='cuda:0', dtype=torch.float16)
tensor(4.3438, device='cuda:0', dtype=torch.float16) tensor(0.3550, device='cuda:0', dtype=torch.float16)
tensor(4.4531, device='cuda:0', dtype=torch.float16) tensor(0.3743, device='cuda:0', dtype=torch.float16)
tensor(4.4531, device='cuda:0', dtype=torch.float16) tensor(0.3557, device='cuda:0', dtype=torch.float16)
tensor(0.0762, device='cuda:0')
old_score: tensor(0.3606, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1313, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.150298118591309
Validation after dual ascent:
out_inf: tensor(19.0625, device='cuda:0', dtype=torch.float16) tensor(1.0107, device='cuda:0', dtype=torch.float16)
tensor(2.1250, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.7305, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.5566, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.6055, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(2.0293, device='cuda:0', dtype=torch.float16) tensor(0.2223, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.2174, device='cuda:0', dtype=torch.float16)
tensor(2.0918, device='cuda:0', dtype=torch.float16) tensor(0.2236, device='cuda:0', dtype=torch.float16)
tensor(2.2754, device='cuda:0', dtype=torch.float16) tensor(0.2184, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0154, device='cuda:0')
tensor(0.0646, device='cuda:0')
old_score: tensor(0.2203, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1062, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.929336547851562
Validation after dual ascent:
out_inf: tensor(5.6055, device='cuda:0', dtype=torch.float16) tensor(0.3662, device='cuda:0', dtype=torch.float16)
tensor(1.0596, device='cuda:0', dtype=torch.float16) tensor(0.1069, device='cuda:0', dtype=torch.float16)
tensor(0.9414, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.1140, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1006, device='cuda:0', dtype=torch.float16)
pruning layer 21 name self_attn.o_proj
Validation after prune:
out_inf: tensor(7.2188, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.7441, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(1.7070, device='cuda:0', dtype=torch.float16) tensor(0.0930, device='cuda:0', dtype=torch.float16)
tensor(2.0020, device='cuda:0', dtype=torch.float16) tensor(0.0890, device='cuda:0', dtype=torch.float16)
tensor(2.2383, device='cuda:0', dtype=torch.float16) tensor(0.0828, device='cuda:0', dtype=torch.float16)
tensor(0.0368, device='cuda:0')
old_score: tensor(0.0898, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0495, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.11397409439087
Validation after dual ascent:
out_inf: tensor(7.2188, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.9062, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.0448, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.4883, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(2.7637, device='cuda:0', dtype=torch.float16) tensor(0.2021, device='cuda:0', dtype=torch.float16)
tensor(2.5059, device='cuda:0', dtype=torch.float16) tensor(0.1980, device='cuda:0', dtype=torch.float16)
tensor(2.8457, device='cuda:0', dtype=torch.float16) tensor(0.2072, device='cuda:0', dtype=torch.float16)
tensor(2.7852, device='cuda:0', dtype=torch.float16) tensor(0.1998, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0146, device='cuda:0')
tensor(0.0209, device='cuda:0')
old_score: tensor(0.2018, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0916, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.174910306930542
Validation after dual ascent:
out_inf: tensor(7.4883, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(1.2471, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
tensor(1.9648, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(1.4219, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.0866, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.5000, device='cuda:0', dtype=torch.float16) tensor(0.2693, device='cuda:0', dtype=torch.float16)
tensor(2.0332, device='cuda:0', dtype=torch.float16) tensor(0.1622, device='cuda:0', dtype=torch.float16)
tensor(1.9492, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(1.9355, device='cuda:0', dtype=torch.float16) tensor(0.1633, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0191, device='cuda:0')
tensor(0.1589, device='cuda:0')
old_score: tensor(0.1608, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0852, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.214660167694092
Validation after dual ascent:
out_inf: tensor(5.5000, device='cuda:0', dtype=torch.float16) tensor(0.2693, device='cuda:0', dtype=torch.float16)
tensor(0.8618, device='cuda:0', dtype=torch.float16) tensor(0.0849, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.0831, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.0805, device='cuda:0', dtype=torch.float16)
pruning layer 21 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.4590, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(0.9136, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.9365, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0089, device='cuda:0')
tensor(0.0115, device='cuda:0')
old_score: tensor(0.0662, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0414, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.947667598724365
Validation after dual ascent:
out_inf: tensor(3.4590, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(0.6069, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.4585, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.5420, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.q_proj
Validation after prune:
out_inf: tensor(18.4531, device='cuda:0', dtype=torch.float16) tensor(0.8647, device='cuda:0', dtype=torch.float16)
tensor(4.3359, device='cuda:0', dtype=torch.float16) tensor(0.3625, device='cuda:0', dtype=torch.float16)
tensor(4.0859, device='cuda:0', dtype=torch.float16) tensor(0.3589, device='cuda:0', dtype=torch.float16)
tensor(4.2031, device='cuda:0', dtype=torch.float16) tensor(0.3789, device='cuda:0', dtype=torch.float16)
tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3591, device='cuda:0', dtype=torch.float16)
tensor(0.0910, device='cuda:0')
old_score: tensor(0.3650, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.173811197280884
Validation after dual ascent:
out_inf: tensor(18.4531, device='cuda:0', dtype=torch.float16) tensor(0.8647, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.k_proj
Validation after prune:
out_inf: tensor(20.9375, device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(4.6172, device='cuda:0', dtype=torch.float16) tensor(0.3721, device='cuda:0', dtype=torch.float16)
tensor(4.1250, device='cuda:0', dtype=torch.float16) tensor(0.3716, device='cuda:0', dtype=torch.float16)
tensor(4.5938, device='cuda:0', dtype=torch.float16) tensor(0.3899, device='cuda:0', dtype=torch.float16)
tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3716, device='cuda:0', dtype=torch.float16)
tensor(0.0910, device='cuda:0')
old_score: tensor(0.3765, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.158288955688477
Validation after dual ascent:
out_inf: tensor(20.9375, device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(2.0938, device='cuda:0', dtype=torch.float16) tensor(0.1372, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1356, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.7979, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.2422, device='cuda:0', dtype=torch.float16) tensor(0.3757, device='cuda:0', dtype=torch.float16)
tensor(2.4297, device='cuda:0', dtype=torch.float16) tensor(0.2300, device='cuda:0', dtype=torch.float16)
tensor(2.3945, device='cuda:0', dtype=torch.float16) tensor(0.2271, device='cuda:0', dtype=torch.float16)
tensor(1.8730, device='cuda:0', dtype=torch.float16) tensor(0.2324, device='cuda:0', dtype=torch.float16)
tensor(2.1211, device='cuda:0', dtype=torch.float16) tensor(0.2269, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0172, device='cuda:0')
tensor(0.0776, device='cuda:0')
old_score: tensor(0.2291, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1090, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.947184562683105
Validation after dual ascent:
out_inf: tensor(7.2422, device='cuda:0', dtype=torch.float16) tensor(0.3757, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.1067, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
pruning layer 22 name self_attn.o_proj
Validation after prune:
out_inf: tensor(11.5938, device='cuda:0', dtype=torch.float16) tensor(0.1716, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
tensor(1.1250, device='cuda:0', dtype=torch.float16) tensor(0.0908, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0852, device='cuda:0', dtype=torch.float16)
tensor(0.8496, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(0.0609, device='cuda:0')
old_score: tensor(0.0917, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0518, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.112640380859375
Validation after dual ascent:
out_inf: tensor(11.5938, device='cuda:0', dtype=torch.float16) tensor(0.1716, device='cuda:0', dtype=torch.float16)
tensor(0.5234, device='cuda:0', dtype=torch.float16) tensor(0.0495, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(0.5742, device='cuda:0', dtype=torch.float16) tensor(0.0523, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.3203, device='cuda:0', dtype=torch.float16) tensor(0.3540, device='cuda:0', dtype=torch.float16)
tensor(3.2090, device='cuda:0', dtype=torch.float16) tensor(0.1976, device='cuda:0', dtype=torch.float16)
tensor(3.2773, device='cuda:0', dtype=torch.float16) tensor(0.1915, device='cuda:0', dtype=torch.float16)
tensor(3.1875, device='cuda:0', dtype=torch.float16) tensor(0.1964, device='cuda:0', dtype=torch.float16)
tensor(3.3926, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0141, device='cuda:0')
tensor(0.0186, device='cuda:0')
old_score: tensor(0.1943, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0906, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.18060827255249
Validation after dual ascent:
out_inf: tensor(7.3203, device='cuda:0', dtype=torch.float16) tensor(0.3540, device='cuda:0', dtype=torch.float16)
tensor(1.8086, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(2.2812, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.8320, device='cuda:0', dtype=torch.float16) tensor(0.2688, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1613, device='cuda:0', dtype=torch.float16)
tensor(1.7090, device='cuda:0', dtype=torch.float16) tensor(0.1564, device='cuda:0', dtype=torch.float16)
tensor(1.8926, device='cuda:0', dtype=torch.float16) tensor(0.1600, device='cuda:0', dtype=torch.float16)
tensor(1.7188, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0177, device='cuda:0')
tensor(0.1404, device='cuda:0')
old_score: tensor(0.1587, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0836, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2155539989471436
Validation after dual ascent:
out_inf: tensor(4.8320, device='cuda:0', dtype=torch.float16) tensor(0.2688, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.8887, device='cuda:0', dtype=torch.float16) tensor(0.0818, device='cuda:0', dtype=torch.float16)
tensor(0.8345, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
pruning layer 22 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.9883, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(0.7393, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.6318, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(0.6768, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0647, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0090, device='cuda:0')
tensor(0.0120, device='cuda:0')
old_score: tensor(0.0642, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0402, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.9539213180542
Validation after dual ascent:
out_inf: tensor(1.9883, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(0.5015, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(0.4524, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
tensor(0.4185, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(0.4429, device='cuda:0', dtype=torch.float16) tensor(0.0378, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.5000, device='cuda:0', dtype=torch.float16) tensor(0.8574, device='cuda:0', dtype=torch.float16)
tensor(3.9453, device='cuda:0', dtype=torch.float16) tensor(0.3687, device='cuda:0', dtype=torch.float16)
tensor(3.8984, device='cuda:0', dtype=torch.float16) tensor(0.3652, device='cuda:0', dtype=torch.float16)
tensor(4.4844, device='cuda:0', dtype=torch.float16) tensor(0.3838, device='cuda:0', dtype=torch.float16)
tensor(3.5703, device='cuda:0', dtype=torch.float16) tensor(0.3633, device='cuda:0', dtype=torch.float16)
tensor(0.1968, device='cuda:0')
old_score: tensor(0.3701, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1438, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.16504979133606
Validation after dual ascent:
out_inf: tensor(16.5000, device='cuda:0', dtype=torch.float16) tensor(0.8574, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1406, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.7432, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(1.6934, device='cuda:0', dtype=torch.float16) tensor(0.1343, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.0029, device='cuda:0', dtype=torch.float16)
tensor(4.0469, device='cuda:0', dtype=torch.float16) tensor(0.3777, device='cuda:0', dtype=torch.float16)
tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.3774, device='cuda:0', dtype=torch.float16)
tensor(4.3281, device='cuda:0', dtype=torch.float16) tensor(0.3940, device='cuda:0', dtype=torch.float16)
tensor(4.1484, device='cuda:0', dtype=torch.float16) tensor(0.3765, device='cuda:0', dtype=torch.float16)
tensor(0.2190, device='cuda:0')
old_score: tensor(0.3813, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1438, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.162301063537598
Validation after dual ascent:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.0029, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
tensor(1.6396, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.8545, device='cuda:0', dtype=torch.float16) tensor(0.1583, device='cuda:0', dtype=torch.float16)
tensor(1.6582, device='cuda:0', dtype=torch.float16) tensor(0.1345, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.v_proj
Validation after prune:
out_inf: tensor(4.4180, device='cuda:0', dtype=torch.float16) tensor(0.4133, device='cuda:0', dtype=torch.float16)
tensor(1.9766, device='cuda:0', dtype=torch.float16) tensor(0.2505, device='cuda:0', dtype=torch.float16)
tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.2479, device='cuda:0', dtype=torch.float16)
tensor(2.0117, device='cuda:0', dtype=torch.float16) tensor(0.2517, device='cuda:0', dtype=torch.float16)
tensor(2.0977, device='cuda:0', dtype=torch.float16) tensor(0.2463, device='cuda:0', dtype=torch.float16)
tensor(0.1339, device='cuda:0')
old_score: tensor(0.2490, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1207, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.175239562988281
Validation after dual ascent:
out_inf: tensor(4.4180, device='cuda:0', dtype=torch.float16) tensor(0.4133, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.1186, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(1.1807, device='cuda:0', dtype=torch.float16) tensor(0.1131, device='cuda:0', dtype=torch.float16)
pruning layer 23 name self_attn.o_proj
Validation after prune:
out_inf: tensor(16.1094, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(1.8945, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
tensor(1.8984, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.0816, device='cuda:0', dtype=torch.float16)
tensor(2.0938, device='cuda:0', dtype=torch.float16) tensor(0.0848, device='cuda:0', dtype=torch.float16)
tensor(0.0685, device='cuda:0')
old_score: tensor(0.0891, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0522, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.12300968170166
Validation after dual ascent:
out_inf: tensor(16.1094, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(0.7188, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0550, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0545, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.3359, device='cuda:0', dtype=torch.float16) tensor(0.3772, device='cuda:0', dtype=torch.float16)
tensor(3.5664, device='cuda:0', dtype=torch.float16) tensor(0.2104, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.2089, device='cuda:0', dtype=torch.float16)
tensor(2.9336, device='cuda:0', dtype=torch.float16) tensor(0.2156, device='cuda:0', dtype=torch.float16)
tensor(3.0508, device='cuda:0', dtype=torch.float16) tensor(0.2079, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0155, device='cuda:0')
tensor(0.0236, device='cuda:0')
old_score: tensor(0.2107, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0957, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.193852186203003
Validation after dual ascent:
out_inf: tensor(9.3359, device='cuda:0', dtype=torch.float16) tensor(0.3772, device='cuda:0', dtype=torch.float16)
tensor(1.2373, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.0940, device='cuda:0', dtype=torch.float16)
tensor(1.4150, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
tensor(1.6797, device='cuda:0', dtype=torch.float16) tensor(0.0892, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.1875, device='cuda:0', dtype=torch.float16) tensor(0.2791, device='cuda:0', dtype=torch.float16)
tensor(2.0762, device='cuda:0', dtype=torch.float16) tensor(0.1693, device='cuda:0', dtype=torch.float16)
tensor(1.9766, device='cuda:0', dtype=torch.float16) tensor(0.1665, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1733, device='cuda:0', dtype=torch.float16)
tensor(2.0410, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0090, device='cuda:0')
tensor(0.0191, device='cuda:0')
old_score: tensor(0.1687, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0888, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.184478759765625
Validation after dual ascent:
out_inf: tensor(6.1875, device='cuda:0', dtype=torch.float16) tensor(0.2791, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0865, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0874, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
tensor(1.3164, device='cuda:0', dtype=torch.float16) tensor(0.0827, device='cuda:0', dtype=torch.float16)
pruning layer 23 name mlp.down_proj
Validation after prune:
out_inf: tensor(9.4844, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(0.6353, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.5947, device='cuda:0', dtype=torch.float16) tensor(0.0675, device='cuda:0', dtype=torch.float16)
tensor(0.6562, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0176, device='cuda:0')
tensor(0.0360, device='cuda:0')
old_score: tensor(0.0701, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0441, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.081463098526
Validation after dual ascent:
out_inf: tensor(9.4844, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(0.4783, device='cuda:0', dtype=torch.float16) tensor(0.0434, device='cuda:0', dtype=torch.float16)
tensor(0.4639, device='cuda:0', dtype=torch.float16) tensor(0.0429, device='cuda:0', dtype=torch.float16)
tensor(0.4553, device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
tensor(0.5063, device='cuda:0', dtype=torch.float16) tensor(0.0407, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17.2969, device='cuda:0', dtype=torch.float16) tensor(0.8066, device='cuda:0', dtype=torch.float16)
tensor(4.4961, device='cuda:0', dtype=torch.float16) tensor(0.3418, device='cuda:0', dtype=torch.float16)
tensor(4.2109, device='cuda:0', dtype=torch.float16) tensor(0.3428, device='cuda:0', dtype=torch.float16)
tensor(4.7578, device='cuda:0', dtype=torch.float16) tensor(0.3696, device='cuda:0', dtype=torch.float16)
tensor(3.9727, device='cuda:0', dtype=torch.float16) tensor(0.3367, device='cuda:0', dtype=torch.float16)
tensor(0.0793, device='cuda:0')
old_score: tensor(0.3479, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1355, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.163841247558594
Validation after dual ascent:
out_inf: tensor(17.2969, device='cuda:0', dtype=torch.float16) tensor(0.8066, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.1310, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
tensor(1.8193, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
tensor(1.8516, device='cuda:0', dtype=torch.float16) tensor(0.1250, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.5938, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(4.3516, device='cuda:0', dtype=torch.float16) tensor(0.3579, device='cuda:0', dtype=torch.float16)
tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.3584, device='cuda:0', dtype=torch.float16)
tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.3823, device='cuda:0', dtype=torch.float16)
tensor(3.4141, device='cuda:0', dtype=torch.float16) tensor(0.3540, device='cuda:0', dtype=torch.float16)
tensor(0.0890, device='cuda:0')
old_score: tensor(0.3633, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1349, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.158671617507935
Validation after dual ascent:
out_inf: tensor(18.5938, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(1.6465, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
tensor(1.9502, device='cuda:0', dtype=torch.float16) tensor(0.1332, device='cuda:0', dtype=torch.float16)
tensor(1.7148, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(1.6172, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.9492, device='cuda:0', dtype=torch.float16) tensor(0.3984, device='cuda:0', dtype=torch.float16)
tensor(2.2461, device='cuda:0', dtype=torch.float16) tensor(0.2399, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.2413, device='cuda:0', dtype=torch.float16)
tensor(2.2910, device='cuda:0', dtype=torch.float16) tensor(0.2493, device='cuda:0', dtype=torch.float16)
tensor(2.2090, device='cuda:0', dtype=torch.float16) tensor(0.2361, device='cuda:0', dtype=torch.float16)
tensor(0.0473, device='cuda:0')
old_score: tensor(0.2417, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1168, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.16250467300415
Validation after dual ascent:
out_inf: tensor(5.9492, device='cuda:0', dtype=torch.float16) tensor(0.3984, device='cuda:0', dtype=torch.float16)
tensor(1.1963, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.1221, device='cuda:0', dtype=torch.float16) tensor(0.1307, device='cuda:0', dtype=torch.float16)
tensor(1.1855, device='cuda:0', dtype=torch.float16) tensor(0.1079, device='cuda:0', dtype=torch.float16)
pruning layer 24 name self_attn.o_proj
Validation after prune:
out_inf: tensor(15.3438, device='cuda:0', dtype=torch.float16) tensor(0.1991, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1172, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
tensor(1.3906, device='cuda:0', dtype=torch.float16) tensor(0.1142, device='cuda:0', dtype=torch.float16)
tensor(0.1123, device='cuda:0')
old_score: tensor(0.1154, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0646, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.123923063278198
Validation after dual ascent:
out_inf: tensor(15.3438, device='cuda:0', dtype=torch.float16) tensor(0.1991, device='cuda:0', dtype=torch.float16)
tensor(0.7383, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0647, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0615, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.8359, device='cuda:0', dtype=torch.float16) tensor(0.3765, device='cuda:0', dtype=torch.float16)
tensor(3.1016, device='cuda:0', dtype=torch.float16) tensor(0.2081, device='cuda:0', dtype=torch.float16)
tensor(3.3047, device='cuda:0', dtype=torch.float16) tensor(0.2122, device='cuda:0', dtype=torch.float16)
tensor(3.0234, device='cuda:0', dtype=torch.float16) tensor(0.2161, device='cuda:0', dtype=torch.float16)
tensor(3.1309, device='cuda:0', dtype=torch.float16) tensor(0.2075, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0161, device='cuda:0')
tensor(0.0240, device='cuda:0')
old_score: tensor(0.2111, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0975, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.191580772399902
Validation after dual ascent:
out_inf: tensor(8.8359, device='cuda:0', dtype=torch.float16) tensor(0.3765, device='cuda:0', dtype=torch.float16)
tensor(1.5156, device='cuda:0', dtype=torch.float16) tensor(0.0937, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.1090, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.0905, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.up_proj
Validation after prune:
out_inf: tensor(4.6641, device='cuda:0', dtype=torch.float16) tensor(0.2803, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.1708, device='cuda:0', dtype=torch.float16)
tensor(2.0918, device='cuda:0', dtype=torch.float16) tensor(0.1757, device='cuda:0', dtype=torch.float16)
tensor(1.9727, device='cuda:0', dtype=torch.float16) tensor(0.1666, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0096, device='cuda:0')
tensor(0.0197, device='cuda:0')
old_score: tensor(0.1707, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0905, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.19162631034851
Validation after dual ascent:
out_inf: tensor(4.6641, device='cuda:0', dtype=torch.float16) tensor(0.2803, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0868, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.0897, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(1.1592, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
pruning layer 24 name mlp.down_proj
Validation after prune:
out_inf: tensor(5.8750, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(0.7358, device='cuda:0', dtype=torch.float16) tensor(0.0722, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.6699, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.6455, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0190, device='cuda:0')
tensor(0.0413, device='cuda:0')
old_score: tensor(0.0714, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0445, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.06108045578003
Validation after dual ascent:
out_inf: tensor(5.8750, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(0.5454, device='cuda:0', dtype=torch.float16) tensor(0.0432, device='cuda:0', dtype=torch.float16)
tensor(0.6631, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
tensor(0.4893, device='cuda:0', dtype=torch.float16) tensor(0.0511, device='cuda:0', dtype=torch.float16)
tensor(0.5171, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.1484, device='cuda:0', dtype=torch.float16) tensor(0.8008, device='cuda:0', dtype=torch.float16)
tensor(4.4609, device='cuda:0', dtype=torch.float16) tensor(0.3484, device='cuda:0', dtype=torch.float16)
tensor(4.5234, device='cuda:0', dtype=torch.float16) tensor(0.3489, device='cuda:0', dtype=torch.float16)
tensor(4.7344, device='cuda:0', dtype=torch.float16) tensor(0.3694, device='cuda:0', dtype=torch.float16)
tensor(4.0977, device='cuda:0', dtype=torch.float16) tensor(0.3430, device='cuda:0', dtype=torch.float16)
tensor(0.0236, device='cuda:0')
old_score: tensor(0.3523, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1425, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.171355485916138
Validation after dual ascent:
out_inf: tensor(15.1484, device='cuda:0', dtype=torch.float16) tensor(0.8008, device='cuda:0', dtype=torch.float16)
tensor(1.8262, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.7559, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.8340, device='cuda:0', dtype=torch.float16) tensor(0.1614, device='cuda:0', dtype=torch.float16)
tensor(1.7236, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.5000, device='cuda:0', dtype=torch.float16) tensor(0.9473, device='cuda:0', dtype=torch.float16)
tensor(4.1953, device='cuda:0', dtype=torch.float16) tensor(0.3604, device='cuda:0', dtype=torch.float16)
tensor(3.9531, device='cuda:0', dtype=torch.float16) tensor(0.3618, device='cuda:0', dtype=torch.float16)
tensor(4.3594, device='cuda:0', dtype=torch.float16) tensor(0.3828, device='cuda:0', dtype=torch.float16)
tensor(4.1250, device='cuda:0', dtype=torch.float16) tensor(0.3550, device='cuda:0', dtype=torch.float16)
tensor(0.0275, device='cuda:0')
old_score: tensor(0.3652, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1426, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.158238887786865
Validation after dual ascent:
out_inf: tensor(19.5000, device='cuda:0', dtype=torch.float16) tensor(0.9473, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.1365, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1417, device='cuda:0', dtype=torch.float16)
tensor(1.6777, device='cuda:0', dtype=torch.float16) tensor(0.1614, device='cuda:0', dtype=torch.float16)
tensor(1.8203, device='cuda:0', dtype=torch.float16) tensor(0.1307, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.1914, device='cuda:0', dtype=torch.float16) tensor(0.4197, device='cuda:0', dtype=torch.float16)
tensor(2.3340, device='cuda:0', dtype=torch.float16) tensor(0.2554, device='cuda:0', dtype=torch.float16)
tensor(2.2676, device='cuda:0', dtype=torch.float16) tensor(0.2578, device='cuda:0', dtype=torch.float16)
tensor(2.3613, device='cuda:0', dtype=torch.float16) tensor(0.2683, device='cuda:0', dtype=torch.float16)
tensor(2.0859, device='cuda:0', dtype=torch.float16) tensor(0.2517, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0152, device='cuda:0')
tensor(0.2704, device='cuda:0')
old_score: tensor(0.2583, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1277, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.235952854156494
Validation after dual ascent:
out_inf: tensor(5.1914, device='cuda:0', dtype=torch.float16) tensor(0.4197, device='cuda:0', dtype=torch.float16)
tensor(1.4316, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.3994, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(1.4482, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
pruning layer 25 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.3867, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(1.6133, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(1.8994, device='cuda:0', dtype=torch.float16) tensor(0.0997, device='cuda:0', dtype=torch.float16)
tensor(2.1465, device='cuda:0', dtype=torch.float16) tensor(0.0807, device='cuda:0', dtype=torch.float16)
tensor(1.8359, device='cuda:0', dtype=torch.float16) tensor(0.0952, device='cuda:0', dtype=torch.float16)
tensor(0.1012, device='cuda:0')
old_score: tensor(0.0912, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0471, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.09752607345581
Validation after dual ascent:
out_inf: tensor(5.3867, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.0478, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0502, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.7852, device='cuda:0', dtype=torch.float16) tensor(0.3975, device='cuda:0', dtype=torch.float16)
tensor(2.6484, device='cuda:0', dtype=torch.float16) tensor(0.2227, device='cuda:0', dtype=torch.float16)
tensor(2.6523, device='cuda:0', dtype=torch.float16) tensor(0.2290, device='cuda:0', dtype=torch.float16)
tensor(2.9258, device='cuda:0', dtype=torch.float16) tensor(0.2294, device='cuda:0', dtype=torch.float16)
tensor(3.3203, device='cuda:0', dtype=torch.float16) tensor(0.2207, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0185, device='cuda:0')
tensor(0.0269, device='cuda:0')
old_score: tensor(0.2255, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0984, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.180237531661987
Validation after dual ascent:
out_inf: tensor(7.7852, device='cuda:0', dtype=torch.float16) tensor(0.3975, device='cuda:0', dtype=torch.float16)
tensor(1.6543, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(1.4609, device='cuda:0', dtype=torch.float16) tensor(0.0977, device='cuda:0', dtype=torch.float16)
tensor(1.4629, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(2.6875, device='cuda:0', dtype=torch.float16) tensor(0.0907, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.6562, device='cuda:0', dtype=torch.float16) tensor(0.2922, device='cuda:0', dtype=torch.float16)
tensor(2.5898, device='cuda:0', dtype=torch.float16) tensor(0.1758, device='cuda:0', dtype=torch.float16)
tensor(2.6250, device='cuda:0', dtype=torch.float16) tensor(0.1776, device='cuda:0', dtype=torch.float16)
tensor(2.6094, device='cuda:0', dtype=torch.float16) tensor(0.1821, device='cuda:0', dtype=torch.float16)
tensor(2.6016, device='cuda:0', dtype=torch.float16) tensor(0.1730, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0110, device='cuda:0')
tensor(0.0216, device='cuda:0')
old_score: tensor(0.1771, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0916, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.18978476524353
Validation after dual ascent:
out_inf: tensor(7.6562, device='cuda:0', dtype=torch.float16) tensor(0.2922, device='cuda:0', dtype=torch.float16)
tensor(0.9492, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.9951, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
tensor(0.9893, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
pruning layer 25 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.1504, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(0.7080, device='cuda:0', dtype=torch.float16) tensor(0.0799, device='cuda:0', dtype=torch.float16)
tensor(0.8193, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
tensor(0.7881, device='cuda:0', dtype=torch.float16) tensor(0.0876, device='cuda:0', dtype=torch.float16)
tensor(1.0576, device='cuda:0', dtype=torch.float16) tensor(0.0773, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0159, device='cuda:0')
tensor(0.0362, device='cuda:0')
old_score: tensor(0.0826, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0469, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 16.99604606628418
Validation after dual ascent:
out_inf: tensor(3.1504, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(0.5596, device='cuda:0', dtype=torch.float16) tensor(0.0446, device='cuda:0', dtype=torch.float16)
tensor(0.6274, device='cuda:0', dtype=torch.float16) tensor(0.0461, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
tensor(0.9409, device='cuda:0', dtype=torch.float16) tensor(0.0423, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.5781, device='cuda:0', dtype=torch.float16) tensor(0.8682, device='cuda:0', dtype=torch.float16)
tensor(4.1328, device='cuda:0', dtype=torch.float16) tensor(0.3713, device='cuda:0', dtype=torch.float16)
tensor(4.0273, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(4.5039, device='cuda:0', dtype=torch.float16) tensor(0.3916, device='cuda:0', dtype=torch.float16)
tensor(3.8672, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(0.0502, device='cuda:0')
old_score: tensor(0.3760, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1443, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.165229320526123
Validation after dual ascent:
out_inf: tensor(16.5781, device='cuda:0', dtype=torch.float16) tensor(0.8682, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.1449, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1647, device='cuda:0', dtype=torch.float16)
tensor(1.8633, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19., device='cuda:0', dtype=torch.float16) tensor(1.0605, device='cuda:0', dtype=torch.float16)
tensor(4.6094, device='cuda:0', dtype=torch.float16) tensor(0.3821, device='cuda:0', dtype=torch.float16)
tensor(4.1406, device='cuda:0', dtype=torch.float16) tensor(0.3918, device='cuda:0', dtype=torch.float16)
tensor(4.7422, device='cuda:0', dtype=torch.float16) tensor(0.4058, device='cuda:0', dtype=torch.float16)
tensor(4.4297, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(0.0561, device='cuda:0')
old_score: tensor(0.3889, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1440, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.149922847747803
Validation after dual ascent:
out_inf: tensor(19., device='cuda:0', dtype=torch.float16) tensor(1.0605, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.6699, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.7939, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.8555, device='cuda:0', dtype=torch.float16) tensor(0.4382, device='cuda:0', dtype=torch.float16)
tensor(2.4004, device='cuda:0', dtype=torch.float16) tensor(0.2664, device='cuda:0', dtype=torch.float16)
tensor(2.4219, device='cuda:0', dtype=torch.float16) tensor(0.2756, device='cuda:0', dtype=torch.float16)
tensor(2.3086, device='cuda:0', dtype=torch.float16) tensor(0.2788, device='cuda:0', dtype=torch.float16)
tensor(2.4473, device='cuda:0', dtype=torch.float16) tensor(0.2649, device='cuda:0', dtype=torch.float16)
tensor(0.0369, device='cuda:0')
old_score: tensor(0.2715, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1307, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.177502155303955
Validation after dual ascent:
out_inf: tensor(5.8555, device='cuda:0', dtype=torch.float16) tensor(0.4382, device='cuda:0', dtype=torch.float16)
tensor(1.3867, device='cuda:0', dtype=torch.float16) tensor(0.1241, device='cuda:0', dtype=torch.float16)
tensor(1.3838, device='cuda:0', dtype=torch.float16) tensor(0.1315, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1482, device='cuda:0', dtype=torch.float16)
tensor(1.6963, device='cuda:0', dtype=torch.float16) tensor(0.1193, device='cuda:0', dtype=torch.float16)
pruning layer 26 name self_attn.o_proj
Validation after prune:
out_inf: tensor(23.7812, device='cuda:0', dtype=torch.float16) tensor(0.2175, device='cuda:0', dtype=torch.float16)
tensor(2.8750, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(3.1953, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(2.8281, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(2.8047, device='cuda:0', dtype=torch.float16) tensor(0.1254, device='cuda:0', dtype=torch.float16)
tensor(0.0659, device='cuda:0')
old_score: tensor(0.1289, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0668, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.126561880111694
Validation after dual ascent:
out_inf: tensor(23.7812, device='cuda:0', dtype=torch.float16) tensor(0.2175, device='cuda:0', dtype=torch.float16)
tensor(1.1592, device='cuda:0', dtype=torch.float16) tensor(0.0611, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.0665, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.0606, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.gate_proj
Validation after prune:
out_inf: tensor(7.6250, device='cuda:0', dtype=torch.float16) tensor(0.4246, device='cuda:0', dtype=torch.float16)
tensor(2.8398, device='cuda:0', dtype=torch.float16) tensor(0.2269, device='cuda:0', dtype=torch.float16)
tensor(4.2656, device='cuda:0', dtype=torch.float16) tensor(0.2386, device='cuda:0', dtype=torch.float16)
tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.2418, device='cuda:0', dtype=torch.float16)
tensor(2.6621, device='cuda:0', dtype=torch.float16) tensor(0.2256, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0143, device='cuda:0')
tensor(0.0147, device='cuda:0')
old_score: tensor(0.2333, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1007, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.136207103729248
Validation after dual ascent:
out_inf: tensor(7.6250, device='cuda:0', dtype=torch.float16) tensor(0.4246, device='cuda:0', dtype=torch.float16)
tensor(1.6973, device='cuda:0', dtype=torch.float16) tensor(0.0951, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(1.8896, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.up_proj
Validation after prune:
out_inf: tensor(5.8242, device='cuda:0', dtype=torch.float16) tensor(0.3140, device='cuda:0', dtype=torch.float16)
tensor(2.1035, device='cuda:0', dtype=torch.float16) tensor(0.1833, device='cuda:0', dtype=torch.float16)
tensor(2.3535, device='cuda:0', dtype=torch.float16) tensor(0.1874, device='cuda:0', dtype=torch.float16)
tensor(2.4102, device='cuda:0', dtype=torch.float16) tensor(0.1945, device='cuda:0', dtype=torch.float16)
tensor(2.1211, device='cuda:0', dtype=torch.float16) tensor(0.1798, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0137, device='cuda:0')
tensor(0.0247, device='cuda:0')
old_score: tensor(0.1862, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0939, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.191954135894775
Validation after dual ascent:
out_inf: tensor(5.8242, device='cuda:0', dtype=torch.float16) tensor(0.3140, device='cuda:0', dtype=torch.float16)
tensor(1.0557, device='cuda:0', dtype=torch.float16) tensor(0.0888, device='cuda:0', dtype=torch.float16)
tensor(0.9717, device='cuda:0', dtype=torch.float16) tensor(0.0937, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
pruning layer 26 name mlp.down_proj
Validation after prune:
out_inf: tensor(3.2891, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
tensor(0.8877, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(0.8389, device='cuda:0', dtype=torch.float16) tensor(0.0852, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.9111, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0194, device='cuda:0')
tensor(0.0471, device='cuda:0')
old_score: tensor(0.0874, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0515, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.042242527008057
Validation after dual ascent:
out_inf: tensor(3.2891, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
tensor(0.8540, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
tensor(0.6816, device='cuda:0', dtype=torch.float16) tensor(0.0508, device='cuda:0', dtype=torch.float16)
tensor(0.6440, device='cuda:0', dtype=torch.float16) tensor(0.0606, device='cuda:0', dtype=torch.float16)
tensor(0.5034, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.q_proj
Validation after prune:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(0.8193, device='cuda:0', dtype=torch.float16)
tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.3608, device='cuda:0', dtype=torch.float16)
tensor(4.8125, device='cuda:0', dtype=torch.float16) tensor(0.3643, device='cuda:0', dtype=torch.float16)
tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.3823, device='cuda:0', dtype=torch.float16)
tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.3538, device='cuda:0', dtype=torch.float16)
tensor(0.3640, device='cuda:0')
old_score: tensor(0.3652, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1434, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.187363386154175
Validation after dual ascent:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(0.8193, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1644, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.4844, device='cuda:0', dtype=torch.float16) tensor(0.9512, device='cuda:0', dtype=torch.float16)
tensor(5.2422, device='cuda:0', dtype=torch.float16) tensor(0.3828, device='cuda:0', dtype=torch.float16)
tensor(5.2812, device='cuda:0', dtype=torch.float16) tensor(0.3914, device='cuda:0', dtype=torch.float16)
tensor(6.2734, device='cuda:0', dtype=torch.float16) tensor(0.4065, device='cuda:0', dtype=torch.float16)
tensor(4.5703, device='cuda:0', dtype=torch.float16) tensor(0.3757, device='cuda:0', dtype=torch.float16)
tensor(0.3558, device='cuda:0')
old_score: tensor(0.3892, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1443, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.150066614151001
Validation after dual ascent:
out_inf: tensor(17.4844, device='cuda:0', dtype=torch.float16) tensor(0.9512, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1443, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.1656, device='cuda:0', dtype=torch.float16)
tensor(2.1523, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.5469, device='cuda:0', dtype=torch.float16) tensor(0.4202, device='cuda:0', dtype=torch.float16)
tensor(2.0762, device='cuda:0', dtype=torch.float16) tensor(0.2571, device='cuda:0', dtype=torch.float16)
tensor(1.9785, device='cuda:0', dtype=torch.float16) tensor(0.2664, device='cuda:0', dtype=torch.float16)
tensor(2.3711, device='cuda:0', dtype=torch.float16) tensor(0.2708, device='cuda:0', dtype=torch.float16)
tensor(1.9863, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(0.2512, device='cuda:0')
old_score: tensor(0.2617, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1250, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.178232669830322
Validation after dual ascent:
out_inf: tensor(7.5469, device='cuda:0', dtype=torch.float16) tensor(0.4202, device='cuda:0', dtype=torch.float16)
tensor(1.3506, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(1.1230, device='cuda:0', dtype=torch.float16) tensor(0.1257, device='cuda:0', dtype=torch.float16)
tensor(1.4072, device='cuda:0', dtype=torch.float16) tensor(0.1431, device='cuda:0', dtype=torch.float16)
tensor(1.3105, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
pruning layer 27 name self_attn.o_proj
Validation after prune:
out_inf: tensor(5.8008, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(1.7852, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(1.3340, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(1.6191, device='cuda:0', dtype=torch.float16) tensor(0.0824, device='cuda:0', dtype=torch.float16)
tensor(0.0748, device='cuda:0')
old_score: tensor(0.0780, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0357, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.120183229446411
Validation after dual ascent:
out_inf: tensor(5.8008, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.7988, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.6719, device='cuda:0', dtype=torch.float16) tensor(0.4497, device='cuda:0', dtype=torch.float16)
tensor(3.9570, device='cuda:0', dtype=torch.float16) tensor(0.2411, device='cuda:0', dtype=torch.float16)
tensor(3.6875, device='cuda:0', dtype=torch.float16) tensor(0.2568, device='cuda:0', dtype=torch.float16)
tensor(4.7812, device='cuda:0', dtype=torch.float16) tensor(0.2542, device='cuda:0', dtype=torch.float16)
tensor(4.0195, device='cuda:0', dtype=torch.float16) tensor(0.2404, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0162, device='cuda:0')
tensor(0.0166, device='cuda:0')
old_score: tensor(0.2480, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1010, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.130956649780273
Validation after dual ascent:
out_inf: tensor(9.6719, device='cuda:0', dtype=torch.float16) tensor(0.4497, device='cuda:0', dtype=torch.float16)
tensor(2.1895, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(1.6807, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
tensor(1.9316, device='cuda:0', dtype=torch.float16) tensor(0.1156, device='cuda:0', dtype=torch.float16)
tensor(1.5234, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.up_proj
Validation after prune:
out_inf: tensor(6.1250, device='cuda:0', dtype=torch.float16) tensor(0.3416, device='cuda:0', dtype=torch.float16)
tensor(2.3828, device='cuda:0', dtype=torch.float16) tensor(0.1959, device='cuda:0', dtype=torch.float16)
tensor(2.4688, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(2.4316, device='cuda:0', dtype=torch.float16) tensor(0.2043, device='cuda:0', dtype=torch.float16)
tensor(2.5957, device='cuda:0', dtype=torch.float16) tensor(0.1930, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0165, device='cuda:0')
tensor(0.0282, device='cuda:0')
old_score: tensor(0.1987, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0946, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.198157548904419
Validation after dual ascent:
out_inf: tensor(6.1250, device='cuda:0', dtype=torch.float16) tensor(0.3416, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0895, device='cuda:0', dtype=torch.float16)
tensor(0.9795, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
pruning layer 27 name mlp.down_proj
Validation after prune:
out_inf: tensor(1.6670, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0087, device='cuda:0')
tensor(0.0172, device='cuda:0')
old_score: tensor(0.1005, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0569, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.90599250793457
Validation after dual ascent:
out_inf: tensor(1.6670, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(0.6079, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
tensor(0.6978, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
tensor(0.7720, device='cuda:0', dtype=torch.float16) tensor(0.0664, device='cuda:0', dtype=torch.float16)
tensor(0.7275, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.q_proj
Validation after prune:
out_inf: tensor(16.1719, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(5.6719, device='cuda:0', dtype=torch.float16) tensor(0.3801, device='cuda:0', dtype=torch.float16)
tensor(5.1484, device='cuda:0', dtype=torch.float16) tensor(0.3875, device='cuda:0', dtype=torch.float16)
tensor(5.0938, device='cuda:0', dtype=torch.float16) tensor(0.3962, device='cuda:0', dtype=torch.float16)
tensor(4.8359, device='cuda:0', dtype=torch.float16) tensor(0.3755, device='cuda:0', dtype=torch.float16)
tensor(0.3799, device='cuda:0')
old_score: tensor(0.3848, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1445, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.179090023040771
Validation after dual ascent:
out_inf: tensor(16.1719, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(1.8477, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(2.0938, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.5527, device='cuda:0', dtype=torch.float16) tensor(0.1660, device='cuda:0', dtype=torch.float16)
tensor(1.8184, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.5312, device='cuda:0', dtype=torch.float16) tensor(1.0215, device='cuda:0', dtype=torch.float16)
tensor(6.0781, device='cuda:0', dtype=torch.float16) tensor(0.4006, device='cuda:0', dtype=torch.float16)
tensor(6.0625, device='cuda:0', dtype=torch.float16) tensor(0.4111, device='cuda:0', dtype=torch.float16)
tensor(6.2031, device='cuda:0', dtype=torch.float16) tensor(0.4214, device='cuda:0', dtype=torch.float16)
tensor(6.3125, device='cuda:0', dtype=torch.float16) tensor(0.3967, device='cuda:0', dtype=torch.float16)
tensor(0.4036, device='cuda:0')
old_score: tensor(0.4072, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1453, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.156126260757446
Validation after dual ascent:
out_inf: tensor(19.5312, device='cuda:0', dtype=torch.float16) tensor(1.0215, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
tensor(1.7646, device='cuda:0', dtype=torch.float16) tensor(0.1667, device='cuda:0', dtype=torch.float16)
tensor(1.8105, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.v_proj
Validation after prune:
out_inf: tensor(6.8047, device='cuda:0', dtype=torch.float16) tensor(0.4785, device='cuda:0', dtype=torch.float16)
tensor(2.6523, device='cuda:0', dtype=torch.float16) tensor(0.2864, device='cuda:0', dtype=torch.float16)
tensor(2.8105, device='cuda:0', dtype=torch.float16) tensor(0.2937, device='cuda:0', dtype=torch.float16)
tensor(2.6133, device='cuda:0', dtype=torch.float16) tensor(0.2964, device='cuda:0', dtype=torch.float16)
tensor(2.7402, device='cuda:0', dtype=torch.float16) tensor(0.2817, device='cuda:0', dtype=torch.float16)
tensor(0.3059, device='cuda:0')
old_score: tensor(0.2896, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1335, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.184318780899048
Validation after dual ascent:
out_inf: tensor(6.8047, device='cuda:0', dtype=torch.float16) tensor(0.4785, device='cuda:0', dtype=torch.float16)
tensor(1.5840, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.6621, device='cuda:0', dtype=torch.float16) tensor(0.1342, device='cuda:0', dtype=torch.float16)
tensor(1.5537, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
tensor(1.8232, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
pruning layer 28 name self_attn.o_proj
Validation after prune:
out_inf: tensor(12.6641, device='cuda:0', dtype=torch.float16) tensor(0.1843, device='cuda:0', dtype=torch.float16)
tensor(3.1367, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(3.1055, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
tensor(4.6328, device='cuda:0', dtype=torch.float16) tensor(0.1232, device='cuda:0', dtype=torch.float16)
tensor(3.5742, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(0.0927, device='cuda:0')
old_score: tensor(0.1165, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0544, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.116487979888916
Validation after dual ascent:
out_inf: tensor(12.6641, device='cuda:0', dtype=torch.float16) tensor(0.1843, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.0484, device='cuda:0', dtype=torch.float16)
tensor(1.2695, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.0496, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.gate_proj
Validation after prune:
out_inf: tensor(8.3750, device='cuda:0', dtype=torch.float16) tensor(0.4631, device='cuda:0', dtype=torch.float16)
tensor(3.3242, device='cuda:0', dtype=torch.float16) tensor(0.2515, device='cuda:0', dtype=torch.float16)
tensor(5., device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(4.9883, device='cuda:0', dtype=torch.float16) tensor(0.2646, device='cuda:0', dtype=torch.float16)
tensor(4.0156, device='cuda:0', dtype=torch.float16) tensor(0.2510, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0172, device='cuda:0')
tensor(0.0177, device='cuda:0')
old_score: tensor(0.2593, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1038, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.125382661819458
Validation after dual ascent:
out_inf: tensor(8.3750, device='cuda:0', dtype=torch.float16) tensor(0.4631, device='cuda:0', dtype=torch.float16)
tensor(1.9609, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
tensor(1.7383, device='cuda:0', dtype=torch.float16) tensor(0.1042, device='cuda:0', dtype=torch.float16)
tensor(2.1133, device='cuda:0', dtype=torch.float16) tensor(0.1186, device='cuda:0', dtype=torch.float16)
tensor(2.5547, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.2930, device='cuda:0', dtype=torch.float16) tensor(0.3831, device='cuda:0', dtype=torch.float16)
tensor(3.9727, device='cuda:0', dtype=torch.float16) tensor(0.2148, device='cuda:0', dtype=torch.float16)
tensor(3.1094, device='cuda:0', dtype=torch.float16) tensor(0.2218, device='cuda:0', dtype=torch.float16)
tensor(4.1523, device='cuda:0', dtype=torch.float16) tensor(0.2245, device='cuda:0', dtype=torch.float16)
tensor(3.1641, device='cuda:0', dtype=torch.float16) tensor(0.2113, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0189, device='cuda:0')
tensor(0.0180, device='cuda:0')
old_score: tensor(0.2181, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0989, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.16187596321106
Validation after dual ascent:
out_inf: tensor(7.2930, device='cuda:0', dtype=torch.float16) tensor(0.3831, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(1.2227, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.5000, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(1.4824, device='cuda:0', dtype=torch.float16) tensor(0.0900, device='cuda:0', dtype=torch.float16)
pruning layer 28 name mlp.down_proj
Validation after prune:
out_inf: tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
tensor(1.0713, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
tensor(1.4648, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.1218, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0096, device='cuda:0')
tensor(0.0220, device='cuda:0')
old_score: tensor(0.1262, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0692, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.907872915267944
Validation after dual ascent:
out_inf: tensor(4.8984, device='cuda:0', dtype=torch.float16) tensor(0.1921, device='cuda:0', dtype=torch.float16)
tensor(0.7900, device='cuda:0', dtype=torch.float16) tensor(0.0622, device='cuda:0', dtype=torch.float16)
tensor(0.7964, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
tensor(0.9492, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.0613, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.8516, device='cuda:0', dtype=torch.float16) tensor(0.8477, device='cuda:0', dtype=torch.float16)
tensor(4.9805, device='cuda:0', dtype=torch.float16) tensor(0.3660, device='cuda:0', dtype=torch.float16)
tensor(4.8164, device='cuda:0', dtype=torch.float16) tensor(0.3765, device='cuda:0', dtype=torch.float16)
tensor(5.1875, device='cuda:0', dtype=torch.float16) tensor(0.3906, device='cuda:0', dtype=torch.float16)
tensor(4.4766, device='cuda:0', dtype=torch.float16) tensor(0.3630, device='cuda:0', dtype=torch.float16)
tensor(0.0345, device='cuda:0')
old_score: tensor(0.3740, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1350, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.179482698440552
Validation after dual ascent:
out_inf: tensor(14.8516, device='cuda:0', dtype=torch.float16) tensor(0.8477, device='cuda:0', dtype=torch.float16)
tensor(2.4531, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1353, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1564, device='cuda:0', dtype=torch.float16)
tensor(1.4941, device='cuda:0', dtype=torch.float16) tensor(0.1223, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.k_proj
Validation after prune:
out_inf: tensor(19.9219, device='cuda:0', dtype=torch.float16) tensor(1.0674, device='cuda:0', dtype=torch.float16)
tensor(5.8203, device='cuda:0', dtype=torch.float16) tensor(0.3894, device='cuda:0', dtype=torch.float16)
tensor(5.0625, device='cuda:0', dtype=torch.float16) tensor(0.4033, device='cuda:0', dtype=torch.float16)
tensor(6., device='cuda:0', dtype=torch.float16) tensor(0.4182, device='cuda:0', dtype=torch.float16)
tensor(5.2969, device='cuda:0', dtype=torch.float16) tensor(0.3867, device='cuda:0', dtype=torch.float16)
tensor(0.0602, device='cuda:0')
old_score: tensor(0.3994, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1357, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.16486144065857
Validation after dual ascent:
out_inf: tensor(19.9219, device='cuda:0', dtype=torch.float16) tensor(1.0674, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(2.1250, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.v_proj
Validation after prune:
out_inf: tensor(5.8555, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(3.0625, device='cuda:0', dtype=torch.float16) tensor(0.2773, device='cuda:0', dtype=torch.float16)
tensor(2.7031, device='cuda:0', dtype=torch.float16) tensor(0.2886, device='cuda:0', dtype=torch.float16)
tensor(3.2656, device='cuda:0', dtype=torch.float16) tensor(0.2949, device='cuda:0', dtype=torch.float16)
tensor(3.0039, device='cuda:0', dtype=torch.float16) tensor(0.2754, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0188, device='cuda:0')
tensor(0.1058, device='cuda:0')
old_score: tensor(0.2842, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1304, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.4658682346344
Validation after dual ascent:
out_inf: tensor(5.8555, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1182, device='cuda:0', dtype=torch.float16)
pruning layer 29 name self_attn.o_proj
Validation after prune:
out_inf: tensor(18.6875, device='cuda:0', dtype=torch.float16) tensor(0.2107, device='cuda:0', dtype=torch.float16)
tensor(4.4297, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(4.2578, device='cuda:0', dtype=torch.float16) tensor(0.1373, device='cuda:0', dtype=torch.float16)
tensor(6.4922, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(3.8828, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
tensor(0.1159, device='cuda:0')
old_score: tensor(0.1295, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0647, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.121873140335083
Validation after dual ascent:
out_inf: tensor(18.6875, device='cuda:0', dtype=torch.float16) tensor(0.2107, device='cuda:0', dtype=torch.float16)
tensor(1.2188, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
tensor(1.4102, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(1.5742, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.gate_proj
Validation after prune:
out_inf: tensor(9.1797, device='cuda:0', dtype=torch.float16) tensor(0.4768, device='cuda:0', dtype=torch.float16)
tensor(5.0117, device='cuda:0', dtype=torch.float16) tensor(0.2539, device='cuda:0', dtype=torch.float16)
tensor(5.0859, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
tensor(4.2539, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(4.2227, device='cuda:0', dtype=torch.float16) tensor(0.2554, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0187, device='cuda:0')
tensor(0.0194, device='cuda:0')
old_score: tensor(0.2637, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1063, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.133323431015015
Validation after dual ascent:
out_inf: tensor(9.1797, device='cuda:0', dtype=torch.float16) tensor(0.4768, device='cuda:0', dtype=torch.float16)
tensor(2.3320, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(2.2031, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
tensor(2.5664, device='cuda:0', dtype=torch.float16) tensor(0.1214, device='cuda:0', dtype=torch.float16)
tensor(2.3750, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.up_proj
Validation after prune:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.4392, device='cuda:0', dtype=torch.float16)
tensor(6.6797, device='cuda:0', dtype=torch.float16) tensor(0.2352, device='cuda:0', dtype=torch.float16)
tensor(7.0703, device='cuda:0', dtype=torch.float16) tensor(0.2441, device='cuda:0', dtype=torch.float16)
tensor(6.3828, device='cuda:0', dtype=torch.float16) tensor(0.2478, device='cuda:0', dtype=torch.float16)
tensor(6.3750, device='cuda:0', dtype=torch.float16) tensor(0.2335, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0176, device='cuda:0')
tensor(0.0182, device='cuda:0')
old_score: tensor(0.2402, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1022, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.138949632644653
Validation after dual ascent:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.4392, device='cuda:0', dtype=torch.float16)
tensor(2.6406, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(3.0781, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(3.5469, device='cuda:0', dtype=torch.float16) tensor(0.1168, device='cuda:0', dtype=torch.float16)
tensor(4.0938, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
pruning layer 29 name mlp.down_proj
Validation after prune:
out_inf: tensor(10.4375, device='cuda:0', dtype=torch.float16) tensor(0.2627, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.1683, device='cuda:0', dtype=torch.float16)
tensor(1.5508, device='cuda:0', dtype=torch.float16) tensor(0.1760, device='cuda:0', dtype=torch.float16)
tensor(1.7480, device='cuda:0', dtype=torch.float16) tensor(0.1843, device='cuda:0', dtype=torch.float16)
tensor(1.6309, device='cuda:0', dtype=torch.float16) tensor(0.1766, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0168, device='cuda:0')
tensor(0.0727, device='cuda:0')
old_score: tensor(0.1763, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0864, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.89505100250244
Validation after dual ascent:
out_inf: tensor(10.4375, device='cuda:0', dtype=torch.float16) tensor(0.2627, device='cuda:0', dtype=torch.float16)
tensor(0.9756, device='cuda:0', dtype=torch.float16) tensor(0.0783, device='cuda:0', dtype=torch.float16)
tensor(1.0889, device='cuda:0', dtype=torch.float16) tensor(0.0880, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0771, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.q_proj
Validation after prune:
out_inf: tensor(15.7344, device='cuda:0', dtype=torch.float16) tensor(0.8882, device='cuda:0', dtype=torch.float16)
tensor(5.2734, device='cuda:0', dtype=torch.float16) tensor(0.3799, device='cuda:0', dtype=torch.float16)
tensor(5.2422, device='cuda:0', dtype=torch.float16) tensor(0.3911, device='cuda:0', dtype=torch.float16)
tensor(5.3594, device='cuda:0', dtype=torch.float16) tensor(0.3970, device='cuda:0', dtype=torch.float16)
tensor(5.3125, device='cuda:0', dtype=torch.float16) tensor(0.3811, device='cuda:0', dtype=torch.float16)
tensor(0.0574, device='cuda:0')
old_score: tensor(0.3872, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1378, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.15278148651123
Validation after dual ascent:
out_inf: tensor(15.7344, device='cuda:0', dtype=torch.float16) tensor(0.8882, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
tensor(1.9688, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
tensor(1.8359, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.1254, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.k_proj
Validation after prune:
out_inf: tensor(18.0625, device='cuda:0', dtype=torch.float16) tensor(1.0273, device='cuda:0', dtype=torch.float16)
tensor(6.3867, device='cuda:0', dtype=torch.float16) tensor(0.4104, device='cuda:0', dtype=torch.float16)
tensor(6.1797, device='cuda:0', dtype=torch.float16) tensor(0.4214, device='cuda:0', dtype=torch.float16)
tensor(6.5391, device='cuda:0', dtype=torch.float16) tensor(0.4309, device='cuda:0', dtype=torch.float16)
tensor(6.0156, device='cuda:0', dtype=torch.float16) tensor(0.4084, device='cuda:0', dtype=torch.float16)
tensor(0.0728, device='cuda:0')
old_score: tensor(0.4177, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1398, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.146896123886108
Validation after dual ascent:
out_inf: tensor(18.0625, device='cuda:0', dtype=torch.float16) tensor(1.0273, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
tensor(1.5518, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
tensor(2.0469, device='cuda:0', dtype=torch.float16) tensor(0.1605, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.v_proj
Validation after prune:
out_inf: tensor(8.1562, device='cuda:0', dtype=torch.float16) tensor(0.5083, device='cuda:0', dtype=torch.float16)
tensor(2.8711, device='cuda:0', dtype=torch.float16) tensor(0.2991, device='cuda:0', dtype=torch.float16)
tensor(2.7344, device='cuda:0', dtype=torch.float16) tensor(0.3123, device='cuda:0', dtype=torch.float16)
tensor(2.8984, device='cuda:0', dtype=torch.float16) tensor(0.3145, device='cuda:0', dtype=torch.float16)
tensor(2.5508, device='cuda:0', dtype=torch.float16) tensor(0.2986, device='cuda:0', dtype=torch.float16)
tensor(0.0374, device='cuda:0')
old_score: tensor(0.3062, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1348, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.181418418884277
Validation after dual ascent:
out_inf: tensor(8.1562, device='cuda:0', dtype=torch.float16) tensor(0.5083, device='cuda:0', dtype=torch.float16)
tensor(1.3018, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(1.3232, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.3506, device='cuda:0', dtype=torch.float16) tensor(0.1542, device='cuda:0', dtype=torch.float16)
tensor(1.3643, device='cuda:0', dtype=torch.float16) tensor(0.1225, device='cuda:0', dtype=torch.float16)
pruning layer 30 name self_attn.o_proj
Validation after prune:
out_inf: tensor(19.9531, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(2.7812, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
tensor(3.0156, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(3.4844, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(3.3906, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(0.1084, device='cuda:0')
old_score: tensor(0.1118, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0468, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.110327243804932
Validation after dual ascent:
out_inf: tensor(19.9531, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.8633, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0465, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(3.3496, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.gate_proj
Validation after prune:
out_inf: tensor(18.2031, device='cuda:0', dtype=torch.float16) tensor(0.5283, device='cuda:0', dtype=torch.float16)
tensor(22.1562, device='cuda:0', dtype=torch.float16) tensor(0.2659, device='cuda:0', dtype=torch.float16)
tensor(23.1875, device='cuda:0', dtype=torch.float16) tensor(0.2861, device='cuda:0', dtype=torch.float16)
tensor(25., device='cuda:0', dtype=torch.float16) tensor(0.2847, device='cuda:0', dtype=torch.float16)
tensor(20.9844, device='cuda:0', dtype=torch.float16) tensor(0.2695, device='cuda:0', dtype=torch.float16)
tensor(0.0274, device='cuda:0')
old_score: tensor(0.2764, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1049, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.73409843444824
Validation after dual ascent:
out_inf: tensor(18.2031, device='cuda:0', dtype=torch.float16) tensor(0.5283, device='cuda:0', dtype=torch.float16)
tensor(9.9531, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(9.7344, device='cuda:0', dtype=torch.float16) tensor(0.1055, device='cuda:0', dtype=torch.float16)
tensor(11.1875, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(9.6172, device='cuda:0', dtype=torch.float16) tensor(0.0951, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.up_proj
Validation after prune:
out_inf: tensor(18.5781, device='cuda:0', dtype=torch.float16) tensor(0.5142, device='cuda:0', dtype=torch.float16)
tensor(19.5000, device='cuda:0', dtype=torch.float16) tensor(0.2590, device='cuda:0', dtype=torch.float16)
tensor(22.1719, device='cuda:0', dtype=torch.float16) tensor(0.2705, device='cuda:0', dtype=torch.float16)
tensor(22.3750, device='cuda:0', dtype=torch.float16) tensor(0.2756, device='cuda:0', dtype=torch.float16)
tensor(17.2188, device='cuda:0', dtype=torch.float16) tensor(0.2617, device='cuda:0', dtype=torch.float16)
tensor(0.0265, device='cuda:0')
old_score: tensor(0.2666, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1003, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.76050686836243
Validation after dual ascent:
out_inf: tensor(18.5781, device='cuda:0', dtype=torch.float16) tensor(0.5142, device='cuda:0', dtype=torch.float16)
tensor(11.1250, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(9.5469, device='cuda:0', dtype=torch.float16) tensor(0.1012, device='cuda:0', dtype=torch.float16)
tensor(10.8594, device='cuda:0', dtype=torch.float16) tensor(0.1151, device='cuda:0', dtype=torch.float16)
tensor(9.4297, device='cuda:0', dtype=torch.float16) tensor(0.0911, device='cuda:0', dtype=torch.float16)
pruning layer 30 name mlp.down_proj
Validation after prune:
out_inf: tensor(460.5000, device='cuda:0', dtype=torch.float16) tensor(0.6050, device='cuda:0', dtype=torch.float16)
tensor(7.4883, device='cuda:0', dtype=torch.float16) tensor(0.4155, device='cuda:0', dtype=torch.float16)
tensor(7.2266, device='cuda:0', dtype=torch.float16) tensor(0.3979, device='cuda:0', dtype=torch.float16)
tensor(6.6914, device='cuda:0', dtype=torch.float16) tensor(0.3406, device='cuda:0', dtype=torch.float16)
tensor(7.0586, device='cuda:0', dtype=torch.float16) tensor(0.4639, device='cuda:0', dtype=torch.float16)
tensor(0.1992, device='cuda:0')
old_score: tensor(0.4045, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1302, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.2720513343811
Validation after dual ascent:
out_inf: tensor(460.5000, device='cuda:0', dtype=torch.float16) tensor(0.6050, device='cuda:0', dtype=torch.float16)
tensor(7.1641, device='cuda:0', dtype=torch.float16) tensor(0.1203, device='cuda:0', dtype=torch.float16)
tensor(6.8984, device='cuda:0', dtype=torch.float16) tensor(0.1317, device='cuda:0', dtype=torch.float16)
tensor(6.3828, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(6.7266, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.q_proj
Validation after prune:
out_inf: tensor(14.9141, device='cuda:0', dtype=torch.float16) tensor(0.9351, device='cuda:0', dtype=torch.float16)
tensor(6.9727, device='cuda:0', dtype=torch.float16) tensor(0.3938, device='cuda:0', dtype=torch.float16)
tensor(6.6328, device='cuda:0', dtype=torch.float16) tensor(0.3933, device='cuda:0', dtype=torch.float16)
tensor(7.0352, device='cuda:0', dtype=torch.float16) tensor(0.4075, device='cuda:0', dtype=torch.float16)
tensor(6.6914, device='cuda:0', dtype=torch.float16) tensor(0.3960, device='cuda:0', dtype=torch.float16)
tensor(0.0363, device='cuda:0')
old_score: tensor(0.3975, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1115, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.161261320114136
Validation after dual ascent:
out_inf: tensor(14.9141, device='cuda:0', dtype=torch.float16) tensor(0.9351, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1041, device='cuda:0', dtype=torch.float16)
tensor(1.6797, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.1307, device='cuda:0', dtype=torch.float16)
tensor(1.4375, device='cuda:0', dtype=torch.float16) tensor(0.0994, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.k_proj
Validation after prune:
out_inf: tensor(17.5156, device='cuda:0', dtype=torch.float16) tensor(1.1543, device='cuda:0', dtype=torch.float16)
tensor(7.8750, device='cuda:0', dtype=torch.float16) tensor(0.4368, device='cuda:0', dtype=torch.float16)
tensor(7.5469, device='cuda:0', dtype=torch.float16) tensor(0.4365, device='cuda:0', dtype=torch.float16)
tensor(8.3047, device='cuda:0', dtype=torch.float16) tensor(0.4531, device='cuda:0', dtype=torch.float16)
tensor(7.9062, device='cuda:0', dtype=torch.float16) tensor(0.4390, device='cuda:0', dtype=torch.float16)
tensor(0.0451, device='cuda:0')
old_score: tensor(0.4414, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1149, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.155318021774292
Validation after dual ascent:
out_inf: tensor(17.5156, device='cuda:0', dtype=torch.float16) tensor(1.1543, device='cuda:0', dtype=torch.float16)
tensor(1.9814, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
tensor(1.7158, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(2.2812, device='cuda:0', dtype=torch.float16) tensor(0.1342, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.v_proj
Validation after prune:
out_inf: tensor(7.7617, device='cuda:0', dtype=torch.float16) tensor(0.3940, device='cuda:0', dtype=torch.float16)
tensor(2.5605, device='cuda:0', dtype=torch.float16) tensor(0.2322, device='cuda:0', dtype=torch.float16)
tensor(2.4316, device='cuda:0', dtype=torch.float16) tensor(0.2401, device='cuda:0', dtype=torch.float16)
tensor(2.3047, device='cuda:0', dtype=torch.float16) tensor(0.2435, device='cuda:0', dtype=torch.float16)
tensor(2.5781, device='cuda:0', dtype=torch.float16) tensor(0.2308, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0131, device='cuda:0')
tensor(0.0329, device='cuda:0')
old_score: tensor(0.2367, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0979, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.233424186706543
Validation after dual ascent:
out_inf: tensor(7.7617, device='cuda:0', dtype=torch.float16) tensor(0.3940, device='cuda:0', dtype=torch.float16)
tensor(1.1982, device='cuda:0', dtype=torch.float16) tensor(0.0917, device='cuda:0', dtype=torch.float16)
tensor(1.0605, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.0874, device='cuda:0', dtype=torch.float16)
pruning layer 31 name self_attn.o_proj
Validation after prune:
out_inf: tensor(132.7500, device='cuda:0', dtype=torch.float16) tensor(0.2874, device='cuda:0', dtype=torch.float16)
tensor(4.7422, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(4.3828, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(5.4062, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
tensor(4.6250, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
tensor(0.0304, device='cuda:0')
old_score: tensor(0.1471, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0564, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.116324424743652
Validation after dual ascent:
out_inf: tensor(132.7500, device='cuda:0', dtype=torch.float16) tensor(0.2874, device='cuda:0', dtype=torch.float16)
tensor(2.1348, device='cuda:0', dtype=torch.float16) tensor(0.0535, device='cuda:0', dtype=torch.float16)
tensor(2.1426, device='cuda:0', dtype=torch.float16) tensor(0.0563, device='cuda:0', dtype=torch.float16)
tensor(2.1523, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(2.1641, device='cuda:0', dtype=torch.float16) tensor(0.0548, device='cuda:0', dtype=torch.float16)
pruning layer 31 name mlp.gate_proj
Validation after prune:
out_inf: tensor(21.7188, device='cuda:0', dtype=torch.float16) tensor(0.6167, device='cuda:0', dtype=torch.float16)
tensor(9.3984, device='cuda:0', dtype=torch.float16) tensor(0.2974, device='cuda:0', dtype=torch.float16)
tensor(12.4141, device='cuda:0', dtype=torch.float16) tensor(0.3093, device='cuda:0', dtype=torch.float16)
tensor(13.0312, device='cuda:0', dtype=torch.float16) tensor(0.3093, device='cuda:0', dtype=torch.float16)
tensor(11.2891, device='cuda:0', dtype=torch.float16) tensor(0.3042, device='cuda:0', dtype=torch.float16)
tensor(0.0513, device='cuda:0')
old_score: tensor(0.3052, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0947, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.70582342147827
Validation after dual ascent:
out_inf: tensor(21.7188, device='cuda:0', dtype=torch.float16) tensor(0.6167, device='cuda:0', dtype=torch.float16)
tensor(2.3438, device='cuda:0', dtype=torch.float16) tensor(0.0880, device='cuda:0', dtype=torch.float16)
tensor(2.6875, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
tensor(3.1250, device='cuda:0', dtype=torch.float16) tensor(0.1103, device='cuda:0', dtype=torch.float16)
tensor(2.6172, device='cuda:0', dtype=torch.float16) tensor(0.0851, device='cuda:0', dtype=torch.float16)
pruning layer 31 name mlp.up_proj
Validation after prune:
out_inf: tensor(24.6562, device='cuda:0', dtype=torch.float16) tensor(0.6567, device='cuda:0', dtype=torch.float16)
tensor(16.9062, device='cuda:0', dtype=torch.float16) tensor(0.3032, device='cuda:0', dtype=torch.float16)
tensor(20.0625, device='cuda:0', dtype=torch.float16) tensor(0.3105, device='cuda:0', dtype=torch.float16)
tensor(20.2031, device='cuda:0', dtype=torch.float16) tensor(0.3176, device='cuda:0', dtype=torch.float16)
tensor(17.6875, device='cuda:0', dtype=torch.float16) tensor(0.3093, device='cuda:0', dtype=torch.float16)
tensor(0.0473, device='cuda:0')
old_score: tensor(0.3103, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0900, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.775890588760376
Validation after dual ascent:
out_inf: tensor(24.6562, device='cuda:0', dtype=torch.float16) tensor(0.6567, device='cuda:0', dtype=torch.float16)
tensor(3.5000, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(2.5156, device='cuda:0', dtype=torch.float16) tensor(0.0908, device='cuda:0', dtype=torch.float16)
tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
pruning layer 31 name mlp.down_proj
Validation after prune:
out_inf: tensor(102.5625, device='cuda:0', dtype=torch.float16) tensor(2.0879, device='cuda:0', dtype=torch.float16)
tensor(10.7969, device='cuda:0', dtype=torch.float16) tensor(1.4014, device='cuda:0', dtype=torch.float16)
tensor(10.4922, device='cuda:0', dtype=torch.float16) tensor(1.2168, device='cuda:0', dtype=torch.float16)
tensor(10.3750, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(11.5156, device='cuda:0', dtype=torch.float16) tensor(1.4619, device='cuda:0', dtype=torch.float16)
tensor(1.5665, device='cuda:0')
old_score: tensor(1.2832, device='cuda:0', dtype=torch.float16) new_score: tensor(0.6084, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.50554895401001
Validation after dual ascent:
out_inf: tensor(102.5625, device='cuda:0', dtype=torch.float16) tensor(2.0879, device='cuda:0', dtype=torch.float16)
tensor(5.2695, device='cuda:0', dtype=torch.float16) tensor(0.6465, device='cuda:0', dtype=torch.float16)
tensor(5.7656, device='cuda:0', dtype=torch.float16) tensor(0.5503, device='cuda:0', dtype=torch.float16)
tensor(5.0352, device='cuda:0', dtype=torch.float16) tensor(0.5322, device='cuda:0', dtype=torch.float16)
tensor(5.5391, device='cuda:0', dtype=torch.float16) tensor(0.7036, device='cuda:0', dtype=torch.float16)
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.11it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.15it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.96it/s]
{'model.embed_tokens': 0, 'model.layers.0': 0, 'model.layers.1': 0, 'model.layers.2': 0, 'model.layers.3': 0, 'model.layers.4': 0, 'model.layers.5': 0, 'model.layers.6': 0, 'model.layers.7': 0, 'model.layers.8': 0, 'model.layers.9': 0, 'model.layers.10': 0, 'model.layers.11': 0, 'model.layers.12': 0, 'model.layers.13': 0, 'model.layers.14': 0, 'model.layers.15': 0, 'model.layers.16': 0, 'model.layers.17': 0, 'model.layers.18': 0, 'model.layers.19': 0, 'model.layers.20': 0, 'model.layers.21': 0, 'model.layers.22': 0, 'model.layers.23': 0, 'model.layers.24': 0, 'model.layers.25': 0, 'model.layers.26': 0, 'model.layers.27': 1, 'model.layers.28': 1, 'model.layers.29': 1, 'model.layers.30': 1, 'model.layers.31': 1, 'model.norm': 1, 'model.rotary_emb': 1, 'lm_head': 1}
use device  1
******************************
layer 0 sparsity 0.799840
layer 1 sparsity 0.799840
layer 2 sparsity 0.799840
layer 3 sparsity 0.799840
layer 4 sparsity 0.799840
layer 5 sparsity 0.799840
layer 6 sparsity 0.799840
layer 7 sparsity 0.799840
layer 8 sparsity 0.799840
layer 9 sparsity 0.799840
layer 10 sparsity 0.799840
layer 11 sparsity 0.799840
layer 12 sparsity 0.799840
layer 13 sparsity 0.799840
layer 14 sparsity 0.799840
layer 15 sparsity 0.799840
layer 16 sparsity 0.799840
layer 17 sparsity 0.799840
layer 18 sparsity 0.799840
layer 19 sparsity 0.799840
layer 20 sparsity 0.799840
layer 21 sparsity 0.799840
layer 22 sparsity 0.799840
layer 23 sparsity 0.799840
layer 24 sparsity 0.799840
layer 25 sparsity 0.799840
layer 26 sparsity 0.799840
layer 27 sparsity 0.799840
layer 28 sparsity 0.799840
layer 29 sparsity 0.799840
layer 30 sparsity 0.799840
layer 31 sparsity 0.799840
sparsity sanity check 0.7998
******************************
evaluating on wikitext2
nsamples 83
sample 0
sample 50
wikitext perplexity 42071.234375
magnitude_dual	0.7998	42071.2344	256
Namespace(model='/h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf', seed=0, nsamples=256, dual_theld=0.03, n_batch=8, sparsity_ratio=0.8, epsilon=0.02, n_flod=1, sparsity_type='unstructured', prune_method='magnitude_dual', cache_dir='llm_weights', use_variant=False, save='/h3cstore_ns/jcxie/LISA/nips2024/log', save_model=None, exclude='gate_proj', ww_metric='alpha_peak', ww_metric_cache='/h3cstore_ns/jcxie/LISA/wanda-main/data/llama2-7b-hf', wanda_scale=0.01, ww_epsilon=0.02, mapping_type='block_wise', dual_sp_theld=0.0, Hyper_m=3, Lamda=0.2, eval_zero_shot=0, save_ckpt=0)
