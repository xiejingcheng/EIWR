nohup: ignoring input
2025-04-23 23:54:41.370149: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-23 23:54:41.570560: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-23 23:54:41.575903: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-23 23:54:41.575931: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2025-04-23 23:54:45.224982: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-23 23:54:45.225489: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-23 23:54:45.230253: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
torch 2.3.1+cu121
transformers 4.47.1
accelerate 0.29.1
# of gpus:  2
loading llm model /h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  3.87it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.78it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.61it/s]
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
model.embed_tokens.weight torch.Size([32000, 4096])
model.layers.0.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.0.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.0.input_layernorm.weight torch.Size([4096])
model.layers.0.post_attention_layernorm.weight torch.Size([4096])
model.layers.1.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.1.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.1.input_layernorm.weight torch.Size([4096])
model.layers.1.post_attention_layernorm.weight torch.Size([4096])
model.layers.2.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.2.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.2.input_layernorm.weight torch.Size([4096])
model.layers.2.post_attention_layernorm.weight torch.Size([4096])
model.layers.3.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.3.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.3.input_layernorm.weight torch.Size([4096])
model.layers.3.post_attention_layernorm.weight torch.Size([4096])
model.layers.4.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.4.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.4.input_layernorm.weight torch.Size([4096])
model.layers.4.post_attention_layernorm.weight torch.Size([4096])
model.layers.5.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.5.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.5.input_layernorm.weight torch.Size([4096])
model.layers.5.post_attention_layernorm.weight torch.Size([4096])
model.layers.6.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.6.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.6.input_layernorm.weight torch.Size([4096])
model.layers.6.post_attention_layernorm.weight torch.Size([4096])
model.layers.7.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.7.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.7.input_layernorm.weight torch.Size([4096])
model.layers.7.post_attention_layernorm.weight torch.Size([4096])
model.layers.8.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.8.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.8.input_layernorm.weight torch.Size([4096])
model.layers.8.post_attention_layernorm.weight torch.Size([4096])
model.layers.9.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.9.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.9.input_layernorm.weight torch.Size([4096])
model.layers.9.post_attention_layernorm.weight torch.Size([4096])
model.layers.10.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.10.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.10.input_layernorm.weight torch.Size([4096])
model.layers.10.post_attention_layernorm.weight torch.Size([4096])
model.layers.11.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.11.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.11.input_layernorm.weight torch.Size([4096])
model.layers.11.post_attention_layernorm.weight torch.Size([4096])
model.layers.12.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.12.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.12.input_layernorm.weight torch.Size([4096])
model.layers.12.post_attention_layernorm.weight torch.Size([4096])
model.layers.13.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.13.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.13.input_layernorm.weight torch.Size([4096])
model.layers.13.post_attention_layernorm.weight torch.Size([4096])
model.layers.14.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.14.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.14.input_layernorm.weight torch.Size([4096])
model.layers.14.post_attention_layernorm.weight torch.Size([4096])
model.layers.15.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.15.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.15.input_layernorm.weight torch.Size([4096])
model.layers.15.post_attention_layernorm.weight torch.Size([4096])
model.layers.16.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.16.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.16.input_layernorm.weight torch.Size([4096])
model.layers.16.post_attention_layernorm.weight torch.Size([4096])
model.layers.17.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.17.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.17.input_layernorm.weight torch.Size([4096])
model.layers.17.post_attention_layernorm.weight torch.Size([4096])
model.layers.18.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.18.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.18.input_layernorm.weight torch.Size([4096])
model.layers.18.post_attention_layernorm.weight torch.Size([4096])
model.layers.19.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.19.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.19.input_layernorm.weight torch.Size([4096])
model.layers.19.post_attention_layernorm.weight torch.Size([4096])
model.layers.20.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.20.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.20.input_layernorm.weight torch.Size([4096])
model.layers.20.post_attention_layernorm.weight torch.Size([4096])
model.layers.21.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.21.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.21.input_layernorm.weight torch.Size([4096])
model.layers.21.post_attention_layernorm.weight torch.Size([4096])
model.layers.22.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.22.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.22.input_layernorm.weight torch.Size([4096])
model.layers.22.post_attention_layernorm.weight torch.Size([4096])
model.layers.23.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.23.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.23.input_layernorm.weight torch.Size([4096])
model.layers.23.post_attention_layernorm.weight torch.Size([4096])
model.layers.24.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.24.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.24.input_layernorm.weight torch.Size([4096])
model.layers.24.post_attention_layernorm.weight torch.Size([4096])
model.layers.25.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.25.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.25.input_layernorm.weight torch.Size([4096])
model.layers.25.post_attention_layernorm.weight torch.Size([4096])
model.layers.26.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.26.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.26.input_layernorm.weight torch.Size([4096])
model.layers.26.post_attention_layernorm.weight torch.Size([4096])
model.layers.27.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.27.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.27.input_layernorm.weight torch.Size([4096])
model.layers.27.post_attention_layernorm.weight torch.Size([4096])
model.layers.28.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.28.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.28.input_layernorm.weight torch.Size([4096])
model.layers.28.post_attention_layernorm.weight torch.Size([4096])
model.layers.29.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.29.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.29.input_layernorm.weight torch.Size([4096])
model.layers.29.post_attention_layernorm.weight torch.Size([4096])
model.layers.30.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.30.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.30.input_layernorm.weight torch.Size([4096])
model.layers.30.post_attention_layernorm.weight torch.Size([4096])
model.layers.31.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.31.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.31.input_layernorm.weight torch.Size([4096])
model.layers.31.post_attention_layernorm.weight torch.Size([4096])
model.norm.weight torch.Size([4096])
lm_head.weight torch.Size([32000, 4096])
use device  cpu
loading calibdation data
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<03:22,  1.26it/s]  1%|          | 2/256 [00:01<03:14,  1.31it/s]  2%|▏         | 4/256 [00:01<01:38,  2.57it/s]  2%|▏         | 5/256 [00:02<01:55,  2.18it/s]  2%|▏         | 6/256 [00:02<01:33,  2.68it/s]  3%|▎         | 7/256 [00:03<02:12,  1.87it/s]  3%|▎         | 8/256 [00:03<01:41,  2.45it/s]  4%|▎         | 9/256 [00:03<01:18,  3.16it/s]  4%|▍         | 11/256 [00:03<00:51,  4.75it/s]  5%|▍         | 12/256 [00:04<00:46,  5.24it/s]  5%|▌         | 13/256 [00:05<01:34,  2.58it/s]  5%|▌         | 14/256 [00:05<01:31,  2.64it/s]  6%|▌         | 15/256 [00:05<01:16,  3.13it/s]  6%|▋         | 16/256 [00:05<01:06,  3.59it/s]  7%|▋         | 18/256 [00:06<01:08,  3.45it/s]  8%|▊         | 20/256 [00:06<00:51,  4.59it/s]  9%|▊         | 22/256 [00:06<00:47,  4.91it/s]  9%|▉         | 24/256 [00:07<00:42,  5.40it/s] 10%|▉         | 25/256 [00:07<00:40,  5.64it/s] 10%|█         | 26/256 [00:07<00:52,  4.38it/s] 11%|█         | 28/256 [00:08<00:44,  5.10it/s] 11%|█▏        | 29/256 [00:08<00:46,  4.92it/s] 12%|█▏        | 31/256 [00:08<00:39,  5.77it/s] 12%|█▎        | 32/256 [00:08<00:46,  4.78it/s] 13%|█▎        | 33/256 [00:09<00:57,  3.85it/s] 13%|█▎        | 34/256 [00:09<01:01,  3.59it/s] 14%|█▎        | 35/256 [00:10<01:08,  3.21it/s] 14%|█▍        | 36/256 [00:10<01:24,  2.62it/s] 14%|█▍        | 37/256 [00:10<01:17,  2.83it/s] 15%|█▍        | 38/256 [00:11<01:11,  3.06it/s] 16%|█▌        | 40/256 [00:11<01:04,  3.36it/s] 16%|█▋        | 42/256 [00:11<00:44,  4.79it/s] 17%|█▋        | 43/256 [00:11<00:39,  5.39it/s] 17%|█▋        | 44/256 [00:12<00:38,  5.45it/s] 18%|█▊        | 45/256 [00:12<00:34,  6.14it/s] 18%|█▊        | 46/256 [00:12<00:33,  6.31it/s] 18%|█▊        | 47/256 [00:12<00:34,  6.03it/s] 19%|█▉        | 48/256 [00:12<00:38,  5.45it/s] 19%|█▉        | 49/256 [00:12<00:34,  6.08it/s] 20%|█▉        | 50/256 [00:13<00:50,  4.08it/s] 21%|██        | 53/256 [00:14<00:48,  4.17it/s] 21%|██        | 54/256 [00:14<00:48,  4.17it/s] 21%|██▏       | 55/256 [00:14<00:41,  4.80it/s] 22%|██▏       | 56/256 [00:14<00:48,  4.12it/s] 22%|██▏       | 57/256 [00:14<00:44,  4.50it/s] 23%|██▎       | 58/256 [00:15<00:49,  4.04it/s] 23%|██▎       | 59/256 [00:15<00:43,  4.58it/s] 23%|██▎       | 60/256 [00:15<00:46,  4.25it/s] 24%|██▍       | 61/256 [00:15<00:54,  3.60it/s] 24%|██▍       | 62/256 [00:16<00:59,  3.24it/s] 25%|██▍       | 63/256 [00:16<00:51,  3.72it/s] 25%|██▌       | 64/256 [00:16<00:42,  4.51it/s] 25%|██▌       | 65/256 [00:17<01:08,  2.78it/s] 26%|██▌       | 67/256 [00:17<00:43,  4.32it/s] 27%|██▋       | 68/256 [00:17<00:43,  4.36it/s] 27%|██▋       | 69/256 [00:17<00:43,  4.31it/s] 28%|██▊       | 71/256 [00:18<00:33,  5.51it/s] 29%|██▊       | 73/256 [00:18<00:26,  6.82it/s] 29%|██▉       | 74/256 [00:18<00:26,  6.89it/s] 29%|██▉       | 75/256 [00:18<00:31,  5.77it/s] 30%|██▉       | 76/256 [00:19<00:44,  4.07it/s] 30%|███       | 78/256 [00:19<00:30,  5.87it/s] 31%|███       | 79/256 [00:19<00:38,  4.58it/s] 31%|███▏      | 80/256 [00:20<00:49,  3.57it/s] 32%|███▏      | 81/256 [00:20<00:53,  3.25it/s] 32%|███▏      | 82/256 [00:20<00:44,  3.92it/s] 32%|███▏      | 83/256 [00:21<00:53,  3.21it/s] 33%|███▎      | 84/256 [00:21<00:51,  3.34it/s] 33%|███▎      | 85/256 [00:21<00:47,  3.63it/s] 34%|███▎      | 86/256 [00:21<00:43,  3.89it/s] 34%|███▍      | 87/256 [00:22<01:01,  2.73it/s] 34%|███▍      | 88/256 [00:22<01:03,  2.64it/s] 35%|███▍      | 89/256 [00:23<00:59,  2.83it/s] 35%|███▌      | 90/256 [00:23<00:59,  2.80it/s] 36%|███▌      | 91/256 [00:23<00:57,  2.87it/s] 36%|███▌      | 92/256 [00:24<00:48,  3.41it/s] 36%|███▋      | 93/256 [00:24<00:42,  3.87it/s] 37%|███▋      | 94/256 [00:24<00:50,  3.24it/s] 37%|███▋      | 95/256 [00:25<01:04,  2.49it/s] 38%|███▊      | 96/256 [00:25<00:51,  3.11it/s] 38%|███▊      | 97/256 [00:25<00:54,  2.89it/s] 38%|███▊      | 98/256 [00:25<00:46,  3.41it/s] 39%|███▊      | 99/256 [00:26<00:44,  3.51it/s] 39%|███▉      | 100/256 [00:26<00:42,  3.66it/s] 39%|███▉      | 101/256 [00:27<01:14,  2.08it/s] 40%|███▉      | 102/256 [00:27<01:03,  2.42it/s] 41%|████      | 104/256 [00:27<00:40,  3.73it/s] 41%|████▏     | 106/256 [00:28<00:33,  4.49it/s] 42%|████▏     | 107/256 [00:28<00:33,  4.49it/s] 42%|████▏     | 108/256 [00:29<00:47,  3.10it/s] 43%|████▎     | 111/256 [00:29<00:30,  4.82it/s] 44%|████▍     | 112/256 [00:29<00:31,  4.56it/s] 44%|████▍     | 113/256 [00:29<00:31,  4.56it/s] 45%|████▍     | 114/256 [00:30<00:28,  4.99it/s] 45%|████▍     | 115/256 [00:30<00:26,  5.23it/s] 45%|████▌     | 116/256 [00:30<00:37,  3.70it/s] 46%|████▌     | 118/256 [00:30<00:29,  4.66it/s] 47%|████▋     | 120/256 [00:31<00:21,  6.19it/s] 47%|████▋     | 121/256 [00:31<00:20,  6.47it/s] 48%|████▊     | 122/256 [00:31<00:36,  3.68it/s] 48%|████▊     | 123/256 [00:32<00:39,  3.34it/s] 48%|████▊     | 124/256 [00:32<00:50,  2.59it/s] 49%|████▉     | 125/256 [00:34<01:19,  1.65it/s] 49%|████▉     | 126/256 [00:34<01:07,  1.93it/s] 50%|████▉     | 127/256 [00:35<01:13,  1.76it/s] 50%|█████     | 129/256 [00:35<00:44,  2.85it/s] 51%|█████     | 130/256 [00:35<00:40,  3.08it/s] 51%|█████     | 131/256 [00:35<00:38,  3.23it/s] 52%|█████▏    | 132/256 [00:36<00:37,  3.33it/s] 52%|█████▏    | 133/256 [00:36<00:45,  2.73it/s] 52%|█████▏    | 134/256 [00:36<00:44,  2.75it/s] 53%|█████▎    | 135/256 [00:37<00:35,  3.39it/s] 53%|█████▎    | 136/256 [00:37<00:35,  3.35it/s] 54%|█████▎    | 137/256 [00:37<00:30,  3.94it/s] 54%|█████▍    | 138/256 [00:37<00:26,  4.40it/s] 54%|█████▍    | 139/256 [00:37<00:24,  4.83it/s] 55%|█████▍    | 140/256 [00:37<00:22,  5.21it/s] 55%|█████▌    | 142/256 [00:38<00:17,  6.69it/s] 56%|█████▌    | 143/256 [00:38<00:16,  6.88it/s] 57%|█████▋    | 145/256 [00:39<00:34,  3.21it/s] 57%|█████▋    | 146/256 [00:39<00:38,  2.87it/s] 57%|█████▋    | 147/256 [00:40<00:35,  3.10it/s] 58%|█████▊    | 148/256 [00:40<00:36,  2.98it/s] 59%|█████▊    | 150/256 [00:40<00:28,  3.66it/s] 59%|█████▉    | 151/256 [00:40<00:25,  4.20it/s] 59%|█████▉    | 152/256 [00:41<00:28,  3.69it/s] 60%|█████▉    | 153/256 [00:41<00:25,  4.10it/s] 60%|██████    | 154/256 [00:41<00:28,  3.52it/s] 61%|██████    | 155/256 [00:42<00:25,  3.90it/s] 61%|██████    | 156/256 [00:42<00:21,  4.61it/s] 61%|██████▏   | 157/256 [00:42<00:27,  3.61it/s] 62%|██████▏   | 158/256 [00:42<00:23,  4.13it/s] 62%|██████▏   | 159/256 [00:43<00:42,  2.30it/s] 62%|██████▎   | 160/256 [00:43<00:32,  2.95it/s] 63%|██████▎   | 162/256 [00:44<00:36,  2.56it/s] 64%|██████▎   | 163/256 [00:44<00:32,  2.86it/s] 64%|██████▍   | 164/256 [00:45<00:26,  3.42it/s] 65%|██████▍   | 166/256 [00:45<00:22,  3.96it/s] 65%|██████▌   | 167/256 [00:45<00:25,  3.51it/s] 66%|██████▌   | 168/256 [00:46<00:28,  3.09it/s] 66%|██████▌   | 169/256 [00:46<00:32,  2.68it/s] 66%|██████▋   | 170/256 [00:47<00:33,  2.60it/s] 67%|██████▋   | 171/256 [00:47<00:26,  3.26it/s] 67%|██████▋   | 172/256 [00:47<00:22,  3.77it/s] 68%|██████▊   | 173/256 [00:47<00:21,  3.91it/s] 68%|██████▊   | 174/256 [00:48<00:29,  2.79it/s] 68%|██████▊   | 175/256 [00:49<00:42,  1.91it/s] 69%|██████▉   | 176/256 [00:49<00:36,  2.20it/s] 69%|██████▉   | 177/256 [00:49<00:29,  2.67it/s] 70%|██████▉   | 179/256 [00:49<00:19,  3.92it/s] 70%|███████   | 180/256 [00:51<00:37,  2.03it/s] 71%|███████   | 181/256 [00:51<00:29,  2.54it/s] 71%|███████   | 182/256 [00:52<00:37,  1.95it/s] 72%|███████▏  | 184/256 [00:53<00:35,  2.03it/s] 73%|███████▎  | 186/256 [00:53<00:23,  2.92it/s] 73%|███████▎  | 187/256 [00:53<00:27,  2.52it/s] 73%|███████▎  | 188/256 [00:54<00:23,  2.89it/s] 74%|███████▍  | 189/256 [00:54<00:22,  2.92it/s] 74%|███████▍  | 190/256 [00:54<00:20,  3.15it/s] 75%|███████▍  | 191/256 [00:54<00:18,  3.45it/s] 75%|███████▌  | 192/256 [00:55<00:22,  2.87it/s] 75%|███████▌  | 193/256 [00:55<00:21,  2.99it/s] 77%|███████▋  | 196/256 [00:56<00:13,  4.48it/s] 77%|███████▋  | 197/256 [00:56<00:15,  3.81it/s] 78%|███████▊  | 199/256 [00:56<00:11,  4.85it/s] 79%|███████▊  | 201/256 [00:56<00:09,  5.50it/s] 79%|███████▉  | 202/256 [00:57<00:11,  4.62it/s] 80%|███████▉  | 204/256 [00:57<00:08,  5.87it/s] 80%|████████  | 206/256 [00:57<00:06,  7.26it/s] 81%|████████  | 207/256 [00:57<00:06,  7.59it/s] 81%|████████▏ | 208/256 [00:57<00:07,  6.63it/s] 82%|████████▏ | 210/256 [00:58<00:05,  8.81it/s] 83%|████████▎ | 212/256 [00:58<00:05,  8.42it/s] 83%|████████▎ | 213/256 [00:58<00:05,  7.46it/s] 84%|████████▎ | 214/256 [00:58<00:07,  5.73it/s] 84%|████████▍ | 215/256 [00:59<00:09,  4.54it/s] 84%|████████▍ | 216/256 [00:59<00:09,  4.43it/s] 85%|████████▌ | 218/256 [00:59<00:07,  5.28it/s] 86%|████████▌ | 219/256 [01:00<00:14,  2.57it/s] 86%|████████▌ | 220/256 [01:00<00:11,  3.01it/s] 86%|████████▋ | 221/256 [01:01<00:12,  2.91it/s] 87%|████████▋ | 222/256 [01:01<00:11,  2.88it/s] 87%|████████▋ | 223/256 [01:02<00:11,  2.77it/s] 88%|████████▊ | 224/256 [01:03<00:23,  1.35it/s] 88%|████████▊ | 225/256 [01:04<00:22,  1.39it/s] 88%|████████▊ | 226/256 [01:04<00:16,  1.78it/s] 89%|████████▊ | 227/256 [01:04<00:13,  2.12it/s] 89%|████████▉ | 228/256 [01:05<00:12,  2.24it/s] 89%|████████▉ | 229/256 [01:06<00:20,  1.32it/s] 90%|████████▉ | 230/256 [01:06<00:15,  1.70it/s] 90%|█████████ | 231/256 [01:07<00:15,  1.62it/s] 91%|█████████ | 232/256 [01:07<00:12,  1.91it/s] 91%|█████████ | 233/256 [01:08<00:09,  2.36it/s] 92%|█████████▏| 235/256 [01:08<00:06,  3.36it/s] 92%|█████████▏| 236/256 [01:08<00:05,  3.35it/s] 93%|█████████▎| 237/256 [01:08<00:05,  3.76it/s] 93%|█████████▎| 238/256 [01:08<00:04,  4.42it/s] 93%|█████████▎| 239/256 [01:09<00:03,  4.39it/s] 94%|█████████▍| 241/256 [01:09<00:02,  5.65it/s] 95%|█████████▍| 242/256 [01:10<00:04,  2.84it/s] 95%|█████████▌| 244/256 [01:10<00:02,  4.33it/s] 96%|█████████▌| 245/256 [01:10<00:02,  4.28it/s] 96%|█████████▌| 246/256 [01:10<00:02,  4.77it/s] 97%|█████████▋| 248/256 [01:10<00:01,  6.41it/s] 97%|█████████▋| 249/256 [01:11<00:01,  3.90it/s] 98%|█████████▊| 251/256 [01:11<00:00,  5.45it/s] 98%|█████████▊| 252/256 [01:12<00:01,  3.50it/s] 99%|█████████▉| 253/256 [01:12<00:01,  2.95it/s]100%|█████████▉| 255/256 [01:13<00:00,  3.00it/s]100%|██████████| 256/256 [01:13<00:00,  3.09it/s]100%|██████████| 256/256 [01:13<00:00,  3.47it/s]
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
dataset loading complete
0 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8555, device='cuda:0', dtype=torch.float16) tensor(0.6099, device='cuda:0', dtype=torch.float16)
tensor(0.0156, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0317, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0371, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
tensor(0.0215, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
0 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.0205, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0293, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0469, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0273, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
0 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.0121, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0111, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0133, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0125, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
0 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0109, device='cuda:0', dtype=torch.float16) tensor(0.0005, device='cuda:0', dtype=torch.float16)
tensor(0.0099, device='cuda:0', dtype=torch.float16) tensor(0.0005, device='cuda:0', dtype=torch.float16)
tensor(0.0100, device='cuda:0', dtype=torch.float16) tensor(0.0005, device='cuda:0', dtype=torch.float16)
tensor(0.0111, device='cuda:0', dtype=torch.float16) tensor(0.0005, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0169, device='cuda:0')
tensor(0.0494, device='cuda:0')
old_score: tensor(0.0005, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0004, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.1476500034332275
Validation after dual ascent:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0088, device='cuda:0', dtype=torch.float16) tensor(0.0003, device='cuda:0', dtype=torch.float16)
tensor(0.0114, device='cuda:0', dtype=torch.float16) tensor(0.0004, device='cuda:0', dtype=torch.float16)
tensor(0.0089, device='cuda:0', dtype=torch.float16) tensor(0.0004, device='cuda:0', dtype=torch.float16)
tensor(0.0106, device='cuda:0', dtype=torch.float16) tensor(0.0004, device='cuda:0', dtype=torch.float16)
0 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.1758, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.1724, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.1963, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(0.1602, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
Converged at iteration 600
tensor(0.0160, device='cuda:0')
tensor(0.0236, device='cuda:0')
old_score: tensor(0.0066, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0052, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 23.762044668197632
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.1484, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
tensor(0.1421, device='cuda:0', dtype=torch.float16) tensor(0.0049, device='cuda:0', dtype=torch.float16)
tensor(0.1724, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.1387, device='cuda:0', dtype=torch.float16) tensor(0.0052, device='cuda:0', dtype=torch.float16)
0 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.1670, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.1699, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.1890, device='cuda:0', dtype=torch.float16) tensor(0.0071, device='cuda:0', dtype=torch.float16)
tensor(0.1455, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
Converged at iteration 600
tensor(0.0159, device='cuda:0')
tensor(0.0234, device='cuda:0')
old_score: tensor(0.0066, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0052, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 23.773190021514893
Validation after dual ascent:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.1587, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
tensor(0.1313, device='cuda:0', dtype=torch.float16) tensor(0.0048, device='cuda:0', dtype=torch.float16)
tensor(0.1738, device='cuda:0', dtype=torch.float16) tensor(0.0057, device='cuda:0', dtype=torch.float16)
tensor(0.1265, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
0 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0157, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
tensor(0.0193, device='cuda:0', dtype=torch.float16) tensor(0.0009, device='cuda:0', dtype=torch.float16)
tensor(0.0233, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0250, device='cuda:0', dtype=torch.float16) tensor(0.0009, device='cuda:0', dtype=torch.float16)
tensor(0.0574, device='cuda:0')
old_score: tensor(0.0009, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0008, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.29688119888306
Validation after dual ascent:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0154, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0176, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
tensor(0.0237, device='cuda:0', dtype=torch.float16) tensor(0.0009, device='cuda:0', dtype=torch.float16)
tensor(0.0240, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
layer 0 done
1 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.2344, device='cuda:0', dtype=torch.float16) tensor(0.7808, device='cuda:0', dtype=torch.float16)
tensor(0.2700, device='cuda:0', dtype=torch.float16) tensor(0.0079, device='cuda:0', dtype=torch.float16)
tensor(0.2729, device='cuda:0', dtype=torch.float16) tensor(0.0079, device='cuda:0', dtype=torch.float16)
tensor(0.2920, device='cuda:0', dtype=torch.float16) tensor(0.0087, device='cuda:0', dtype=torch.float16)
tensor(0.2690, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
1 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.6523, device='cuda:0', dtype=torch.float16) tensor(0.7861, device='cuda:0', dtype=torch.float16)
tensor(0.3638, device='cuda:0', dtype=torch.float16) tensor(0.0082, device='cuda:0', dtype=torch.float16)
tensor(0.3662, device='cuda:0', dtype=torch.float16) tensor(0.0083, device='cuda:0', dtype=torch.float16)
tensor(0.3799, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
tensor(0.3555, device='cuda:0', dtype=torch.float16) tensor(0.0083, device='cuda:0', dtype=torch.float16)
1 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.5713, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.0488, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(0.0499, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(0.0542, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.0503, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0135, device='cuda:0')
tensor(0.0208, device='cuda:0')
old_score: tensor(0.0039, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0031, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.421833992004395
Validation after dual ascent:
out_inf: tensor(1.5713, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.0451, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0511, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0514, device='cuda:0', dtype=torch.float16) tensor(0.0034, device='cuda:0', dtype=torch.float16)
tensor(0.0538, device='cuda:0', dtype=torch.float16) tensor(0.0031, device='cuda:0', dtype=torch.float16)
1 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.5747, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.0262, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0276, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0279, device='cuda:0', dtype=torch.float16) tensor(0.0017, device='cuda:0', dtype=torch.float16)
tensor(0.0294, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0192, device='cuda:0')
old_score: tensor(0.0016, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0015, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.09616732597351
Validation after dual ascent:
out_inf: tensor(0.5747, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.0275, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0265, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0294, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0267, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
1 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(43.7500, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.2188, device='cuda:0', dtype=torch.float16) tensor(0.0149, device='cuda:0', dtype=torch.float16)
tensor(0.2090, device='cuda:0', dtype=torch.float16) tensor(0.0148, device='cuda:0', dtype=torch.float16)
tensor(0.2637, device='cuda:0', dtype=torch.float16) tensor(0.0160, device='cuda:0', dtype=torch.float16)
tensor(0.2578, device='cuda:0', dtype=torch.float16) tensor(0.0151, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0144, device='cuda:0')
tensor(0.0251, device='cuda:0')
old_score: tensor(0.0152, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0125, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 33.56454944610596
Validation after dual ascent:
out_inf: tensor(43.7500, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.1816, device='cuda:0', dtype=torch.float16) tensor(0.0122, device='cuda:0', dtype=torch.float16)
tensor(0.1699, device='cuda:0', dtype=torch.float16) tensor(0.0121, device='cuda:0', dtype=torch.float16)
tensor(0.2178, device='cuda:0', dtype=torch.float16) tensor(0.0134, device='cuda:0', dtype=torch.float16)
tensor(0.2266, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
1 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(37.6562, device='cuda:0', dtype=torch.float16) tensor(0.0711, device='cuda:0', dtype=torch.float16)
tensor(0.2285, device='cuda:0', dtype=torch.float16) tensor(0.0140, device='cuda:0', dtype=torch.float16)
tensor(0.1973, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
tensor(0.2305, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.2383, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0186, device='cuda:0')
tensor(0.0233, device='cuda:0')
old_score: tensor(0.0143, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0118, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.777073621749878
Validation after dual ascent:
out_inf: tensor(37.6562, device='cuda:0', dtype=torch.float16) tensor(0.0711, device='cuda:0', dtype=torch.float16)
tensor(0.1963, device='cuda:0', dtype=torch.float16) tensor(0.0115, device='cuda:0', dtype=torch.float16)
tensor(0.1938, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.2480, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
tensor(0.2100, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
1 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2672., device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(0.0659, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.1250, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0764, device='cuda:0', dtype=torch.float16) tensor(0.0044, device='cuda:0', dtype=torch.float16)
tensor(0.0868, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(3.9786, device='cuda:0')
old_score: tensor(0.0039, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0168, device='cuda:0', dtype=torch.float16)
Not converged!
Dual ascent finished!
Time: 99.98532748222351
Validation after dual ascent:
out_inf: tensor(2672., device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(0.0659, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.1250, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0764, device='cuda:0', dtype=torch.float16) tensor(0.0044, device='cuda:0', dtype=torch.float16)
tensor(0.0868, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
layer 1 done
2 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.2344, device='cuda:0', dtype=torch.float16) tensor(0.9028, device='cuda:0', dtype=torch.float16)
tensor(0.5547, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0348, device='cuda:0', dtype=torch.float16)
tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0383, device='cuda:0', dtype=torch.float16)
tensor(0.4531, device='cuda:0', dtype=torch.float16) tensor(0.0355, device='cuda:0', dtype=torch.float16)
2 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.6328, device='cuda:0', dtype=torch.float16) tensor(1.0547, device='cuda:0', dtype=torch.float16)
tensor(0.6260, device='cuda:0', dtype=torch.float16) tensor(0.0346, device='cuda:0', dtype=torch.float16)
tensor(0.5225, device='cuda:0', dtype=torch.float16) tensor(0.0345, device='cuda:0', dtype=torch.float16)
tensor(0.7031, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
2 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.9570, device='cuda:0', dtype=torch.float16) tensor(0.1318, device='cuda:0', dtype=torch.float16)
tensor(0.2190, device='cuda:0', dtype=torch.float16) tensor(0.0224, device='cuda:0', dtype=torch.float16)
tensor(0.2322, device='cuda:0', dtype=torch.float16) tensor(0.0220, device='cuda:0', dtype=torch.float16)
tensor(0.2378, device='cuda:0', dtype=torch.float16) tensor(0.0243, device='cuda:0', dtype=torch.float16)
tensor(0.2467, device='cuda:0', dtype=torch.float16) tensor(0.0226, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0133, device='cuda:0')
tensor(0.0423, device='cuda:0')
old_score: tensor(0.0228, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0196, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2242767810821533
Validation after dual ascent:
out_inf: tensor(2.9570, device='cuda:0', dtype=torch.float16) tensor(0.1318, device='cuda:0', dtype=torch.float16)
tensor(0.2191, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.2264, device='cuda:0', dtype=torch.float16) tensor(0.0187, device='cuda:0', dtype=torch.float16)
tensor(0.2186, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
tensor(0.2443, device='cuda:0', dtype=torch.float16) tensor(0.0195, device='cuda:0', dtype=torch.float16)
2 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.9941, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
tensor(0.0366, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0339, device='cuda:0', dtype=torch.float16) tensor(0.0021, device='cuda:0', dtype=torch.float16)
tensor(0.0396, device='cuda:0', dtype=torch.float16) tensor(0.0023, device='cuda:0', dtype=torch.float16)
tensor(0.0421, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0344, device='cuda:0')
old_score: tensor(0.0022, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0021, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.158129930496216
Validation after dual ascent:
out_inf: tensor(0.9941, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
tensor(0.0350, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.0307, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.0320, device='cuda:0', dtype=torch.float16) tensor(0.0021, device='cuda:0', dtype=torch.float16)
tensor(0.0364, device='cuda:0', dtype=torch.float16) tensor(0.0021, device='cuda:0', dtype=torch.float16)
2 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2344, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(0.2571, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.2693, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(0.2607, device='cuda:0', dtype=torch.float16) tensor(0.0264, device='cuda:0', dtype=torch.float16)
tensor(0.2681, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
tensor(0.0210, device='cuda:0')
old_score: tensor(0.0248, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0220, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.351104497909546
Validation after dual ascent:
out_inf: tensor(2.2344, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(0.2444, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
tensor(0.2576, device='cuda:0', dtype=torch.float16) tensor(0.0207, device='cuda:0', dtype=torch.float16)
tensor(0.2395, device='cuda:0', dtype=torch.float16) tensor(0.0235, device='cuda:0', dtype=torch.float16)
tensor(0.2598, device='cuda:0', dtype=torch.float16) tensor(0.0222, device='cuda:0', dtype=torch.float16)
2 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2734, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.2266, device='cuda:0', dtype=torch.float16) tensor(0.0228, device='cuda:0', dtype=torch.float16)
tensor(0.2324, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
tensor(0.2664, device='cuda:0', dtype=torch.float16) tensor(0.0244, device='cuda:0', dtype=torch.float16)
tensor(0.2769, device='cuda:0', dtype=torch.float16) tensor(0.0230, device='cuda:0', dtype=torch.float16)
Converged at iteration 800
tensor(0.0190, device='cuda:0')
tensor(0.0276, device='cuda:0')
old_score: tensor(0.0230, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0205, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.662492513656616
Validation after dual ascent:
out_inf: tensor(2.2734, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.2211, device='cuda:0', dtype=torch.float16) tensor(0.0202, device='cuda:0', dtype=torch.float16)
tensor(0.2432, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.2490, device='cuda:0', dtype=torch.float16) tensor(0.0218, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0206, device='cuda:0', dtype=torch.float16)
2 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2539, device='cuda:0', dtype=torch.float16) tensor(0.0178, device='cuda:0', dtype=torch.float16)
tensor(0.0676, device='cuda:0', dtype=torch.float16) tensor(0.0044, device='cuda:0', dtype=torch.float16)
tensor(0.0692, device='cuda:0', dtype=torch.float16) tensor(0.0042, device='cuda:0', dtype=torch.float16)
tensor(0.0681, device='cuda:0', dtype=torch.float16) tensor(0.0052, device='cuda:0', dtype=torch.float16)
tensor(0.0715, device='cuda:0', dtype=torch.float16) tensor(0.0045, device='cuda:0', dtype=torch.float16)
tensor(0.0854, device='cuda:0')
old_score: tensor(0.0046, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0043, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.37484169006348
Validation after dual ascent:
out_inf: tensor(4.2539, device='cuda:0', dtype=torch.float16) tensor(0.0178, device='cuda:0', dtype=torch.float16)
tensor(0.0641, device='cuda:0', dtype=torch.float16) tensor(0.0042, device='cuda:0', dtype=torch.float16)
tensor(0.0677, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0688, device='cuda:0', dtype=torch.float16) tensor(0.0048, device='cuda:0', dtype=torch.float16)
tensor(0.0724, device='cuda:0', dtype=torch.float16) tensor(0.0043, device='cuda:0', dtype=torch.float16)
layer 2 done
3 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.0625, device='cuda:0', dtype=torch.float16) tensor(0.8184, device='cuda:0', dtype=torch.float16)
tensor(0.8975, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(0.7266, device='cuda:0', dtype=torch.float16) tensor(0.0664, device='cuda:0', dtype=torch.float16)
tensor(0.8643, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.7568, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
3 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.4531, device='cuda:0', dtype=torch.float16) tensor(0.9819, device='cuda:0', dtype=torch.float16)
tensor(0.6978, device='cuda:0', dtype=torch.float16) tensor(0.0673, device='cuda:0', dtype=torch.float16)
tensor(0.6924, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.7441, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0689, device='cuda:0', dtype=torch.float16)
3 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.7637, device='cuda:0', dtype=torch.float16) tensor(0.1967, device='cuda:0', dtype=torch.float16)
tensor(0.3931, device='cuda:0', dtype=torch.float16) tensor(0.0404, device='cuda:0', dtype=torch.float16)
tensor(0.3853, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
tensor(0.3845, device='cuda:0', dtype=torch.float16) tensor(0.0446, device='cuda:0', dtype=torch.float16)
tensor(0.3787, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0196, device='cuda:0')
tensor(0.2256, device='cuda:0')
old_score: tensor(0.0415, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0375, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.748347282409668
Validation after dual ascent:
out_inf: tensor(2.7637, device='cuda:0', dtype=torch.float16) tensor(0.1967, device='cuda:0', dtype=torch.float16)
tensor(0.3748, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.3860, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.3726, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.3726, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
3 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.3994, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
tensor(0.0561, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0528, device='cuda:0', dtype=torch.float16) tensor(0.0034, device='cuda:0', dtype=torch.float16)
tensor(0.0555, device='cuda:0', dtype=torch.float16) tensor(0.0031, device='cuda:0', dtype=torch.float16)
tensor(0.0592, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.0257, device='cuda:0')
old_score: tensor(0.0032, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0030, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.14736557006836
Validation after dual ascent:
out_inf: tensor(1.3994, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
tensor(0.0515, device='cuda:0', dtype=torch.float16) tensor(0.0028, device='cuda:0', dtype=torch.float16)
tensor(0.0536, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.0452, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0590, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
3 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8242, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
tensor(0.3276, device='cuda:0', dtype=torch.float16) tensor(0.0333, device='cuda:0', dtype=torch.float16)
tensor(0.3569, device='cuda:0', dtype=torch.float16) tensor(0.0324, device='cuda:0', dtype=torch.float16)
tensor(0.3572, device='cuda:0', dtype=torch.float16) tensor(0.0368, device='cuda:0', dtype=torch.float16)
tensor(0.3535, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0198, device='cuda:0')
tensor(0.0233, device='cuda:0')
old_score: tensor(0.0342, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0312, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.015519857406616
Validation after dual ascent:
out_inf: tensor(4.8242, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
tensor(0.3179, device='cuda:0', dtype=torch.float16) tensor(0.0303, device='cuda:0', dtype=torch.float16)
tensor(0.3379, device='cuda:0', dtype=torch.float16) tensor(0.0293, device='cuda:0', dtype=torch.float16)
tensor(0.3708, device='cuda:0', dtype=torch.float16) tensor(0.0339, device='cuda:0', dtype=torch.float16)
tensor(0.3442, device='cuda:0', dtype=torch.float16) tensor(0.0314, device='cuda:0', dtype=torch.float16)
3 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.5098, device='cuda:0', dtype=torch.float16) tensor(0.1173, device='cuda:0', dtype=torch.float16)
tensor(0.3176, device='cuda:0', dtype=torch.float16) tensor(0.0309, device='cuda:0', dtype=torch.float16)
tensor(0.3362, device='cuda:0', dtype=torch.float16) tensor(0.0300, device='cuda:0', dtype=torch.float16)
tensor(0.3086, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.3213, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0176, device='cuda:0')
tensor(0.0198, device='cuda:0')
old_score: tensor(0.0316, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0290, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.03838849067688
Validation after dual ascent:
out_inf: tensor(2.5098, device='cuda:0', dtype=torch.float16) tensor(0.1173, device='cuda:0', dtype=torch.float16)
tensor(0.3164, device='cuda:0', dtype=torch.float16) tensor(0.0281, device='cuda:0', dtype=torch.float16)
tensor(0.3105, device='cuda:0', dtype=torch.float16) tensor(0.0272, device='cuda:0', dtype=torch.float16)
tensor(0.3069, device='cuda:0', dtype=torch.float16) tensor(0.0314, device='cuda:0', dtype=torch.float16)
tensor(0.3376, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
3 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.4404, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.0873, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.0781, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.0776, device='cuda:0', dtype=torch.float16) tensor(0.0075, device='cuda:0', dtype=torch.float16)
tensor(0.0925, device='cuda:0', dtype=torch.float16) tensor(0.0070, device='cuda:0', dtype=torch.float16)
Converged at iteration 900
tensor(0.0127, device='cuda:0')
tensor(0.0209, device='cuda:0')
old_score: tensor(0.0069, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0066, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 90.61827874183655
Validation after dual ascent:
out_inf: tensor(1.4404, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.0828, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.0750, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
tensor(0.0822, device='cuda:0', dtype=torch.float16) tensor(0.0070, device='cuda:0', dtype=torch.float16)
tensor(0.0854, device='cuda:0', dtype=torch.float16) tensor(0.0067, device='cuda:0', dtype=torch.float16)
layer 3 done
4 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.0625, device='cuda:0', dtype=torch.float16) tensor(0.8042, device='cuda:0', dtype=torch.float16)
tensor(0.7065, device='cuda:0', dtype=torch.float16) tensor(0.0707, device='cuda:0', dtype=torch.float16)
tensor(0.6929, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.7900, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.8887, device='cuda:0', dtype=torch.float16) tensor(0.0733, device='cuda:0', dtype=torch.float16)
4 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.6562, device='cuda:0', dtype=torch.float16) tensor(1.0273, device='cuda:0', dtype=torch.float16)
tensor(0.8975, device='cuda:0', dtype=torch.float16) tensor(0.0700, device='cuda:0', dtype=torch.float16)
tensor(0.7744, device='cuda:0', dtype=torch.float16) tensor(0.0704, device='cuda:0', dtype=torch.float16)
tensor(0.6572, device='cuda:0', dtype=torch.float16) tensor(0.0768, device='cuda:0', dtype=torch.float16)
tensor(0.8301, device='cuda:0', dtype=torch.float16) tensor(0.0722, device='cuda:0', dtype=torch.float16)
4 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.1582, device='cuda:0', dtype=torch.float16) tensor(0.2001, device='cuda:0', dtype=torch.float16)
tensor(0.3579, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0426, device='cuda:0', dtype=torch.float16)
tensor(0.4077, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.4473, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0067, device='cuda:0')
tensor(0.0291, device='cuda:0')
old_score: tensor(0.0439, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0401, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2386183738708496
Validation after dual ascent:
out_inf: tensor(3.1582, device='cuda:0', dtype=torch.float16) tensor(0.2001, device='cuda:0', dtype=torch.float16)
tensor(0.3474, device='cuda:0', dtype=torch.float16) tensor(0.0385, device='cuda:0', dtype=torch.float16)
tensor(0.3569, device='cuda:0', dtype=torch.float16) tensor(0.0385, device='cuda:0', dtype=torch.float16)
tensor(0.3877, device='cuda:0', dtype=torch.float16) tensor(0.0429, device='cuda:0', dtype=torch.float16)
tensor(0.4641, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
4 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.2207, device='cuda:0', dtype=torch.float16) tensor(0.0226, device='cuda:0', dtype=torch.float16)
tensor(0.0758, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
tensor(0.0734, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
tensor(0.0704, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.0813, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
tensor(0.0170, device='cuda:0')
old_score: tensor(0.0055, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0051, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.132408142089844
Validation after dual ascent:
out_inf: tensor(3.2207, device='cuda:0', dtype=torch.float16) tensor(0.0226, device='cuda:0', dtype=torch.float16)
tensor(0.0746, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.0778, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.0677, device='cuda:0', dtype=torch.float16) tensor(0.0047, device='cuda:0', dtype=torch.float16)
tensor(0.0939, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
4 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7734, device='cuda:0', dtype=torch.float16) tensor(0.1951, device='cuda:0', dtype=torch.float16)
tensor(0.4065, device='cuda:0', dtype=torch.float16) tensor(0.0407, device='cuda:0', dtype=torch.float16)
tensor(0.3896, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.4097, device='cuda:0', dtype=torch.float16) tensor(0.0442, device='cuda:0', dtype=torch.float16)
tensor(0.4360, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0178, device='cuda:0')
tensor(0.1915, device='cuda:0')
old_score: tensor(0.0417, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0384, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.224358320236206
Validation after dual ascent:
out_inf: tensor(4.7734, device='cuda:0', dtype=torch.float16) tensor(0.1951, device='cuda:0', dtype=torch.float16)
tensor(0.4102, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
tensor(0.3809, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.4065, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0389, device='cuda:0', dtype=torch.float16)
4 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.0332, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(0.3467, device='cuda:0', dtype=torch.float16) tensor(0.0368, device='cuda:0', dtype=torch.float16)
tensor(0.3535, device='cuda:0', dtype=torch.float16) tensor(0.0360, device='cuda:0', dtype=torch.float16)
tensor(0.3562, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
tensor(0.4351, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0139, device='cuda:0')
tensor(0.1729, device='cuda:0')
old_score: tensor(0.0377, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0347, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.229764699935913
Validation after dual ascent:
out_inf: tensor(3.0332, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(0.3364, device='cuda:0', dtype=torch.float16) tensor(0.0337, device='cuda:0', dtype=torch.float16)
tensor(0.3701, device='cuda:0', dtype=torch.float16) tensor(0.0329, device='cuda:0', dtype=torch.float16)
tensor(0.3689, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
tensor(0.5107, device='cuda:0', dtype=torch.float16) tensor(0.0352, device='cuda:0', dtype=torch.float16)
4 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.3906, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.0921, device='cuda:0', dtype=torch.float16) tensor(0.0102, device='cuda:0', dtype=torch.float16)
tensor(0.0850, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
tensor(0.0922, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
tensor(0.1028, device='cuda:0', dtype=torch.float16) tensor(0.0107, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0121, device='cuda:0')
tensor(0.0193, device='cuda:0')
old_score: tensor(0.0103, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0098, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.56743144989014
Validation after dual ascent:
out_inf: tensor(9.3906, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.0898, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
tensor(0.0876, device='cuda:0', dtype=torch.float16) tensor(0.0092, device='cuda:0', dtype=torch.float16)
tensor(0.0950, device='cuda:0', dtype=torch.float16) tensor(0.0099, device='cuda:0', dtype=torch.float16)
tensor(0.1049, device='cuda:0', dtype=torch.float16) tensor(0.0103, device='cuda:0', dtype=torch.float16)
layer 4 done
5 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.7266, device='cuda:0', dtype=torch.float16) tensor(0.8120, device='cuda:0', dtype=torch.float16)
tensor(0.7041, device='cuda:0', dtype=torch.float16) tensor(0.0788, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(0.9160, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.9434, device='cuda:0', dtype=torch.float16) tensor(0.0817, device='cuda:0', dtype=torch.float16)
5 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.9688, device='cuda:0', dtype=torch.float16) tensor(1.0664, device='cuda:0', dtype=torch.float16)
tensor(0.7393, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.6958, device='cuda:0', dtype=torch.float16) tensor(0.0794, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
tensor(0.6543, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
5 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.4473, device='cuda:0', dtype=torch.float16) tensor(0.2050, device='cuda:0', dtype=torch.float16)
tensor(0.3857, device='cuda:0', dtype=torch.float16) tensor(0.0471, device='cuda:0', dtype=torch.float16)
tensor(0.3987, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.3770, device='cuda:0', dtype=torch.float16) tensor(0.0497, device='cuda:0', dtype=torch.float16)
tensor(0.4978, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0194, device='cuda:0')
tensor(0.0409, device='cuda:0')
old_score: tensor(0.0480, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0444, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4970502853393555
Validation after dual ascent:
out_inf: tensor(2.4473, device='cuda:0', dtype=torch.float16) tensor(0.2050, device='cuda:0', dtype=torch.float16)
tensor(0.4043, device='cuda:0', dtype=torch.float16) tensor(0.0433, device='cuda:0', dtype=torch.float16)
tensor(0.4211, device='cuda:0', dtype=torch.float16) tensor(0.0429, device='cuda:0', dtype=torch.float16)
tensor(0.3735, device='cuda:0', dtype=torch.float16) tensor(0.0462, device='cuda:0', dtype=torch.float16)
tensor(0.4746, device='cuda:0', dtype=torch.float16) tensor(0.0453, device='cuda:0', dtype=torch.float16)
5 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5898, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.0887, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.0924, device='cuda:0', dtype=torch.float16) tensor(0.0067, device='cuda:0', dtype=torch.float16)
tensor(0.0870, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.0849, device='cuda:0', dtype=torch.float16) tensor(0.0066, device='cuda:0', dtype=torch.float16)
tensor(0.0186, device='cuda:0')
old_score: tensor(0.0065, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0060, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.132384300231934
Validation after dual ascent:
out_inf: tensor(4.5898, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.0768, device='cuda:0', dtype=torch.float16) tensor(0.0059, device='cuda:0', dtype=torch.float16)
tensor(0.0789, device='cuda:0', dtype=torch.float16) tensor(0.0061, device='cuda:0', dtype=torch.float16)
tensor(0.0806, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.0852, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
5 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.3086, device='cuda:0', dtype=torch.float16) tensor(0.2266, device='cuda:0', dtype=torch.float16)
tensor(0.3809, device='cuda:0', dtype=torch.float16) tensor(0.0461, device='cuda:0', dtype=torch.float16)
tensor(0.4448, device='cuda:0', dtype=torch.float16) tensor(0.0446, device='cuda:0', dtype=torch.float16)
tensor(0.3884, device='cuda:0', dtype=torch.float16) tensor(0.0477, device='cuda:0', dtype=torch.float16)
tensor(0.3799, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0117, device='cuda:0')
tensor(0.0183, device='cuda:0')
old_score: tensor(0.0465, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0429, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.067944526672363
Validation after dual ascent:
out_inf: tensor(3.3086, device='cuda:0', dtype=torch.float16) tensor(0.2266, device='cuda:0', dtype=torch.float16)
tensor(0.3784, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(0.3833, device='cuda:0', dtype=torch.float16) tensor(0.0407, device='cuda:0', dtype=torch.float16)
tensor(0.3801, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.3816, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
5 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.0938, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(0.3906, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
tensor(0.3535, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.4102, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
tensor(0.3657, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0120, device='cuda:0')
tensor(0.0241, device='cuda:0')
old_score: tensor(0.0420, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0388, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.183943033218384
Validation after dual ascent:
out_inf: tensor(4.0938, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(0.3809, device='cuda:0', dtype=torch.float16) tensor(0.0383, device='cuda:0', dtype=torch.float16)
tensor(0.3396, device='cuda:0', dtype=torch.float16) tensor(0.0368, device='cuda:0', dtype=torch.float16)
tensor(0.3745, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
tensor(0.3701, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
5 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.5566, device='cuda:0', dtype=torch.float16) tensor(0.0451, device='cuda:0', dtype=torch.float16)
tensor(0.1213, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.1567, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.1072, device='cuda:0', dtype=torch.float16) tensor(0.0123, device='cuda:0', dtype=torch.float16)
tensor(0.1198, device='cuda:0', dtype=torch.float16) tensor(0.0133, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0195, device='cuda:0')
tensor(0.0129, device='cuda:0')
old_score: tensor(0.0128, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0123, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.943907499313354
Validation after dual ascent:
out_inf: tensor(1.5566, device='cuda:0', dtype=torch.float16) tensor(0.0451, device='cuda:0', dtype=torch.float16)
tensor(0.1265, device='cuda:0', dtype=torch.float16) tensor(0.0122, device='cuda:0', dtype=torch.float16)
tensor(0.1389, device='cuda:0', dtype=torch.float16) tensor(0.0121, device='cuda:0', dtype=torch.float16)
tensor(0.1019, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
tensor(0.1224, device='cuda:0', dtype=torch.float16) tensor(0.0129, device='cuda:0', dtype=torch.float16)
layer 5 done
6 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.5859, device='cuda:0', dtype=torch.float16) tensor(0.8325, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
tensor(0.8027, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(0.7705, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.7910, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0134, device='cuda:0')
tensor(0.0563, device='cuda:0')
old_score: tensor(0.0944, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0870, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.256359577178955
Validation after dual ascent:
out_inf: tensor(13.5859, device='cuda:0', dtype=torch.float16) tensor(0.8325, device='cuda:0', dtype=torch.float16)
tensor(0.7793, device='cuda:0', dtype=torch.float16) tensor(0.0859, device='cuda:0', dtype=torch.float16)
tensor(0.7998, device='cuda:0', dtype=torch.float16) tensor(0.0847, device='cuda:0', dtype=torch.float16)
tensor(0.7817, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.7627, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
6 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.5312, device='cuda:0', dtype=torch.float16) tensor(1.0098, device='cuda:0', dtype=torch.float16)
tensor(0.7637, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.7227, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(0.7666, device='cuda:0', dtype=torch.float16) tensor(0.0948, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
6 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.4316, device='cuda:0', dtype=torch.float16) tensor(0.2515, device='cuda:0', dtype=torch.float16)
tensor(0.4697, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.4229, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(0.4253, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
tensor(0.4766, device='cuda:0', dtype=torch.float16) tensor(0.0581, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0119, device='cuda:0')
tensor(0.0562, device='cuda:0')
old_score: tensor(0.0567, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0525, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5036072731018066
Validation after dual ascent:
out_inf: tensor(3.4316, device='cuda:0', dtype=torch.float16) tensor(0.2515, device='cuda:0', dtype=torch.float16)
tensor(0.4106, device='cuda:0', dtype=torch.float16) tensor(0.0520, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0510, device='cuda:0', dtype=torch.float16)
tensor(0.4121, device='cuda:0', dtype=torch.float16) tensor(0.0527, device='cuda:0', dtype=torch.float16)
tensor(0.4517, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
6 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
tensor(0.1105, device='cuda:0', dtype=torch.float16) tensor(0.0085, device='cuda:0', dtype=torch.float16)
tensor(0.1129, device='cuda:0', dtype=torch.float16) tensor(0.0100, device='cuda:0', dtype=torch.float16)
tensor(0.1154, device='cuda:0', dtype=torch.float16) tensor(0.0102, device='cuda:0', dtype=torch.float16)
tensor(0.0991, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0131, device='cuda:0')
tensor(0.0234, device='cuda:0')
old_score: tensor(0.0094, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0086, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.447231769561768
Validation after dual ascent:
out_inf: tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
tensor(0.1129, device='cuda:0', dtype=torch.float16) tensor(0.0078, device='cuda:0', dtype=torch.float16)
tensor(0.1128, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
tensor(0.1077, device='cuda:0', dtype=torch.float16) tensor(0.0093, device='cuda:0', dtype=torch.float16)
tensor(0.0977, device='cuda:0', dtype=torch.float16) tensor(0.0083, device='cuda:0', dtype=torch.float16)
6 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4805, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(0.4329, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(0.4482, device='cuda:0', dtype=torch.float16) tensor(0.0492, device='cuda:0', dtype=torch.float16)
tensor(0.4150, device='cuda:0', dtype=torch.float16) tensor(0.0517, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0529, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0039, device='cuda:0')
tensor(0.0239, device='cuda:0')
old_score: tensor(0.0513, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0475, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.16913628578186
Validation after dual ascent:
out_inf: tensor(4.4805, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(0.4009, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(0.4280, device='cuda:0', dtype=torch.float16) tensor(0.0450, device='cuda:0', dtype=torch.float16)
tensor(0.4106, device='cuda:0', dtype=torch.float16) tensor(0.0478, device='cuda:0', dtype=torch.float16)
tensor(0.4355, device='cuda:0', dtype=torch.float16) tensor(0.0494, device='cuda:0', dtype=torch.float16)
6 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.9727, device='cuda:0', dtype=torch.float16) tensor(0.1781, device='cuda:0', dtype=torch.float16)
tensor(0.3828, device='cuda:0', dtype=torch.float16) tensor(0.0456, device='cuda:0', dtype=torch.float16)
tensor(0.4414, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(0.3867, device='cuda:0', dtype=torch.float16) tensor(0.0458, device='cuda:0', dtype=torch.float16)
tensor(0.3911, device='cuda:0', dtype=torch.float16) tensor(0.0469, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0178, device='cuda:0')
tensor(0.2606, device='cuda:0')
old_score: tensor(0.0455, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0421, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.228105306625366
Validation after dual ascent:
out_inf: tensor(2.9727, device='cuda:0', dtype=torch.float16) tensor(0.1781, device='cuda:0', dtype=torch.float16)
tensor(0.3652, device='cuda:0', dtype=torch.float16) tensor(0.0423, device='cuda:0', dtype=torch.float16)
tensor(0.3789, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
tensor(0.3555, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(0.3730, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
6 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.4756, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.1609, device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
tensor(0.1384, device='cuda:0', dtype=torch.float16) tensor(0.0151, device='cuda:0', dtype=torch.float16)
tensor(0.1261, device='cuda:0', dtype=torch.float16) tensor(0.0144, device='cuda:0', dtype=torch.float16)
tensor(0.1367, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0091, device='cuda:0')
tensor(0.0170, device='cuda:0')
old_score: tensor(0.0152, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0145, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.161463499069214
Validation after dual ascent:
out_inf: tensor(1.4756, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.1667, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.1354, device='cuda:0', dtype=torch.float16) tensor(0.0143, device='cuda:0', dtype=torch.float16)
tensor(0.1255, device='cuda:0', dtype=torch.float16) tensor(0.0136, device='cuda:0', dtype=torch.float16)
tensor(0.1442, device='cuda:0', dtype=torch.float16) tensor(0.0152, device='cuda:0', dtype=torch.float16)
layer 6 done
7 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.0156, device='cuda:0', dtype=torch.float16) tensor(0.8291, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.0970, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
tensor(0.8623, device='cuda:0', dtype=torch.float16) tensor(0.1007, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0105, device='cuda:0')
tensor(0.0550, device='cuda:0')
old_score: tensor(0.0979, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0902, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2416129112243652
Validation after dual ascent:
out_inf: tensor(17.0156, device='cuda:0', dtype=torch.float16) tensor(0.8291, device='cuda:0', dtype=torch.float16)
tensor(1.3711, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(1.5156, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(0.9414, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
7 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.0938, device='cuda:0', dtype=torch.float16) tensor(0.9863, device='cuda:0', dtype=torch.float16)
tensor(0.7549, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(0.8335, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
tensor(0.7202, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(0.8540, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
7 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8828, device='cuda:0', dtype=torch.float16) tensor(0.2634, device='cuda:0', dtype=torch.float16)
tensor(0.4888, device='cuda:0', dtype=torch.float16) tensor(0.0593, device='cuda:0', dtype=torch.float16)
tensor(0.4695, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(0.5078, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
tensor(0.4646, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0061, device='cuda:0')
tensor(0.0633, device='cuda:0')
old_score: tensor(0.0596, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0552, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4949169158935547
Validation after dual ascent:
out_inf: tensor(4.8828, device='cuda:0', dtype=torch.float16) tensor(0.2634, device='cuda:0', dtype=torch.float16)
tensor(0.4761, device='cuda:0', dtype=torch.float16) tensor(0.0551, device='cuda:0', dtype=torch.float16)
tensor(0.4255, device='cuda:0', dtype=torch.float16) tensor(0.0534, device='cuda:0', dtype=torch.float16)
tensor(0.4312, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
tensor(0.4368, device='cuda:0', dtype=torch.float16) tensor(0.0574, device='cuda:0', dtype=torch.float16)
7 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.0977, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.1428, device='cuda:0', dtype=torch.float16) tensor(0.0109, device='cuda:0', dtype=torch.float16)
tensor(0.1076, device='cuda:0', dtype=torch.float16) tensor(0.0121, device='cuda:0', dtype=torch.float16)
tensor(0.1295, device='cuda:0', dtype=torch.float16) tensor(0.0130, device='cuda:0', dtype=torch.float16)
tensor(0.1230, device='cuda:0', dtype=torch.float16) tensor(0.0113, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0166, device='cuda:0')
tensor(0.0270, device='cuda:0')
old_score: tensor(0.0118, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0108, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.460156440734863
Validation after dual ascent:
out_inf: tensor(4.0977, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.1287, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.1008, device='cuda:0', dtype=torch.float16) tensor(0.0109, device='cuda:0', dtype=torch.float16)
tensor(0.1117, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
tensor(0.1115, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
7 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.8359, device='cuda:0', dtype=torch.float16) tensor(0.3254, device='cuda:0', dtype=torch.float16)
tensor(0.4697, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.4727, device='cuda:0', dtype=torch.float16) tensor(0.0525, device='cuda:0', dtype=torch.float16)
tensor(0.4595, device='cuda:0', dtype=torch.float16) tensor(0.0541, device='cuda:0', dtype=torch.float16)
tensor(0.4600, device='cuda:0', dtype=torch.float16) tensor(0.0550, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0043, device='cuda:0')
tensor(0.0263, device='cuda:0')
old_score: tensor(0.0537, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0496, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.171928644180298
Validation after dual ascent:
out_inf: tensor(5.8359, device='cuda:0', dtype=torch.float16) tensor(0.3254, device='cuda:0', dtype=torch.float16)
tensor(0.4236, device='cuda:0', dtype=torch.float16) tensor(0.0494, device='cuda:0', dtype=torch.float16)
tensor(0.4714, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.4304, device='cuda:0', dtype=torch.float16) tensor(0.0496, device='cuda:0', dtype=torch.float16)
tensor(0.4563, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
7 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.0234, device='cuda:0', dtype=torch.float16) tensor(0.1920, device='cuda:0', dtype=torch.float16)
tensor(0.4297, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.3691, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
tensor(0.4067, device='cuda:0', dtype=torch.float16) tensor(0.0490, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0193, device='cuda:0')
tensor(0.2892, device='cuda:0')
old_score: tensor(0.0479, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0443, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.227075576782227
Validation after dual ascent:
out_inf: tensor(4.0234, device='cuda:0', dtype=torch.float16) tensor(0.1920, device='cuda:0', dtype=torch.float16)
tensor(0.4121, device='cuda:0', dtype=torch.float16) tensor(0.0442, device='cuda:0', dtype=torch.float16)
tensor(0.4031, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.3613, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.4185, device='cuda:0', dtype=torch.float16) tensor(0.0460, device='cuda:0', dtype=torch.float16)
7 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.4844, device='cuda:0', dtype=torch.float16) tensor(0.0633, device='cuda:0', dtype=torch.float16)
tensor(0.1726, device='cuda:0', dtype=torch.float16) tensor(0.0174, device='cuda:0', dtype=torch.float16)
tensor(0.1616, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
tensor(0.1396, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
tensor(0.1653, device='cuda:0', dtype=torch.float16) tensor(0.0177, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0116, device='cuda:0')
tensor(0.0216, device='cuda:0')
old_score: tensor(0.0172, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0164, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.27642846107483
Validation after dual ascent:
out_inf: tensor(2.4844, device='cuda:0', dtype=torch.float16) tensor(0.0633, device='cuda:0', dtype=torch.float16)
tensor(0.1711, device='cuda:0', dtype=torch.float16) tensor(0.0166, device='cuda:0', dtype=torch.float16)
tensor(0.1533, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.1339, device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(0.1588, device='cuda:0', dtype=torch.float16) tensor(0.0170, device='cuda:0', dtype=torch.float16)
layer 7 done
8 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16., device='cuda:0', dtype=torch.float16) tensor(0.7974, device='cuda:0', dtype=torch.float16)
tensor(0.7861, device='cuda:0', dtype=torch.float16) tensor(0.0971, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
tensor(1.1338, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(0.7974, device='cuda:0', dtype=torch.float16) tensor(0.1008, device='cuda:0', dtype=torch.float16)
tensor(0.0901, device='cuda:0')
old_score: tensor(0.0986, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0906, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.108880758285522
Validation after dual ascent:
out_inf: tensor(16., device='cuda:0', dtype=torch.float16) tensor(0.7974, device='cuda:0', dtype=torch.float16)
tensor(0.7393, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(0.8975, device='cuda:0', dtype=torch.float16) tensor(0.0886, device='cuda:0', dtype=torch.float16)
tensor(0.8906, device='cuda:0', dtype=torch.float16) tensor(0.0904, device='cuda:0', dtype=torch.float16)
tensor(0.7812, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
8 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.7188, device='cuda:0', dtype=torch.float16) tensor(1.0195, device='cuda:0', dtype=torch.float16)
tensor(0.8330, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
tensor(0.8169, device='cuda:0', dtype=torch.float16) tensor(0.0971, device='cuda:0', dtype=torch.float16)
tensor(0.8140, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
tensor(0.8301, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
8 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8789, device='cuda:0', dtype=torch.float16) tensor(0.2744, device='cuda:0', dtype=torch.float16)
tensor(0.5298, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0602, device='cuda:0', dtype=torch.float16)
tensor(0.4521, device='cuda:0', dtype=torch.float16) tensor(0.0614, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0626, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0157, device='cuda:0')
tensor(0.0716, device='cuda:0')
old_score: tensor(0.0612, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0565, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2300403118133545
Validation after dual ascent:
out_inf: tensor(4.8789, device='cuda:0', dtype=torch.float16) tensor(0.2744, device='cuda:0', dtype=torch.float16)
tensor(0.5337, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.4648, device='cuda:0', dtype=torch.float16) tensor(0.0551, device='cuda:0', dtype=torch.float16)
tensor(0.4573, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.5234, device='cuda:0', dtype=torch.float16) tensor(0.0585, device='cuda:0', dtype=torch.float16)
8 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.0625, device='cuda:0', dtype=torch.float16) tensor(0.0491, device='cuda:0', dtype=torch.float16)
tensor(0.1470, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
tensor(0.1569, device='cuda:0', dtype=torch.float16) tensor(0.0152, device='cuda:0', dtype=torch.float16)
tensor(0.1758, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1393, device='cuda:0', dtype=torch.float16) tensor(0.0138, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0111, device='cuda:0')
tensor(0.0243, device='cuda:0')
old_score: tensor(0.0143, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0132, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.718307971954346
Validation after dual ascent:
out_inf: tensor(4.0625, device='cuda:0', dtype=torch.float16) tensor(0.0491, device='cuda:0', dtype=torch.float16)
tensor(0.1288, device='cuda:0', dtype=torch.float16) tensor(0.0117, device='cuda:0', dtype=torch.float16)
tensor(0.1476, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
tensor(0.1403, device='cuda:0', dtype=torch.float16) tensor(0.0143, device='cuda:0', dtype=torch.float16)
tensor(0.1232, device='cuda:0', dtype=torch.float16) tensor(0.0128, device='cuda:0', dtype=torch.float16)
8 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1445, device='cuda:0', dtype=torch.float16) tensor(0.3164, device='cuda:0', dtype=torch.float16)
tensor(0.4678, device='cuda:0', dtype=torch.float16) tensor(0.0549, device='cuda:0', dtype=torch.float16)
tensor(0.4688, device='cuda:0', dtype=torch.float16) tensor(0.0546, device='cuda:0', dtype=torch.float16)
tensor(0.5586, device='cuda:0', dtype=torch.float16) tensor(0.0558, device='cuda:0', dtype=torch.float16)
tensor(0.4526, device='cuda:0', dtype=torch.float16) tensor(0.0567, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0039, device='cuda:0')
tensor(0.0296, device='cuda:0')
old_score: tensor(0.0555, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0513, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.182819843292236
Validation after dual ascent:
out_inf: tensor(6.1445, device='cuda:0', dtype=torch.float16) tensor(0.3164, device='cuda:0', dtype=torch.float16)
tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0510, device='cuda:0', dtype=torch.float16)
tensor(0.4583, device='cuda:0', dtype=torch.float16) tensor(0.0499, device='cuda:0', dtype=torch.float16)
tensor(0.5732, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.4441, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
8 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8984, device='cuda:0', dtype=torch.float16) tensor(0.2063, device='cuda:0', dtype=torch.float16)
tensor(0.4370, device='cuda:0', dtype=torch.float16) tensor(0.0505, device='cuda:0', dtype=torch.float16)
tensor(0.4727, device='cuda:0', dtype=torch.float16) tensor(0.0502, device='cuda:0', dtype=torch.float16)
tensor(0.4263, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.5234, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0024, device='cuda:0')
tensor(0.0275, device='cuda:0')
old_score: tensor(0.0511, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0472, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.187958717346191
Validation after dual ascent:
out_inf: tensor(7.8984, device='cuda:0', dtype=torch.float16) tensor(0.2063, device='cuda:0', dtype=torch.float16)
tensor(0.4077, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.4512, device='cuda:0', dtype=torch.float16) tensor(0.0460, device='cuda:0', dtype=torch.float16)
tensor(0.3972, device='cuda:0', dtype=torch.float16) tensor(0.0471, device='cuda:0', dtype=torch.float16)
tensor(0.5020, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
8 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.0664, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.1713, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.1713, device='cuda:0', dtype=torch.float16) tensor(0.0185, device='cuda:0', dtype=torch.float16)
tensor(0.1608, device='cuda:0', dtype=torch.float16) tensor(0.0191, device='cuda:0', dtype=torch.float16)
tensor(0.1781, device='cuda:0', dtype=torch.float16) tensor(0.0198, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0042, device='cuda:0')
tensor(0.0070, device='cuda:0')
old_score: tensor(0.0191, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0182, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.298569440841675
Validation after dual ascent:
out_inf: tensor(4.0664, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.1776, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.1792, device='cuda:0', dtype=torch.float16) tensor(0.0176, device='cuda:0', dtype=torch.float16)
tensor(0.1436, device='cuda:0', dtype=torch.float16) tensor(0.0181, device='cuda:0', dtype=torch.float16)
tensor(0.1719, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
layer 8 done
9 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.4141, device='cuda:0', dtype=torch.float16) tensor(0.7930, device='cuda:0', dtype=torch.float16)
tensor(0.8638, device='cuda:0', dtype=torch.float16) tensor(0.1042, device='cuda:0', dtype=torch.float16)
tensor(0.8750, device='cuda:0', dtype=torch.float16) tensor(0.1052, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.1070, device='cuda:0', dtype=torch.float16)
tensor(0.8926, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0195, device='cuda:0')
tensor(0.0895, device='cuda:0')
old_score: tensor(0.1062, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0980, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.888385772705078
Validation after dual ascent:
out_inf: tensor(14.4141, device='cuda:0', dtype=torch.float16) tensor(0.7930, device='cuda:0', dtype=torch.float16)
tensor(0.8228, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(0.7793, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
tensor(0.8652, device='cuda:0', dtype=torch.float16) tensor(0.0979, device='cuda:0', dtype=torch.float16)
tensor(0.8408, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
9 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.7188, device='cuda:0', dtype=torch.float16) tensor(1.0420, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
tensor(0.9512, device='cuda:0', dtype=torch.float16) tensor(0.1057, device='cuda:0', dtype=torch.float16)
tensor(0.8652, device='cuda:0', dtype=torch.float16) tensor(0.1074, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.1087, device='cuda:0', dtype=torch.float16)
tensor(0.0781, device='cuda:0')
old_score: tensor(0.1066, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0983, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.13611912727356
Validation after dual ascent:
out_inf: tensor(19.7188, device='cuda:0', dtype=torch.float16) tensor(1.0420, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.0970, device='cuda:0', dtype=torch.float16)
tensor(0.8555, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(0.8535, device='cuda:0', dtype=torch.float16) tensor(0.0982, device='cuda:0', dtype=torch.float16)
tensor(0.9180, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
9 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.7695, device='cuda:0', dtype=torch.float16) tensor(0.2803, device='cuda:0', dtype=torch.float16)
tensor(0.5200, device='cuda:0', dtype=torch.float16) tensor(0.0638, device='cuda:0', dtype=torch.float16)
tensor(0.4924, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.4692, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(0.5859, device='cuda:0', dtype=torch.float16) tensor(0.0662, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0114, device='cuda:0')
tensor(0.0570, device='cuda:0')
old_score: tensor(0.0648, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0601, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2355713844299316
Validation after dual ascent:
out_inf: tensor(6.7695, device='cuda:0', dtype=torch.float16) tensor(0.2803, device='cuda:0', dtype=torch.float16)
tensor(0.5396, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
tensor(0.4941, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.5239, device='cuda:0', dtype=torch.float16) tensor(0.0599, device='cuda:0', dtype=torch.float16)
tensor(0.4897, device='cuda:0', dtype=torch.float16) tensor(0.0622, device='cuda:0', dtype=torch.float16)
9 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2227, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.1594, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.1693, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
tensor(0.2014, device='cuda:0', dtype=torch.float16) tensor(0.0175, device='cuda:0', dtype=torch.float16)
tensor(0.1499, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0176, device='cuda:0')
tensor(0.0235, device='cuda:0')
old_score: tensor(0.0163, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0149, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.9785752296447754
Validation after dual ascent:
out_inf: tensor(4.2227, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.1381, device='cuda:0', dtype=torch.float16) tensor(0.0137, device='cuda:0', dtype=torch.float16)
tensor(0.1558, device='cuda:0', dtype=torch.float16) tensor(0.0153, device='cuda:0', dtype=torch.float16)
tensor(0.1903, device='cuda:0', dtype=torch.float16) tensor(0.0160, device='cuda:0', dtype=torch.float16)
tensor(0.1387, device='cuda:0', dtype=torch.float16) tensor(0.0146, device='cuda:0', dtype=torch.float16)
9 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.8008, device='cuda:0', dtype=torch.float16) tensor(0.3196, device='cuda:0', dtype=torch.float16)
tensor(0.4309, device='cuda:0', dtype=torch.float16) tensor(0.0571, device='cuda:0', dtype=torch.float16)
tensor(0.4629, device='cuda:0', dtype=torch.float16) tensor(0.0567, device='cuda:0', dtype=torch.float16)
tensor(0.4678, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
tensor(0.5444, device='cuda:0', dtype=torch.float16) tensor(0.0589, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0037, device='cuda:0')
tensor(0.0336, device='cuda:0')
old_score: tensor(0.0577, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0535, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.186426639556885
Validation after dual ascent:
out_inf: tensor(6.8008, device='cuda:0', dtype=torch.float16) tensor(0.3196, device='cuda:0', dtype=torch.float16)
tensor(0.4592, device='cuda:0', dtype=torch.float16) tensor(0.0531, device='cuda:0', dtype=torch.float16)
tensor(0.4932, device='cuda:0', dtype=torch.float16) tensor(0.0522, device='cuda:0', dtype=torch.float16)
tensor(0.4443, device='cuda:0', dtype=torch.float16) tensor(0.0534, device='cuda:0', dtype=torch.float16)
tensor(0.4919, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
9 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.6738, device='cuda:0', dtype=torch.float16) tensor(0.2181, device='cuda:0', dtype=torch.float16)
tensor(0.6055, device='cuda:0', dtype=torch.float16) tensor(0.0535, device='cuda:0', dtype=torch.float16)
tensor(0.4241, device='cuda:0', dtype=torch.float16) tensor(0.0532, device='cuda:0', dtype=torch.float16)
tensor(0.4126, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
tensor(0.4297, device='cuda:0', dtype=torch.float16) tensor(0.0552, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0026, device='cuda:0')
tensor(0.0321, device='cuda:0')
old_score: tensor(0.0540, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0502, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.18815803527832
Validation after dual ascent:
out_inf: tensor(3.6738, device='cuda:0', dtype=torch.float16) tensor(0.2181, device='cuda:0', dtype=torch.float16)
tensor(0.5508, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.3936, device='cuda:0', dtype=torch.float16) tensor(0.0490, device='cuda:0', dtype=torch.float16)
tensor(0.4087, device='cuda:0', dtype=torch.float16) tensor(0.0500, device='cuda:0', dtype=torch.float16)
tensor(0.4080, device='cuda:0', dtype=torch.float16) tensor(0.0519, device='cuda:0', dtype=torch.float16)
9 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.0215, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.1858, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
tensor(0.1676, device='cuda:0', dtype=torch.float16) tensor(0.0206, device='cuda:0', dtype=torch.float16)
tensor(0.1670, device='cuda:0', dtype=torch.float16) tensor(0.0209, device='cuda:0', dtype=torch.float16)
tensor(0.1863, device='cuda:0', dtype=torch.float16) tensor(0.0218, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0057, device='cuda:0')
tensor(0.0190, device='cuda:0')
old_score: tensor(0.0211, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0202, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.438346147537231
Validation after dual ascent:
out_inf: tensor(3.0215, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.1775, device='cuda:0', dtype=torch.float16) tensor(0.0203, device='cuda:0', dtype=torch.float16)
tensor(0.1627, device='cuda:0', dtype=torch.float16) tensor(0.0197, device='cuda:0', dtype=torch.float16)
tensor(0.1718, device='cuda:0', dtype=torch.float16) tensor(0.0199, device='cuda:0', dtype=torch.float16)
tensor(0.1757, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
layer 9 done
10 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.6172, device='cuda:0', dtype=torch.float16) tensor(0.7827, device='cuda:0', dtype=torch.float16)
tensor(0.8662, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
tensor(1.1611, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
tensor(0.9561, device='cuda:0', dtype=torch.float16) tensor(0.1088, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.1104, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0106, device='cuda:0')
tensor(0.1411, device='cuda:0')
old_score: tensor(0.1083, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1004, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4970061779022217
Validation after dual ascent:
out_inf: tensor(13.6172, device='cuda:0', dtype=torch.float16) tensor(0.7827, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0991, device='cuda:0', dtype=torch.float16)
tensor(0.9912, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
tensor(0.8486, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(0.9268, device='cuda:0', dtype=torch.float16) tensor(0.1035, device='cuda:0', dtype=torch.float16)
10 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.6562, device='cuda:0', dtype=torch.float16) tensor(1.0508, device='cuda:0', dtype=torch.float16)
tensor(0.8018, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
tensor(1.4707, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(0.9131, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0125, device='cuda:0')
tensor(0.1451, device='cuda:0')
old_score: tensor(0.1085, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1005, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4986469745635986
Validation after dual ascent:
out_inf: tensor(16.6562, device='cuda:0', dtype=torch.float16) tensor(1.0508, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.3252, device='cuda:0', dtype=torch.float16) tensor(0.0990, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(0.8062, device='cuda:0', dtype=torch.float16) tensor(0.1035, device='cuda:0', dtype=torch.float16)
10 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1953, device='cuda:0', dtype=torch.float16) tensor(0.2876, device='cuda:0', dtype=torch.float16)
tensor(0.4619, device='cuda:0', dtype=torch.float16) tensor(0.0659, device='cuda:0', dtype=torch.float16)
tensor(0.4736, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(0.5571, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(0.5356, device='cuda:0', dtype=torch.float16) tensor(0.0682, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0043, device='cuda:0')
tensor(0.0782, device='cuda:0')
old_score: tensor(0.0668, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0622, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5008630752563477
Validation after dual ascent:
out_inf: tensor(7.1953, device='cuda:0', dtype=torch.float16) tensor(0.2876, device='cuda:0', dtype=torch.float16)
tensor(0.4822, device='cuda:0', dtype=torch.float16) tensor(0.0616, device='cuda:0', dtype=torch.float16)
tensor(0.4514, device='cuda:0', dtype=torch.float16) tensor(0.0611, device='cuda:0', dtype=torch.float16)
tensor(0.5127, device='cuda:0', dtype=torch.float16) tensor(0.0618, device='cuda:0', dtype=torch.float16)
tensor(0.5127, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
10 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.7773, device='cuda:0', dtype=torch.float16) tensor(0.0678, device='cuda:0', dtype=torch.float16)
tensor(0.2129, device='cuda:0', dtype=torch.float16) tensor(0.0184, device='cuda:0', dtype=torch.float16)
tensor(0.1898, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.2007, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
tensor(0.1813, device='cuda:0', dtype=torch.float16) tensor(0.0192, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0037, device='cuda:0')
tensor(0.0370, device='cuda:0')
old_score: tensor(0.0195, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0178, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7529850006103516
Validation after dual ascent:
out_inf: tensor(5.7773, device='cuda:0', dtype=torch.float16) tensor(0.0678, device='cuda:0', dtype=torch.float16)
tensor(0.1877, device='cuda:0', dtype=torch.float16) tensor(0.0167, device='cuda:0', dtype=torch.float16)
tensor(0.1759, device='cuda:0', dtype=torch.float16) tensor(0.0177, device='cuda:0', dtype=torch.float16)
tensor(0.1997, device='cuda:0', dtype=torch.float16) tensor(0.0191, device='cuda:0', dtype=torch.float16)
tensor(0.1606, device='cuda:0', dtype=torch.float16) tensor(0.0177, device='cuda:0', dtype=torch.float16)
10 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.3789, device='cuda:0', dtype=torch.float16) tensor(0.3396, device='cuda:0', dtype=torch.float16)
tensor(0.4863, device='cuda:0', dtype=torch.float16) tensor(0.0586, device='cuda:0', dtype=torch.float16)
tensor(0.4746, device='cuda:0', dtype=torch.float16) tensor(0.0581, device='cuda:0', dtype=torch.float16)
tensor(0.4824, device='cuda:0', dtype=torch.float16) tensor(0.0593, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0607, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0039, device='cuda:0')
tensor(0.0362, device='cuda:0')
old_score: tensor(0.0591, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0550, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.202401638031006
Validation after dual ascent:
out_inf: tensor(6.3789, device='cuda:0', dtype=torch.float16) tensor(0.3396, device='cuda:0', dtype=torch.float16)
tensor(0.4565, device='cuda:0', dtype=torch.float16) tensor(0.0545, device='cuda:0', dtype=torch.float16)
tensor(0.4639, device='cuda:0', dtype=torch.float16) tensor(0.0537, device='cuda:0', dtype=torch.float16)
tensor(0.4497, device='cuda:0', dtype=torch.float16) tensor(0.0548, device='cuda:0', dtype=torch.float16)
tensor(0.4785, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
10 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.7734, device='cuda:0', dtype=torch.float16) tensor(0.2369, device='cuda:0', dtype=torch.float16)
tensor(0.4697, device='cuda:0', dtype=torch.float16) tensor(0.0560, device='cuda:0', dtype=torch.float16)
tensor(0.4502, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(0.4473, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.5049, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0028, device='cuda:0')
tensor(0.0346, device='cuda:0')
old_score: tensor(0.0565, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0527, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.212939739227295
Validation after dual ascent:
out_inf: tensor(3.7734, device='cuda:0', dtype=torch.float16) tensor(0.2369, device='cuda:0', dtype=torch.float16)
tensor(0.4629, device='cuda:0', dtype=torch.float16) tensor(0.0522, device='cuda:0', dtype=torch.float16)
tensor(0.4102, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.4307, device='cuda:0', dtype=torch.float16) tensor(0.0524, device='cuda:0', dtype=torch.float16)
tensor(0.4683, device='cuda:0', dtype=torch.float16) tensor(0.0546, device='cuda:0', dtype=torch.float16)
10 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.9883, device='cuda:0', dtype=torch.float16) tensor(0.0838, device='cuda:0', dtype=torch.float16)
tensor(0.2028, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(0.2094, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.1763, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(0.2155, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0045, device='cuda:0')
tensor(0.0217, device='cuda:0')
old_score: tensor(0.0235, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0225, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.459861516952515
Validation after dual ascent:
out_inf: tensor(2.9883, device='cuda:0', dtype=torch.float16) tensor(0.0838, device='cuda:0', dtype=torch.float16)
tensor(0.2031, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.2008, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
tensor(0.1794, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
tensor(0.2083, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
layer 10 done
11 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.7500, device='cuda:0', dtype=torch.float16) tensor(0.7822, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(1.0488, device='cuda:0', dtype=torch.float16) tensor(0.1096, device='cuda:0', dtype=torch.float16)
tensor(0.9648, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(1.1865, device='cuda:0', dtype=torch.float16) tensor(0.1127, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0120, device='cuda:0')
tensor(0.1895, device='cuda:0')
old_score: tensor(0.1105, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1029, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5111193656921387
Validation after dual ascent:
out_inf: tensor(18.7500, device='cuda:0', dtype=torch.float16) tensor(0.7822, device='cuda:0', dtype=torch.float16)
tensor(0.9072, device='cuda:0', dtype=torch.float16) tensor(0.1019, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.1020, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.1063, device='cuda:0', dtype=torch.float16)
11 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.5938, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(0.8105, device='cuda:0', dtype=torch.float16) tensor(0.1084, device='cuda:0', dtype=torch.float16)
tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.1087, device='cuda:0', dtype=torch.float16)
tensor(0.8809, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.1120, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0129, device='cuda:0')
tensor(0.1905, device='cuda:0')
old_score: tensor(0.1096, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1019, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5130884647369385
Validation after dual ascent:
out_inf: tensor(16.5938, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(0.7729, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
tensor(0.8096, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(0.8975, device='cuda:0', dtype=torch.float16) tensor(0.1008, device='cuda:0', dtype=torch.float16)
tensor(0.7915, device='cuda:0', dtype=torch.float16) tensor(0.1053, device='cuda:0', dtype=torch.float16)
11 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.2891, device='cuda:0', dtype=torch.float16) tensor(0.3269, device='cuda:0', dtype=torch.float16)
tensor(0.5688, device='cuda:0', dtype=torch.float16) tensor(0.0773, device='cuda:0', dtype=torch.float16)
tensor(0.5981, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
tensor(0.5962, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.6016, device='cuda:0', dtype=torch.float16) tensor(0.0799, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0064, device='cuda:0')
tensor(0.1221, device='cuda:0')
old_score: tensor(0.0779, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0728, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.503878116607666
Validation after dual ascent:
out_inf: tensor(8.2891, device='cuda:0', dtype=torch.float16) tensor(0.3269, device='cuda:0', dtype=torch.float16)
tensor(0.5371, device='cuda:0', dtype=torch.float16) tensor(0.0722, device='cuda:0', dtype=torch.float16)
tensor(0.5898, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.5718, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.5459, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
11 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2266, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.1810, device='cuda:0', dtype=torch.float16) tensor(0.0189, device='cuda:0', dtype=torch.float16)
tensor(0.1960, device='cuda:0', dtype=torch.float16) tensor(0.0215, device='cuda:0', dtype=torch.float16)
tensor(0.2593, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(0.2153, device='cuda:0', dtype=torch.float16) tensor(0.0194, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0064, device='cuda:0')
tensor(0.0382, device='cuda:0')
old_score: tensor(0.0208, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0192, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7593796253204346
Validation after dual ascent:
out_inf: tensor(5.2266, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.1741, device='cuda:0', dtype=torch.float16) tensor(0.0175, device='cuda:0', dtype=torch.float16)
tensor(0.2021, device='cuda:0', dtype=torch.float16) tensor(0.0197, device='cuda:0', dtype=torch.float16)
tensor(0.2588, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
tensor(0.1899, device='cuda:0', dtype=torch.float16) tensor(0.0179, device='cuda:0', dtype=torch.float16)
11 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.2578, device='cuda:0', dtype=torch.float16) tensor(0.3491, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0618, device='cuda:0', dtype=torch.float16)
tensor(0.4966, device='cuda:0', dtype=torch.float16) tensor(0.0611, device='cuda:0', dtype=torch.float16)
tensor(0.5068, device='cuda:0', dtype=torch.float16) tensor(0.0622, device='cuda:0', dtype=torch.float16)
tensor(0.5469, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0041, device='cuda:0')
tensor(0.0415, device='cuda:0')
old_score: tensor(0.0623, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0582, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.218914270401001
Validation after dual ascent:
out_inf: tensor(6.2578, device='cuda:0', dtype=torch.float16) tensor(0.3491, device='cuda:0', dtype=torch.float16)
tensor(0.5430, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.4390, device='cuda:0', dtype=torch.float16) tensor(0.0565, device='cuda:0', dtype=torch.float16)
tensor(0.4585, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
11 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2305, device='cuda:0', dtype=torch.float16) tensor(0.2426, device='cuda:0', dtype=torch.float16)
tensor(0.4922, device='cuda:0', dtype=torch.float16) tensor(0.0596, device='cuda:0', dtype=torch.float16)
tensor(0.4561, device='cuda:0', dtype=torch.float16) tensor(0.0589, device='cuda:0', dtype=torch.float16)
tensor(0.4492, device='cuda:0', dtype=torch.float16) tensor(0.0600, device='cuda:0', dtype=torch.float16)
tensor(0.5000, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0030, device='cuda:0')
tensor(0.0402, device='cuda:0')
old_score: tensor(0.0602, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0562, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2223193645477295
Validation after dual ascent:
out_inf: tensor(4.2305, device='cuda:0', dtype=torch.float16) tensor(0.2426, device='cuda:0', dtype=torch.float16)
tensor(0.4443, device='cuda:0', dtype=torch.float16) tensor(0.0559, device='cuda:0', dtype=torch.float16)
tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0546, device='cuda:0', dtype=torch.float16)
tensor(0.4304, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
tensor(0.5195, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
11 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.2578, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(0.2046, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
tensor(0.1995, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
tensor(0.1871, device='cuda:0', dtype=torch.float16) tensor(0.0242, device='cuda:0', dtype=torch.float16)
tensor(0.2075, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
Converged at iteration 50
tensor(0.0198, device='cuda:0')
tensor(0.3034, device='cuda:0')
old_score: tensor(0.0250, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0240, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.59104061126709
Validation after dual ascent:
out_inf: tensor(3.2578, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(0.1969, device='cuda:0', dtype=torch.float16) tensor(0.0239, device='cuda:0', dtype=torch.float16)
tensor(0.1925, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(0.1825, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(0.2024, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
layer 11 done
12 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.7656, device='cuda:0', dtype=torch.float16) tensor(0.7852, device='cuda:0', dtype=torch.float16)
tensor(0.9048, device='cuda:0', dtype=torch.float16) tensor(0.1181, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.1194, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.1199, device='cuda:0', dtype=torch.float16)
tensor(0.9902, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0159, device='cuda:0')
tensor(0.2007, device='cuda:0')
old_score: tensor(0.1200, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1121, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5004007816314697
Validation after dual ascent:
out_inf: tensor(17.7656, device='cuda:0', dtype=torch.float16) tensor(0.7852, device='cuda:0', dtype=torch.float16)
tensor(0.9194, device='cuda:0', dtype=torch.float16) tensor(0.1107, device='cuda:0', dtype=torch.float16)
tensor(0.9736, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(0.8394, device='cuda:0', dtype=torch.float16) tensor(0.1109, device='cuda:0', dtype=torch.float16)
tensor(0.9634, device='cuda:0', dtype=torch.float16) tensor(0.1160, device='cuda:0', dtype=torch.float16)
12 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.6328, device='cuda:0', dtype=torch.float16) tensor(1.0449, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.1195, device='cuda:0', dtype=torch.float16)
tensor(0.9648, device='cuda:0', dtype=torch.float16) tensor(0.1206, device='cuda:0', dtype=torch.float16)
tensor(0.9521, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(0.8789, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0171, device='cuda:0')
tensor(0.2071, device='cuda:0')
old_score: tensor(0.1213, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1131, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.499978542327881
Validation after dual ascent:
out_inf: tensor(15.6328, device='cuda:0', dtype=torch.float16) tensor(1.0449, device='cuda:0', dtype=torch.float16)
tensor(0.8599, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(0.9121, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(0.8789, device='cuda:0', dtype=torch.float16) tensor(0.1120, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
12 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.2578, device='cuda:0', dtype=torch.float16) tensor(0.3225, device='cuda:0', dtype=torch.float16)
tensor(0.5654, device='cuda:0', dtype=torch.float16) tensor(0.0773, device='cuda:0', dtype=torch.float16)
tensor(0.5752, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.5376, device='cuda:0', dtype=torch.float16) tensor(0.0780, device='cuda:0', dtype=torch.float16)
tensor(0.5840, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0078, device='cuda:0')
tensor(0.1238, device='cuda:0')
old_score: tensor(0.0782, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0732, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4937379360198975
Validation after dual ascent:
out_inf: tensor(6.2578, device='cuda:0', dtype=torch.float16) tensor(0.3225, device='cuda:0', dtype=torch.float16)
tensor(0.5908, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
tensor(0.5801, device='cuda:0', dtype=torch.float16) tensor(0.0722, device='cuda:0', dtype=torch.float16)
tensor(0.5293, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(0.5630, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
12 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5625, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(0.2107, device='cuda:0', dtype=torch.float16) tensor(0.0213, device='cuda:0', dtype=torch.float16)
tensor(0.2048, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(0.2244, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
tensor(0.2146, device='cuda:0', dtype=torch.float16) tensor(0.0218, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0159, device='cuda:0')
tensor(0.0452, device='cuda:0')
old_score: tensor(0.0227, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0209, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.751990556716919
Validation after dual ascent:
out_inf: tensor(4.5625, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(0.1985, device='cuda:0', dtype=torch.float16) tensor(0.0196, device='cuda:0', dtype=torch.float16)
tensor(0.1979, device='cuda:0', dtype=torch.float16) tensor(0.0210, device='cuda:0', dtype=torch.float16)
tensor(0.2087, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.1979, device='cuda:0', dtype=torch.float16) tensor(0.0202, device='cuda:0', dtype=torch.float16)
12 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.6836, device='cuda:0', dtype=torch.float16) tensor(0.3547, device='cuda:0', dtype=torch.float16)
tensor(0.5293, device='cuda:0', dtype=torch.float16) tensor(0.0641, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.5625, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0041, device='cuda:0')
tensor(0.0463, device='cuda:0')
old_score: tensor(0.0647, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0605, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.172680854797363
Validation after dual ascent:
out_inf: tensor(6.6836, device='cuda:0', dtype=torch.float16) tensor(0.3547, device='cuda:0', dtype=torch.float16)
tensor(0.4922, device='cuda:0', dtype=torch.float16) tensor(0.0600, device='cuda:0', dtype=torch.float16)
tensor(0.5176, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
tensor(0.4746, device='cuda:0', dtype=torch.float16) tensor(0.0597, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0631, device='cuda:0', dtype=torch.float16)
12 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9453, device='cuda:0', dtype=torch.float16) tensor(0.2542, device='cuda:0', dtype=torch.float16)
tensor(0.4941, device='cuda:0', dtype=torch.float16) tensor(0.0627, device='cuda:0', dtype=torch.float16)
tensor(0.5371, device='cuda:0', dtype=torch.float16) tensor(0.0622, device='cuda:0', dtype=torch.float16)
tensor(0.4814, device='cuda:0', dtype=torch.float16) tensor(0.0630, device='cuda:0', dtype=torch.float16)
tensor(0.5693, device='cuda:0', dtype=torch.float16) tensor(0.0652, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0033, device='cuda:0')
tensor(0.0455, device='cuda:0')
old_score: tensor(0.0632, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0592, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.179545640945435
Validation after dual ascent:
out_inf: tensor(4.9453, device='cuda:0', dtype=torch.float16) tensor(0.2542, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
tensor(0.4631, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.4473, device='cuda:0', dtype=torch.float16) tensor(0.0584, device='cuda:0', dtype=torch.float16)
tensor(0.4883, device='cuda:0', dtype=torch.float16) tensor(0.0618, device='cuda:0', dtype=torch.float16)
12 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.5293, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(0.2252, device='cuda:0', dtype=torch.float16) tensor(0.0270, device='cuda:0', dtype=torch.float16)
tensor(0.2207, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.2578, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
tensor(0.2505, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0018, device='cuda:0')
tensor(0.0287, device='cuda:0')
old_score: tensor(0.0270, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0260, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.408715009689331
Validation after dual ascent:
out_inf: tensor(3.5293, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(0.2063, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
tensor(0.2115, device='cuda:0', dtype=torch.float16) tensor(0.0253, device='cuda:0', dtype=torch.float16)
tensor(0.2384, device='cuda:0', dtype=torch.float16) tensor(0.0250, device='cuda:0', dtype=torch.float16)
tensor(0.2478, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
layer 12 done
13 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.2891, device='cuda:0', dtype=torch.float16) tensor(0.7974, device='cuda:0', dtype=torch.float16)
tensor(0.9331, device='cuda:0', dtype=torch.float16) tensor(0.1205, device='cuda:0', dtype=torch.float16)
tensor(0.9971, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(0.9678, device='cuda:0', dtype=torch.float16) tensor(0.1219, device='cuda:0', dtype=torch.float16)
tensor(1.0186, device='cuda:0', dtype=torch.float16) tensor(0.1256, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0115, device='cuda:0')
tensor(0.2108, device='cuda:0')
old_score: tensor(0.1224, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1145, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.512122869491577
Validation after dual ascent:
out_inf: tensor(14.2891, device='cuda:0', dtype=torch.float16) tensor(0.7974, device='cuda:0', dtype=torch.float16)
tensor(0.8696, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(0.9644, device='cuda:0', dtype=torch.float16) tensor(0.1129, device='cuda:0', dtype=torch.float16)
tensor(0.8774, device='cuda:0', dtype=torch.float16) tensor(0.1129, device='cuda:0', dtype=torch.float16)
tensor(0.9277, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
13 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.8906, device='cuda:0', dtype=torch.float16) tensor(1.0078, device='cuda:0', dtype=torch.float16)
tensor(0.9697, device='cuda:0', dtype=torch.float16) tensor(0.1210, device='cuda:0', dtype=torch.float16)
tensor(0.9014, device='cuda:0', dtype=torch.float16) tensor(0.1219, device='cuda:0', dtype=torch.float16)
tensor(0.9570, device='cuda:0', dtype=torch.float16) tensor(0.1222, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.1260, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0126, device='cuda:0')
tensor(0.2134, device='cuda:0')
old_score: tensor(0.1228, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1147, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5108301639556885
Validation after dual ascent:
out_inf: tensor(18.8906, device='cuda:0', dtype=torch.float16) tensor(1.0078, device='cuda:0', dtype=torch.float16)
tensor(0.8896, device='cuda:0', dtype=torch.float16) tensor(0.1134, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(0.8555, device='cuda:0', dtype=torch.float16) tensor(0.1131, device='cuda:0', dtype=torch.float16)
tensor(0.9233, device='cuda:0', dtype=torch.float16) tensor(0.1193, device='cuda:0', dtype=torch.float16)
13 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2031, device='cuda:0', dtype=torch.float16) tensor(0.3276, device='cuda:0', dtype=torch.float16)
tensor(0.5913, device='cuda:0', dtype=torch.float16) tensor(0.0822, device='cuda:0', dtype=torch.float16)
tensor(0.5947, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
tensor(0.5957, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.6235, device='cuda:0', dtype=torch.float16) tensor(0.0855, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0066, device='cuda:0')
tensor(0.1362, device='cuda:0')
old_score: tensor(0.0831, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0780, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.501361131668091
Validation after dual ascent:
out_inf: tensor(5.2031, device='cuda:0', dtype=torch.float16) tensor(0.3276, device='cuda:0', dtype=torch.float16)
tensor(0.5903, device='cuda:0', dtype=torch.float16) tensor(0.0773, device='cuda:0', dtype=torch.float16)
tensor(0.5518, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
tensor(0.5439, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
tensor(0.6226, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
13 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8008, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
tensor(0.2183, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.2087, device='cuda:0', dtype=torch.float16) tensor(0.0232, device='cuda:0', dtype=torch.float16)
tensor(0.2148, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.2417, device='cuda:0', dtype=torch.float16) tensor(0.0233, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0183, device='cuda:0')
tensor(0.0161, device='cuda:0')
old_score: tensor(0.0233, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0213, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.240165948867798
Validation after dual ascent:
out_inf: tensor(4.8008, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
tensor(0.2244, device='cuda:0', dtype=torch.float16) tensor(0.0203, device='cuda:0', dtype=torch.float16)
tensor(0.2068, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
tensor(0.1945, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.2313, device='cuda:0', dtype=torch.float16) tensor(0.0215, device='cuda:0', dtype=torch.float16)
13 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.4258, device='cuda:0', dtype=torch.float16) tensor(0.3718, device='cuda:0', dtype=torch.float16)
tensor(0.5840, device='cuda:0', dtype=torch.float16) tensor(0.0657, device='cuda:0', dtype=torch.float16)
tensor(0.5449, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(0.5879, device='cuda:0', dtype=torch.float16) tensor(0.0686, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0044, device='cuda:0')
tensor(0.0514, device='cuda:0')
old_score: tensor(0.0664, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0620, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.182518720626831
Validation after dual ascent:
out_inf: tensor(7.4258, device='cuda:0', dtype=torch.float16) tensor(0.3718, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0614, device='cuda:0', dtype=torch.float16)
tensor(0.5391, device='cuda:0', dtype=torch.float16) tensor(0.0604, device='cuda:0', dtype=torch.float16)
tensor(0.4902, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(0.5337, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
13 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6836, device='cuda:0', dtype=torch.float16) tensor(0.2703, device='cuda:0', dtype=torch.float16)
tensor(0.5186, device='cuda:0', dtype=torch.float16) tensor(0.0652, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.4800, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(0.5391, device='cuda:0', dtype=torch.float16) tensor(0.0680, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0037, device='cuda:0')
tensor(0.0511, device='cuda:0')
old_score: tensor(0.0658, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0615, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.178747892379761
Validation after dual ascent:
out_inf: tensor(4.6836, device='cuda:0', dtype=torch.float16) tensor(0.2703, device='cuda:0', dtype=torch.float16)
tensor(0.5166, device='cuda:0', dtype=torch.float16) tensor(0.0610, device='cuda:0', dtype=torch.float16)
tensor(0.4814, device='cuda:0', dtype=torch.float16) tensor(0.0599, device='cuda:0', dtype=torch.float16)
tensor(0.4763, device='cuda:0', dtype=torch.float16) tensor(0.0607, device='cuda:0', dtype=torch.float16)
tensor(0.4897, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
13 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0859, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
tensor(0.2671, device='cuda:0', dtype=torch.float16) tensor(0.0304, device='cuda:0', dtype=torch.float16)
tensor(0.2515, device='cuda:0', dtype=torch.float16) tensor(0.0295, device='cuda:0', dtype=torch.float16)
tensor(0.2316, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.2734, device='cuda:0', dtype=torch.float16) tensor(0.0323, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0022, device='cuda:0')
tensor(0.0356, device='cuda:0')
old_score: tensor(0.0302, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0289, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.403266191482544
Validation after dual ascent:
out_inf: tensor(5.0859, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
tensor(0.2754, device='cuda:0', dtype=torch.float16) tensor(0.0293, device='cuda:0', dtype=torch.float16)
tensor(0.2500, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
tensor(0.2126, device='cuda:0', dtype=torch.float16) tensor(0.0271, device='cuda:0', dtype=torch.float16)
tensor(0.2607, device='cuda:0', dtype=torch.float16) tensor(0.0312, device='cuda:0', dtype=torch.float16)
layer 13 done
14 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.8125, device='cuda:0', dtype=torch.float16) tensor(0.8008, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.1223, device='cuda:0', dtype=torch.float16)
tensor(1.6953, device='cuda:0', dtype=torch.float16) tensor(0.1227, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1232, device='cuda:0', dtype=torch.float16)
tensor(0.9893, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0134, device='cuda:0')
tensor(0.2288, device='cuda:0')
old_score: tensor(0.1240, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1157, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.503068685531616
Validation after dual ascent:
out_inf: tensor(13.8125, device='cuda:0', dtype=torch.float16) tensor(0.8008, device='cuda:0', dtype=torch.float16)
tensor(1.0508, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
tensor(1.4980, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.1140, device='cuda:0', dtype=torch.float16)
tensor(0.9194, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
14 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19., device='cuda:0', dtype=torch.float16) tensor(1.0801, device='cuda:0', dtype=torch.float16)
tensor(0.9136, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.0762, device='cuda:0', dtype=torch.float16) tensor(0.1232, device='cuda:0', dtype=torch.float16)
tensor(0.9512, device='cuda:0', dtype=torch.float16) tensor(0.1237, device='cuda:0', dtype=torch.float16)
tensor(1.1211, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0155, device='cuda:0')
tensor(0.2302, device='cuda:0')
old_score: tensor(0.1245, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1160, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.50879168510437
Validation after dual ascent:
out_inf: tensor(19., device='cuda:0', dtype=torch.float16) tensor(1.0801, device='cuda:0', dtype=torch.float16)
tensor(0.8506, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(0.8955, device='cuda:0', dtype=torch.float16) tensor(0.1142, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
14 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.3250, device='cuda:0', dtype=torch.float16)
tensor(0.5967, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
tensor(0.5586, device='cuda:0', dtype=torch.float16) tensor(0.0819, device='cuda:0', dtype=torch.float16)
tensor(0.5645, device='cuda:0', dtype=torch.float16) tensor(0.0824, device='cuda:0', dtype=torch.float16)
tensor(0.6851, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0070, device='cuda:0')
tensor(0.1448, device='cuda:0')
old_score: tensor(0.0831, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0778, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.498835802078247
Validation after dual ascent:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.3250, device='cuda:0', dtype=torch.float16)
tensor(0.6128, device='cuda:0', dtype=torch.float16) tensor(0.0773, device='cuda:0', dtype=torch.float16)
tensor(0.6011, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
tensor(0.5513, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(0.6182, device='cuda:0', dtype=torch.float16) tensor(0.0816, device='cuda:0', dtype=torch.float16)
14 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1406, device='cuda:0', dtype=torch.float16) tensor(0.0915, device='cuda:0', dtype=torch.float16)
tensor(0.2280, device='cuda:0', dtype=torch.float16) tensor(0.0256, device='cuda:0', dtype=torch.float16)
tensor(0.2524, device='cuda:0', dtype=torch.float16) tensor(0.0251, device='cuda:0', dtype=torch.float16)
tensor(0.2874, device='cuda:0', dtype=torch.float16) tensor(0.0270, device='cuda:0', dtype=torch.float16)
tensor(0.2573, device='cuda:0', dtype=torch.float16) tensor(0.0260, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0046, device='cuda:0')
tensor(0.0573, device='cuda:0')
old_score: tensor(0.0259, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0238, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7500696182250977
Validation after dual ascent:
out_inf: tensor(7.1406, device='cuda:0', dtype=torch.float16) tensor(0.0915, device='cuda:0', dtype=torch.float16)
tensor(0.2026, device='cuda:0', dtype=torch.float16) tensor(0.0234, device='cuda:0', dtype=torch.float16)
tensor(0.2286, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(0.2803, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
tensor(0.2461, device='cuda:0', dtype=torch.float16) tensor(0.0242, device='cuda:0', dtype=torch.float16)
14 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.9453, device='cuda:0', dtype=torch.float16) tensor(0.3801, device='cuda:0', dtype=torch.float16)
tensor(0.6758, device='cuda:0', dtype=torch.float16) tensor(0.0694, device='cuda:0', dtype=torch.float16)
tensor(0.5869, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0696, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0047, device='cuda:0')
tensor(0.0593, device='cuda:0')
old_score: tensor(0.0699, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0654, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.174022674560547
Validation after dual ascent:
out_inf: tensor(6.9453, device='cuda:0', dtype=torch.float16) tensor(0.3801, device='cuda:0', dtype=torch.float16)
tensor(0.5820, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
tensor(0.5107, device='cuda:0', dtype=torch.float16) tensor(0.0631, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0647, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0690, device='cuda:0', dtype=torch.float16)
14 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3555, device='cuda:0', dtype=torch.float16) tensor(0.2832, device='cuda:0', dtype=torch.float16)
tensor(0.5137, device='cuda:0', dtype=torch.float16) tensor(0.0689, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0673, device='cuda:0', dtype=torch.float16)
tensor(0.5161, device='cuda:0', dtype=torch.float16) tensor(0.0690, device='cuda:0', dtype=torch.float16)
tensor(0.6445, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0041, device='cuda:0')
tensor(0.0589, device='cuda:0')
old_score: tensor(0.0694, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0650, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.182429552078247
Validation after dual ascent:
out_inf: tensor(4.3555, device='cuda:0', dtype=torch.float16) tensor(0.2832, device='cuda:0', dtype=torch.float16)
tensor(0.4949, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
tensor(0.5781, device='cuda:0', dtype=torch.float16) tensor(0.0627, device='cuda:0', dtype=torch.float16)
tensor(0.4775, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(0.6089, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
14 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.6660, device='cuda:0', dtype=torch.float16) tensor(0.1160, device='cuda:0', dtype=torch.float16)
tensor(0.2773, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(0.2698, device='cuda:0', dtype=torch.float16) tensor(0.0313, device='cuda:0', dtype=torch.float16)
tensor(0.2563, device='cuda:0', dtype=torch.float16) tensor(0.0304, device='cuda:0', dtype=torch.float16)
tensor(0.2920, device='cuda:0', dtype=torch.float16) tensor(0.0352, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0025, device='cuda:0')
tensor(0.0418, device='cuda:0')
old_score: tensor(0.0326, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0313, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.417571067810059
Validation after dual ascent:
out_inf: tensor(2.6660, device='cuda:0', dtype=torch.float16) tensor(0.1160, device='cuda:0', dtype=torch.float16)
tensor(0.2661, device='cuda:0', dtype=torch.float16) tensor(0.0321, device='cuda:0', dtype=torch.float16)
tensor(0.2537, device='cuda:0', dtype=torch.float16) tensor(0.0299, device='cuda:0', dtype=torch.float16)
tensor(0.2410, device='cuda:0', dtype=torch.float16) tensor(0.0292, device='cuda:0', dtype=torch.float16)
tensor(0.2737, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
layer 14 done
15 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.9141, device='cuda:0', dtype=torch.float16) tensor(0.7905, device='cuda:0', dtype=torch.float16)
tensor(0.8677, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1193, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
tensor(1.2061, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0110, device='cuda:0')
tensor(0.2087, device='cuda:0')
old_score: tensor(0.1216, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1138, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5080606937408447
Validation after dual ascent:
out_inf: tensor(15.9141, device='cuda:0', dtype=torch.float16) tensor(0.7905, device='cuda:0', dtype=torch.float16)
tensor(0.9062, device='cuda:0', dtype=torch.float16) tensor(0.1127, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(1.0078, device='cuda:0', dtype=torch.float16) tensor(0.1120, device='cuda:0', dtype=torch.float16)
tensor(1.1885, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
15 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.1875, device='cuda:0', dtype=torch.float16) tensor(1.0459, device='cuda:0', dtype=torch.float16)
tensor(0.8989, device='cuda:0', dtype=torch.float16) tensor(0.1222, device='cuda:0', dtype=torch.float16)
tensor(0.9497, device='cuda:0', dtype=torch.float16) tensor(0.1214, device='cuda:0', dtype=torch.float16)
tensor(0.9634, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(1.4189, device='cuda:0', dtype=torch.float16) tensor(0.1283, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0117, device='cuda:0')
tensor(0.2158, device='cuda:0')
old_score: tensor(0.1237, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1154, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.510915517807007
Validation after dual ascent:
out_inf: tensor(16.1875, device='cuda:0', dtype=torch.float16) tensor(1.0459, device='cuda:0', dtype=torch.float16)
tensor(0.8667, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
tensor(0.9009, device='cuda:0', dtype=torch.float16) tensor(0.1123, device='cuda:0', dtype=torch.float16)
tensor(0.8276, device='cuda:0', dtype=torch.float16) tensor(0.1134, device='cuda:0', dtype=torch.float16)
tensor(1.4033, device='cuda:0', dtype=torch.float16) tensor(0.1216, device='cuda:0', dtype=torch.float16)
15 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0078, device='cuda:0', dtype=torch.float16) tensor(0.3374, device='cuda:0', dtype=torch.float16)
tensor(0.6177, device='cuda:0', dtype=torch.float16) tensor(0.0846, device='cuda:0', dtype=torch.float16)
tensor(0.6431, device='cuda:0', dtype=torch.float16) tensor(0.0834, device='cuda:0', dtype=torch.float16)
tensor(0.6777, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
tensor(0.6270, device='cuda:0', dtype=torch.float16) tensor(0.0886, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0067, device='cuda:0')
tensor(0.1421, device='cuda:0')
old_score: tensor(0.0853, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0800, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4968574047088623
Validation after dual ascent:
out_inf: tensor(5.0078, device='cuda:0', dtype=torch.float16) tensor(0.3374, device='cuda:0', dtype=torch.float16)
tensor(0.5879, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.6001, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.6553, device='cuda:0', dtype=torch.float16) tensor(0.0784, device='cuda:0', dtype=torch.float16)
tensor(0.6416, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
15 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.8789, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
tensor(0.2262, device='cuda:0', dtype=torch.float16) tensor(0.0259, device='cuda:0', dtype=torch.float16)
tensor(0.2311, device='cuda:0', dtype=torch.float16) tensor(0.0274, device='cuda:0', dtype=torch.float16)
tensor(0.2263, device='cuda:0', dtype=torch.float16) tensor(0.0270, device='cuda:0', dtype=torch.float16)
tensor(0.2773, device='cuda:0', dtype=torch.float16) tensor(0.0271, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0059, device='cuda:0')
tensor(0.0708, device='cuda:0')
old_score: tensor(0.0269, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0247, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7651941776275635
Validation after dual ascent:
out_inf: tensor(5.8789, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
tensor(0.2144, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
tensor(0.2286, device='cuda:0', dtype=torch.float16) tensor(0.0251, device='cuda:0', dtype=torch.float16)
tensor(0.2125, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
tensor(0.2476, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
15 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.6562, device='cuda:0', dtype=torch.float16) tensor(0.3955, device='cuda:0', dtype=torch.float16)
tensor(0.5957, device='cuda:0', dtype=torch.float16) tensor(0.0716, device='cuda:0', dtype=torch.float16)
tensor(0.5957, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
tensor(0.6016, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.6562, device='cuda:0', dtype=torch.float16) tensor(0.0753, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0052, device='cuda:0')
tensor(0.0666, device='cuda:0')
old_score: tensor(0.0719, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0673, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.17754054069519
Validation after dual ascent:
out_inf: tensor(9.6562, device='cuda:0', dtype=torch.float16) tensor(0.3955, device='cuda:0', dtype=torch.float16)
tensor(0.6152, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.5762, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(0.5977, device='cuda:0', dtype=torch.float16) tensor(0.0661, device='cuda:0', dtype=torch.float16)
tensor(0.6484, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
15 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9258, device='cuda:0', dtype=torch.float16) tensor(0.2976, device='cuda:0', dtype=torch.float16)
tensor(0.6094, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0690, device='cuda:0', dtype=torch.float16)
tensor(0.5898, device='cuda:0', dtype=torch.float16) tensor(0.0708, device='cuda:0', dtype=torch.float16)
tensor(0.5557, device='cuda:0', dtype=torch.float16) tensor(0.0748, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0046, device='cuda:0')
tensor(0.0660, device='cuda:0')
old_score: tensor(0.0714, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0669, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.179363489151001
Validation after dual ascent:
out_inf: tensor(4.9258, device='cuda:0', dtype=torch.float16) tensor(0.2976, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(0.5054, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.5586, device='cuda:0', dtype=torch.float16) tensor(0.0657, device='cuda:0', dtype=torch.float16)
tensor(0.5586, device='cuda:0', dtype=torch.float16) tensor(0.0710, device='cuda:0', dtype=torch.float16)
15 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.6016, device='cuda:0', dtype=torch.float16) tensor(0.1287, device='cuda:0', dtype=torch.float16)
tensor(0.3066, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
tensor(0.2676, device='cuda:0', dtype=torch.float16) tensor(0.0339, device='cuda:0', dtype=torch.float16)
tensor(0.2874, device='cuda:0', dtype=torch.float16) tensor(0.0330, device='cuda:0', dtype=torch.float16)
tensor(0.3477, device='cuda:0', dtype=torch.float16) tensor(0.0386, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0031, device='cuda:0')
tensor(0.0514, device='cuda:0')
old_score: tensor(0.0354, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0340, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.411253690719604
Validation after dual ascent:
out_inf: tensor(6.6016, device='cuda:0', dtype=torch.float16) tensor(0.1287, device='cuda:0', dtype=torch.float16)
tensor(0.2905, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.2524, device='cuda:0', dtype=torch.float16) tensor(0.0323, device='cuda:0', dtype=torch.float16)
tensor(0.2739, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
tensor(0.3364, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
layer 15 done
16 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.6562, device='cuda:0', dtype=torch.float16) tensor(0.7935, device='cuda:0', dtype=torch.float16)
tensor(1.6211, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
tensor(1.6494, device='cuda:0', dtype=torch.float16) tensor(0.1182, device='cuda:0', dtype=torch.float16)
tensor(0.9634, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0114, device='cuda:0')
tensor(0.2208, device='cuda:0')
old_score: tensor(0.1212, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1132, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5044171810150146
Validation after dual ascent:
out_inf: tensor(17.6562, device='cuda:0', dtype=torch.float16) tensor(0.7935, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1124, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(0.9648, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
16 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.7500, device='cuda:0', dtype=torch.float16) tensor(1.0703, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.1213, device='cuda:0', dtype=torch.float16)
tensor(1.5352, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(0.9854, device='cuda:0', dtype=torch.float16) tensor(0.1210, device='cuda:0', dtype=torch.float16)
tensor(1.2334, device='cuda:0', dtype=torch.float16) tensor(0.1273, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0123, device='cuda:0')
tensor(0.2268, device='cuda:0')
old_score: tensor(0.1222, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1138, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5045809745788574
Validation after dual ascent:
out_inf: tensor(16.7500, device='cuda:0', dtype=torch.float16) tensor(1.0703, device='cuda:0', dtype=torch.float16)
tensor(0.9653, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.3320, device='cuda:0', dtype=torch.float16) tensor(0.1098, device='cuda:0', dtype=torch.float16)
tensor(0.8906, device='cuda:0', dtype=torch.float16) tensor(0.1117, device='cuda:0', dtype=torch.float16)
tensor(1.1035, device='cuda:0', dtype=torch.float16) tensor(0.1205, device='cuda:0', dtype=torch.float16)
16 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0195, device='cuda:0', dtype=torch.float16) tensor(0.3428, device='cuda:0', dtype=torch.float16)
tensor(0.6558, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(0.7188, device='cuda:0', dtype=torch.float16) tensor(0.0870, device='cuda:0', dtype=torch.float16)
tensor(0.6650, device='cuda:0', dtype=torch.float16) tensor(0.0888, device='cuda:0', dtype=torch.float16)
tensor(0.7041, device='cuda:0', dtype=torch.float16) tensor(0.0940, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0074, device='cuda:0')
tensor(0.1569, device='cuda:0')
old_score: tensor(0.0898, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0841, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.499502182006836
Validation after dual ascent:
out_inf: tensor(5.0195, device='cuda:0', dtype=torch.float16) tensor(0.3428, device='cuda:0', dtype=torch.float16)
tensor(0.6670, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(0.7007, device='cuda:0', dtype=torch.float16) tensor(0.0807, device='cuda:0', dtype=torch.float16)
tensor(0.6172, device='cuda:0', dtype=torch.float16) tensor(0.0824, device='cuda:0', dtype=torch.float16)
tensor(0.7085, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
16 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.3789, device='cuda:0', dtype=torch.float16) tensor(0.1246, device='cuda:0', dtype=torch.float16)
tensor(0.3250, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
tensor(0.2861, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
tensor(0.3228, device='cuda:0', dtype=torch.float16) tensor(0.0325, device='cuda:0', dtype=torch.float16)
tensor(0.3430, device='cuda:0', dtype=torch.float16) tensor(0.0324, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0058, device='cuda:0')
tensor(0.0819, device='cuda:0')
old_score: tensor(0.0320, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0296, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7529041767120361
Validation after dual ascent:
out_inf: tensor(6.3789, device='cuda:0', dtype=torch.float16) tensor(0.1246, device='cuda:0', dtype=torch.float16)
tensor(0.3010, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.2720, device='cuda:0', dtype=torch.float16) tensor(0.0289, device='cuda:0', dtype=torch.float16)
tensor(0.2830, device='cuda:0', dtype=torch.float16) tensor(0.0299, device='cuda:0', dtype=torch.float16)
tensor(0.3240, device='cuda:0', dtype=torch.float16) tensor(0.0304, device='cuda:0', dtype=torch.float16)
16 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.4229, device='cuda:0', dtype=torch.float16)
tensor(0.8359, device='cuda:0', dtype=torch.float16) tensor(0.0761, device='cuda:0', dtype=torch.float16)
tensor(0.6914, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.6562, device='cuda:0', dtype=torch.float16) tensor(0.0755, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0060, device='cuda:0')
tensor(0.0789, device='cuda:0')
old_score: tensor(0.0762, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0707, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.177634239196777
Validation after dual ascent:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.4229, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.6836, device='cuda:0', dtype=torch.float16) tensor(0.0672, device='cuda:0', dtype=torch.float16)
tensor(0.6172, device='cuda:0', dtype=torch.float16) tensor(0.0696, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0755, device='cuda:0', dtype=torch.float16)
16 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2852, device='cuda:0', dtype=torch.float16) tensor(0.3167, device='cuda:0', dtype=torch.float16)
tensor(0.5840, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
tensor(0.5444, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.5703, device='cuda:0', dtype=torch.float16) tensor(0.0744, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0053, device='cuda:0')
tensor(0.0769, device='cuda:0')
old_score: tensor(0.0750, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0697, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.180752515792847
Validation after dual ascent:
out_inf: tensor(5.2852, device='cuda:0', dtype=torch.float16) tensor(0.3167, device='cuda:0', dtype=torch.float16)
tensor(0.5835, device='cuda:0', dtype=torch.float16) tensor(0.0696, device='cuda:0', dtype=torch.float16)
tensor(0.5337, device='cuda:0', dtype=torch.float16) tensor(0.0662, device='cuda:0', dtype=torch.float16)
tensor(0.5020, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
tensor(0.5957, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
16 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.3203, device='cuda:0', dtype=torch.float16) tensor(0.1497, device='cuda:0', dtype=torch.float16)
tensor(0.4478, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.3291, device='cuda:0', dtype=torch.float16) tensor(0.0378, device='cuda:0', dtype=torch.float16)
tensor(0.2959, device='cuda:0', dtype=torch.float16) tensor(0.0373, device='cuda:0', dtype=torch.float16)
tensor(0.3984, device='cuda:0', dtype=torch.float16) tensor(0.0437, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0042, device='cuda:0')
tensor(0.0680, device='cuda:0')
old_score: tensor(0.0400, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0384, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.39148998260498
Validation after dual ascent:
out_inf: tensor(6.3203, device='cuda:0', dtype=torch.float16) tensor(0.1497, device='cuda:0', dtype=torch.float16)
tensor(0.4248, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.3330, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.3054, device='cuda:0', dtype=torch.float16) tensor(0.0355, device='cuda:0', dtype=torch.float16)
tensor(0.3794, device='cuda:0', dtype=torch.float16) tensor(0.0423, device='cuda:0', dtype=torch.float16)
layer 16 done
17 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.7031, device='cuda:0', dtype=torch.float16) tensor(0.8003, device='cuda:0', dtype=torch.float16)
tensor(1.3066, device='cuda:0', dtype=torch.float16) tensor(0.1222, device='cuda:0', dtype=torch.float16)
tensor(1.3965, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.2881, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
tensor(0.1414, device='cuda:0')
old_score: tensor(0.1226, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1137, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.121643781661987
Validation after dual ascent:
out_inf: tensor(16.7031, device='cuda:0', dtype=torch.float16) tensor(0.8003, device='cuda:0', dtype=torch.float16)
tensor(1.1768, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.1080, device='cuda:0', dtype=torch.float16)
tensor(0.9805, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(1.1914, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
17 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.1875, device='cuda:0', dtype=torch.float16) tensor(1.0254, device='cuda:0', dtype=torch.float16)
tensor(1.0342, device='cuda:0', dtype=torch.float16) tensor(0.1233, device='cuda:0', dtype=torch.float16)
tensor(0.9551, device='cuda:0', dtype=torch.float16) tensor(0.1186, device='cuda:0', dtype=torch.float16)
tensor(1.1680, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
tensor(1.0430, device='cuda:0', dtype=torch.float16) tensor(0.1301, device='cuda:0', dtype=torch.float16)
tensor(0.1573, device='cuda:0')
old_score: tensor(0.1235, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1144, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.155468225479126
Validation after dual ascent:
out_inf: tensor(17.1875, device='cuda:0', dtype=torch.float16) tensor(1.0254, device='cuda:0', dtype=torch.float16)
tensor(0.9326, device='cuda:0', dtype=torch.float16) tensor(0.1145, device='cuda:0', dtype=torch.float16)
tensor(0.9590, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
tensor(0.9121, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(0.9790, device='cuda:0', dtype=torch.float16) tensor(0.1227, device='cuda:0', dtype=torch.float16)
17 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.3538, device='cuda:0', dtype=torch.float16)
tensor(0.7578, device='cuda:0', dtype=torch.float16) tensor(0.0904, device='cuda:0', dtype=torch.float16)
tensor(0.6880, device='cuda:0', dtype=torch.float16) tensor(0.0867, device='cuda:0', dtype=torch.float16)
tensor(0.6802, device='cuda:0', dtype=torch.float16) tensor(0.0891, device='cuda:0', dtype=torch.float16)
tensor(0.6929, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0175, device='cuda:0')
tensor(0.0804, device='cuda:0')
old_score: tensor(0.0904, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0840, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.913079261779785
Validation after dual ascent:
out_inf: tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.3538, device='cuda:0', dtype=torch.float16)
tensor(0.6909, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
tensor(0.6021, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0818, device='cuda:0', dtype=torch.float16)
tensor(0.6875, device='cuda:0', dtype=torch.float16) tensor(0.0904, device='cuda:0', dtype=torch.float16)
17 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.2617, device='cuda:0', dtype=torch.float16) tensor(0.1007, device='cuda:0', dtype=torch.float16)
tensor(0.2734, device='cuda:0', dtype=torch.float16) tensor(0.0274, device='cuda:0', dtype=torch.float16)
tensor(0.2922, device='cuda:0', dtype=torch.float16) tensor(0.0272, device='cuda:0', dtype=torch.float16)
tensor(0.2491, device='cuda:0', dtype=torch.float16) tensor(0.0289, device='cuda:0', dtype=torch.float16)
tensor(0.2917, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0053, device='cuda:0')
tensor(0.0651, device='cuda:0')
old_score: tensor(0.0280, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0257, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7485239505767822
Validation after dual ascent:
out_inf: tensor(6.2617, device='cuda:0', dtype=torch.float16) tensor(0.1007, device='cuda:0', dtype=torch.float16)
tensor(0.2422, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
tensor(0.2480, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.2522, device='cuda:0', dtype=torch.float16) tensor(0.0264, device='cuda:0', dtype=torch.float16)
tensor(0.2612, device='cuda:0', dtype=torch.float16) tensor(0.0269, device='cuda:0', dtype=torch.float16)
17 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.7422, device='cuda:0', dtype=torch.float16) tensor(0.4421, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0769, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0803, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0068, device='cuda:0')
tensor(0.0942, device='cuda:0')
old_score: tensor(0.0811, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0754, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.191853046417236
Validation after dual ascent:
out_inf: tensor(8.7422, device='cuda:0', dtype=torch.float16) tensor(0.4421, device='cuda:0', dtype=torch.float16)
tensor(0.7031, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(0.6445, device='cuda:0', dtype=torch.float16) tensor(0.0707, device='cuda:0', dtype=torch.float16)
tensor(0.6562, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
17 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.2578, device='cuda:0', dtype=torch.float16) tensor(0.3188, device='cuda:0', dtype=torch.float16)
tensor(0.7051, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(0.6660, device='cuda:0', dtype=torch.float16) tensor(0.0746, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(0.6699, device='cuda:0', dtype=torch.float16) tensor(0.0831, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0060, device='cuda:0')
tensor(0.0900, device='cuda:0')
old_score: tensor(0.0786, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0732, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.195587873458862
Validation after dual ascent:
out_inf: tensor(6.2578, device='cuda:0', dtype=torch.float16) tensor(0.3188, device='cuda:0', dtype=torch.float16)
tensor(0.6543, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
tensor(0.6406, device='cuda:0', dtype=torch.float16) tensor(0.0687, device='cuda:0', dtype=torch.float16)
tensor(0.5439, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.6611, device='cuda:0', dtype=torch.float16) tensor(0.0787, device='cuda:0', dtype=torch.float16)
17 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0508, device='cuda:0', dtype=torch.float16) tensor(0.1522, device='cuda:0', dtype=torch.float16)
tensor(0.4082, device='cuda:0', dtype=torch.float16) tensor(0.0429, device='cuda:0', dtype=torch.float16)
tensor(0.3506, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
tensor(0.3269, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
tensor(0.4341, device='cuda:0', dtype=torch.float16) tensor(0.0451, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0044, device='cuda:0')
tensor(0.0728, device='cuda:0')
old_score: tensor(0.0409, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0393, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.429171323776245
Validation after dual ascent:
out_inf: tensor(5.0508, device='cuda:0', dtype=torch.float16) tensor(0.1522, device='cuda:0', dtype=torch.float16)
tensor(0.4194, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(0.3347, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.3196, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(0.4028, device='cuda:0', dtype=torch.float16) tensor(0.0438, device='cuda:0', dtype=torch.float16)
layer 17 done
18 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.1953, device='cuda:0', dtype=torch.float16) tensor(0.8193, device='cuda:0', dtype=torch.float16)
tensor(1.1445, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1209, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(2.1211, device='cuda:0', dtype=torch.float16) tensor(0.1344, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0173, device='cuda:0')
tensor(0.2677, device='cuda:0')
old_score: tensor(0.1273, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1182, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5129261016845703
Validation after dual ascent:
out_inf: tensor(14.1953, device='cuda:0', dtype=torch.float16) tensor(0.8193, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1109, device='cuda:0', dtype=torch.float16)
tensor(1.0283, device='cuda:0', dtype=torch.float16) tensor(0.1158, device='cuda:0', dtype=torch.float16)
tensor(1.9609, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
18 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.5781, device='cuda:0', dtype=torch.float16) tensor(0.9922, device='cuda:0', dtype=torch.float16)
tensor(0.9976, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(0.9590, device='cuda:0', dtype=torch.float16) tensor(0.1271, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0198, device='cuda:0')
tensor(0.2709, device='cuda:0')
old_score: tensor(0.1282, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1189, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.51159405708313
Validation after dual ascent:
out_inf: tensor(17.5781, device='cuda:0', dtype=torch.float16) tensor(0.9922, device='cuda:0', dtype=torch.float16)
tensor(0.9971, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
tensor(1.0322, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.1166, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
18 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9844, device='cuda:0', dtype=torch.float16) tensor(0.3733, device='cuda:0', dtype=torch.float16)
tensor(0.8062, device='cuda:0', dtype=torch.float16) tensor(0.1000, device='cuda:0', dtype=torch.float16)
tensor(0.7305, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(0.7266, device='cuda:0', dtype=torch.float16) tensor(0.0984, device='cuda:0', dtype=torch.float16)
tensor(0.8613, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0097, device='cuda:0')
tensor(0.2037, device='cuda:0')
old_score: tensor(0.0994, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0926, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5074617862701416
Validation after dual ascent:
out_inf: tensor(4.9844, device='cuda:0', dtype=torch.float16) tensor(0.3733, device='cuda:0', dtype=torch.float16)
tensor(0.8330, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.7031, device='cuda:0', dtype=torch.float16) tensor(0.0866, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.0998, device='cuda:0', dtype=torch.float16)
18 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3242, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.3499, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.2917, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.2915, device='cuda:0', dtype=torch.float16) tensor(0.0303, device='cuda:0', dtype=torch.float16)
tensor(0.3284, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0178, device='cuda:0')
tensor(0.0124, device='cuda:0')
old_score: tensor(0.0289, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0267, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4953017234802246
Validation after dual ascent:
out_inf: tensor(4.3242, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.2991, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.2627, device='cuda:0', dtype=torch.float16) tensor(0.0257, device='cuda:0', dtype=torch.float16)
tensor(0.2903, device='cuda:0', dtype=torch.float16) tensor(0.0278, device='cuda:0', dtype=torch.float16)
tensor(0.2942, device='cuda:0', dtype=torch.float16) tensor(0.0271, device='cuda:0', dtype=torch.float16)
18 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.7812, device='cuda:0', dtype=torch.float16) tensor(0.4558, device='cuda:0', dtype=torch.float16)
tensor(0.7578, device='cuda:0', dtype=torch.float16) tensor(0.0862, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
tensor(0.6812, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
tensor(0.7949, device='cuda:0', dtype=torch.float16) tensor(0.0903, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0079, device='cuda:0')
tensor(0.1139, device='cuda:0')
old_score: tensor(0.0852, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0789, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.20652437210083
Validation after dual ascent:
out_inf: tensor(9.7812, device='cuda:0', dtype=torch.float16) tensor(0.4558, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(0.7578, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.6592, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(0.7563, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
18 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.8320, device='cuda:0', dtype=torch.float16) tensor(0.3245, device='cuda:0', dtype=torch.float16)
tensor(0.6699, device='cuda:0', dtype=torch.float16) tensor(0.0826, device='cuda:0', dtype=torch.float16)
tensor(0.6206, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
tensor(0.6416, device='cuda:0', dtype=torch.float16) tensor(0.0808, device='cuda:0', dtype=torch.float16)
tensor(0.7217, device='cuda:0', dtype=torch.float16) tensor(0.0866, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0070, device='cuda:0')
tensor(0.1071, device='cuda:0')
old_score: tensor(0.0817, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0757, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.217751741409302
Validation after dual ascent:
out_inf: tensor(5.8320, device='cuda:0', dtype=torch.float16) tensor(0.3245, device='cuda:0', dtype=torch.float16)
tensor(0.6396, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
tensor(0.6255, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(0.6299, device='cuda:0', dtype=torch.float16) tensor(0.0741, device='cuda:0', dtype=torch.float16)
tensor(0.7129, device='cuda:0', dtype=torch.float16) tensor(0.0818, device='cuda:0', dtype=torch.float16)
18 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6797, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(0.4360, device='cuda:0', dtype=torch.float16) tensor(0.0455, device='cuda:0', dtype=torch.float16)
tensor(0.3589, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.3574, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.4175, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0054, device='cuda:0')
tensor(0.0859, device='cuda:0')
old_score: tensor(0.0435, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0418, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.437782049179077
Validation after dual ascent:
out_inf: tensor(5.6797, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(0.4287, device='cuda:0', dtype=torch.float16) tensor(0.0438, device='cuda:0', dtype=torch.float16)
tensor(0.3550, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
tensor(0.3411, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(0.4224, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
layer 18 done
19 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.9062, device='cuda:0', dtype=torch.float16) tensor(0.7827, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.1228, device='cuda:0', dtype=torch.float16)
tensor(1.3682, device='cuda:0', dtype=torch.float16) tensor(0.1157, device='cuda:0', dtype=torch.float16)
tensor(1.1279, device='cuda:0', dtype=torch.float16) tensor(0.1211, device='cuda:0', dtype=torch.float16)
tensor(1.4189, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0135, device='cuda:0')
tensor(0.2563, device='cuda:0')
old_score: tensor(0.1222, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1130, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.509896993637085
Validation after dual ascent:
out_inf: tensor(12.9062, device='cuda:0', dtype=torch.float16) tensor(0.7827, device='cuda:0', dtype=torch.float16)
tensor(0.9424, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
tensor(1.2705, device='cuda:0', dtype=torch.float16) tensor(0.1054, device='cuda:0', dtype=torch.float16)
tensor(1.0215, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(1.3955, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
19 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.6250, device='cuda:0', dtype=torch.float16) tensor(1.0225, device='cuda:0', dtype=torch.float16)
tensor(1.0400, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(1.4004, device='cuda:0', dtype=torch.float16) tensor(0.1158, device='cuda:0', dtype=torch.float16)
tensor(0.9810, device='cuda:0', dtype=torch.float16) tensor(0.1216, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0147, device='cuda:0')
tensor(0.2597, device='cuda:0')
old_score: tensor(0.1226, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1132, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5136871337890625
Validation after dual ascent:
out_inf: tensor(19.6250, device='cuda:0', dtype=torch.float16) tensor(1.0225, device='cuda:0', dtype=torch.float16)
tensor(0.9248, device='cuda:0', dtype=torch.float16) tensor(0.1145, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1053, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(1.0508, device='cuda:0', dtype=torch.float16) tensor(0.1223, device='cuda:0', dtype=torch.float16)
19 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2695, device='cuda:0', dtype=torch.float16) tensor(0.3848, device='cuda:0', dtype=torch.float16)
tensor(0.7178, device='cuda:0', dtype=torch.float16) tensor(0.0995, device='cuda:0', dtype=torch.float16)
tensor(0.7368, device='cuda:0', dtype=torch.float16) tensor(0.0930, device='cuda:0', dtype=torch.float16)
tensor(0.7725, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(0.8115, device='cuda:0', dtype=torch.float16) tensor(0.1045, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0096, device='cuda:0')
tensor(0.1987, device='cuda:0')
old_score: tensor(0.0986, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0914, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.506380796432495
Validation after dual ascent:
out_inf: tensor(4.2695, device='cuda:0', dtype=torch.float16) tensor(0.3848, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0926, device='cuda:0', dtype=torch.float16)
tensor(0.7534, device='cuda:0', dtype=torch.float16) tensor(0.0850, device='cuda:0', dtype=torch.float16)
tensor(0.7329, device='cuda:0', dtype=torch.float16) tensor(0.0892, device='cuda:0', dtype=torch.float16)
tensor(0.7773, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
19 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.7773, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(0.2947, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
tensor(0.3677, device='cuda:0', dtype=torch.float16) tensor(0.0295, device='cuda:0', dtype=torch.float16)
tensor(0.2812, device='cuda:0', dtype=torch.float16) tensor(0.0298, device='cuda:0', dtype=torch.float16)
tensor(0.3169, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0067, device='cuda:0')
tensor(0.0670, device='cuda:0')
old_score: tensor(0.0293, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0270, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7515344619750977
Validation after dual ascent:
out_inf: tensor(5.7773, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(0.2866, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.2922, device='cuda:0', dtype=torch.float16) tensor(0.0267, device='cuda:0', dtype=torch.float16)
tensor(0.3108, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
tensor(0.3242, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
19 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.1875, device='cuda:0', dtype=torch.float16) tensor(0.4492, device='cuda:0', dtype=torch.float16)
tensor(0.6904, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(0.8047, device='cuda:0', dtype=torch.float16) tensor(0.0826, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.7822, device='cuda:0', dtype=torch.float16) tensor(0.0935, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0086, device='cuda:0')
tensor(0.1286, device='cuda:0')
old_score: tensor(0.0883, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0817, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.207808256149292
Validation after dual ascent:
out_inf: tensor(8.1875, device='cuda:0', dtype=torch.float16) tensor(0.4492, device='cuda:0', dtype=torch.float16)
tensor(0.7178, device='cuda:0', dtype=torch.float16) tensor(0.0829, device='cuda:0', dtype=torch.float16)
tensor(0.7920, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
tensor(0.6973, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0883, device='cuda:0', dtype=torch.float16)
19 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.5781, device='cuda:0', dtype=torch.float16) tensor(0.3333, device='cuda:0', dtype=torch.float16)
tensor(0.7852, device='cuda:0', dtype=torch.float16) tensor(0.0851, device='cuda:0', dtype=torch.float16)
tensor(0.7417, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(0.6533, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0891, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0077, device='cuda:0')
tensor(0.1205, device='cuda:0')
old_score: tensor(0.0840, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0779, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.214199542999268
Validation after dual ascent:
out_inf: tensor(7.5781, device='cuda:0', dtype=torch.float16) tensor(0.3333, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0791, device='cuda:0', dtype=torch.float16)
tensor(0.7119, device='cuda:0', dtype=torch.float16) tensor(0.0721, device='cuda:0', dtype=torch.float16)
tensor(0.6895, device='cuda:0', dtype=torch.float16) tensor(0.0763, device='cuda:0', dtype=torch.float16)
tensor(0.7500, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
19 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.3359, device='cuda:0', dtype=torch.float16) tensor(0.1764, device='cuda:0', dtype=torch.float16)
tensor(0.4307, device='cuda:0', dtype=torch.float16) tensor(0.0473, device='cuda:0', dtype=torch.float16)
tensor(0.3938, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.3706, device='cuda:0', dtype=torch.float16) tensor(0.0426, device='cuda:0', dtype=torch.float16)
tensor(0.4595, device='cuda:0', dtype=torch.float16) tensor(0.0495, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0058, device='cuda:0')
tensor(0.0930, device='cuda:0')
old_score: tensor(0.0452, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0434, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.445536136627197
Validation after dual ascent:
out_inf: tensor(5.3359, device='cuda:0', dtype=torch.float16) tensor(0.1764, device='cuda:0', dtype=torch.float16)
tensor(0.4319, device='cuda:0', dtype=torch.float16) tensor(0.0455, device='cuda:0', dtype=torch.float16)
tensor(0.3779, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
tensor(0.3728, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.4531, device='cuda:0', dtype=torch.float16) tensor(0.0481, device='cuda:0', dtype=torch.float16)
layer 19 done
20 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.4297, device='cuda:0', dtype=torch.float16) tensor(0.8022, device='cuda:0', dtype=torch.float16)
tensor(1.2256, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.2441, device='cuda:0', dtype=torch.float16) tensor(0.1219, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0131, device='cuda:0')
tensor(0.2622, device='cuda:0')
old_score: tensor(0.1224, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1130, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5038650035858154
Validation after dual ascent:
out_inf: tensor(15.4297, device='cuda:0', dtype=torch.float16) tensor(0.8022, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(1.0889, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(1.0947, device='cuda:0', dtype=torch.float16) tensor(0.1213, device='cuda:0', dtype=torch.float16)
20 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.2500, device='cuda:0', dtype=torch.float16) tensor(1.0205, device='cuda:0', dtype=torch.float16)
tensor(1.3320, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
tensor(1.0137, device='cuda:0', dtype=torch.float16) tensor(0.1157, device='cuda:0', dtype=torch.float16)
tensor(1.0225, device='cuda:0', dtype=torch.float16) tensor(0.1223, device='cuda:0', dtype=torch.float16)
tensor(1.0664, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0138, device='cuda:0')
tensor(0.2654, device='cuda:0')
old_score: tensor(0.1227, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1130, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5068342685699463
Validation after dual ascent:
out_inf: tensor(18.2500, device='cuda:0', dtype=torch.float16) tensor(1.0205, device='cuda:0', dtype=torch.float16)
tensor(1.2734, device='cuda:0', dtype=torch.float16) tensor(0.1145, device='cuda:0', dtype=torch.float16)
tensor(1.0869, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(0.9487, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(1.0918, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
20 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5977, device='cuda:0', dtype=torch.float16) tensor(0.3755, device='cuda:0', dtype=torch.float16)
tensor(0.7686, device='cuda:0', dtype=torch.float16) tensor(0.1020, device='cuda:0', dtype=torch.float16)
tensor(0.7910, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(0.7603, device='cuda:0', dtype=torch.float16) tensor(0.1000, device='cuda:0', dtype=torch.float16)
tensor(0.8652, device='cuda:0', dtype=torch.float16) tensor(0.1062, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0098, device='cuda:0')
tensor(0.2049, device='cuda:0')
old_score: tensor(0.1007, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0933, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5014452934265137
Validation after dual ascent:
out_inf: tensor(4.5977, device='cuda:0', dtype=torch.float16) tensor(0.3755, device='cuda:0', dtype=torch.float16)
tensor(0.7764, device='cuda:0', dtype=torch.float16) tensor(0.0948, device='cuda:0', dtype=torch.float16)
tensor(0.7871, device='cuda:0', dtype=torch.float16) tensor(0.0862, device='cuda:0', dtype=torch.float16)
tensor(0.7461, device='cuda:0', dtype=torch.float16) tensor(0.0916, device='cuda:0', dtype=torch.float16)
tensor(0.8086, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
20 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.6328, device='cuda:0', dtype=torch.float16) tensor(0.1377, device='cuda:0', dtype=torch.float16)
tensor(0.3262, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.3311, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.3354, device='cuda:0', dtype=torch.float16) tensor(0.0317, device='cuda:0', dtype=torch.float16)
tensor(0.3760, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0064, device='cuda:0')
tensor(0.0885, device='cuda:0')
old_score: tensor(0.0344, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0313, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7570724487304688
Validation after dual ascent:
out_inf: tensor(12.6328, device='cuda:0', dtype=torch.float16) tensor(0.1377, device='cuda:0', dtype=torch.float16)
tensor(0.3127, device='cuda:0', dtype=torch.float16) tensor(0.0308, device='cuda:0', dtype=torch.float16)
tensor(0.3113, device='cuda:0', dtype=torch.float16) tensor(0.0328, device='cuda:0', dtype=torch.float16)
tensor(0.2874, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.3369, device='cuda:0', dtype=torch.float16) tensor(0.0324, device='cuda:0', dtype=torch.float16)
20 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(11.1172, device='cuda:0', dtype=torch.float16) tensor(0.4634, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.0912, device='cuda:0', dtype=torch.float16)
tensor(0.8726, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.7070, device='cuda:0', dtype=torch.float16) tensor(0.0899, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0092, device='cuda:0')
tensor(0.1373, device='cuda:0')
old_score: tensor(0.0898, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0828, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.174974203109741
Validation after dual ascent:
out_inf: tensor(11.1172, device='cuda:0', dtype=torch.float16) tensor(0.4634, device='cuda:0', dtype=torch.float16)
tensor(0.8555, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
tensor(0.8701, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(0.7031, device='cuda:0', dtype=torch.float16) tensor(0.0822, device='cuda:0', dtype=torch.float16)
tensor(0.7949, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
20 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9062, device='cuda:0', dtype=torch.float16) tensor(0.3430, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
tensor(0.6875, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(0.7959, device='cuda:0', dtype=torch.float16) tensor(0.0850, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0082, device='cuda:0')
tensor(0.1278, device='cuda:0')
old_score: tensor(0.0848, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0782, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.18222713470459
Validation after dual ascent:
out_inf: tensor(5.9062, device='cuda:0', dtype=torch.float16) tensor(0.3430, device='cuda:0', dtype=torch.float16)
tensor(0.8062, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.7100, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
tensor(0.7412, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.8906, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
20 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.2109, device='cuda:0', dtype=torch.float16) tensor(0.1891, device='cuda:0', dtype=torch.float16)
tensor(0.4844, device='cuda:0', dtype=torch.float16) tensor(0.0500, device='cuda:0', dtype=torch.float16)
tensor(0.4126, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
tensor(0.3916, device='cuda:0', dtype=torch.float16) tensor(0.0456, device='cuda:0', dtype=torch.float16)
tensor(0.5264, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0068, device='cuda:0')
tensor(0.1074, device='cuda:0')
old_score: tensor(0.0474, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0455, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.353106260299683
Validation after dual ascent:
out_inf: tensor(7.2109, device='cuda:0', dtype=torch.float16) tensor(0.1891, device='cuda:0', dtype=torch.float16)
tensor(0.4805, device='cuda:0', dtype=torch.float16) tensor(0.0480, device='cuda:0', dtype=torch.float16)
tensor(0.3943, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
tensor(0.3931, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(0.5200, device='cuda:0', dtype=torch.float16) tensor(0.0503, device='cuda:0', dtype=torch.float16)
layer 20 done
21 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.8594, device='cuda:0', dtype=torch.float16) tensor(0.7847, device='cuda:0', dtype=torch.float16)
tensor(1.0400, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(1.6992, device='cuda:0', dtype=torch.float16) tensor(0.1146, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.1234, device='cuda:0', dtype=torch.float16)
tensor(1.4248, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0143, device='cuda:0')
tensor(0.2867, device='cuda:0')
old_score: tensor(0.1224, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1127, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.512514114379883
Validation after dual ascent:
out_inf: tensor(16.8594, device='cuda:0', dtype=torch.float16) tensor(0.7847, device='cuda:0', dtype=torch.float16)
tensor(1.1104, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
tensor(1.5342, device='cuda:0', dtype=torch.float16) tensor(0.1038, device='cuda:0', dtype=torch.float16)
tensor(1.0518, device='cuda:0', dtype=torch.float16) tensor(0.1126, device='cuda:0', dtype=torch.float16)
tensor(1.2520, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
21 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.2812, device='cuda:0', dtype=torch.float16) tensor(0.9834, device='cuda:0', dtype=torch.float16)
tensor(1.2402, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.0410, device='cuda:0', dtype=torch.float16) tensor(0.1140, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.0977, device='cuda:0', dtype=torch.float16) tensor(0.1273, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0153, device='cuda:0')
tensor(0.2903, device='cuda:0')
old_score: tensor(0.1218, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1121, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5151896476745605
Validation after dual ascent:
out_inf: tensor(18.2812, device='cuda:0', dtype=torch.float16) tensor(0.9834, device='cuda:0', dtype=torch.float16)
tensor(1.2041, device='cuda:0', dtype=torch.float16) tensor(0.1134, device='cuda:0', dtype=torch.float16)
tensor(0.9443, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(0.9258, device='cuda:0', dtype=torch.float16) tensor(0.1121, device='cuda:0', dtype=torch.float16)
tensor(1.0732, device='cuda:0', dtype=torch.float16) tensor(0.1196, device='cuda:0', dtype=torch.float16)
21 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.5586, device='cuda:0', dtype=torch.float16) tensor(0.3943, device='cuda:0', dtype=torch.float16)
tensor(0.8486, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0996, device='cuda:0', dtype=torch.float16)
tensor(0.8633, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.1121, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0112, device='cuda:0')
tensor(0.2371, device='cuda:0')
old_score: tensor(0.1069, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0986, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.507286787033081
Validation after dual ascent:
out_inf: tensor(5.5586, device='cuda:0', dtype=torch.float16) tensor(0.3943, device='cuda:0', dtype=torch.float16)
tensor(0.8809, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(0.9014, device='cuda:0', dtype=torch.float16) tensor(0.0904, device='cuda:0', dtype=torch.float16)
tensor(0.8853, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(0.9741, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
21 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.2422, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(0.3457, device='cuda:0', dtype=torch.float16) tensor(0.0322, device='cuda:0', dtype=torch.float16)
tensor(0.3970, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.4431, device='cuda:0', dtype=torch.float16) tensor(0.0355, device='cuda:0', dtype=torch.float16)
tensor(0.4382, device='cuda:0', dtype=torch.float16) tensor(0.0306, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0082, device='cuda:0')
tensor(0.1049, device='cuda:0')
old_score: tensor(0.0337, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0310, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7498550415039062
Validation after dual ascent:
out_inf: tensor(9.2422, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(0.3735, device='cuda:0', dtype=torch.float16) tensor(0.0297, device='cuda:0', dtype=torch.float16)
tensor(0.3972, device='cuda:0', dtype=torch.float16) tensor(0.0324, device='cuda:0', dtype=torch.float16)
tensor(0.3813, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.4797, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
21 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.5234, device='cuda:0', dtype=torch.float16) tensor(0.4587, device='cuda:0', dtype=torch.float16)
tensor(0.8740, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
tensor(1.0664, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(0.7451, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0100, device='cuda:0')
tensor(0.1533, device='cuda:0')
old_score: tensor(0.0927, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0856, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.214662313461304
Validation after dual ascent:
out_inf: tensor(10.5234, device='cuda:0', dtype=torch.float16) tensor(0.4587, device='cuda:0', dtype=torch.float16)
tensor(0.7959, device='cuda:0', dtype=torch.float16) tensor(0.0867, device='cuda:0', dtype=torch.float16)
tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0784, device='cuda:0', dtype=torch.float16)
tensor(0.7119, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
tensor(1.1250, device='cuda:0', dtype=torch.float16) tensor(0.0916, device='cuda:0', dtype=torch.float16)
21 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4648, device='cuda:0', dtype=torch.float16) tensor(0.3408, device='cuda:0', dtype=torch.float16)
tensor(0.8125, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(0.7178, device='cuda:0', dtype=torch.float16) tensor(0.0805, device='cuda:0', dtype=torch.float16)
tensor(0.7021, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0911, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0089, device='cuda:0')
tensor(0.1414, device='cuda:0')
old_score: tensor(0.0867, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0801, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2178215980529785
Validation after dual ascent:
out_inf: tensor(6.4648, device='cuda:0', dtype=torch.float16) tensor(0.3408, device='cuda:0', dtype=torch.float16)
tensor(0.7969, device='cuda:0', dtype=torch.float16) tensor(0.0812, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0734, device='cuda:0', dtype=torch.float16)
tensor(0.7300, device='cuda:0', dtype=torch.float16) tensor(0.0802, device='cuda:0', dtype=torch.float16)
tensor(0.8257, device='cuda:0', dtype=torch.float16) tensor(0.0857, device='cuda:0', dtype=torch.float16)
21 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.1562, device='cuda:0', dtype=torch.float16) tensor(0.1837, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.4504, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.4629, device='cuda:0', dtype=torch.float16) tensor(0.0458, device='cuda:0', dtype=torch.float16)
tensor(0.5073, device='cuda:0', dtype=torch.float16) tensor(0.0511, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0066, device='cuda:0')
tensor(0.1064, device='cuda:0')
old_score: tensor(0.0470, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0453, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.438143014907837
Validation after dual ascent:
out_inf: tensor(4.1562, device='cuda:0', dtype=torch.float16) tensor(0.1837, device='cuda:0', dtype=torch.float16)
tensor(0.5171, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.4509, device='cuda:0', dtype=torch.float16) tensor(0.0395, device='cuda:0', dtype=torch.float16)
tensor(0.4258, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.5029, device='cuda:0', dtype=torch.float16) tensor(0.0497, device='cuda:0', dtype=torch.float16)
layer 21 done
22 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.0938, device='cuda:0', dtype=torch.float16) tensor(0.8369, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(1.1514, device='cuda:0', dtype=torch.float16) tensor(0.1193, device='cuda:0', dtype=torch.float16)
tensor(1.2129, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
tensor(1.4648, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
tensor(0.1280, device='cuda:0')
old_score: tensor(0.1281, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1181, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.221991777420044
Validation after dual ascent:
out_inf: tensor(18.0938, device='cuda:0', dtype=torch.float16) tensor(0.8369, device='cuda:0', dtype=torch.float16)
tensor(1.0762, device='cuda:0', dtype=torch.float16) tensor(0.1194, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1190, device='cuda:0', dtype=torch.float16)
tensor(1.3506, device='cuda:0', dtype=torch.float16) tensor(0.1257, device='cuda:0', dtype=torch.float16)
22 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.3594, device='cuda:0', dtype=torch.float16) tensor(1.0107, device='cuda:0', dtype=torch.float16)
tensor(1.2207, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1190, device='cuda:0', dtype=torch.float16)
tensor(1.1533, device='cuda:0', dtype=torch.float16) tensor(0.1301, device='cuda:0', dtype=torch.float16)
tensor(1.0879, device='cuda:0', dtype=torch.float16) tensor(0.1333, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0175, device='cuda:0')
tensor(0.1234, device='cuda:0')
old_score: tensor(0.1279, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1179, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.269700765609741
Validation after dual ascent:
out_inf: tensor(20.3594, device='cuda:0', dtype=torch.float16) tensor(1.0107, device='cuda:0', dtype=torch.float16)
tensor(1.1533, device='cuda:0', dtype=torch.float16) tensor(0.1193, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.1079, device='cuda:0', dtype=torch.float16)
tensor(1.0439, device='cuda:0', dtype=torch.float16) tensor(0.1189, device='cuda:0', dtype=torch.float16)
tensor(1.1035, device='cuda:0', dtype=torch.float16) tensor(0.1252, device='cuda:0', dtype=torch.float16)
22 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.5000, device='cuda:0', dtype=torch.float16) tensor(0.4165, device='cuda:0', dtype=torch.float16)
tensor(0.9072, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
tensor(0.9429, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(0.8525, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
tensor(1.0498, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0188, device='cuda:0')
tensor(0.2502, device='cuda:0')
old_score: tensor(0.1086, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1005, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.512155055999756
Validation after dual ascent:
out_inf: tensor(7.5000, device='cuda:0', dtype=torch.float16) tensor(0.4165, device='cuda:0', dtype=torch.float16)
tensor(0.9146, device='cuda:0', dtype=torch.float16) tensor(0.1021, device='cuda:0', dtype=torch.float16)
tensor(0.9028, device='cuda:0', dtype=torch.float16) tensor(0.0916, device='cuda:0', dtype=torch.float16)
tensor(0.8525, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
tensor(1.0049, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
22 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.0469, device='cuda:0', dtype=torch.float16) tensor(0.1328, device='cuda:0', dtype=torch.float16)
tensor(0.3760, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.4629, device='cuda:0', dtype=torch.float16) tensor(0.0386, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0357, device='cuda:0', dtype=torch.float16)
tensor(0.3833, device='cuda:0', dtype=torch.float16) tensor(0.0373, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0123, device='cuda:0')
tensor(0.1346, device='cuda:0')
old_score: tensor(0.0369, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0342, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7574238777160645
Validation after dual ascent:
out_inf: tensor(12.0469, device='cuda:0', dtype=torch.float16) tensor(0.1328, device='cuda:0', dtype=torch.float16)
tensor(0.3555, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(0.4609, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.4097, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(0.3872, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
22 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.9297, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.8311, device='cuda:0', dtype=torch.float16) tensor(0.0951, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.0874, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(0.8770, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0105, device='cuda:0')
tensor(0.1611, device='cuda:0')
old_score: tensor(0.0940, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0865, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.222959041595459
Validation after dual ascent:
out_inf: tensor(10.9297, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.8359, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.9492, device='cuda:0', dtype=torch.float16) tensor(0.0794, device='cuda:0', dtype=torch.float16)
tensor(0.7847, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
22 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1133, device='cuda:0', dtype=torch.float16) tensor(0.3484, device='cuda:0', dtype=torch.float16)
tensor(0.8730, device='cuda:0', dtype=torch.float16) tensor(0.0883, device='cuda:0', dtype=torch.float16)
tensor(0.7373, device='cuda:0', dtype=torch.float16) tensor(0.0812, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0886, device='cuda:0', dtype=torch.float16)
tensor(0.8174, device='cuda:0', dtype=torch.float16) tensor(0.0910, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0093, device='cuda:0')
tensor(0.1477, device='cuda:0')
old_score: tensor(0.0873, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0804, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.228981971740723
Validation after dual ascent:
out_inf: tensor(6.1133, device='cuda:0', dtype=torch.float16) tensor(0.3484, device='cuda:0', dtype=torch.float16)
tensor(0.9292, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(0.7407, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
tensor(0.7832, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(0.8428, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
22 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.7734, device='cuda:0', dtype=torch.float16) tensor(0.1982, device='cuda:0', dtype=torch.float16)
tensor(0.5747, device='cuda:0', dtype=torch.float16) tensor(0.0527, device='cuda:0', dtype=torch.float16)
tensor(0.5693, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
tensor(0.4868, device='cuda:0', dtype=torch.float16) tensor(0.0485, device='cuda:0', dtype=torch.float16)
tensor(0.5103, device='cuda:0', dtype=torch.float16) tensor(0.0529, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0075, device='cuda:0')
tensor(0.1214, device='cuda:0')
old_score: tensor(0.0496, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0476, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.46678876876831
Validation after dual ascent:
out_inf: tensor(3.7734, device='cuda:0', dtype=torch.float16) tensor(0.1982, device='cuda:0', dtype=torch.float16)
tensor(0.5518, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
tensor(0.5117, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
tensor(0.4741, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.5264, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
layer 22 done
23 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.0781, device='cuda:0', dtype=torch.float16) tensor(0.8228, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.1373, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.1266, device='cuda:0', dtype=torch.float16)
tensor(1.3535, device='cuda:0', dtype=torch.float16) tensor(0.1392, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1407, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0166, device='cuda:0')
tensor(0.3590, device='cuda:0')
old_score: tensor(0.1360, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1255, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5014069080352783
Validation after dual ascent:
out_inf: tensor(16.0781, device='cuda:0', dtype=torch.float16) tensor(0.8228, device='cuda:0', dtype=torch.float16)
tensor(1.5088, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(1.7559, device='cuda:0', dtype=torch.float16) tensor(0.1151, device='cuda:0', dtype=torch.float16)
tensor(1.2891, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
tensor(1.3379, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
23 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.8125, device='cuda:0', dtype=torch.float16) tensor(0.9771, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1370, device='cuda:0', dtype=torch.float16)
tensor(1.1309, device='cuda:0', dtype=torch.float16) tensor(0.1266, device='cuda:0', dtype=torch.float16)
tensor(1.3037, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0174, device='cuda:0')
tensor(0.3632, device='cuda:0')
old_score: tensor(0.1357, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1250, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5014586448669434
Validation after dual ascent:
out_inf: tensor(19.8125, device='cuda:0', dtype=torch.float16) tensor(0.9771, device='cuda:0', dtype=torch.float16)
tensor(1.2314, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
tensor(1.2051, device='cuda:0', dtype=torch.float16) tensor(0.1149, device='cuda:0', dtype=torch.float16)
tensor(1.1377, device='cuda:0', dtype=torch.float16) tensor(0.1276, device='cuda:0', dtype=torch.float16)
tensor(1.2314, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
23 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6758, device='cuda:0', dtype=torch.float16) tensor(0.4553, device='cuda:0', dtype=torch.float16)
tensor(1.0205, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(0.9507, device='cuda:0', dtype=torch.float16) tensor(0.1232, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0139, device='cuda:0')
tensor(0.3088, device='cuda:0')
old_score: tensor(0.1205, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1113, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4986424446105957
Validation after dual ascent:
out_inf: tensor(5.6758, device='cuda:0', dtype=torch.float16) tensor(0.4553, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.1126, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.1019, device='cuda:0', dtype=torch.float16)
tensor(0.9541, device='cuda:0', dtype=torch.float16) tensor(0.1133, device='cuda:0', dtype=torch.float16)
tensor(1.0439, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
23 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.9062, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
tensor(0.4570, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.4500, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
tensor(0.4231, device='cuda:0', dtype=torch.float16) tensor(0.0360, device='cuda:0', dtype=torch.float16)
tensor(0.3945, device='cuda:0', dtype=torch.float16) tensor(0.0342, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0100, device='cuda:0')
tensor(0.1322, device='cuda:0')
old_score: tensor(0.0364, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0338, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7447326183319092
Validation after dual ascent:
out_inf: tensor(18.9062, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
tensor(0.4536, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.4045, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
tensor(0.4067, device='cuda:0', dtype=torch.float16) tensor(0.0335, device='cuda:0', dtype=torch.float16)
tensor(0.3838, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
23 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.3281, device='cuda:0', dtype=torch.float16) tensor(0.4663, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.0997, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0915, device='cuda:0', dtype=torch.float16)
tensor(0.8193, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
tensor(0.8882, device='cuda:0', dtype=torch.float16) tensor(0.1019, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0120, device='cuda:0')
tensor(0.1932, device='cuda:0')
old_score: tensor(0.0985, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0910, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.179349184036255
Validation after dual ascent:
out_inf: tensor(10.3281, device='cuda:0', dtype=torch.float16) tensor(0.4663, device='cuda:0', dtype=torch.float16)
tensor(0.8838, device='cuda:0', dtype=torch.float16) tensor(0.0921, device='cuda:0', dtype=torch.float16)
tensor(0.8477, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(0.8369, device='cuda:0', dtype=torch.float16) tensor(0.0930, device='cuda:0', dtype=torch.float16)
tensor(0.9639, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
23 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.3281, device='cuda:0', dtype=torch.float16) tensor(0.3550, device='cuda:0', dtype=torch.float16)
tensor(0.8032, device='cuda:0', dtype=torch.float16) tensor(0.0929, device='cuda:0', dtype=torch.float16)
tensor(0.7759, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
tensor(0.7510, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(0.8530, device='cuda:0', dtype=torch.float16) tensor(0.0949, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0108, device='cuda:0')
tensor(0.1777, device='cuda:0')
old_score: tensor(0.0918, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0848, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.187328100204468
Validation after dual ascent:
out_inf: tensor(7.3281, device='cuda:0', dtype=torch.float16) tensor(0.3550, device='cuda:0', dtype=torch.float16)
tensor(0.8374, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
tensor(0.8262, device='cuda:0', dtype=torch.float16) tensor(0.0775, device='cuda:0', dtype=torch.float16)
tensor(0.7637, device='cuda:0', dtype=torch.float16) tensor(0.0866, device='cuda:0', dtype=torch.float16)
tensor(0.8643, device='cuda:0', dtype=torch.float16) tensor(0.0891, device='cuda:0', dtype=torch.float16)
23 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.9922, device='cuda:0', dtype=torch.float16) tensor(0.2026, device='cuda:0', dtype=torch.float16)
tensor(0.5767, device='cuda:0', dtype=torch.float16) tensor(0.0552, device='cuda:0', dtype=torch.float16)
tensor(0.6011, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
tensor(0.6064, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
tensor(0.6807, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0085, device='cuda:0')
tensor(0.1384, device='cuda:0')
old_score: tensor(0.0521, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0503, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.412688255310059
Validation after dual ascent:
out_inf: tensor(3.9922, device='cuda:0', dtype=torch.float16) tensor(0.2026, device='cuda:0', dtype=torch.float16)
tensor(0.5840, device='cuda:0', dtype=torch.float16) tensor(0.0532, device='cuda:0', dtype=torch.float16)
tensor(0.5605, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.5449, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.6396, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
layer 23 done
24 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.8672, device='cuda:0', dtype=torch.float16) tensor(0.7915, device='cuda:0', dtype=torch.float16)
tensor(1.2041, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(1.8945, device='cuda:0', dtype=torch.float16) tensor(0.1173, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(1.1553, device='cuda:0', dtype=torch.float16) tensor(0.1292, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0170, device='cuda:0')
tensor(0.3338, device='cuda:0')
old_score: tensor(0.1255, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1160, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.509413003921509
Validation after dual ascent:
out_inf: tensor(15.8672, device='cuda:0', dtype=torch.float16) tensor(0.7915, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
tensor(1.8301, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
tensor(1.0645, device='cuda:0', dtype=torch.float16) tensor(0.1188, device='cuda:0', dtype=torch.float16)
tensor(1.1807, device='cuda:0', dtype=torch.float16) tensor(0.1213, device='cuda:0', dtype=torch.float16)
24 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.3906, device='cuda:0', dtype=torch.float16) tensor(1.0059, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1257, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(1.0723, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(1.0918, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0190, device='cuda:0')
tensor(0.3369, device='cuda:0')
old_score: tensor(0.1246, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1150, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5066821575164795
Validation after dual ascent:
out_inf: tensor(17.3906, device='cuda:0', dtype=torch.float16) tensor(1.0059, device='cuda:0', dtype=torch.float16)
tensor(1.0361, device='cuda:0', dtype=torch.float16) tensor(0.1162, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.1058, device='cuda:0', dtype=torch.float16)
tensor(0.9561, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(1.0918, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
24 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4336, device='cuda:0', dtype=torch.float16) tensor(0.4377, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.1189, device='cuda:0', dtype=torch.float16)
tensor(0.9561, device='cuda:0', dtype=torch.float16) tensor(0.1097, device='cuda:0', dtype=torch.float16)
tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
tensor(1.2520, device='cuda:0', dtype=torch.float16) tensor(0.1214, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0139, device='cuda:0')
tensor(0.2932, device='cuda:0')
old_score: tensor(0.1177, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1090, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.502476453781128
Validation after dual ascent:
out_inf: tensor(6.4336, device='cuda:0', dtype=torch.float16) tensor(0.4377, device='cuda:0', dtype=torch.float16)
tensor(1.0488, device='cuda:0', dtype=torch.float16) tensor(0.1103, device='cuda:0', dtype=torch.float16)
tensor(0.9424, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(0.9629, device='cuda:0', dtype=torch.float16) tensor(0.1115, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
24 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.1797, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(0.4368, device='cuda:0', dtype=torch.float16) tensor(0.0394, device='cuda:0', dtype=torch.float16)
tensor(0.4673, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.4646, device='cuda:0', dtype=torch.float16) tensor(0.0449, device='cuda:0', dtype=torch.float16)
tensor(0.4771, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0168, device='cuda:0')
tensor(0.0149, device='cuda:0')
old_score: tensor(0.0426, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0395, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.237959861755371
Validation after dual ascent:
out_inf: tensor(14.1797, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(0.4028, device='cuda:0', dtype=torch.float16) tensor(0.0364, device='cuda:0', dtype=torch.float16)
tensor(0.4768, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
tensor(0.4434, device='cuda:0', dtype=torch.float16) tensor(0.0415, device='cuda:0', dtype=torch.float16)
tensor(0.4387, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
24 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.1875, device='cuda:0', dtype=torch.float16) tensor(0.4717, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(0.9307, device='cuda:0', dtype=torch.float16) tensor(0.1032, device='cuda:0', dtype=torch.float16)
tensor(1.0381, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0126, device='cuda:0')
tensor(0.2053, device='cuda:0')
old_score: tensor(0.1004, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0929, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.18241548538208
Validation after dual ascent:
out_inf: tensor(12.1875, device='cuda:0', dtype=torch.float16) tensor(0.4717, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
tensor(0.9019, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
tensor(0.8604, device='cuda:0', dtype=torch.float16) tensor(0.0952, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.0970, device='cuda:0', dtype=torch.float16)
24 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.5039, device='cuda:0', dtype=torch.float16) tensor(0.3611, device='cuda:0', dtype=torch.float16)
tensor(0.8335, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(0.8569, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.9292, device='cuda:0', dtype=torch.float16) tensor(0.0963, device='cuda:0', dtype=torch.float16)
tensor(0.8447, device='cuda:0', dtype=torch.float16) tensor(0.0964, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0113, device='cuda:0')
tensor(0.1891, device='cuda:0')
old_score: tensor(0.0936, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0867, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.187650918960571
Validation after dual ascent:
out_inf: tensor(7.5039, device='cuda:0', dtype=torch.float16) tensor(0.3611, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.0876, device='cuda:0', dtype=torch.float16)
tensor(0.8301, device='cuda:0', dtype=torch.float16) tensor(0.0796, device='cuda:0', dtype=torch.float16)
tensor(0.9912, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
tensor(0.8535, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
24 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8047, device='cuda:0', dtype=torch.float16) tensor(0.2096, device='cuda:0', dtype=torch.float16)
tensor(0.6992, device='cuda:0', dtype=torch.float16) tensor(0.0567, device='cuda:0', dtype=torch.float16)
tensor(0.6260, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(0.5215, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
tensor(0.6484, device='cuda:0', dtype=torch.float16) tensor(0.0568, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0089, device='cuda:0')
tensor(0.1464, device='cuda:0')
old_score: tensor(0.0535, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0517, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.388670444488525
Validation after dual ascent:
out_inf: tensor(4.8047, device='cuda:0', dtype=torch.float16) tensor(0.2096, device='cuda:0', dtype=torch.float16)
tensor(0.6572, device='cuda:0', dtype=torch.float16) tensor(0.0548, device='cuda:0', dtype=torch.float16)
tensor(0.5884, device='cuda:0', dtype=torch.float16) tensor(0.0456, device='cuda:0', dtype=torch.float16)
tensor(0.4966, device='cuda:0', dtype=torch.float16) tensor(0.0510, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
layer 24 done
25 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(11.9141, device='cuda:0', dtype=torch.float16) tensor(0.8037, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(1.3076, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
tensor(1.6553, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.7715, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0177, device='cuda:0')
tensor(0.4005, device='cuda:0')
old_score: tensor(0.1390, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1288, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.507223129272461
Validation after dual ascent:
out_inf: tensor(11.9141, device='cuda:0', dtype=torch.float16) tensor(0.8037, device='cuda:0', dtype=torch.float16)
tensor(1.3096, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(1.5508, device='cuda:0', dtype=torch.float16) tensor(0.1327, device='cuda:0', dtype=torch.float16)
tensor(1.7168, device='cuda:0', dtype=torch.float16) tensor(0.1342, device='cuda:0', dtype=torch.float16)
25 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(0.9512, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(1.1660, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
tensor(1.3594, device='cuda:0', dtype=torch.float16) tensor(0.1433, device='cuda:0', dtype=torch.float16)
tensor(1.3564, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0186, device='cuda:0')
tensor(0.4021, device='cuda:0')
old_score: tensor(0.1387, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1285, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.510512590408325
Validation after dual ascent:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(0.9512, device='cuda:0', dtype=torch.float16)
tensor(1.3887, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
tensor(1.1777, device='cuda:0', dtype=torch.float16) tensor(0.1181, device='cuda:0', dtype=torch.float16)
tensor(1.3936, device='cuda:0', dtype=torch.float16) tensor(0.1324, device='cuda:0', dtype=torch.float16)
tensor(1.4307, device='cuda:0', dtype=torch.float16) tensor(0.1337, device='cuda:0', dtype=torch.float16)
25 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.3477, device='cuda:0', dtype=torch.float16) tensor(0.4790, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.0049, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.1348, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.1339, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0158, device='cuda:0')
tensor(0.3646, device='cuda:0')
old_score: tensor(0.1306, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1212, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5059492588043213
Validation after dual ascent:
out_inf: tensor(5.3477, device='cuda:0', dtype=torch.float16) tensor(0.4790, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.1225, device='cuda:0', dtype=torch.float16)
tensor(0.9819, device='cuda:0', dtype=torch.float16) tensor(0.1114, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1248, device='cuda:0', dtype=torch.float16)
tensor(1.1982, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
25 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2461, device='cuda:0', dtype=torch.float16) tensor(0.1049, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0307, device='cuda:0', dtype=torch.float16)
tensor(0.3853, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.4170, device='cuda:0', dtype=torch.float16) tensor(0.0373, device='cuda:0', dtype=torch.float16)
tensor(0.4170, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0078, device='cuda:0')
tensor(0.0159, device='cuda:0')
old_score: tensor(0.0347, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0319, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.975084066390991
Validation after dual ascent:
out_inf: tensor(4.2461, device='cuda:0', dtype=torch.float16) tensor(0.1049, device='cuda:0', dtype=torch.float16)
tensor(0.3911, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
tensor(0.3760, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.3770, device='cuda:0', dtype=torch.float16) tensor(0.0345, device='cuda:0', dtype=torch.float16)
tensor(0.4126, device='cuda:0', dtype=torch.float16) tensor(0.0308, device='cuda:0', dtype=torch.float16)
25 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.8047, device='cuda:0', dtype=torch.float16) tensor(0.4980, device='cuda:0', dtype=torch.float16)
tensor(0.9365, device='cuda:0', dtype=torch.float16) tensor(0.1051, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.1071, device='cuda:0', dtype=torch.float16)
tensor(0.9287, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0140, device='cuda:0')
tensor(0.2361, device='cuda:0')
old_score: tensor(0.1040, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0961, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.191122055053711
Validation after dual ascent:
out_inf: tensor(9.8047, device='cuda:0', dtype=torch.float16) tensor(0.4980, device='cuda:0', dtype=torch.float16)
tensor(0.9229, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(0.9028, device='cuda:0', dtype=torch.float16) tensor(0.0880, device='cuda:0', dtype=torch.float16)
tensor(0.9258, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
tensor(0.9443, device='cuda:0', dtype=torch.float16) tensor(0.1004, device='cuda:0', dtype=torch.float16)
25 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.6797, device='cuda:0', dtype=torch.float16) tensor(0.3743, device='cuda:0', dtype=torch.float16)
tensor(0.9097, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
tensor(0.8682, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(0.9287, device='cuda:0', dtype=torch.float16) tensor(0.1001, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0127, device='cuda:0')
tensor(0.2184, device='cuda:0')
old_score: tensor(0.0974, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0902, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.194070816040039
Validation after dual ascent:
out_inf: tensor(8.6797, device='cuda:0', dtype=torch.float16) tensor(0.3743, device='cuda:0', dtype=torch.float16)
tensor(0.9385, device='cuda:0', dtype=torch.float16) tensor(0.0913, device='cuda:0', dtype=torch.float16)
tensor(0.8721, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.8379, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(0.9492, device='cuda:0', dtype=torch.float16) tensor(0.0942, device='cuda:0', dtype=torch.float16)
25 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9258, device='cuda:0', dtype=torch.float16) tensor(0.2206, device='cuda:0', dtype=torch.float16)
tensor(0.7007, device='cuda:0', dtype=torch.float16) tensor(0.0585, device='cuda:0', dtype=torch.float16)
tensor(0.6421, device='cuda:0', dtype=torch.float16) tensor(0.0501, device='cuda:0', dtype=torch.float16)
tensor(0.5698, device='cuda:0', dtype=torch.float16) tensor(0.0558, device='cuda:0', dtype=torch.float16)
tensor(0.6885, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0103, device='cuda:0')
tensor(0.1668, device='cuda:0')
old_score: tensor(0.0557, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0539, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.368263959884644
Validation after dual ascent:
out_inf: tensor(5.9258, device='cuda:0', dtype=torch.float16) tensor(0.2206, device='cuda:0', dtype=torch.float16)
tensor(0.6284, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.5410, device='cuda:0', dtype=torch.float16) tensor(0.0538, device='cuda:0', dtype=torch.float16)
tensor(0.6797, device='cuda:0', dtype=torch.float16) tensor(0.0572, device='cuda:0', dtype=torch.float16)
layer 25 done
26 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.0312, device='cuda:0', dtype=torch.float16) tensor(0.8335, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1348, device='cuda:0', dtype=torch.float16)
tensor(1.4473, device='cuda:0', dtype=torch.float16) tensor(0.1268, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
tensor(1.2891, device='cuda:0', dtype=torch.float16) tensor(0.1370, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0074, device='cuda:0')
tensor(0.1220, device='cuda:0')
old_score: tensor(0.1343, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1244, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2552404403686523
Validation after dual ascent:
out_inf: tensor(14.0312, device='cuda:0', dtype=torch.float16) tensor(0.8335, device='cuda:0', dtype=torch.float16)
tensor(1.1602, device='cuda:0', dtype=torch.float16) tensor(0.1250, device='cuda:0', dtype=torch.float16)
tensor(1.3057, device='cuda:0', dtype=torch.float16) tensor(0.1157, device='cuda:0', dtype=torch.float16)
tensor(1.0908, device='cuda:0', dtype=torch.float16) tensor(0.1281, device='cuda:0', dtype=torch.float16)
tensor(1.2881, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
26 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.9844, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(1.2959, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
tensor(1.1338, device='cuda:0', dtype=torch.float16) tensor(0.1268, device='cuda:0', dtype=torch.float16)
tensor(1.0918, device='cuda:0', dtype=torch.float16) tensor(0.1387, device='cuda:0', dtype=torch.float16)
tensor(1.4551, device='cuda:0', dtype=torch.float16) tensor(0.1368, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0092, device='cuda:0')
tensor(0.1287, device='cuda:0')
old_score: tensor(0.1343, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1243, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2496249675750732
Validation after dual ascent:
out_inf: tensor(17.9844, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(1.2891, device='cuda:0', dtype=torch.float16) tensor(0.1250, device='cuda:0', dtype=torch.float16)
tensor(1.2236, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.0527, device='cuda:0', dtype=torch.float16) tensor(0.1281, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.1287, device='cuda:0', dtype=torch.float16)
26 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.2734, device='cuda:0', dtype=torch.float16) tensor(0.4775, device='cuda:0', dtype=torch.float16)
tensor(1.1221, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(1.0410, device='cuda:0', dtype=torch.float16) tensor(0.1227, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.1343, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0170, device='cuda:0')
tensor(0.3550, device='cuda:0')
old_score: tensor(0.1301, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1209, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4982800483703613
Validation after dual ascent:
out_inf: tensor(8.2734, device='cuda:0', dtype=torch.float16) tensor(0.4775, device='cuda:0', dtype=torch.float16)
tensor(1.1934, device='cuda:0', dtype=torch.float16) tensor(0.1218, device='cuda:0', dtype=torch.float16)
tensor(1.0186, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(1.0967, device='cuda:0', dtype=torch.float16) tensor(0.1246, device='cuda:0', dtype=torch.float16)
tensor(1.1426, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
26 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(22.4219, device='cuda:0', dtype=torch.float16) tensor(0.1655, device='cuda:0', dtype=torch.float16)
tensor(0.4346, device='cuda:0', dtype=torch.float16) tensor(0.0440, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(0.5303, device='cuda:0', dtype=torch.float16) tensor(0.0513, device='cuda:0', dtype=torch.float16)
tensor(0.5161, device='cuda:0', dtype=torch.float16) tensor(0.0471, device='cuda:0', dtype=torch.float16)
Converged at iteration 600
tensor(0.0106, device='cuda:0')
tensor(0.0300, device='cuda:0')
old_score: tensor(0.0485, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0446, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 9.171884775161743
Validation after dual ascent:
out_inf: tensor(22.4219, device='cuda:0', dtype=torch.float16) tensor(0.1655, device='cuda:0', dtype=torch.float16)
tensor(0.4622, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.4958, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.5098, device='cuda:0', dtype=torch.float16) tensor(0.0463, device='cuda:0', dtype=torch.float16)
tensor(0.4595, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
26 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.7422, device='cuda:0', dtype=torch.float16) tensor(0.5195, device='cuda:0', dtype=torch.float16)
tensor(0.9902, device='cuda:0', dtype=torch.float16) tensor(0.1061, device='cuda:0', dtype=torch.float16)
tensor(0.9912, device='cuda:0', dtype=torch.float16) tensor(0.0979, device='cuda:0', dtype=torch.float16)
tensor(0.9839, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
tensor(0.9805, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0147, device='cuda:0')
tensor(0.2479, device='cuda:0')
old_score: tensor(0.1050, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0972, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.198576211929321
Validation after dual ascent:
out_inf: tensor(9.7422, device='cuda:0', dtype=torch.float16) tensor(0.5195, device='cuda:0', dtype=torch.float16)
tensor(0.9897, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
tensor(0.9111, device='cuda:0', dtype=torch.float16) tensor(0.0892, device='cuda:0', dtype=torch.float16)
tensor(0.9399, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
26 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.3828, device='cuda:0', dtype=torch.float16) tensor(0.3943, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.1021, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0133, device='cuda:0')
tensor(0.2296, device='cuda:0')
old_score: tensor(0.0989, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0915, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.207425594329834
Validation after dual ascent:
out_inf: tensor(8.3828, device='cuda:0', dtype=torch.float16) tensor(0.3943, device='cuda:0', dtype=torch.float16)
tensor(1.0508, device='cuda:0', dtype=torch.float16) tensor(0.0925, device='cuda:0', dtype=torch.float16)
tensor(0.9863, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0943, device='cuda:0', dtype=torch.float16)
tensor(0.9277, device='cuda:0', dtype=torch.float16) tensor(0.0952, device='cuda:0', dtype=torch.float16)
26 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6562, device='cuda:0', dtype=torch.float16) tensor(0.2285, device='cuda:0', dtype=torch.float16)
tensor(0.7119, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(0.6416, device='cuda:0', dtype=torch.float16) tensor(0.0522, device='cuda:0', dtype=torch.float16)
tensor(0.5684, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.6191, device='cuda:0', dtype=torch.float16) tensor(0.0610, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0118, device='cuda:0')
tensor(0.1877, device='cuda:0')
old_score: tensor(0.0577, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0557, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.358866453170776
Validation after dual ascent:
out_inf: tensor(5.6562, device='cuda:0', dtype=torch.float16) tensor(0.2285, device='cuda:0', dtype=torch.float16)
tensor(0.6763, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.6045, device='cuda:0', dtype=torch.float16) tensor(0.0499, device='cuda:0', dtype=torch.float16)
tensor(0.5518, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
tensor(0.6274, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
layer 26 done
27 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.7422, device='cuda:0', dtype=torch.float16) tensor(0.8335, device='cuda:0', dtype=torch.float16)
tensor(1.4414, device='cuda:0', dtype=torch.float16) tensor(0.1454, device='cuda:0', dtype=torch.float16)
tensor(1.3447, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
tensor(1.3535, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0185, device='cuda:0')
tensor(0.3848, device='cuda:0')
old_score: tensor(0.1443, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1335, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.506746292114258
Validation after dual ascent:
out_inf: tensor(15.7422, device='cuda:0', dtype=torch.float16) tensor(0.8335, device='cuda:0', dtype=torch.float16)
tensor(1.3984, device='cuda:0', dtype=torch.float16) tensor(0.1345, device='cuda:0', dtype=torch.float16)
tensor(1.3350, device='cuda:0', dtype=torch.float16) tensor(0.1230, device='cuda:0', dtype=torch.float16)
tensor(1.2197, device='cuda:0', dtype=torch.float16) tensor(0.1382, device='cuda:0', dtype=torch.float16)
tensor(1.3320, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
27 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.7344, device='cuda:0', dtype=torch.float16) tensor(0.9790, device='cuda:0', dtype=torch.float16)
tensor(1.2959, device='cuda:0', dtype=torch.float16) tensor(0.1461, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.2051, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.1483, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0195, device='cuda:0')
tensor(0.3891, device='cuda:0')
old_score: tensor(0.1454, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1345, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5075907707214355
Validation after dual ascent:
out_inf: tensor(18.7344, device='cuda:0', dtype=torch.float16) tensor(0.9790, device='cuda:0', dtype=torch.float16)
tensor(1.4502, device='cuda:0', dtype=torch.float16) tensor(0.1354, device='cuda:0', dtype=torch.float16)
tensor(1.2002, device='cuda:0', dtype=torch.float16) tensor(0.1240, device='cuda:0', dtype=torch.float16)
tensor(1.2188, device='cuda:0', dtype=torch.float16) tensor(0.1392, device='cuda:0', dtype=torch.float16)
tensor(1.3486, device='cuda:0', dtype=torch.float16) tensor(0.1394, device='cuda:0', dtype=torch.float16)
27 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.2266, device='cuda:0', dtype=torch.float16) tensor(0.4866, device='cuda:0', dtype=torch.float16)
tensor(1.1523, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.2910, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(1.1162, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
tensor(1.1465, device='cuda:0', dtype=torch.float16) tensor(0.1339, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0156, device='cuda:0')
tensor(0.3482, device='cuda:0')
old_score: tensor(0.1311, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1216, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5048563480377197
Validation after dual ascent:
out_inf: tensor(10.2266, device='cuda:0', dtype=torch.float16) tensor(0.4866, device='cuda:0', dtype=torch.float16)
tensor(1.1680, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(1.1436, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(1.0166, device='cuda:0', dtype=torch.float16) tensor(0.1257, device='cuda:0', dtype=torch.float16)
tensor(1.1455, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
27 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.8008, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(0.5039, device='cuda:0', dtype=torch.float16) tensor(0.0289, device='cuda:0', dtype=torch.float16)
tensor(0.4451, device='cuda:0', dtype=torch.float16) tensor(0.0330, device='cuda:0', dtype=torch.float16)
tensor(0.4014, device='cuda:0', dtype=torch.float16) tensor(0.0307, device='cuda:0', dtype=torch.float16)
tensor(0.4834, device='cuda:0', dtype=torch.float16) tensor(0.0325, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0190, device='cuda:0')
tensor(0.1323, device='cuda:0')
old_score: tensor(0.0312, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0290, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7507271766662598
Validation after dual ascent:
out_inf: tensor(5.8008, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(0.4836, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(0.3601, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.4087, device='cuda:0', dtype=torch.float16) tensor(0.0290, device='cuda:0', dtype=torch.float16)
tensor(0.4548, device='cuda:0', dtype=torch.float16) tensor(0.0306, device='cuda:0', dtype=torch.float16)
27 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(11.3203, device='cuda:0', dtype=torch.float16) tensor(0.5488, device='cuda:0', dtype=torch.float16)
tensor(1.0439, device='cuda:0', dtype=torch.float16) tensor(0.1086, device='cuda:0', dtype=torch.float16)
tensor(0.9868, device='cuda:0', dtype=torch.float16) tensor(0.1006, device='cuda:0', dtype=torch.float16)
tensor(1.0762, device='cuda:0', dtype=torch.float16) tensor(0.1114, device='cuda:0', dtype=torch.float16)
tensor(1.0293, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0161, device='cuda:0')
tensor(0.2768, device='cuda:0')
old_score: tensor(0.1076, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0994, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.214318037033081
Validation after dual ascent:
out_inf: tensor(11.3203, device='cuda:0', dtype=torch.float16) tensor(0.5488, device='cuda:0', dtype=torch.float16)
tensor(1.0010, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(0.9771, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
tensor(1.0420, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
tensor(1.0879, device='cuda:0', dtype=torch.float16) tensor(0.1030, device='cuda:0', dtype=torch.float16)
27 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1289, device='cuda:0', dtype=torch.float16) tensor(0.4209, device='cuda:0', dtype=torch.float16)
tensor(0.9648, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(0.9673, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(0.9062, device='cuda:0', dtype=torch.float16) tensor(0.1055, device='cuda:0', dtype=torch.float16)
tensor(0.9624, device='cuda:0', dtype=torch.float16) tensor(0.1044, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0147, device='cuda:0')
tensor(0.2582, device='cuda:0')
old_score: tensor(0.1022, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0944, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.194375991821289
Validation after dual ascent:
out_inf: tensor(7.1289, device='cuda:0', dtype=torch.float16) tensor(0.4209, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
tensor(0.9990, device='cuda:0', dtype=torch.float16) tensor(0.0867, device='cuda:0', dtype=torch.float16)
tensor(0.8667, device='cuda:0', dtype=torch.float16) tensor(0.0976, device='cuda:0', dtype=torch.float16)
tensor(1.0146, device='cuda:0', dtype=torch.float16) tensor(0.0978, device='cuda:0', dtype=torch.float16)
27 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2891, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(0.7021, device='cuda:0', dtype=torch.float16) tensor(0.0631, device='cuda:0', dtype=torch.float16)
tensor(0.6914, device='cuda:0', dtype=torch.float16) tensor(0.0564, device='cuda:0', dtype=torch.float16)
tensor(0.6475, device='cuda:0', dtype=torch.float16) tensor(0.0613, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0142, device='cuda:0')
tensor(0.2243, device='cuda:0')
old_score: tensor(0.0615, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0593, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.27634334564209
Validation after dual ascent:
out_inf: tensor(4.2891, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0610, device='cuda:0', dtype=torch.float16)
tensor(0.6968, device='cuda:0', dtype=torch.float16) tensor(0.0538, device='cuda:0', dtype=torch.float16)
tensor(0.6035, device='cuda:0', dtype=torch.float16) tensor(0.0590, device='cuda:0', dtype=torch.float16)
tensor(0.6729, device='cuda:0', dtype=torch.float16) tensor(0.0632, device='cuda:0', dtype=torch.float16)
layer 27 done
28 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.3672, device='cuda:0', dtype=torch.float16) tensor(0.8496, device='cuda:0', dtype=torch.float16)
tensor(1.2793, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.4033, device='cuda:0', dtype=torch.float16) tensor(0.1335, device='cuda:0', dtype=torch.float16)
tensor(1.8066, device='cuda:0', dtype=torch.float16) tensor(0.1470, device='cuda:0', dtype=torch.float16)
tensor(1.6787, device='cuda:0', dtype=torch.float16) tensor(0.1439, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0141, device='cuda:0')
tensor(0.1166, device='cuda:0')
old_score: tensor(0.1416, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1307, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2550013065338135
Validation after dual ascent:
out_inf: tensor(14.3672, device='cuda:0', dtype=torch.float16) tensor(0.8496, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.1213, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1356, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
28 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.7656, device='cuda:0', dtype=torch.float16) tensor(1.0137, device='cuda:0', dtype=torch.float16)
tensor(1.3379, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
tensor(1.2627, device='cuda:0', dtype=torch.float16) tensor(0.1348, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1482, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0120, device='cuda:0')
tensor(0.1146, device='cuda:0')
old_score: tensor(0.1429, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1318, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2570042610168457
Validation after dual ascent:
out_inf: tensor(20.7656, device='cuda:0', dtype=torch.float16) tensor(1.0137, device='cuda:0', dtype=torch.float16)
tensor(1.2080, device='cuda:0', dtype=torch.float16) tensor(0.1326, device='cuda:0', dtype=torch.float16)
tensor(1.1611, device='cuda:0', dtype=torch.float16) tensor(0.1223, device='cuda:0', dtype=torch.float16)
tensor(1.2373, device='cuda:0', dtype=torch.float16) tensor(0.1368, device='cuda:0', dtype=torch.float16)
tensor(1.2139, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
28 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1172, device='cuda:0', dtype=torch.float16) tensor(0.5239, device='cuda:0', dtype=torch.float16)
tensor(1.1660, device='cuda:0', dtype=torch.float16) tensor(0.1382, device='cuda:0', dtype=torch.float16)
tensor(1.0996, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(1.2090, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0073, device='cuda:0')
tensor(0.0989, device='cuda:0')
old_score: tensor(0.1377, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1274, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.253899574279785
Validation after dual ascent:
out_inf: tensor(7.1172, device='cuda:0', dtype=torch.float16) tensor(0.5239, device='cuda:0', dtype=torch.float16)
tensor(1.2100, device='cuda:0', dtype=torch.float16) tensor(0.1281, device='cuda:0', dtype=torch.float16)
tensor(1.0830, device='cuda:0', dtype=torch.float16) tensor(0.1181, device='cuda:0', dtype=torch.float16)
tensor(1.2363, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.2656, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
28 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(9., device='cuda:0', dtype=torch.float16) tensor(0.1432, device='cuda:0', dtype=torch.float16)
tensor(0.5825, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.5107, device='cuda:0', dtype=torch.float16) tensor(0.0458, device='cuda:0', dtype=torch.float16)
tensor(0.6392, device='cuda:0', dtype=torch.float16) tensor(0.0472, device='cuda:0', dtype=torch.float16)
tensor(0.5596, device='cuda:0', dtype=torch.float16) tensor(0.0465, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0176, device='cuda:0')
tensor(0.0413, device='cuda:0')
old_score: tensor(0.0444, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0412, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.730940103530884
Validation after dual ascent:
out_inf: tensor(9., device='cuda:0', dtype=torch.float16) tensor(0.1432, device='cuda:0', dtype=torch.float16)
tensor(0.5107, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
tensor(0.5337, device='cuda:0', dtype=torch.float16) tensor(0.0415, device='cuda:0', dtype=torch.float16)
tensor(0.6270, device='cuda:0', dtype=torch.float16) tensor(0.0440, device='cuda:0', dtype=torch.float16)
tensor(0.5078, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
28 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.6250, device='cuda:0', dtype=torch.float16) tensor(0.5757, device='cuda:0', dtype=torch.float16)
tensor(0.9946, device='cuda:0', dtype=torch.float16) tensor(0.1106, device='cuda:0', dtype=torch.float16)
tensor(1.0225, device='cuda:0', dtype=torch.float16) tensor(0.1030, device='cuda:0', dtype=torch.float16)
tensor(1.0283, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.0566, device='cuda:0', dtype=torch.float16) tensor(0.1121, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0173, device='cuda:0')
tensor(0.3057, device='cuda:0')
old_score: tensor(0.1098, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1013, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.225064754486084
Validation after dual ascent:
out_inf: tensor(14.6250, device='cuda:0', dtype=torch.float16) tensor(0.5757, device='cuda:0', dtype=torch.float16)
tensor(1.0635, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(0.9648, device='cuda:0', dtype=torch.float16) tensor(0.0930, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1049, device='cuda:0', dtype=torch.float16)
28 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.7812, device='cuda:0', dtype=torch.float16) tensor(0.4607, device='cuda:0', dtype=torch.float16)
tensor(0.9424, device='cuda:0', dtype=torch.float16) tensor(0.1069, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.0994, device='cuda:0', dtype=torch.float16)
tensor(1.0303, device='cuda:0', dtype=torch.float16) tensor(0.1098, device='cuda:0', dtype=torch.float16)
tensor(1.0469, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0162, device='cuda:0')
tensor(0.2904, device='cuda:0')
old_score: tensor(0.1061, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0978, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.233423709869385
Validation after dual ascent:
out_inf: tensor(12.7812, device='cuda:0', dtype=torch.float16) tensor(0.4607, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
tensor(1.0293, device='cuda:0', dtype=torch.float16) tensor(0.0899, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
tensor(1.0811, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
28 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.1016, device='cuda:0', dtype=torch.float16) tensor(0.2874, device='cuda:0', dtype=torch.float16)
tensor(0.8130, device='cuda:0', dtype=torch.float16) tensor(0.0688, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0629, device='cuda:0', dtype=torch.float16)
tensor(0.6904, device='cuda:0', dtype=torch.float16) tensor(0.0683, device='cuda:0', dtype=torch.float16)
tensor(0.8662, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0185, device='cuda:0')
tensor(0.2925, device='cuda:0')
old_score: tensor(0.0679, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0654, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.276421785354614
Validation after dual ascent:
out_inf: tensor(8.1016, device='cuda:0', dtype=torch.float16) tensor(0.2874, device='cuda:0', dtype=torch.float16)
tensor(0.8330, device='cuda:0', dtype=torch.float16) tensor(0.0664, device='cuda:0', dtype=torch.float16)
tensor(0.7651, device='cuda:0', dtype=torch.float16) tensor(0.0599, device='cuda:0', dtype=torch.float16)
tensor(0.6816, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
tensor(0.9424, device='cuda:0', dtype=torch.float16) tensor(0.0698, device='cuda:0', dtype=torch.float16)
layer 28 done
29 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.9219, device='cuda:0', dtype=torch.float16) tensor(0.8223, device='cuda:0', dtype=torch.float16)
tensor(1.8105, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1242, device='cuda:0', dtype=torch.float16)
tensor(1.3369, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(2.1895, device='cuda:0', dtype=torch.float16) tensor(0.1327, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0076, device='cuda:0')
tensor(0.0410, device='cuda:0')
old_score: tensor(0.1312, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1210, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.477161884307861
Validation after dual ascent:
out_inf: tensor(12.9219, device='cuda:0', dtype=torch.float16) tensor(0.8223, device='cuda:0', dtype=torch.float16)
tensor(1.7158, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.3105, device='cuda:0', dtype=torch.float16) tensor(0.1127, device='cuda:0', dtype=torch.float16)
tensor(1.3301, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.8828, device='cuda:0', dtype=torch.float16) tensor(0.1243, device='cuda:0', dtype=torch.float16)
29 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.7812, device='cuda:0', dtype=torch.float16) tensor(1.0439, device='cuda:0', dtype=torch.float16)
tensor(1.1709, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.1252, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1373, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1332, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0198, device='cuda:0')
tensor(0.1001, device='cuda:0')
old_score: tensor(0.1320, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1215, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2466273307800293
Validation after dual ascent:
out_inf: tensor(20.7812, device='cuda:0', dtype=torch.float16) tensor(1.0439, device='cuda:0', dtype=torch.float16)
tensor(1.1123, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
29 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.4922, device='cuda:0', dtype=torch.float16) tensor(0.4988, device='cuda:0', dtype=torch.float16)
tensor(1.2900, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
tensor(1.0908, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.0664, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0180, device='cuda:0')
tensor(0.3502, device='cuda:0')
old_score: tensor(0.1346, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1243, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5006752014160156
Validation after dual ascent:
out_inf: tensor(8.4922, device='cuda:0', dtype=torch.float16) tensor(0.4988, device='cuda:0', dtype=torch.float16)
tensor(1.1318, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
tensor(1.0713, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.1292, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
29 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.6406, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(0.5190, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(0.5674, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.5161, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.5649, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0029, device='cuda:0')
tensor(0.0182, device='cuda:0')
old_score: tensor(0.0457, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0427, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.492565870285034
Validation after dual ascent:
out_inf: tensor(16.6406, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(0.5117, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.5488, device='cuda:0', dtype=torch.float16) tensor(0.0465, device='cuda:0', dtype=torch.float16)
tensor(0.4741, device='cuda:0', dtype=torch.float16) tensor(0.0440, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
29 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(11.6016, device='cuda:0', dtype=torch.float16) tensor(0.5908, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(1.0283, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0182, device='cuda:0')
tensor(0.3266, device='cuda:0')
old_score: tensor(0.1116, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1027, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.193833589553833
Validation after dual ascent:
out_inf: tensor(11.6016, device='cuda:0', dtype=torch.float16) tensor(0.5908, device='cuda:0', dtype=torch.float16)
tensor(1.0430, device='cuda:0', dtype=torch.float16) tensor(0.1035, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0948, device='cuda:0', dtype=torch.float16)
tensor(0.9575, device='cuda:0', dtype=torch.float16) tensor(0.1061, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
29 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.6875, device='cuda:0', dtype=torch.float16) tensor(0.5161, device='cuda:0', dtype=torch.float16)
tensor(1.0391, device='cuda:0', dtype=torch.float16) tensor(0.1095, device='cuda:0', dtype=torch.float16)
tensor(1.0410, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(1.0811, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(1.1084, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0175, device='cuda:0')
tensor(0.3135, device='cuda:0')
old_score: tensor(0.1089, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1002, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.201054096221924
Validation after dual ascent:
out_inf: tensor(9.6875, device='cuda:0', dtype=torch.float16) tensor(0.5161, device='cuda:0', dtype=torch.float16)
tensor(1.0078, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
tensor(1.0596, device='cuda:0', dtype=torch.float16) tensor(0.0924, device='cuda:0', dtype=torch.float16)
tensor(0.9731, device='cuda:0', dtype=torch.float16) tensor(0.1036, device='cuda:0', dtype=torch.float16)
tensor(1.0420, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
29 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(23.4844, device='cuda:0', dtype=torch.float16) tensor(0.3423, device='cuda:0', dtype=torch.float16)
tensor(0.8672, device='cuda:0', dtype=torch.float16) tensor(0.0753, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.7866, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(0.9092, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0032, device='cuda:0')
tensor(0.0409, device='cuda:0')
old_score: tensor(0.0752, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0723, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.051448583602905
Validation after dual ascent:
out_inf: tensor(23.4844, device='cuda:0', dtype=torch.float16) tensor(0.3423, device='cuda:0', dtype=torch.float16)
tensor(0.8281, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
tensor(0.8647, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.7837, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.9419, device='cuda:0', dtype=torch.float16) tensor(0.0768, device='cuda:0', dtype=torch.float16)
layer 29 done
30 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.7109, device='cuda:0', dtype=torch.float16) tensor(0.8638, device='cuda:0', dtype=torch.float16)
tensor(1.2910, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(1.5449, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
tensor(1.2256, device='cuda:0', dtype=torch.float16) tensor(0.1443, device='cuda:0', dtype=torch.float16)
tensor(1.3164, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0095, device='cuda:0')
tensor(0.0826, device='cuda:0')
old_score: tensor(0.1395, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1282, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2488417625427246
Validation after dual ascent:
out_inf: tensor(14.7109, device='cuda:0', dtype=torch.float16) tensor(0.8638, device='cuda:0', dtype=torch.float16)
tensor(1.2139, device='cuda:0', dtype=torch.float16) tensor(0.1290, device='cuda:0', dtype=torch.float16)
tensor(1.3926, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1324, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
30 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.0156, device='cuda:0', dtype=torch.float16)
tensor(1.3291, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
tensor(1.2324, device='cuda:0', dtype=torch.float16) tensor(0.1340, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.1466, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0113, device='cuda:0')
tensor(0.0867, device='cuda:0')
old_score: tensor(0.1416, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1300, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2488858699798584
Validation after dual ascent:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(1.0156, device='cuda:0', dtype=torch.float16)
tensor(1.2939, device='cuda:0', dtype=torch.float16) tensor(0.1307, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.1206, device='cuda:0', dtype=torch.float16)
tensor(1.2168, device='cuda:0', dtype=torch.float16) tensor(0.1346, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1337, device='cuda:0', dtype=torch.float16)
30 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.8984, device='cuda:0', dtype=torch.float16) tensor(0.5610, device='cuda:0', dtype=torch.float16)
tensor(1.2705, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(1.2715, device='cuda:0', dtype=torch.float16) tensor(0.1344, device='cuda:0', dtype=torch.float16)
tensor(1.2402, device='cuda:0', dtype=torch.float16) tensor(0.1469, device='cuda:0', dtype=torch.float16)
tensor(1.2939, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0188, device='cuda:0')
tensor(0.3809, device='cuda:0')
old_score: tensor(0.1421, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1307, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.500277519226074
Validation after dual ascent:
out_inf: tensor(9.8984, device='cuda:0', dtype=torch.float16) tensor(0.5610, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.1317, device='cuda:0', dtype=torch.float16)
tensor(1.2139, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.2188, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
tensor(1.3770, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
30 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(21.1406, device='cuda:0', dtype=torch.float16) tensor(0.1504, device='cuda:0', dtype=torch.float16)
tensor(0.6113, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.7881, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.6016, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0046, device='cuda:0')
tensor(0.0223, device='cuda:0')
old_score: tensor(0.0392, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0366, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4947445392608643
Validation after dual ascent:
out_inf: tensor(21.1406, device='cuda:0', dtype=torch.float16) tensor(0.1504, device='cuda:0', dtype=torch.float16)
tensor(0.5488, device='cuda:0', dtype=torch.float16) tensor(0.0353, device='cuda:0', dtype=torch.float16)
tensor(0.5908, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.5693, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
30 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(34.9062, device='cuda:0', dtype=torch.float16) tensor(0.6455, device='cuda:0', dtype=torch.float16)
tensor(1.1279, device='cuda:0', dtype=torch.float16) tensor(0.1121, device='cuda:0', dtype=torch.float16)
tensor(1.0664, device='cuda:0', dtype=torch.float16) tensor(0.1049, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.0674, device='cuda:0', dtype=torch.float16) tensor(0.1133, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0189, device='cuda:0')
tensor(0.3171, device='cuda:0')
old_score: tensor(0.1115, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1023, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.200150489807129
Validation after dual ascent:
out_inf: tensor(34.9062, device='cuda:0', dtype=torch.float16) tensor(0.6455, device='cuda:0', dtype=torch.float16)
tensor(1.0508, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(1.0410, device='cuda:0', dtype=torch.float16) tensor(0.0943, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1061, device='cuda:0', dtype=torch.float16)
tensor(1.2090, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
30 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(35.4062, device='cuda:0', dtype=torch.float16) tensor(0.5981, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1023, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.1123, device='cuda:0', dtype=torch.float16)
tensor(1.0908, device='cuda:0', dtype=torch.float16) tensor(0.1102, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0183, device='cuda:0')
tensor(0.3029, device='cuda:0')
old_score: tensor(0.1084, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0994, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.201803922653198
Validation after dual ascent:
out_inf: tensor(35.4062, device='cuda:0', dtype=torch.float16) tensor(0.5981, device='cuda:0', dtype=torch.float16)
tensor(0.9248, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(0.9658, device='cuda:0', dtype=torch.float16) tensor(0.0918, device='cuda:0', dtype=torch.float16)
tensor(0.9775, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
30 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1515., device='cuda:0', dtype=torch.float16) tensor(0.5356, device='cuda:0', dtype=torch.float16)
tensor(0.9863, device='cuda:0', dtype=torch.float16) tensor(0.0802, device='cuda:0', dtype=torch.float16)
tensor(1.0264, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
tensor(1.0459, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0159, device='cuda:0')
tensor(0.0800, device='cuda:0')
old_score: tensor(0.0809, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0773, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 16.9634690284729
Validation after dual ascent:
out_inf: tensor(1515., device='cuda:0', dtype=torch.float16) tensor(0.5356, device='cuda:0', dtype=torch.float16)
tensor(1.3799, device='cuda:0', dtype=torch.float16) tensor(0.0768, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.0722, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.0777, device='cuda:0', dtype=torch.float16)
tensor(1.3584, device='cuda:0', dtype=torch.float16) tensor(0.0824, device='cuda:0', dtype=torch.float16)
layer 30 done
31 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.7031, device='cuda:0', dtype=torch.float16) tensor(0.8511, device='cuda:0', dtype=torch.float16)
tensor(2.8750, device='cuda:0', dtype=torch.float16) tensor(0.1140, device='cuda:0', dtype=torch.float16)
tensor(2.3906, device='cuda:0', dtype=torch.float16) tensor(0.1080, device='cuda:0', dtype=torch.float16)
tensor(2.6328, device='cuda:0', dtype=torch.float16) tensor(0.1190, device='cuda:0', dtype=torch.float16)
tensor(2.0234, device='cuda:0', dtype=torch.float16) tensor(0.1149, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0129, device='cuda:0')
tensor(0.2002, device='cuda:0')
old_score: tensor(0.1139, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1035, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5067195892333984
Validation after dual ascent:
out_inf: tensor(19.7031, device='cuda:0', dtype=torch.float16) tensor(0.8511, device='cuda:0', dtype=torch.float16)
tensor(2.7656, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
tensor(2.2891, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
tensor(2.5234, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.9180, device='cuda:0', dtype=torch.float16) tensor(0.1061, device='cuda:0', dtype=torch.float16)
31 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(23.6250, device='cuda:0', dtype=torch.float16) tensor(1.0850, device='cuda:0', dtype=torch.float16)
tensor(2.6094, device='cuda:0', dtype=torch.float16) tensor(0.1166, device='cuda:0', dtype=torch.float16)
tensor(2.1953, device='cuda:0', dtype=torch.float16) tensor(0.1101, device='cuda:0', dtype=torch.float16)
tensor(2.4336, device='cuda:0', dtype=torch.float16) tensor(0.1218, device='cuda:0', dtype=torch.float16)
tensor(1.8789, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0150, device='cuda:0')
tensor(0.2116, device='cuda:0')
old_score: tensor(0.1165, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1058, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.512338399887085
Validation after dual ascent:
out_inf: tensor(23.6250, device='cuda:0', dtype=torch.float16) tensor(1.0850, device='cuda:0', dtype=torch.float16)
tensor(2.3594, device='cuda:0', dtype=torch.float16) tensor(0.1063, device='cuda:0', dtype=torch.float16)
tensor(1.9414, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(1.6426, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
31 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.0352, device='cuda:0', dtype=torch.float16) tensor(0.4277, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.1043, device='cuda:0', dtype=torch.float16)
tensor(0.9375, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(0.9565, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0096, device='cuda:0')
tensor(0.1737, device='cuda:0')
old_score: tensor(0.1040, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0947, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5046939849853516
Validation after dual ascent:
out_inf: tensor(7.0352, device='cuda:0', dtype=torch.float16) tensor(0.4277, device='cuda:0', dtype=torch.float16)
tensor(1.0391, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
tensor(0.8965, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0970, device='cuda:0', dtype=torch.float16)
31 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(129.1250, device='cuda:0', dtype=torch.float16) tensor(0.2478, device='cuda:0', dtype=torch.float16)
tensor(0.5317, device='cuda:0', dtype=torch.float16) tensor(0.0483, device='cuda:0', dtype=torch.float16)
tensor(0.5195, device='cuda:0', dtype=torch.float16) tensor(0.0445, device='cuda:0', dtype=torch.float16)
tensor(0.6387, device='cuda:0', dtype=torch.float16) tensor(0.0452, device='cuda:0', dtype=torch.float16)
tensor(0.5513, device='cuda:0', dtype=torch.float16) tensor(0.0481, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0132, device='cuda:0')
tensor(0.0953, device='cuda:0')
old_score: tensor(0.0465, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0404, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.493152618408203
Validation after dual ascent:
out_inf: tensor(129.1250, device='cuda:0', dtype=torch.float16) tensor(0.2478, device='cuda:0', dtype=torch.float16)
tensor(0.5166, device='cuda:0', dtype=torch.float16) tensor(0.0419, device='cuda:0', dtype=torch.float16)
tensor(0.5645, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
31 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(31.3281, device='cuda:0', dtype=torch.float16) tensor(0.6870, device='cuda:0', dtype=torch.float16)
tensor(1.0430, device='cuda:0', dtype=torch.float16) tensor(0.1020, device='cuda:0', dtype=torch.float16)
tensor(1.1309, device='cuda:0', dtype=torch.float16) tensor(0.0964, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.1060, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0165, device='cuda:0')
tensor(0.1957, device='cuda:0')
old_score: tensor(0.1018, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0922, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.236793518066406
Validation after dual ascent:
out_inf: tensor(31.3281, device='cuda:0', dtype=torch.float16) tensor(0.6870, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(1.1182, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(1.1006, device='cuda:0', dtype=torch.float16) tensor(0.0962, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
31 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(34.4375, device='cuda:0', dtype=torch.float16) tensor(0.7021, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.0979, device='cuda:0', dtype=torch.float16)
tensor(0.8945, device='cuda:0', dtype=torch.float16) tensor(0.0926, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(0.9893, device='cuda:0', dtype=torch.float16) tensor(0.0987, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0158, device='cuda:0')
tensor(0.1844, device='cuda:0')
old_score: tensor(0.0977, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0884, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.238968372344971
Validation after dual ascent:
out_inf: tensor(34.4375, device='cuda:0', dtype=torch.float16) tensor(0.7021, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.0888, device='cuda:0', dtype=torch.float16)
tensor(0.9785, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(0.9834, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
31 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(193.7500, device='cuda:0', dtype=torch.float16) tensor(1.5225, device='cuda:0', dtype=torch.float16)
tensor(1.0479, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(1.2432, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
tensor(0.9941, device='cuda:0', dtype=torch.float16) tensor(0.0877, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.0882, device='cuda:0', dtype=torch.float16)
layer 31 done
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.24it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.24it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.06it/s]
{'model.embed_tokens': 0, 'model.layers.0': 0, 'model.layers.1': 0, 'model.layers.2': 0, 'model.layers.3': 0, 'model.layers.4': 0, 'model.layers.5': 0, 'model.layers.6': 0, 'model.layers.7': 0, 'model.layers.8': 0, 'model.layers.9': 0, 'model.layers.10': 0, 'model.layers.11': 0, 'model.layers.12': 0, 'model.layers.13': 0, 'model.layers.14': 0, 'model.layers.15': 0, 'model.layers.16': 0, 'model.layers.17': 0, 'model.layers.18': 0, 'model.layers.19': 0, 'model.layers.20': 0, 'model.layers.21': 0, 'model.layers.22': 0, 'model.layers.23': 0, 'model.layers.24': 0, 'model.layers.25': 0, 'model.layers.26': 0, 'model.layers.27': 1, 'model.layers.28': 1, 'model.layers.29': 1, 'model.layers.30': 1, 'model.layers.31': 1, 'model.norm': 1, 'model.rotary_emb': 1, 'lm_head': 1}
use device  1
******************************
layer 0 sparsity 0.600001
layer 1 sparsity 0.600001
layer 2 sparsity 0.600001
layer 3 sparsity 0.600001
layer 4 sparsity 0.600001
layer 5 sparsity 0.600001
layer 6 sparsity 0.600001
layer 7 sparsity 0.600001
layer 8 sparsity 0.600001
layer 9 sparsity 0.600001
layer 10 sparsity 0.600001
layer 11 sparsity 0.600001
layer 12 sparsity 0.600001
layer 13 sparsity 0.600001
layer 14 sparsity 0.600001
layer 15 sparsity 0.600001
layer 16 sparsity 0.600001
layer 17 sparsity 0.600001
layer 18 sparsity 0.600001
layer 19 sparsity 0.600001
layer 20 sparsity 0.600001
layer 21 sparsity 0.600001
layer 22 sparsity 0.600001
layer 23 sparsity 0.600001
layer 24 sparsity 0.600001
layer 25 sparsity 0.600001
layer 26 sparsity 0.600001
layer 27 sparsity 0.600001
layer 28 sparsity 0.600001
layer 29 sparsity 0.600001
layer 30 sparsity 0.600001
layer 31 sparsity 0.600001
sparsity sanity check 0.6000
******************************
evaluating on wikitext2
nsamples 83
sample 0
sample 50
wikitext perplexity 9.012979507446289
sparsegpt_dual_3	0.6000	9.0130	256
Namespace(model='/h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf', seed=0, nsamples=256, dual_theld=0.03, n_batch=8, sparsity_ratio=0.6, epsilon=0.02, n_flod=1, sparsity_type='unstructured', prune_method='sparsegpt_dual_3', cache_dir='llm_weights', use_variant=False, save='/h3cstore_ns/jcxie/LISA/nips2024/log', save_model=None, exclude='gate_proj', ww_metric='alpha_peak', ww_metric_cache='/h3cstore_ns/jcxie/LISA/wanda-main/data/llama2-7b-hf', wanda_scale=0.01, ww_epsilon=0.02, mapping_type='block_wise', dual_sp_theld=0.0, Hyper_m=3, Lamda=0.2, eval_zero_shot=0, save_ckpt=0)
2025-04-24 01:14:04.077176: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-24 01:14:04.278763: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-24 01:14:04.284181: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 01:14:04.284209: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2025-04-24 01:14:09.413522: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 01:14:09.414048: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 01:14:09.414067: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
torch 2.3.1+cu121
transformers 4.47.1
accelerate 0.29.1
# of gpus:  2
loading llm model /h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  2.56it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.16it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.05it/s]
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
model.embed_tokens.weight torch.Size([32000, 4096])
model.layers.0.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.0.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.0.input_layernorm.weight torch.Size([4096])
model.layers.0.post_attention_layernorm.weight torch.Size([4096])
model.layers.1.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.1.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.1.input_layernorm.weight torch.Size([4096])
model.layers.1.post_attention_layernorm.weight torch.Size([4096])
model.layers.2.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.2.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.2.input_layernorm.weight torch.Size([4096])
model.layers.2.post_attention_layernorm.weight torch.Size([4096])
model.layers.3.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.3.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.3.input_layernorm.weight torch.Size([4096])
model.layers.3.post_attention_layernorm.weight torch.Size([4096])
model.layers.4.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.4.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.4.input_layernorm.weight torch.Size([4096])
model.layers.4.post_attention_layernorm.weight torch.Size([4096])
model.layers.5.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.5.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.5.input_layernorm.weight torch.Size([4096])
model.layers.5.post_attention_layernorm.weight torch.Size([4096])
model.layers.6.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.6.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.6.input_layernorm.weight torch.Size([4096])
model.layers.6.post_attention_layernorm.weight torch.Size([4096])
model.layers.7.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.7.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.7.input_layernorm.weight torch.Size([4096])
model.layers.7.post_attention_layernorm.weight torch.Size([4096])
model.layers.8.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.8.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.8.input_layernorm.weight torch.Size([4096])
model.layers.8.post_attention_layernorm.weight torch.Size([4096])
model.layers.9.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.9.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.9.input_layernorm.weight torch.Size([4096])
model.layers.9.post_attention_layernorm.weight torch.Size([4096])
model.layers.10.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.10.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.10.input_layernorm.weight torch.Size([4096])
model.layers.10.post_attention_layernorm.weight torch.Size([4096])
model.layers.11.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.11.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.11.input_layernorm.weight torch.Size([4096])
model.layers.11.post_attention_layernorm.weight torch.Size([4096])
model.layers.12.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.12.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.12.input_layernorm.weight torch.Size([4096])
model.layers.12.post_attention_layernorm.weight torch.Size([4096])
model.layers.13.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.13.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.13.input_layernorm.weight torch.Size([4096])
model.layers.13.post_attention_layernorm.weight torch.Size([4096])
model.layers.14.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.14.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.14.input_layernorm.weight torch.Size([4096])
model.layers.14.post_attention_layernorm.weight torch.Size([4096])
model.layers.15.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.15.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.15.input_layernorm.weight torch.Size([4096])
model.layers.15.post_attention_layernorm.weight torch.Size([4096])
model.layers.16.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.16.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.16.input_layernorm.weight torch.Size([4096])
model.layers.16.post_attention_layernorm.weight torch.Size([4096])
model.layers.17.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.17.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.17.input_layernorm.weight torch.Size([4096])
model.layers.17.post_attention_layernorm.weight torch.Size([4096])
model.layers.18.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.18.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.18.input_layernorm.weight torch.Size([4096])
model.layers.18.post_attention_layernorm.weight torch.Size([4096])
model.layers.19.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.19.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.19.input_layernorm.weight torch.Size([4096])
model.layers.19.post_attention_layernorm.weight torch.Size([4096])
model.layers.20.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.20.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.20.input_layernorm.weight torch.Size([4096])
model.layers.20.post_attention_layernorm.weight torch.Size([4096])
model.layers.21.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.21.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.21.input_layernorm.weight torch.Size([4096])
model.layers.21.post_attention_layernorm.weight torch.Size([4096])
model.layers.22.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.22.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.22.input_layernorm.weight torch.Size([4096])
model.layers.22.post_attention_layernorm.weight torch.Size([4096])
model.layers.23.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.23.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.23.input_layernorm.weight torch.Size([4096])
model.layers.23.post_attention_layernorm.weight torch.Size([4096])
model.layers.24.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.24.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.24.input_layernorm.weight torch.Size([4096])
model.layers.24.post_attention_layernorm.weight torch.Size([4096])
model.layers.25.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.25.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.25.input_layernorm.weight torch.Size([4096])
model.layers.25.post_attention_layernorm.weight torch.Size([4096])
model.layers.26.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.26.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.26.input_layernorm.weight torch.Size([4096])
model.layers.26.post_attention_layernorm.weight torch.Size([4096])
model.layers.27.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.27.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.27.input_layernorm.weight torch.Size([4096])
model.layers.27.post_attention_layernorm.weight torch.Size([4096])
model.layers.28.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.28.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.28.input_layernorm.weight torch.Size([4096])
model.layers.28.post_attention_layernorm.weight torch.Size([4096])
model.layers.29.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.29.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.29.input_layernorm.weight torch.Size([4096])
model.layers.29.post_attention_layernorm.weight torch.Size([4096])
model.layers.30.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.30.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.30.input_layernorm.weight torch.Size([4096])
model.layers.30.post_attention_layernorm.weight torch.Size([4096])
model.layers.31.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.31.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.31.input_layernorm.weight torch.Size([4096])
model.layers.31.post_attention_layernorm.weight torch.Size([4096])
model.norm.weight torch.Size([4096])
lm_head.weight torch.Size([32000, 4096])
use device  cpu
loading calibdation data
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<03:21,  1.26it/s]  1%|          | 2/256 [00:01<03:13,  1.31it/s]  2%|▏         | 4/256 [00:01<01:37,  2.58it/s]  2%|▏         | 5/256 [00:02<01:54,  2.19it/s]  2%|▏         | 6/256 [00:02<01:32,  2.72it/s]  3%|▎         | 7/256 [00:03<02:01,  2.04it/s]  3%|▎         | 8/256 [00:03<01:33,  2.65it/s]  4%|▎         | 9/256 [00:03<01:12,  3.40it/s]  4%|▍         | 11/256 [00:03<00:48,  5.08it/s]  5%|▍         | 12/256 [00:03<00:43,  5.55it/s]  5%|▌         | 13/256 [00:04<01:30,  2.68it/s]  5%|▌         | 14/256 [00:05<01:28,  2.73it/s]  6%|▌         | 15/256 [00:05<01:15,  3.21it/s]  6%|▋         | 16/256 [00:05<01:05,  3.67it/s]  7%|▋         | 18/256 [00:06<01:08,  3.46it/s]  8%|▊         | 20/256 [00:06<00:51,  4.58it/s]  8%|▊         | 21/256 [00:06<00:45,  5.18it/s]  9%|▊         | 22/256 [00:06<00:48,  4.84it/s]  9%|▉         | 24/256 [00:07<00:41,  5.53it/s] 10%|▉         | 25/256 [00:07<00:40,  5.76it/s] 10%|█         | 26/256 [00:07<00:52,  4.35it/s] 11%|█         | 28/256 [00:07<00:44,  5.16it/s] 11%|█▏        | 29/256 [00:08<00:45,  4.95it/s] 12%|█▏        | 31/256 [00:08<00:38,  5.85it/s] 12%|█▎        | 32/256 [00:08<00:46,  4.82it/s] 13%|█▎        | 33/256 [00:09<00:58,  3.83it/s] 13%|█▎        | 34/256 [00:09<01:01,  3.58it/s] 14%|█▎        | 35/256 [00:09<01:09,  3.18it/s] 14%|█▍        | 36/256 [00:10<01:20,  2.75it/s] 14%|█▍        | 37/256 [00:10<01:14,  2.94it/s] 15%|█▍        | 38/256 [00:10<01:08,  3.17it/s] 16%|█▌        | 40/256 [00:11<01:04,  3.36it/s] 16%|█▋        | 42/256 [00:11<00:45,  4.75it/s] 17%|█▋        | 43/256 [00:11<00:40,  5.32it/s] 17%|█▋        | 44/256 [00:11<00:39,  5.35it/s] 18%|█▊        | 45/256 [00:11<00:34,  6.05it/s] 18%|█▊        | 46/256 [00:12<00:33,  6.31it/s] 18%|█▊        | 47/256 [00:12<00:34,  6.10it/s] 19%|█▉        | 48/256 [00:12<00:37,  5.49it/s] 19%|█▉        | 49/256 [00:12<00:33,  6.11it/s] 20%|█▉        | 50/256 [00:13<00:49,  4.14it/s] 21%|██        | 53/256 [00:13<00:48,  4.21it/s] 21%|██        | 54/256 [00:13<00:47,  4.26it/s] 21%|██▏       | 55/256 [00:14<00:41,  4.89it/s] 22%|██▏       | 56/256 [00:14<00:48,  4.13it/s] 22%|██▏       | 57/256 [00:14<00:44,  4.50it/s] 23%|██▎       | 58/256 [00:14<00:49,  4.01it/s] 23%|██▎       | 59/256 [00:15<00:43,  4.57it/s] 23%|██▎       | 60/256 [00:15<00:46,  4.23it/s] 24%|██▍       | 61/256 [00:15<00:53,  3.63it/s] 24%|██▍       | 62/256 [00:16<00:58,  3.31it/s] 25%|██▍       | 63/256 [00:16<00:50,  3.79it/s] 25%|██▌       | 64/256 [00:16<00:42,  4.56it/s] 25%|██▌       | 65/256 [00:17<01:09,  2.76it/s] 26%|██▌       | 67/256 [00:17<00:44,  4.28it/s] 27%|██▋       | 68/256 [00:17<00:42,  4.40it/s] 27%|██▋       | 69/256 [00:17<00:43,  4.31it/s] 28%|██▊       | 71/256 [00:17<00:33,  5.47it/s] 29%|██▊       | 73/256 [00:18<00:27,  6.78it/s] 29%|██▉       | 74/256 [00:18<00:26,  6.84it/s] 29%|██▉       | 75/256 [00:18<00:31,  5.73it/s] 30%|██▉       | 76/256 [00:18<00:44,  4.09it/s] 30%|███       | 78/256 [00:19<00:30,  5.89it/s] 31%|███       | 79/256 [00:19<00:37,  4.68it/s] 31%|███▏      | 80/256 [00:19<00:48,  3.62it/s] 32%|███▏      | 81/256 [00:20<00:54,  3.24it/s] 32%|███▏      | 82/256 [00:20<00:44,  3.90it/s] 32%|███▏      | 83/256 [00:20<00:54,  3.15it/s] 33%|███▎      | 84/256 [00:21<00:51,  3.32it/s] 33%|███▎      | 85/256 [00:21<00:47,  3.61it/s] 34%|███▎      | 86/256 [00:21<00:43,  3.93it/s] 34%|███▍      | 87/256 [00:22<01:00,  2.79it/s] 34%|███▍      | 88/256 [00:22<01:02,  2.67it/s] 35%|███▍      | 89/256 [00:22<00:57,  2.88it/s] 35%|███▌      | 90/256 [00:23<00:59,  2.80it/s] 36%|███▌      | 91/256 [00:23<00:57,  2.88it/s] 36%|███▌      | 92/256 [00:23<00:48,  3.37it/s] 36%|███▋      | 93/256 [00:23<00:42,  3.82it/s] 37%|███▋      | 94/256 [00:24<00:50,  3.20it/s] 37%|███▋      | 95/256 [00:24<01:04,  2.51it/s] 38%|███▊      | 96/256 [00:25<00:51,  3.13it/s] 38%|███▊      | 97/256 [00:25<00:55,  2.87it/s] 38%|███▊      | 98/256 [00:25<00:46,  3.42it/s] 39%|███▊      | 99/256 [00:25<00:45,  3.48it/s] 39%|███▉      | 100/256 [00:26<00:43,  3.62it/s] 39%|███▉      | 101/256 [00:27<01:16,  2.04it/s] 40%|███▉      | 102/256 [00:27<01:05,  2.36it/s] 41%|████      | 104/256 [00:27<00:41,  3.66it/s] 41%|████▏     | 106/256 [00:27<00:33,  4.41it/s] 42%|████▏     | 107/256 [00:28<00:33,  4.42it/s] 42%|████▏     | 108/256 [00:28<00:48,  3.07it/s] 43%|████▎     | 110/256 [00:28<00:31,  4.64it/s] 43%|████▎     | 111/256 [00:29<00:30,  4.72it/s] 44%|████▍     | 112/256 [00:29<00:32,  4.45it/s] 44%|████▍     | 113/256 [00:29<00:32,  4.46it/s] 45%|████▍     | 114/256 [00:29<00:29,  4.87it/s] 45%|████▍     | 115/256 [00:29<00:27,  5.10it/s] 45%|████▌     | 116/256 [00:30<00:39,  3.56it/s] 46%|████▌     | 117/256 [00:30<00:32,  4.30it/s] 46%|████▌     | 118/256 [00:30<00:30,  4.59it/s] 47%|████▋     | 120/256 [00:30<00:20,  6.50it/s] 47%|████▋     | 121/256 [00:31<00:19,  6.87it/s] 48%|████▊     | 122/256 [00:31<00:37,  3.60it/s] 48%|████▊     | 123/256 [00:32<00:40,  3.28it/s] 48%|████▊     | 124/256 [00:32<00:52,  2.49it/s] 49%|████▉     | 125/256 [00:33<01:22,  1.58it/s] 49%|████▉     | 126/256 [00:34<01:09,  1.88it/s] 50%|████▉     | 127/256 [00:34<01:15,  1.71it/s] 50%|█████     | 129/256 [00:35<00:45,  2.77it/s] 51%|█████     | 130/256 [00:35<00:41,  3.02it/s] 51%|█████     | 131/256 [00:35<00:39,  3.18it/s] 52%|█████▏    | 132/256 [00:35<00:38,  3.26it/s] 52%|█████▏    | 133/256 [00:36<00:45,  2.68it/s] 52%|█████▏    | 134/256 [00:36<00:45,  2.70it/s] 53%|█████▎    | 135/256 [00:36<00:36,  3.33it/s] 53%|█████▎    | 136/256 [00:37<00:36,  3.31it/s] 54%|█████▎    | 137/256 [00:37<00:30,  3.93it/s] 54%|█████▍    | 138/256 [00:37<00:26,  4.45it/s] 54%|█████▍    | 139/256 [00:37<00:24,  4.76it/s] 55%|█████▍    | 140/256 [00:37<00:23,  5.03it/s] 55%|█████▌    | 141/256 [00:38<00:19,  5.81it/s] 55%|█████▌    | 142/256 [00:38<00:17,  6.42it/s] 56%|█████▌    | 143/256 [00:38<00:17,  6.63it/s] 57%|█████▋    | 145/256 [00:39<00:37,  2.96it/s] 57%|█████▋    | 146/256 [00:39<00:40,  2.71it/s] 57%|█████▋    | 147/256 [00:40<00:36,  2.97it/s] 58%|█████▊    | 148/256 [00:40<00:37,  2.90it/s] 59%|█████▊    | 150/256 [00:40<00:29,  3.60it/s] 59%|█████▉    | 151/256 [00:40<00:25,  4.16it/s] 59%|█████▉    | 152/256 [00:41<00:29,  3.58it/s] 60%|█████▉    | 153/256 [00:41<00:25,  4.00it/s] 60%|██████    | 154/256 [00:41<00:30,  3.39it/s] 61%|██████    | 155/256 [00:42<00:26,  3.78it/s] 61%|██████    | 156/256 [00:42<00:22,  4.50it/s] 61%|██████▏   | 157/256 [00:42<00:27,  3.62it/s] 62%|██████▏   | 158/256 [00:42<00:23,  4.13it/s] 62%|██████▏   | 159/256 [00:43<00:42,  2.30it/s] 62%|██████▎   | 160/256 [00:43<00:32,  2.94it/s] 63%|██████▎   | 162/256 [00:44<00:37,  2.48it/s] 64%|██████▎   | 163/256 [00:45<00:35,  2.59it/s] 64%|██████▍   | 164/256 [00:45<00:31,  2.96it/s] 65%|██████▍   | 166/256 [00:45<00:28,  3.15it/s] 65%|██████▌   | 167/256 [00:46<00:33,  2.66it/s] 66%|██████▌   | 168/256 [00:47<00:39,  2.25it/s] 66%|██████▌   | 169/256 [00:47<00:39,  2.20it/s] 66%|██████▋   | 170/256 [00:47<00:37,  2.30it/s] 67%|██████▋   | 172/256 [00:48<00:25,  3.32it/s] 68%|██████▊   | 173/256 [00:48<00:23,  3.53it/s] 68%|██████▊   | 174/256 [00:49<00:30,  2.73it/s] 68%|██████▊   | 175/256 [00:50<00:41,  1.94it/s] 69%|██████▉   | 176/256 [00:50<00:36,  2.18it/s] 69%|██████▉   | 177/256 [00:50<00:29,  2.63it/s] 70%|██████▉   | 179/256 [00:50<00:20,  3.80it/s] 70%|███████   | 180/256 [00:51<00:37,  2.01it/s] 71%|███████   | 181/256 [00:52<00:29,  2.50it/s] 71%|███████   | 182/256 [00:52<00:38,  1.93it/s] 72%|███████▏  | 184/256 [00:53<00:35,  2.01it/s] 73%|███████▎  | 186/256 [00:54<00:24,  2.90it/s] 73%|███████▎  | 187/256 [00:54<00:27,  2.49it/s] 73%|███████▎  | 188/256 [00:54<00:24,  2.83it/s] 74%|███████▍  | 189/256 [00:55<00:23,  2.89it/s] 74%|███████▍  | 190/256 [00:55<00:21,  3.08it/s] 75%|███████▍  | 191/256 [00:55<00:19,  3.36it/s] 75%|███████▌  | 192/256 [00:56<00:22,  2.81it/s] 75%|███████▌  | 193/256 [00:56<00:21,  2.93it/s] 77%|███████▋  | 196/256 [00:56<00:13,  4.43it/s] 77%|███████▋  | 197/256 [00:57<00:15,  3.79it/s] 78%|███████▊  | 199/256 [00:57<00:11,  4.84it/s] 79%|███████▊  | 201/256 [00:57<00:10,  5.41it/s] 79%|███████▉  | 202/256 [00:58<00:11,  4.53it/s] 80%|███████▉  | 204/256 [00:58<00:09,  5.77it/s] 80%|████████  | 206/256 [00:58<00:07,  7.14it/s] 81%|████████  | 207/256 [00:58<00:06,  7.49it/s] 81%|████████▏ | 208/256 [00:58<00:07,  6.36it/s] 82%|████████▏ | 210/256 [00:58<00:05,  8.44it/s] 83%|████████▎ | 212/256 [00:59<00:05,  7.99it/s] 83%|████████▎ | 213/256 [00:59<00:06,  7.12it/s] 84%|████████▎ | 214/256 [00:59<00:07,  5.46it/s] 84%|████████▍ | 215/256 [01:00<00:09,  4.38it/s] 84%|████████▍ | 216/256 [01:00<00:09,  4.31it/s] 85%|████████▌ | 218/256 [01:00<00:07,  5.15it/s] 86%|████████▌ | 219/256 [01:01<00:14,  2.53it/s] 86%|████████▌ | 220/256 [01:01<00:12,  2.98it/s] 86%|████████▋ | 221/256 [01:02<00:12,  2.88it/s] 87%|████████▋ | 222/256 [01:02<00:11,  2.86it/s] 87%|████████▋ | 223/256 [01:03<00:12,  2.72it/s] 88%|████████▊ | 224/256 [01:04<00:24,  1.33it/s] 88%|████████▊ | 225/256 [01:05<00:22,  1.36it/s] 88%|████████▊ | 226/256 [01:05<00:17,  1.76it/s] 89%|████████▊ | 227/256 [01:05<00:13,  2.10it/s] 89%|████████▉ | 228/256 [01:06<00:12,  2.23it/s] 89%|████████▉ | 229/256 [01:07<00:18,  1.44it/s] 90%|████████▉ | 230/256 [01:07<00:13,  1.90it/s] 90%|█████████ | 231/256 [01:08<00:12,  1.95it/s] 91%|█████████ | 232/256 [01:08<00:10,  2.20it/s] 91%|█████████ | 233/256 [01:08<00:08,  2.65it/s] 92%|█████████▏| 235/256 [01:08<00:05,  3.67it/s] 92%|█████████▏| 236/256 [01:09<00:05,  3.57it/s] 93%|█████████▎| 237/256 [01:09<00:04,  3.97it/s] 93%|█████████▎| 238/256 [01:09<00:03,  4.63it/s] 93%|█████████▎| 239/256 [01:09<00:03,  4.59it/s] 94%|█████████▍| 241/256 [01:09<00:02,  5.85it/s] 95%|█████████▍| 242/256 [01:10<00:04,  2.87it/s] 95%|█████████▌| 244/256 [01:10<00:02,  4.39it/s] 96%|█████████▌| 245/256 [01:11<00:02,  4.24it/s] 96%|█████████▌| 246/256 [01:11<00:02,  4.72it/s] 97%|█████████▋| 248/256 [01:11<00:01,  6.43it/s] 97%|█████████▋| 249/256 [01:12<00:01,  3.84it/s] 98%|█████████▊| 251/256 [01:12<00:00,  5.31it/s] 98%|█████████▊| 252/256 [01:12<00:01,  3.47it/s] 99%|█████████▉| 253/256 [01:13<00:01,  2.95it/s]100%|█████████▉| 255/256 [01:14<00:00,  3.07it/s]100%|██████████| 256/256 [01:14<00:00,  3.07it/s]100%|██████████| 256/256 [01:14<00:00,  3.44it/s]
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
dataset loading complete
0 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8555, device='cuda:0', dtype=torch.float16) tensor(0.6099, device='cuda:0', dtype=torch.float16)
tensor(0.0254, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0449, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0527, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
tensor(0.0371, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
0 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.0386, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0479, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0674, device='cuda:0', dtype=torch.float16) tensor(0.0017, device='cuda:0', dtype=torch.float16)
tensor(0.0479, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
0 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.0217, device='cuda:0', dtype=torch.float16) tensor(0.0014, device='cuda:0', dtype=torch.float16)
tensor(0.0190, device='cuda:0', dtype=torch.float16) tensor(0.0014, device='cuda:0', dtype=torch.float16)
tensor(0.0260, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0183, device='cuda:0', dtype=torch.float16) tensor(0.0014, device='cuda:0', dtype=torch.float16)
tensor(0.0381, device='cuda:0')
old_score: tensor(0.0014, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0011, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.004220962524414
Validation after dual ascent:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.0176, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0171, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0212, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
tensor(0.0170, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
0 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0160, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0143, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0145, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0154, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0204, device='cuda:0')
old_score: tensor(0.0007, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0005, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.07265043258667
Validation after dual ascent:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0126, device='cuda:0', dtype=torch.float16) tensor(0.0005, device='cuda:0', dtype=torch.float16)
tensor(0.0128, device='cuda:0', dtype=torch.float16) tensor(0.0006, device='cuda:0', dtype=torch.float16)
tensor(0.0118, device='cuda:0', dtype=torch.float16) tensor(0.0005, device='cuda:0', dtype=torch.float16)
tensor(0.0164, device='cuda:0', dtype=torch.float16) tensor(0.0005, device='cuda:0', dtype=torch.float16)
0 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.2900, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
tensor(0.2759, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
tensor(0.2773, device='cuda:0', dtype=torch.float16) tensor(0.0100, device='cuda:0', dtype=torch.float16)
tensor(0.2710, device='cuda:0', dtype=torch.float16) tensor(0.0091, device='cuda:0', dtype=torch.float16)
Converged at iteration 800
tensor(0.0145, device='cuda:0')
tensor(0.0242, device='cuda:0')
old_score: tensor(0.0092, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0075, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.549320220947266
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.2666, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(0.2480, device='cuda:0', dtype=torch.float16) tensor(0.0070, device='cuda:0', dtype=torch.float16)
tensor(0.2708, device='cuda:0', dtype=torch.float16) tensor(0.0083, device='cuda:0', dtype=torch.float16)
tensor(0.2368, device='cuda:0', dtype=torch.float16) tensor(0.0074, device='cuda:0', dtype=torch.float16)
0 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.2681, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.2690, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.3125, device='cuda:0', dtype=torch.float16) tensor(0.0099, device='cuda:0', dtype=torch.float16)
tensor(0.2324, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
Converged at iteration 800
tensor(0.0143, device='cuda:0')
tensor(0.0239, device='cuda:0')
old_score: tensor(0.0091, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0074, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.628501176834106
Validation after dual ascent:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.2402, device='cuda:0', dtype=torch.float16) tensor(0.0071, device='cuda:0', dtype=torch.float16)
tensor(0.2207, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.2969, device='cuda:0', dtype=torch.float16) tensor(0.0082, device='cuda:0', dtype=torch.float16)
tensor(0.2021, device='cuda:0', dtype=torch.float16) tensor(0.0073, device='cuda:0', dtype=torch.float16)
0 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0223, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0259, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
tensor(0.0269, device='cuda:0', dtype=torch.float16) tensor(0.0014, device='cuda:0', dtype=torch.float16)
tensor(0.0321, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
tensor(0.0779, device='cuda:0')
old_score: tensor(0.0013, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0011, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.02083015441895
Validation after dual ascent:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0212, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0231, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0261, device='cuda:0', dtype=torch.float16) tensor(0.0013, device='cuda:0', dtype=torch.float16)
tensor(0.0295, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
layer 0 done
1 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.2500, device='cuda:0', dtype=torch.float16) tensor(0.7856, device='cuda:0', dtype=torch.float16)
tensor(0.4590, device='cuda:0', dtype=torch.float16) tensor(0.0120, device='cuda:0', dtype=torch.float16)
tensor(0.4639, device='cuda:0', dtype=torch.float16) tensor(0.0122, device='cuda:0', dtype=torch.float16)
tensor(0.4780, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
tensor(0.4678, device='cuda:0', dtype=torch.float16) tensor(0.0122, device='cuda:0', dtype=torch.float16)
1 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.6445, device='cuda:0', dtype=torch.float16) tensor(0.7910, device='cuda:0', dtype=torch.float16)
tensor(0.5234, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.5356, device='cuda:0', dtype=torch.float16) tensor(0.0138, device='cuda:0', dtype=torch.float16)
tensor(0.5293, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
1 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.6299, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.0859, device='cuda:0', dtype=torch.float16) tensor(0.0053, device='cuda:0', dtype=torch.float16)
tensor(0.0856, device='cuda:0', dtype=torch.float16) tensor(0.0053, device='cuda:0', dtype=torch.float16)
tensor(0.1074, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.0850, device='cuda:0', dtype=torch.float16) tensor(0.0053, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0166, device='cuda:0')
tensor(0.0258, device='cuda:0')
old_score: tensor(0.0054, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0045, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.39476990699768
Validation after dual ascent:
out_inf: tensor(1.6299, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.0715, device='cuda:0', dtype=torch.float16) tensor(0.0043, device='cuda:0', dtype=torch.float16)
tensor(0.0712, device='cuda:0', dtype=torch.float16) tensor(0.0043, device='cuda:0', dtype=torch.float16)
tensor(0.1060, device='cuda:0', dtype=torch.float16) tensor(0.0048, device='cuda:0', dtype=torch.float16)
tensor(0.0706, device='cuda:0', dtype=torch.float16) tensor(0.0044, device='cuda:0', dtype=torch.float16)
1 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.5669, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
tensor(0.0344, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0347, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0425, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0360, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0255, device='cuda:0')
old_score: tensor(0.0022, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0021, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.087031364440918
Validation after dual ascent:
out_inf: tensor(0.5669, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
tensor(0.0337, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.0358, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.0346, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0334, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
1 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(43.6875, device='cuda:0', dtype=torch.float16) tensor(0.0948, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0205, device='cuda:0', dtype=torch.float16)
tensor(0.4189, device='cuda:0', dtype=torch.float16) tensor(0.0205, device='cuda:0', dtype=torch.float16)
tensor(0.4678, device='cuda:0', dtype=torch.float16) tensor(0.0222, device='cuda:0', dtype=torch.float16)
tensor(0.4453, device='cuda:0', dtype=torch.float16) tensor(0.0207, device='cuda:0', dtype=torch.float16)
tensor(0.0288, device='cuda:0')
old_score: tensor(0.0210, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0178, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.31170630455017
Validation after dual ascent:
out_inf: tensor(43.6875, device='cuda:0', dtype=torch.float16) tensor(0.0948, device='cuda:0', dtype=torch.float16)
tensor(0.3008, device='cuda:0', dtype=torch.float16) tensor(0.0173, device='cuda:0', dtype=torch.float16)
tensor(0.3857, device='cuda:0', dtype=torch.float16) tensor(0.0171, device='cuda:0', dtype=torch.float16)
tensor(0.4092, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.4014, device='cuda:0', dtype=torch.float16) tensor(0.0177, device='cuda:0', dtype=torch.float16)
1 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(37.6250, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.3799, device='cuda:0', dtype=torch.float16) tensor(0.0191, device='cuda:0', dtype=torch.float16)
tensor(0.3760, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.3594, device='cuda:0', dtype=torch.float16) tensor(0.0206, device='cuda:0', dtype=torch.float16)
tensor(0.3857, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0181, device='cuda:0')
tensor(0.0288, device='cuda:0')
old_score: tensor(0.0195, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0166, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 33.58413338661194
Validation after dual ascent:
out_inf: tensor(37.6250, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.3247, device='cuda:0', dtype=torch.float16) tensor(0.0162, device='cuda:0', dtype=torch.float16)
tensor(0.3311, device='cuda:0', dtype=torch.float16) tensor(0.0160, device='cuda:0', dtype=torch.float16)
tensor(0.4224, device='cuda:0', dtype=torch.float16) tensor(0.0177, device='cuda:0', dtype=torch.float16)
tensor(0.3867, device='cuda:0', dtype=torch.float16) tensor(0.0166, device='cuda:0', dtype=torch.float16)
1 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2666., device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.1250, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.2500, device='cuda:0', dtype=torch.float16) tensor(0.0048, device='cuda:0', dtype=torch.float16)
tensor(0.1095, device='cuda:0', dtype=torch.float16) tensor(0.0057, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0049, device='cuda:0', dtype=torch.float16)
tensor(804.5793, device='cuda:0')
old_score: tensor(0.0051, device='cuda:0', dtype=torch.float16) new_score: tensor(inf, device='cuda:0', dtype=torch.float16)
Not converged!
Dual ascent finished!
Time: 99.89012885093689
Validation after dual ascent:
out_inf: tensor(2666., device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.1250, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.2500, device='cuda:0', dtype=torch.float16) tensor(0.0048, device='cuda:0', dtype=torch.float16)
tensor(0.1095, device='cuda:0', dtype=torch.float16) tensor(0.0057, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0049, device='cuda:0', dtype=torch.float16)
layer 1 done
2 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.5703, device='cuda:0', dtype=torch.float16) tensor(0.9219, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.7217, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.7930, device='cuda:0', dtype=torch.float16) tensor(0.0529, device='cuda:0', dtype=torch.float16)
tensor(0.6172, device='cuda:0', dtype=torch.float16) tensor(0.0491, device='cuda:0', dtype=torch.float16)
2 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.0312, device='cuda:0', dtype=torch.float16) tensor(1.0781, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.0485, device='cuda:0', dtype=torch.float16)
tensor(0.7905, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(1.0527, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
2 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.8125, device='cuda:0', dtype=torch.float16) tensor(0.1284, device='cuda:0', dtype=torch.float16)
tensor(0.2817, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(0.3103, device='cuda:0', dtype=torch.float16) tensor(0.0293, device='cuda:0', dtype=torch.float16)
tensor(0.2822, device='cuda:0', dtype=torch.float16) tensor(0.0321, device='cuda:0', dtype=torch.float16)
tensor(0.3313, device='cuda:0', dtype=torch.float16) tensor(0.0298, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0169, device='cuda:0')
tensor(0.0192, device='cuda:0')
old_score: tensor(0.0302, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0264, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4771358966827393
Validation after dual ascent:
out_inf: tensor(2.8125, device='cuda:0', dtype=torch.float16) tensor(0.1284, device='cuda:0', dtype=torch.float16)
tensor(0.3113, device='cuda:0', dtype=torch.float16) tensor(0.0257, device='cuda:0', dtype=torch.float16)
tensor(0.2974, device='cuda:0', dtype=torch.float16) tensor(0.0252, device='cuda:0', dtype=torch.float16)
tensor(0.3018, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
tensor(0.3447, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
2 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.0703, device='cuda:0', dtype=torch.float16) tensor(0.0085, device='cuda:0', dtype=torch.float16)
tensor(0.0435, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0414, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0463, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.0421, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
tensor(0.0466, device='cuda:0')
old_score: tensor(0.0025, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0023, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.152992010116577
Validation after dual ascent:
out_inf: tensor(1.0703, device='cuda:0', dtype=torch.float16) tensor(0.0085, device='cuda:0', dtype=torch.float16)
tensor(0.0438, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0399, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0418, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0422, device='cuda:0', dtype=torch.float16) tensor(0.0023, device='cuda:0', dtype=torch.float16)
2 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2305, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(0.3301, device='cuda:0', dtype=torch.float16) tensor(0.0320, device='cuda:0', dtype=torch.float16)
tensor(0.3674, device='cuda:0', dtype=torch.float16) tensor(0.0311, device='cuda:0', dtype=torch.float16)
tensor(0.3245, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.3604, device='cuda:0', dtype=torch.float16) tensor(0.0323, device='cuda:0', dtype=torch.float16)
tensor(0.0276, device='cuda:0')
old_score: tensor(0.0325, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0293, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.30630850791931
Validation after dual ascent:
out_inf: tensor(2.2305, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(0.3262, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.3596, device='cuda:0', dtype=torch.float16) tensor(0.0277, device='cuda:0', dtype=torch.float16)
tensor(0.3284, device='cuda:0', dtype=torch.float16) tensor(0.0314, device='cuda:0', dtype=torch.float16)
tensor(0.3555, device='cuda:0', dtype=torch.float16) tensor(0.0293, device='cuda:0', dtype=torch.float16)
2 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2734, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(0.3311, device='cuda:0', dtype=torch.float16) tensor(0.0297, device='cuda:0', dtype=torch.float16)
tensor(0.3770, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.3398, device='cuda:0', dtype=torch.float16) tensor(0.0320, device='cuda:0', dtype=torch.float16)
tensor(0.3984, device='cuda:0', dtype=torch.float16) tensor(0.0299, device='cuda:0', dtype=torch.float16)
tensor(0.0225, device='cuda:0')
old_score: tensor(0.0301, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0271, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.38543128967285
Validation after dual ascent:
out_inf: tensor(2.2734, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(0.2795, device='cuda:0', dtype=torch.float16) tensor(0.0267, device='cuda:0', dtype=torch.float16)
tensor(0.3604, device='cuda:0', dtype=torch.float16) tensor(0.0257, device='cuda:0', dtype=torch.float16)
tensor(0.3096, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.3428, device='cuda:0', dtype=torch.float16) tensor(0.0272, device='cuda:0', dtype=torch.float16)
2 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
tensor(0.0786, device='cuda:0', dtype=torch.float16) tensor(0.0054, device='cuda:0', dtype=torch.float16)
tensor(0.0887, device='cuda:0', dtype=torch.float16) tensor(0.0052, device='cuda:0', dtype=torch.float16)
tensor(0.0835, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.0880, device='cuda:0', dtype=torch.float16) tensor(0.0056, device='cuda:0', dtype=torch.float16)
tensor(0.1133, device='cuda:0')
old_score: tensor(0.0056, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0053, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.29068899154663
Validation after dual ascent:
out_inf: tensor(4.2500, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
tensor(0.0760, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.0853, device='cuda:0', dtype=torch.float16) tensor(0.0049, device='cuda:0', dtype=torch.float16)
tensor(0.0854, device='cuda:0', dtype=torch.float16) tensor(0.0060, device='cuda:0', dtype=torch.float16)
tensor(0.0876, device='cuda:0', dtype=torch.float16) tensor(0.0053, device='cuda:0', dtype=torch.float16)
layer 2 done
3 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.9219, device='cuda:0', dtype=torch.float16) tensor(0.8306, device='cuda:0', dtype=torch.float16)
tensor(1.3125, device='cuda:0', dtype=torch.float16) tensor(0.0886, device='cuda:0', dtype=torch.float16)
tensor(0.9985, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
tensor(1.0391, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
tensor(0.9561, device='cuda:0', dtype=torch.float16) tensor(0.0907, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0145, device='cuda:0')
tensor(0.0500, device='cuda:0')
old_score: tensor(0.0916, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0825, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.928752183914185
Validation after dual ascent:
out_inf: tensor(15.9219, device='cuda:0', dtype=torch.float16) tensor(0.8306, device='cuda:0', dtype=torch.float16)
tensor(1.3877, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.8271, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(0.9629, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(0.8857, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
3 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.4453, device='cuda:0', dtype=torch.float16) tensor(0.9980, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0900, device='cuda:0', dtype=torch.float16)
tensor(0.8496, device='cuda:0', dtype=torch.float16) tensor(0.0901, device='cuda:0', dtype=torch.float16)
tensor(0.8594, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
3 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.7852, device='cuda:0', dtype=torch.float16) tensor(0.1932, device='cuda:0', dtype=torch.float16)
tensor(0.5181, device='cuda:0', dtype=torch.float16) tensor(0.0520, device='cuda:0', dtype=torch.float16)
tensor(0.4666, device='cuda:0', dtype=torch.float16) tensor(0.0517, device='cuda:0', dtype=torch.float16)
tensor(0.4753, device='cuda:0', dtype=torch.float16) tensor(0.0574, device='cuda:0', dtype=torch.float16)
tensor(0.4810, device='cuda:0', dtype=torch.float16) tensor(0.0529, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0164, device='cuda:0')
tensor(0.0478, device='cuda:0')
old_score: tensor(0.0535, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0486, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5008137226104736
Validation after dual ascent:
out_inf: tensor(2.7852, device='cuda:0', dtype=torch.float16) tensor(0.1932, device='cuda:0', dtype=torch.float16)
tensor(0.4780, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.4651, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.4683, device='cuda:0', dtype=torch.float16) tensor(0.0528, device='cuda:0', dtype=torch.float16)
tensor(0.4817, device='cuda:0', dtype=torch.float16) tensor(0.0483, device='cuda:0', dtype=torch.float16)
3 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.2480, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.0794, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.0767, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.0654, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0603, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(0.0397, device='cuda:0')
old_score: tensor(0.0038, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0035, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.11861515045166
Validation after dual ascent:
out_inf: tensor(1.2480, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.0730, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
tensor(0.0717, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(0.0613, device='cuda:0', dtype=torch.float16) tensor(0.0034, device='cuda:0', dtype=torch.float16)
tensor(0.0606, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
3 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7344, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(0.4766, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.4512, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0473, device='cuda:0', dtype=torch.float16)
tensor(0.4482, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0191, device='cuda:0')
tensor(0.0225, device='cuda:0')
old_score: tensor(0.0439, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0405, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.987637519836426
Validation after dual ascent:
out_inf: tensor(4.7344, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(0.4512, device='cuda:0', dtype=torch.float16) tensor(0.0393, device='cuda:0', dtype=torch.float16)
tensor(0.4360, device='cuda:0', dtype=torch.float16) tensor(0.0383, device='cuda:0', dtype=torch.float16)
tensor(0.4180, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.4138, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
3 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.5742, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(0.4609, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.3911, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(0.4185, device='cuda:0', dtype=torch.float16) tensor(0.0437, device='cuda:0', dtype=torch.float16)
tensor(0.4414, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0137, device='cuda:0')
tensor(0.0198, device='cuda:0')
old_score: tensor(0.0406, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0374, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.001927852630615
Validation after dual ascent:
out_inf: tensor(2.5742, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(0.4658, device='cuda:0', dtype=torch.float16) tensor(0.0364, device='cuda:0', dtype=torch.float16)
tensor(0.3853, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.4058, device='cuda:0', dtype=torch.float16) tensor(0.0407, device='cuda:0', dtype=torch.float16)
tensor(0.4141, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
3 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.3848, device='cuda:0', dtype=torch.float16) tensor(0.0254, device='cuda:0', dtype=torch.float16)
tensor(0.0911, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.1085, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(0.0930, device='cuda:0', dtype=torch.float16) tensor(0.0092, device='cuda:0', dtype=torch.float16)
tensor(0.0907, device='cuda:0', dtype=torch.float16) tensor(0.0086, device='cuda:0', dtype=torch.float16)
tensor(0.0518, device='cuda:0')
old_score: tensor(0.0086, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0082, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.23047137260437
Validation after dual ascent:
out_inf: tensor(1.3848, device='cuda:0', dtype=torch.float16) tensor(0.0254, device='cuda:0', dtype=torch.float16)
tensor(0.0900, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
tensor(0.1080, device='cuda:0', dtype=torch.float16) tensor(0.0077, device='cuda:0', dtype=torch.float16)
tensor(0.0894, device='cuda:0', dtype=torch.float16) tensor(0.0088, device='cuda:0', dtype=torch.float16)
tensor(0.0978, device='cuda:0', dtype=torch.float16) tensor(0.0083, device='cuda:0', dtype=torch.float16)
layer 3 done
4 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.3516, device='cuda:0', dtype=torch.float16) tensor(0.8159, device='cuda:0', dtype=torch.float16)
tensor(0.8604, device='cuda:0', dtype=torch.float16) tensor(0.0937, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0949, device='cuda:0', dtype=torch.float16)
tensor(1.1250, device='cuda:0', dtype=torch.float16) tensor(0.1030, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0180, device='cuda:0')
tensor(0.0415, device='cuda:0')
old_score: tensor(0.0971, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0882, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.242046356201172
Validation after dual ascent:
out_inf: tensor(13.3516, device='cuda:0', dtype=torch.float16) tensor(0.8159, device='cuda:0', dtype=torch.float16)
tensor(0.8423, device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
tensor(0.8633, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
4 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.4531, device='cuda:0', dtype=torch.float16) tensor(1.0498, device='cuda:0', dtype=torch.float16)
tensor(1.2891, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(1.0928, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(0.8945, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
tensor(1.2510, device='cuda:0', dtype=torch.float16) tensor(0.0962, device='cuda:0', dtype=torch.float16)
4 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.2266, device='cuda:0', dtype=torch.float16) tensor(0.1991, device='cuda:0', dtype=torch.float16)
tensor(0.5176, device='cuda:0', dtype=torch.float16) tensor(0.0548, device='cuda:0', dtype=torch.float16)
tensor(0.4739, device='cuda:0', dtype=torch.float16) tensor(0.0549, device='cuda:0', dtype=torch.float16)
tensor(0.4819, device='cuda:0', dtype=torch.float16) tensor(0.0601, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0069, device='cuda:0')
tensor(0.0410, device='cuda:0')
old_score: tensor(0.0565, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0517, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.490004301071167
Validation after dual ascent:
out_inf: tensor(3.2266, device='cuda:0', dtype=torch.float16) tensor(0.1991, device='cuda:0', dtype=torch.float16)
tensor(0.4573, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.4622, device='cuda:0', dtype=torch.float16) tensor(0.0498, device='cuda:0', dtype=torch.float16)
tensor(0.4651, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
tensor(0.5166, device='cuda:0', dtype=torch.float16) tensor(0.0517, device='cuda:0', dtype=torch.float16)
4 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.0176, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
tensor(0.0994, device='cuda:0', dtype=torch.float16) tensor(0.0068, device='cuda:0', dtype=torch.float16)
tensor(0.0930, device='cuda:0', dtype=torch.float16) tensor(0.0071, device='cuda:0', dtype=torch.float16)
tensor(0.0891, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.0971, device='cuda:0', dtype=torch.float16) tensor(0.0074, device='cuda:0', dtype=torch.float16)
tensor(0.0264, device='cuda:0')
old_score: tensor(0.0069, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0065, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.099218130111694
Validation after dual ascent:
out_inf: tensor(3.0176, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
tensor(0.0999, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.0835, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.0838, device='cuda:0', dtype=torch.float16) tensor(0.0060, device='cuda:0', dtype=torch.float16)
tensor(0.0992, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
4 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7695, device='cuda:0', dtype=torch.float16) tensor(0.1887, device='cuda:0', dtype=torch.float16)
tensor(0.5283, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.5449, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(0.5283, device='cuda:0', dtype=torch.float16) tensor(0.0571, device='cuda:0', dtype=torch.float16)
tensor(0.5977, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0150, device='cuda:0')
tensor(0.0233, device='cuda:0')
old_score: tensor(0.0538, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0498, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.1735758781433105
Validation after dual ascent:
out_inf: tensor(4.7695, device='cuda:0', dtype=torch.float16) tensor(0.1887, device='cuda:0', dtype=torch.float16)
tensor(0.4824, device='cuda:0', dtype=torch.float16) tensor(0.0484, device='cuda:0', dtype=torch.float16)
tensor(0.5234, device='cuda:0', dtype=torch.float16) tensor(0.0472, device='cuda:0', dtype=torch.float16)
tensor(0.4946, device='cuda:0', dtype=torch.float16) tensor(0.0535, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0501, device='cuda:0', dtype=torch.float16)
4 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.0977, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
tensor(0.4668, device='cuda:0', dtype=torch.float16) tensor(0.0475, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.4688, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(0.5894, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0199, device='cuda:0')
tensor(0.2393, device='cuda:0')
old_score: tensor(0.0485, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0450, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.226863145828247
Validation after dual ascent:
out_inf: tensor(3.0977, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
tensor(0.4463, device='cuda:0', dtype=torch.float16) tensor(0.0437, device='cuda:0', dtype=torch.float16)
tensor(0.5234, device='cuda:0', dtype=torch.float16) tensor(0.0426, device='cuda:0', dtype=torch.float16)
tensor(0.4854, device='cuda:0', dtype=torch.float16) tensor(0.0483, device='cuda:0', dtype=torch.float16)
tensor(0.6743, device='cuda:0', dtype=torch.float16) tensor(0.0453, device='cuda:0', dtype=torch.float16)
4 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.3828, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.1252, device='cuda:0', dtype=torch.float16) tensor(0.0129, device='cuda:0', dtype=torch.float16)
tensor(0.1219, device='cuda:0', dtype=torch.float16) tensor(0.0122, device='cuda:0', dtype=torch.float16)
tensor(0.1151, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
tensor(0.1252, device='cuda:0', dtype=torch.float16) tensor(0.0134, device='cuda:0', dtype=torch.float16)
Converged at iteration 600
tensor(0.0120, device='cuda:0')
tensor(0.0201, device='cuda:0')
old_score: tensor(0.0129, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0124, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 61.16703820228577
Validation after dual ascent:
out_inf: tensor(9.3828, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.1104, device='cuda:0', dtype=torch.float16) tensor(0.0124, device='cuda:0', dtype=torch.float16)
tensor(0.1257, device='cuda:0', dtype=torch.float16) tensor(0.0117, device='cuda:0', dtype=torch.float16)
tensor(0.1121, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
tensor(0.1248, device='cuda:0', dtype=torch.float16) tensor(0.0129, device='cuda:0', dtype=torch.float16)
layer 4 done
5 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.0938, device='cuda:0', dtype=torch.float16) tensor(0.8242, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.1030, device='cuda:0', dtype=torch.float16)
tensor(1.5723, device='cuda:0', dtype=torch.float16) tensor(0.1035, device='cuda:0', dtype=torch.float16)
tensor(1.1865, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1061, device='cuda:0', dtype=torch.float16)
tensor(0.1329, device='cuda:0')
old_score: tensor(0.1055, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0969, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.097806930541992
Validation after dual ascent:
out_inf: tensor(15.0938, device='cuda:0', dtype=torch.float16) tensor(0.8242, device='cuda:0', dtype=torch.float16)
tensor(0.9834, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
tensor(1.5635, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(1.2529, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(1.2510, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
5 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.1406, device='cuda:0', dtype=torch.float16) tensor(1.0879, device='cuda:0', dtype=torch.float16)
tensor(0.8926, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
tensor(0.8486, device='cuda:0', dtype=torch.float16) tensor(0.1051, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(0.8672, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
5 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.6016, device='cuda:0', dtype=torch.float16) tensor(0.2034, device='cuda:0', dtype=torch.float16)
tensor(0.4612, device='cuda:0', dtype=torch.float16) tensor(0.0601, device='cuda:0', dtype=torch.float16)
tensor(0.4697, device='cuda:0', dtype=torch.float16) tensor(0.0601, device='cuda:0', dtype=torch.float16)
tensor(0.5479, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(0.4949, device='cuda:0', dtype=torch.float16) tensor(0.0616, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0062, device='cuda:0')
tensor(0.0391, device='cuda:0')
old_score: tensor(0.0613, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0568, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2247142791748047
Validation after dual ascent:
out_inf: tensor(2.6016, device='cuda:0', dtype=torch.float16) tensor(0.2034, device='cuda:0', dtype=torch.float16)
tensor(0.4578, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
tensor(0.4868, device='cuda:0', dtype=torch.float16) tensor(0.0551, device='cuda:0', dtype=torch.float16)
tensor(0.5020, device='cuda:0', dtype=torch.float16) tensor(0.0593, device='cuda:0', dtype=torch.float16)
tensor(0.5161, device='cuda:0', dtype=torch.float16) tensor(0.0574, device='cuda:0', dtype=torch.float16)
5 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3086, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.1151, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(0.1257, device='cuda:0', dtype=torch.float16) tensor(0.0086, device='cuda:0', dtype=torch.float16)
tensor(0.1221, device='cuda:0', dtype=torch.float16) tensor(0.0082, device='cuda:0', dtype=torch.float16)
tensor(0.1184, device='cuda:0', dtype=torch.float16) tensor(0.0085, device='cuda:0', dtype=torch.float16)
tensor(0.0320, device='cuda:0')
old_score: tensor(0.0083, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0078, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.095269441604614
Validation after dual ascent:
out_inf: tensor(4.3086, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.0995, device='cuda:0', dtype=torch.float16) tensor(0.0076, device='cuda:0', dtype=torch.float16)
tensor(0.1036, device='cuda:0', dtype=torch.float16) tensor(0.0079, device='cuda:0', dtype=torch.float16)
tensor(0.1122, device='cuda:0', dtype=torch.float16) tensor(0.0076, device='cuda:0', dtype=torch.float16)
tensor(0.1054, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
5 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.7168, device='cuda:0', dtype=torch.float16) tensor(0.2173, device='cuda:0', dtype=torch.float16)
tensor(0.5410, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.4980, device='cuda:0', dtype=torch.float16) tensor(0.0570, device='cuda:0', dtype=torch.float16)
tensor(0.4883, device='cuda:0', dtype=torch.float16) tensor(0.0604, device='cuda:0', dtype=torch.float16)
tensor(0.5269, device='cuda:0', dtype=torch.float16) tensor(0.0602, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0155, device='cuda:0')
tensor(0.0186, device='cuda:0')
old_score: tensor(0.0591, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0546, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.089253187179565
Validation after dual ascent:
out_inf: tensor(3.7168, device='cuda:0', dtype=torch.float16) tensor(0.2173, device='cuda:0', dtype=torch.float16)
tensor(0.4834, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
tensor(0.4746, device='cuda:0', dtype=torch.float16) tensor(0.0519, device='cuda:0', dtype=torch.float16)
tensor(0.4888, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.5366, device='cuda:0', dtype=torch.float16) tensor(0.0559, device='cuda:0', dtype=torch.float16)
5 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3086, device='cuda:0', dtype=torch.float16) tensor(0.1593, device='cuda:0', dtype=torch.float16)
tensor(0.6309, device='cuda:0', dtype=torch.float16) tensor(0.0529, device='cuda:0', dtype=torch.float16)
tensor(0.6523, device='cuda:0', dtype=torch.float16) tensor(0.0511, device='cuda:0', dtype=torch.float16)
tensor(0.4993, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
tensor(0.5098, device='cuda:0', dtype=torch.float16) tensor(0.0541, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0142, device='cuda:0')
tensor(0.0313, device='cuda:0')
old_score: tensor(0.0531, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0491, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.197019100189209
Validation after dual ascent:
out_inf: tensor(4.3086, device='cuda:0', dtype=torch.float16) tensor(0.1593, device='cuda:0', dtype=torch.float16)
tensor(0.6992, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
tensor(0.6406, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.4814, device='cuda:0', dtype=torch.float16) tensor(0.0506, device='cuda:0', dtype=torch.float16)
tensor(0.4478, device='cuda:0', dtype=torch.float16) tensor(0.0503, device='cuda:0', dtype=torch.float16)
5 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.6953, device='cuda:0', dtype=torch.float16) tensor(0.0445, device='cuda:0', dtype=torch.float16)
tensor(0.1434, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.1501, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1248, device='cuda:0', dtype=torch.float16) tensor(0.0151, device='cuda:0', dtype=torch.float16)
tensor(0.1602, device='cuda:0', dtype=torch.float16) tensor(0.0162, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0105, device='cuda:0')
tensor(0.0232, device='cuda:0')
old_score: tensor(0.0157, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0151, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.680758476257324
Validation after dual ascent:
out_inf: tensor(1.6953, device='cuda:0', dtype=torch.float16) tensor(0.0445, device='cuda:0', dtype=torch.float16)
tensor(0.1490, device='cuda:0', dtype=torch.float16) tensor(0.0152, device='cuda:0', dtype=torch.float16)
tensor(0.1465, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.1267, device='cuda:0', dtype=torch.float16) tensor(0.0145, device='cuda:0', dtype=torch.float16)
tensor(0.1528, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
layer 5 done
6 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.7578, device='cuda:0', dtype=torch.float16) tensor(0.8413, device='cuda:0', dtype=torch.float16)
tensor(1.0537, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(1.0645, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
tensor(1.1709, device='cuda:0', dtype=torch.float16) tensor(0.1227, device='cuda:0', dtype=torch.float16)
tensor(0.9727, device='cuda:0', dtype=torch.float16) tensor(0.1241, device='cuda:0', dtype=torch.float16)
tensor(0.1886, device='cuda:0')
old_score: tensor(0.1221, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1118, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.205076217651367
Validation after dual ascent:
out_inf: tensor(13.7578, device='cuda:0', dtype=torch.float16) tensor(0.8413, device='cuda:0', dtype=torch.float16)
tensor(0.9209, device='cuda:0', dtype=torch.float16) tensor(0.1115, device='cuda:0', dtype=torch.float16)
tensor(0.9072, device='cuda:0', dtype=torch.float16) tensor(0.1087, device='cuda:0', dtype=torch.float16)
tensor(1.0225, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(0.9062, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
6 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.2031, device='cuda:0', dtype=torch.float16) tensor(1.0254, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.1222, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(0.9883, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.0479, device='cuda:0', dtype=torch.float16) tensor(0.1242, device='cuda:0', dtype=torch.float16)
tensor(0.2012, device='cuda:0')
old_score: tensor(0.1225, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1119, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.237734317779541
Validation after dual ascent:
out_inf: tensor(17.2031, device='cuda:0', dtype=torch.float16) tensor(1.0254, device='cuda:0', dtype=torch.float16)
tensor(0.8906, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(0.8857, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(0.9014, device='cuda:0', dtype=torch.float16) tensor(0.1127, device='cuda:0', dtype=torch.float16)
tensor(0.9580, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
6 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.1953, device='cuda:0', dtype=torch.float16) tensor(0.2515, device='cuda:0', dtype=torch.float16)
tensor(0.5317, device='cuda:0', dtype=torch.float16) tensor(0.0713, device='cuda:0', dtype=torch.float16)
tensor(0.5283, device='cuda:0', dtype=torch.float16) tensor(0.0696, device='cuda:0', dtype=torch.float16)
tensor(0.5620, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.5571, device='cuda:0', dtype=torch.float16) tensor(0.0723, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0173, device='cuda:0')
tensor(0.0797, device='cuda:0')
old_score: tensor(0.0712, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0657, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.971216440200806
Validation after dual ascent:
out_inf: tensor(4.1953, device='cuda:0', dtype=torch.float16) tensor(0.2515, device='cuda:0', dtype=torch.float16)
tensor(0.5547, device='cuda:0', dtype=torch.float16) tensor(0.0658, device='cuda:0', dtype=torch.float16)
tensor(0.4890, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
tensor(0.5454, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(0.5771, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
6 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7188, device='cuda:0', dtype=torch.float16) tensor(0.0426, device='cuda:0', dtype=torch.float16)
tensor(0.1401, device='cuda:0', dtype=torch.float16) tensor(0.0110, device='cuda:0', dtype=torch.float16)
tensor(0.1279, device='cuda:0', dtype=torch.float16) tensor(0.0129, device='cuda:0', dtype=torch.float16)
tensor(0.1477, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
tensor(0.1359, device='cuda:0', dtype=torch.float16) tensor(0.0115, device='cuda:0', dtype=torch.float16)
Converged at iteration 950
tensor(0.0151, device='cuda:0')
tensor(0.0264, device='cuda:0')
old_score: tensor(0.0121, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0111, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.471968173980713
Validation after dual ascent:
out_inf: tensor(4.7188, device='cuda:0', dtype=torch.float16) tensor(0.0426, device='cuda:0', dtype=torch.float16)
tensor(0.1184, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.1316, device='cuda:0', dtype=torch.float16) tensor(0.0117, device='cuda:0', dtype=torch.float16)
tensor(0.1271, device='cuda:0', dtype=torch.float16) tensor(0.0121, device='cuda:0', dtype=torch.float16)
tensor(0.1311, device='cuda:0', dtype=torch.float16) tensor(0.0106, device='cuda:0', dtype=torch.float16)
6 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.2764, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0634, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0600, device='cuda:0', dtype=torch.float16)
tensor(0.5205, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(0.7324, device='cuda:0', dtype=torch.float16) tensor(0.0624, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0067, device='cuda:0')
tensor(0.0294, device='cuda:0')
old_score: tensor(0.0623, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0574, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.238315582275391
Validation after dual ascent:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.2764, device='cuda:0', dtype=torch.float16)
tensor(0.5293, device='cuda:0', dtype=torch.float16) tensor(0.0585, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(0.4946, device='cuda:0', dtype=torch.float16) tensor(0.0586, device='cuda:0', dtype=torch.float16)
tensor(0.7500, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
6 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.9883, device='cuda:0', dtype=torch.float16) tensor(0.1768, device='cuda:0', dtype=torch.float16)
tensor(0.5566, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
tensor(0.5371, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.5000, device='cuda:0', dtype=torch.float16) tensor(0.0560, device='cuda:0', dtype=torch.float16)
tensor(0.4902, device='cuda:0', dtype=torch.float16) tensor(0.0549, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0045, device='cuda:0')
tensor(0.0250, device='cuda:0')
old_score: tensor(0.0548, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0506, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.239810943603516
Validation after dual ascent:
out_inf: tensor(2.9883, device='cuda:0', dtype=torch.float16) tensor(0.1768, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0516, device='cuda:0', dtype=torch.float16)
tensor(0.5459, device='cuda:0', dtype=torch.float16) tensor(0.0480, device='cuda:0', dtype=torch.float16)
tensor(0.4805, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
tensor(0.5068, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
6 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.7285, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.1826, device='cuda:0', dtype=torch.float16) tensor(0.0184, device='cuda:0', dtype=torch.float16)
tensor(0.1418, device='cuda:0', dtype=torch.float16) tensor(0.0173, device='cuda:0', dtype=torch.float16)
tensor(0.1653, device='cuda:0', dtype=torch.float16) tensor(0.0170, device='cuda:0', dtype=torch.float16)
tensor(0.1719, device='cuda:0', dtype=torch.float16) tensor(0.0175, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0070, device='cuda:0')
tensor(0.0174, device='cuda:0')
old_score: tensor(0.0175, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0167, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.87020921707153
Validation after dual ascent:
out_inf: tensor(1.7285, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.1843, device='cuda:0', dtype=torch.float16) tensor(0.0176, device='cuda:0', dtype=torch.float16)
tensor(0.1458, device='cuda:0', dtype=torch.float16) tensor(0.0163, device='cuda:0', dtype=torch.float16)
tensor(0.1578, device='cuda:0', dtype=torch.float16) tensor(0.0161, device='cuda:0', dtype=torch.float16)
tensor(0.1646, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
layer 6 done
7 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.3906, device='cuda:0', dtype=torch.float16) tensor(0.8384, device='cuda:0', dtype=torch.float16)
tensor(1.2559, device='cuda:0', dtype=torch.float16) tensor(0.1222, device='cuda:0', dtype=torch.float16)
tensor(2.0117, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
tensor(1.0791, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(0.1324, device='cuda:0')
old_score: tensor(0.1224, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1110, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.207326889038086
Validation after dual ascent:
out_inf: tensor(16.3906, device='cuda:0', dtype=torch.float16) tensor(0.8384, device='cuda:0', dtype=torch.float16)
tensor(1.4375, device='cuda:0', dtype=torch.float16) tensor(0.1115, device='cuda:0', dtype=torch.float16)
tensor(2.1895, device='cuda:0', dtype=torch.float16) tensor(0.1081, device='cuda:0', dtype=torch.float16)
tensor(1.3613, device='cuda:0', dtype=torch.float16) tensor(0.1133, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
7 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.4844, device='cuda:0', dtype=torch.float16) tensor(0.9878, device='cuda:0', dtype=torch.float16)
tensor(0.9883, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
tensor(1.0215, device='cuda:0', dtype=torch.float16) tensor(0.1210, device='cuda:0', dtype=torch.float16)
tensor(0.1291, device='cuda:0')
old_score: tensor(0.1219, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1105, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.241952180862427
Validation after dual ascent:
out_inf: tensor(16.4844, device='cuda:0', dtype=torch.float16) tensor(0.9878, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
tensor(0.8691, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(0.9180, device='cuda:0', dtype=torch.float16) tensor(0.1128, device='cuda:0', dtype=torch.float16)
tensor(0.9712, device='cuda:0', dtype=torch.float16) tensor(0.1104, device='cuda:0', dtype=torch.float16)
7 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.2656, device='cuda:0', dtype=torch.float16)
tensor(0.5347, device='cuda:0', dtype=torch.float16) tensor(0.0725, device='cuda:0', dtype=torch.float16)
tensor(0.5410, device='cuda:0', dtype=torch.float16) tensor(0.0708, device='cuda:0', dtype=torch.float16)
tensor(0.5498, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
tensor(0.5430, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.0683, device='cuda:0')
old_score: tensor(0.0721, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0660, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.203791618347168
Validation after dual ascent:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.2656, device='cuda:0', dtype=torch.float16)
tensor(0.5264, device='cuda:0', dtype=torch.float16) tensor(0.0666, device='cuda:0', dtype=torch.float16)
tensor(0.5220, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.5518, device='cuda:0', dtype=torch.float16) tensor(0.0673, device='cuda:0', dtype=torch.float16)
tensor(0.5664, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
7 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2812, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
tensor(0.1477, device='cuda:0', dtype=torch.float16) tensor(0.0146, device='cuda:0', dtype=torch.float16)
tensor(0.1445, device='cuda:0', dtype=torch.float16) tensor(0.0152, device='cuda:0', dtype=torch.float16)
tensor(0.1753, device='cuda:0', dtype=torch.float16) tensor(0.0173, device='cuda:0', dtype=torch.float16)
tensor(0.1576, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0162, device='cuda:0')
tensor(0.0321, device='cuda:0')
old_score: tensor(0.0153, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0138, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.467835426330566
Validation after dual ascent:
out_inf: tensor(4.2812, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
tensor(0.1372, device='cuda:0', dtype=torch.float16) tensor(0.0133, device='cuda:0', dtype=torch.float16)
tensor(0.1233, device='cuda:0', dtype=torch.float16) tensor(0.0136, device='cuda:0', dtype=torch.float16)
tensor(0.1461, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1378, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
7 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5703, device='cuda:0', dtype=torch.float16) tensor(0.3381, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0624, device='cuda:0', dtype=torch.float16)
tensor(0.5449, device='cuda:0', dtype=torch.float16) tensor(0.0628, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0620, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0076, device='cuda:0')
tensor(0.0298, device='cuda:0')
old_score: tensor(0.0630, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0574, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.242672681808472
Validation after dual ascent:
out_inf: tensor(4.5703, device='cuda:0', dtype=torch.float16) tensor(0.3381, device='cuda:0', dtype=torch.float16)
tensor(0.5303, device='cuda:0', dtype=torch.float16) tensor(0.0571, device='cuda:0', dtype=torch.float16)
tensor(0.5684, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0589, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0569, device='cuda:0', dtype=torch.float16)
7 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6758, device='cuda:0', dtype=torch.float16) tensor(0.1917, device='cuda:0', dtype=torch.float16)
tensor(0.5371, device='cuda:0', dtype=torch.float16) tensor(0.0552, device='cuda:0', dtype=torch.float16)
tensor(0.5566, device='cuda:0', dtype=torch.float16) tensor(0.0556, device='cuda:0', dtype=torch.float16)
tensor(0.5156, device='cuda:0', dtype=torch.float16) tensor(0.0574, device='cuda:0', dtype=torch.float16)
tensor(0.5430, device='cuda:0', dtype=torch.float16) tensor(0.0548, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0035, device='cuda:0')
tensor(0.0251, device='cuda:0')
old_score: tensor(0.0557, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0510, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2335045337677
Validation after dual ascent:
out_inf: tensor(4.6758, device='cuda:0', dtype=torch.float16) tensor(0.1917, device='cuda:0', dtype=torch.float16)
tensor(0.4688, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
tensor(0.4385, device='cuda:0', dtype=torch.float16) tensor(0.0503, device='cuda:0', dtype=torch.float16)
tensor(0.4746, device='cuda:0', dtype=torch.float16) tensor(0.0523, device='cuda:0', dtype=torch.float16)
tensor(0.5371, device='cuda:0', dtype=torch.float16) tensor(0.0506, device='cuda:0', dtype=torch.float16)
7 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.0642, device='cuda:0', dtype=torch.float16)
tensor(0.1967, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.1714, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.1807, device='cuda:0', dtype=torch.float16) tensor(0.0194, device='cuda:0', dtype=torch.float16)
tensor(0.1699, device='cuda:0', dtype=torch.float16) tensor(0.0185, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0064, device='cuda:0')
tensor(0.0152, device='cuda:0')
old_score: tensor(0.0190, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0179, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.81430697441101
Validation after dual ascent:
out_inf: tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.0642, device='cuda:0', dtype=torch.float16)
tensor(0.1821, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.1616, device='cuda:0', dtype=torch.float16) tensor(0.0177, device='cuda:0', dtype=torch.float16)
tensor(0.1838, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.1545, device='cuda:0', dtype=torch.float16) tensor(0.0174, device='cuda:0', dtype=torch.float16)
layer 7 done
8 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.3125, device='cuda:0', dtype=torch.float16) tensor(0.7983, device='cuda:0', dtype=torch.float16)
tensor(0.9268, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(1.7412, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.0371, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0145, device='cuda:0')
tensor(0.0857, device='cuda:0')
old_score: tensor(0.1225, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1105, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2500410079956055
Validation after dual ascent:
out_inf: tensor(17.3125, device='cuda:0', dtype=torch.float16) tensor(0.7983, device='cuda:0', dtype=torch.float16)
tensor(0.8804, device='cuda:0', dtype=torch.float16) tensor(0.1097, device='cuda:0', dtype=torch.float16)
tensor(1.0264, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(1.4561, device='cuda:0', dtype=torch.float16) tensor(0.1133, device='cuda:0', dtype=torch.float16)
tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.1097, device='cuda:0', dtype=torch.float16)
8 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.5312, device='cuda:0', dtype=torch.float16) tensor(1.0215, device='cuda:0', dtype=torch.float16)
tensor(1.1582, device='cuda:0', dtype=torch.float16) tensor(0.1209, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
tensor(1.1777, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.1309, device='cuda:0', dtype=torch.float16) tensor(0.1206, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0178, device='cuda:0')
tensor(0.0895, device='cuda:0')
old_score: tensor(0.1223, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1104, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.253164768218994
Validation after dual ascent:
out_inf: tensor(19.5312, device='cuda:0', dtype=torch.float16) tensor(1.0215, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.1096, device='cuda:0', dtype=torch.float16)
tensor(0.9268, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.1133, device='cuda:0', dtype=torch.float16)
tensor(0.8857, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
8 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8867, device='cuda:0', dtype=torch.float16) tensor(0.2734, device='cuda:0', dtype=torch.float16)
tensor(0.5957, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.5303, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.5576, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(0.5898, device='cuda:0', dtype=torch.float16) tensor(0.0727, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0169, device='cuda:0')
tensor(0.0844, device='cuda:0')
old_score: tensor(0.0737, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0670, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.498807430267334
Validation after dual ascent:
out_inf: tensor(4.8867, device='cuda:0', dtype=torch.float16) tensor(0.2734, device='cuda:0', dtype=torch.float16)
tensor(0.5762, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(0.5347, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(0.5479, device='cuda:0', dtype=torch.float16) tensor(0.0687, device='cuda:0', dtype=torch.float16)
tensor(0.6323, device='cuda:0', dtype=torch.float16) tensor(0.0665, device='cuda:0', dtype=torch.float16)
8 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6641, device='cuda:0', dtype=torch.float16) tensor(0.0527, device='cuda:0', dtype=torch.float16)
tensor(0.1996, device='cuda:0', dtype=torch.float16) tensor(0.0162, device='cuda:0', dtype=torch.float16)
tensor(0.1908, device='cuda:0', dtype=torch.float16) tensor(0.0189, device='cuda:0', dtype=torch.float16)
tensor(0.2034, device='cuda:0', dtype=torch.float16) tensor(0.0206, device='cuda:0', dtype=torch.float16)
tensor(0.1638, device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0145, device='cuda:0')
tensor(0.0353, device='cuda:0')
old_score: tensor(0.0179, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0163, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.457953453063965
Validation after dual ascent:
out_inf: tensor(4.6641, device='cuda:0', dtype=torch.float16) tensor(0.0527, device='cuda:0', dtype=torch.float16)
tensor(0.1799, device='cuda:0', dtype=torch.float16) tensor(0.0148, device='cuda:0', dtype=torch.float16)
tensor(0.1628, device='cuda:0', dtype=torch.float16) tensor(0.0171, device='cuda:0', dtype=torch.float16)
tensor(0.2043, device='cuda:0', dtype=torch.float16) tensor(0.0187, device='cuda:0', dtype=torch.float16)
tensor(0.1625, device='cuda:0', dtype=torch.float16) tensor(0.0146, device='cuda:0', dtype=torch.float16)
8 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4805, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.5566, device='cuda:0', dtype=torch.float16) tensor(0.0663, device='cuda:0', dtype=torch.float16)
tensor(0.6035, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.5889, device='cuda:0', dtype=torch.float16) tensor(0.0665, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0058, device='cuda:0')
tensor(0.0360, device='cuda:0')
old_score: tensor(0.0667, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0608, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.215284824371338
Validation after dual ascent:
out_inf: tensor(5.4805, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(0.6084, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(0.5156, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(0.6143, device='cuda:0', dtype=torch.float16) tensor(0.0614, device='cuda:0', dtype=torch.float16)
tensor(0.6338, device='cuda:0', dtype=torch.float16) tensor(0.0611, device='cuda:0', dtype=torch.float16)
8 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.5391, device='cuda:0', dtype=torch.float16) tensor(0.2035, device='cuda:0', dtype=torch.float16)
tensor(0.5410, device='cuda:0', dtype=torch.float16) tensor(0.0607, device='cuda:0', dtype=torch.float16)
tensor(0.6240, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.8726, device='cuda:0', dtype=torch.float16) tensor(0.0618, device='cuda:0', dtype=torch.float16)
tensor(0.7178, device='cuda:0', dtype=torch.float16) tensor(0.0609, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0034, device='cuda:0')
tensor(0.0317, device='cuda:0')
old_score: tensor(0.0610, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0557, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.22141432762146
Validation after dual ascent:
out_inf: tensor(7.5391, device='cuda:0', dtype=torch.float16) tensor(0.2035, device='cuda:0', dtype=torch.float16)
tensor(0.5405, device='cuda:0', dtype=torch.float16) tensor(0.0557, device='cuda:0', dtype=torch.float16)
tensor(0.5239, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
tensor(0.7764, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.5889, device='cuda:0', dtype=torch.float16) tensor(0.0560, device='cuda:0', dtype=torch.float16)
8 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.3027, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(0.2024, device='cuda:0', dtype=torch.float16) tensor(0.0222, device='cuda:0', dtype=torch.float16)
tensor(0.1866, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
tensor(0.1940, device='cuda:0', dtype=torch.float16) tensor(0.0223, device='cuda:0', dtype=torch.float16)
tensor(0.2365, device='cuda:0', dtype=torch.float16) tensor(0.0220, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0173, device='cuda:0')
tensor(0.0398, device='cuda:0')
old_score: tensor(0.0220, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0210, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.246665477752686
Validation after dual ascent:
out_inf: tensor(2.3027, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(0.2014, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
tensor(0.1750, device='cuda:0', dtype=torch.float16) tensor(0.0205, device='cuda:0', dtype=torch.float16)
tensor(0.1929, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
tensor(0.2317, device='cuda:0', dtype=torch.float16) tensor(0.0210, device='cuda:0', dtype=torch.float16)
layer 8 done
9 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.4453, device='cuda:0', dtype=torch.float16) tensor(0.8022, device='cuda:0', dtype=torch.float16)
tensor(1.0225, device='cuda:0', dtype=torch.float16) tensor(0.1310, device='cuda:0', dtype=torch.float16)
tensor(1.0869, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
tensor(1.1416, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0122, device='cuda:0')
tensor(0.0754, device='cuda:0')
old_score: tensor(0.1331, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1205, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.245664596557617
Validation after dual ascent:
out_inf: tensor(14.4453, device='cuda:0', dtype=torch.float16) tensor(0.8022, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.1194, device='cuda:0', dtype=torch.float16)
tensor(1.0293, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
tensor(1.1699, device='cuda:0', dtype=torch.float16) tensor(0.1227, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
9 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.1250, device='cuda:0', dtype=torch.float16) tensor(1.0479, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
tensor(1.4102, device='cuda:0', dtype=torch.float16) tensor(0.1340, device='cuda:0', dtype=torch.float16)
tensor(1.1621, device='cuda:0', dtype=torch.float16) tensor(0.1367, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.1327, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0154, device='cuda:0')
tensor(0.0820, device='cuda:0')
old_score: tensor(0.1339, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1212, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2599263191223145
Validation after dual ascent:
out_inf: tensor(19.1250, device='cuda:0', dtype=torch.float16) tensor(1.0479, device='cuda:0', dtype=torch.float16)
tensor(0.9082, device='cuda:0', dtype=torch.float16) tensor(0.1203, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(0.9756, device='cuda:0', dtype=torch.float16) tensor(0.1233, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.1209, device='cuda:0', dtype=torch.float16)
9 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.6602, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(0.6182, device='cuda:0', dtype=torch.float16) tensor(0.0783, device='cuda:0', dtype=torch.float16)
tensor(0.6055, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0806, device='cuda:0', dtype=torch.float16)
tensor(0.6689, device='cuda:0', dtype=torch.float16) tensor(0.0785, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0128, device='cuda:0')
tensor(0.0962, device='cuda:0')
old_score: tensor(0.0791, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0723, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.487457752227783
Validation after dual ascent:
out_inf: tensor(6.6602, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(0.5972, device='cuda:0', dtype=torch.float16) tensor(0.0719, device='cuda:0', dtype=torch.float16)
tensor(0.5566, device='cuda:0', dtype=torch.float16) tensor(0.0716, device='cuda:0', dtype=torch.float16)
tensor(0.5942, device='cuda:0', dtype=torch.float16) tensor(0.0733, device='cuda:0', dtype=torch.float16)
tensor(0.5977, device='cuda:0', dtype=torch.float16) tensor(0.0722, device='cuda:0', dtype=torch.float16)
9 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3047, device='cuda:0', dtype=torch.float16) tensor(0.0582, device='cuda:0', dtype=torch.float16)
tensor(0.2153, device='cuda:0', dtype=torch.float16) tensor(0.0192, device='cuda:0', dtype=torch.float16)
tensor(0.2152, device='cuda:0', dtype=torch.float16) tensor(0.0208, device='cuda:0', dtype=torch.float16)
tensor(0.2129, device='cuda:0', dtype=torch.float16) tensor(0.0226, device='cuda:0', dtype=torch.float16)
tensor(0.2091, device='cuda:0', dtype=torch.float16) tensor(0.0184, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0172, device='cuda:0')
tensor(0.0280, device='cuda:0')
old_score: tensor(0.0202, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0185, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.703582048416138
Validation after dual ascent:
out_inf: tensor(4.3047, device='cuda:0', dtype=torch.float16) tensor(0.0582, device='cuda:0', dtype=torch.float16)
tensor(0.1978, device='cuda:0', dtype=torch.float16) tensor(0.0175, device='cuda:0', dtype=torch.float16)
tensor(0.1877, device='cuda:0', dtype=torch.float16) tensor(0.0189, device='cuda:0', dtype=torch.float16)
tensor(0.1913, device='cuda:0', dtype=torch.float16) tensor(0.0206, device='cuda:0', dtype=torch.float16)
tensor(0.1812, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
9 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.3125, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(0.5811, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(0.5996, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
tensor(0.6162, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
tensor(0.5996, device='cuda:0', dtype=torch.float16) tensor(0.0698, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0054, device='cuda:0')
tensor(0.0424, device='cuda:0')
old_score: tensor(0.0701, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0642, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.208754062652588
Validation after dual ascent:
out_inf: tensor(6.3125, device='cuda:0', dtype=torch.float16) tensor(0.3125, device='cuda:0', dtype=torch.float16)
tensor(0.5723, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.5156, device='cuda:0', dtype=torch.float16) tensor(0.0630, device='cuda:0', dtype=torch.float16)
tensor(0.5679, device='cuda:0', dtype=torch.float16) tensor(0.0650, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
9 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3867, device='cuda:0', dtype=torch.float16) tensor(0.2151, device='cuda:0', dtype=torch.float16)
tensor(0.6660, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(0.5361, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.5674, device='cuda:0', dtype=torch.float16) tensor(0.0664, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0036, device='cuda:0')
tensor(0.0385, device='cuda:0')
old_score: tensor(0.0653, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0599, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2139811515808105
Validation after dual ascent:
out_inf: tensor(4.3867, device='cuda:0', dtype=torch.float16) tensor(0.2151, device='cuda:0', dtype=torch.float16)
tensor(0.6094, device='cuda:0', dtype=torch.float16) tensor(0.0602, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.4810, device='cuda:0', dtype=torch.float16) tensor(0.0607, device='cuda:0', dtype=torch.float16)
tensor(0.5210, device='cuda:0', dtype=torch.float16) tensor(0.0601, device='cuda:0', dtype=torch.float16)
9 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2891, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.2178, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
tensor(0.2329, device='cuda:0', dtype=torch.float16) tensor(0.0245, device='cuda:0', dtype=torch.float16)
tensor(0.2231, device='cuda:0', dtype=torch.float16) tensor(0.0250, device='cuda:0', dtype=torch.float16)
tensor(0.2292, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0086, device='cuda:0')
tensor(0.0075, device='cuda:0')
old_score: tensor(0.0249, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0239, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.11326313018799
Validation after dual ascent:
out_inf: tensor(2.2891, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.2163, device='cuda:0', dtype=torch.float16) tensor(0.0245, device='cuda:0', dtype=torch.float16)
tensor(0.2188, device='cuda:0', dtype=torch.float16) tensor(0.0233, device='cuda:0', dtype=torch.float16)
tensor(0.2164, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
tensor(0.2188, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
layer 9 done
10 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.5156, device='cuda:0', dtype=torch.float16) tensor(0.7891, device='cuda:0', dtype=torch.float16)
tensor(1.0312, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.3320, device='cuda:0', dtype=torch.float16) tensor(0.1368, device='cuda:0', dtype=torch.float16)
tensor(1.2744, device='cuda:0', dtype=torch.float16) tensor(0.1406, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.1365, device='cuda:0', dtype=torch.float16)
tensor(0.2200, device='cuda:0')
old_score: tensor(0.1375, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1254, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.186537981033325
Validation after dual ascent:
out_inf: tensor(13.5156, device='cuda:0', dtype=torch.float16) tensor(0.7891, device='cuda:0', dtype=torch.float16)
tensor(0.9902, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
tensor(1.1748, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
tensor(1.1816, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
tensor(1.0977, device='cuda:0', dtype=torch.float16) tensor(0.1250, device='cuda:0', dtype=torch.float16)
10 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.7500, device='cuda:0', dtype=torch.float16) tensor(1.0527, device='cuda:0', dtype=torch.float16)
tensor(1.1572, device='cuda:0', dtype=torch.float16) tensor(0.1373, device='cuda:0', dtype=torch.float16)
tensor(1.4521, device='cuda:0', dtype=torch.float16) tensor(0.1375, device='cuda:0', dtype=torch.float16)
tensor(1.5010, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(1.2715, device='cuda:0', dtype=torch.float16) tensor(0.1372, device='cuda:0', dtype=torch.float16)
tensor(0.2229, device='cuda:0')
old_score: tensor(0.1383, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1260, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.253493309020996
Validation after dual ascent:
out_inf: tensor(16.7500, device='cuda:0', dtype=torch.float16) tensor(1.0527, device='cuda:0', dtype=torch.float16)
tensor(0.9619, device='cuda:0', dtype=torch.float16) tensor(0.1256, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.1244, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.1256, device='cuda:0', dtype=torch.float16)
10 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1328, device='cuda:0', dtype=torch.float16) tensor(0.2866, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0819, device='cuda:0', dtype=torch.float16)
tensor(0.6812, device='cuda:0', dtype=torch.float16) tensor(0.0812, device='cuda:0', dtype=torch.float16)
tensor(0.6152, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(0.7485, device='cuda:0', dtype=torch.float16) tensor(0.0817, device='cuda:0', dtype=torch.float16)
tensor(0.0966, device='cuda:0')
old_score: tensor(0.0822, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0754, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.186972379684448
Validation after dual ascent:
out_inf: tensor(7.1328, device='cuda:0', dtype=torch.float16) tensor(0.2866, device='cuda:0', dtype=torch.float16)
tensor(0.7041, device='cuda:0', dtype=torch.float16) tensor(0.0755, device='cuda:0', dtype=torch.float16)
tensor(0.6289, device='cuda:0', dtype=torch.float16) tensor(0.0742, device='cuda:0', dtype=torch.float16)
tensor(0.6343, device='cuda:0', dtype=torch.float16) tensor(0.0766, device='cuda:0', dtype=torch.float16)
tensor(0.6338, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
10 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.2305, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.2405, device='cuda:0', dtype=torch.float16) tensor(0.0234, device='cuda:0', dtype=torch.float16)
tensor(0.2496, device='cuda:0', dtype=torch.float16) tensor(0.0243, device='cuda:0', dtype=torch.float16)
tensor(0.2605, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
tensor(0.2278, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0144, device='cuda:0')
tensor(0.0110, device='cuda:0')
old_score: tensor(0.0245, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0224, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.507521390914917
Validation after dual ascent:
out_inf: tensor(6.2305, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.1985, device='cuda:0', dtype=torch.float16) tensor(0.0214, device='cuda:0', dtype=torch.float16)
tensor(0.2151, device='cuda:0', dtype=torch.float16) tensor(0.0222, device='cuda:0', dtype=torch.float16)
tensor(0.2242, device='cuda:0', dtype=torch.float16) tensor(0.0250, device='cuda:0', dtype=torch.float16)
tensor(0.1934, device='cuda:0', dtype=torch.float16) tensor(0.0210, device='cuda:0', dtype=torch.float16)
10 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.0859, device='cuda:0', dtype=torch.float16) tensor(0.3325, device='cuda:0', dtype=torch.float16)
tensor(0.7070, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.7012, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.6914, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
tensor(0.7129, device='cuda:0', dtype=torch.float16) tensor(0.0720, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0057, device='cuda:0')
tensor(0.0463, device='cuda:0')
old_score: tensor(0.0723, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0665, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.231618404388428
Validation after dual ascent:
out_inf: tensor(6.0859, device='cuda:0', dtype=torch.float16) tensor(0.3325, device='cuda:0', dtype=torch.float16)
tensor(0.7715, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.6309, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
tensor(0.6440, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
10 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.5801, device='cuda:0', dtype=torch.float16) tensor(0.2322, device='cuda:0', dtype=torch.float16)
tensor(0.8457, device='cuda:0', dtype=torch.float16) tensor(0.0691, device='cuda:0', dtype=torch.float16)
tensor(0.5068, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
tensor(0.6758, device='cuda:0', dtype=torch.float16) tensor(0.0684, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0039, device='cuda:0')
tensor(0.0415, device='cuda:0')
old_score: tensor(0.0687, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0633, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.228935480117798
Validation after dual ascent:
out_inf: tensor(3.5801, device='cuda:0', dtype=torch.float16) tensor(0.2322, device='cuda:0', dtype=torch.float16)
tensor(0.9395, device='cuda:0', dtype=torch.float16) tensor(0.0639, device='cuda:0', dtype=torch.float16)
tensor(0.4795, device='cuda:0', dtype=torch.float16) tensor(0.0615, device='cuda:0', dtype=torch.float16)
tensor(0.6602, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0634, device='cuda:0', dtype=torch.float16)
10 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.5098, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
tensor(0.2374, device='cuda:0', dtype=torch.float16) tensor(0.0286, device='cuda:0', dtype=torch.float16)
tensor(0.2368, device='cuda:0', dtype=torch.float16) tensor(0.0267, device='cuda:0', dtype=torch.float16)
tensor(0.2417, device='cuda:0', dtype=torch.float16) tensor(0.0281, device='cuda:0', dtype=torch.float16)
tensor(0.2725, device='cuda:0', dtype=torch.float16) tensor(0.0281, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0070, device='cuda:0')
tensor(0.0127, device='cuda:0')
old_score: tensor(0.0279, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0267, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.339234352111816
Validation after dual ascent:
out_inf: tensor(2.5098, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
tensor(0.2394, device='cuda:0', dtype=torch.float16) tensor(0.0275, device='cuda:0', dtype=torch.float16)
tensor(0.2366, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
tensor(0.2306, device='cuda:0', dtype=torch.float16) tensor(0.0268, device='cuda:0', dtype=torch.float16)
tensor(0.2532, device='cuda:0', dtype=torch.float16) tensor(0.0271, device='cuda:0', dtype=torch.float16)
layer 10 done
11 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.6719, device='cuda:0', dtype=torch.float16) tensor(0.7910, device='cuda:0', dtype=torch.float16)
tensor(2.1836, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
tensor(1.4385, device='cuda:0', dtype=torch.float16) tensor(0.1392, device='cuda:0', dtype=torch.float16)
tensor(1.2393, device='cuda:0', dtype=torch.float16) tensor(0.1438, device='cuda:0', dtype=torch.float16)
tensor(1.1768, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0152, device='cuda:0')
tensor(0.2895, device='cuda:0')
old_score: tensor(0.1409, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1294, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5082051753997803
Validation after dual ascent:
out_inf: tensor(18.6719, device='cuda:0', dtype=torch.float16) tensor(0.7910, device='cuda:0', dtype=torch.float16)
tensor(1.8008, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(1.4355, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(1.2363, device='cuda:0', dtype=torch.float16) tensor(0.1317, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
11 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.9688, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(1.4111, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
tensor(1.0996, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0168, device='cuda:0')
tensor(0.2901, device='cuda:0')
old_score: tensor(0.1401, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1284, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.507204055786133
Validation after dual ascent:
out_inf: tensor(15.9688, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(1.1592, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.0459, device='cuda:0', dtype=torch.float16) tensor(0.1287, device='cuda:0', dtype=torch.float16)
11 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.1562, device='cuda:0', dtype=torch.float16) tensor(0.3276, device='cuda:0', dtype=torch.float16)
tensor(0.7520, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(0.7266, device='cuda:0', dtype=torch.float16) tensor(0.0948, device='cuda:0', dtype=torch.float16)
tensor(0.7710, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
tensor(0.7085, device='cuda:0', dtype=torch.float16) tensor(0.0964, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0086, device='cuda:0')
tensor(0.1662, device='cuda:0')
old_score: tensor(0.0964, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0891, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.502011775970459
Validation after dual ascent:
out_inf: tensor(8.1562, device='cuda:0', dtype=torch.float16) tensor(0.3276, device='cuda:0', dtype=torch.float16)
tensor(0.7407, device='cuda:0', dtype=torch.float16) tensor(0.0896, device='cuda:0', dtype=torch.float16)
tensor(0.7383, device='cuda:0', dtype=torch.float16) tensor(0.0869, device='cuda:0', dtype=torch.float16)
tensor(0.6904, device='cuda:0', dtype=torch.float16) tensor(0.0901, device='cuda:0', dtype=torch.float16)
tensor(0.6938, device='cuda:0', dtype=torch.float16) tensor(0.0895, device='cuda:0', dtype=torch.float16)
11 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1484, device='cuda:0', dtype=torch.float16) tensor(0.0781, device='cuda:0', dtype=torch.float16)
tensor(0.2573, device='cuda:0', dtype=torch.float16) tensor(0.0250, device='cuda:0', dtype=torch.float16)
tensor(0.2771, device='cuda:0', dtype=torch.float16) tensor(0.0280, device='cuda:0', dtype=torch.float16)
tensor(0.2961, device='cuda:0', dtype=torch.float16) tensor(0.0322, device='cuda:0', dtype=torch.float16)
tensor(0.2693, device='cuda:0', dtype=torch.float16) tensor(0.0235, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0129, device='cuda:0')
tensor(0.0113, device='cuda:0')
old_score: tensor(0.0272, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0250, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5020389556884766
Validation after dual ascent:
out_inf: tensor(6.1484, device='cuda:0', dtype=torch.float16) tensor(0.0781, device='cuda:0', dtype=torch.float16)
tensor(0.2380, device='cuda:0', dtype=torch.float16) tensor(0.0230, device='cuda:0', dtype=torch.float16)
tensor(0.2568, device='cuda:0', dtype=torch.float16) tensor(0.0257, device='cuda:0', dtype=torch.float16)
tensor(0.2993, device='cuda:0', dtype=torch.float16) tensor(0.0295, device='cuda:0', dtype=torch.float16)
tensor(0.2383, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
11 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.7734, device='cuda:0', dtype=torch.float16) tensor(0.3384, device='cuda:0', dtype=torch.float16)
tensor(0.7246, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(0.6895, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.6274, device='cuda:0', dtype=torch.float16) tensor(0.0778, device='cuda:0', dtype=torch.float16)
tensor(0.8535, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0061, device='cuda:0')
tensor(0.0525, device='cuda:0')
old_score: tensor(0.0759, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0701, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.216317415237427
Validation after dual ascent:
out_inf: tensor(6.7734, device='cuda:0', dtype=torch.float16) tensor(0.3384, device='cuda:0', dtype=torch.float16)
tensor(0.7500, device='cuda:0', dtype=torch.float16) tensor(0.0705, device='cuda:0', dtype=torch.float16)
tensor(0.6426, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.6055, device='cuda:0', dtype=torch.float16) tensor(0.0716, device='cuda:0', dtype=torch.float16)
tensor(0.8086, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
11 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4492, device='cuda:0', dtype=torch.float16) tensor(0.2350, device='cuda:0', dtype=torch.float16)
tensor(0.6426, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.5908, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.5747, device='cuda:0', dtype=torch.float16) tensor(0.0746, device='cuda:0', dtype=torch.float16)
tensor(0.6387, device='cuda:0', dtype=torch.float16) tensor(0.0727, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0043, device='cuda:0')
tensor(0.0482, device='cuda:0')
old_score: tensor(0.0728, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0673, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.217159032821655
Validation after dual ascent:
out_inf: tensor(4.4492, device='cuda:0', dtype=torch.float16) tensor(0.2350, device='cuda:0', dtype=torch.float16)
tensor(0.5947, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.5449, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(0.5645, device='cuda:0', dtype=torch.float16) tensor(0.0687, device='cuda:0', dtype=torch.float16)
tensor(0.6152, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
11 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(0.3130, device='cuda:0', dtype=torch.float16) tensor(0.0293, device='cuda:0', dtype=torch.float16)
tensor(0.2487, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
tensor(0.2661, device='cuda:0', dtype=torch.float16) tensor(0.0298, device='cuda:0', dtype=torch.float16)
tensor(0.2659, device='cuda:0', dtype=torch.float16) tensor(0.0299, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0042, device='cuda:0')
tensor(0.0061, device='cuda:0')
old_score: tensor(0.0294, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0282, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.301279306411743
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
tensor(0.3064, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
tensor(0.2426, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(0.2671, device='cuda:0', dtype=torch.float16) tensor(0.0284, device='cuda:0', dtype=torch.float16)
tensor(0.2725, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
layer 11 done
12 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.9375, device='cuda:0', dtype=torch.float16) tensor(0.7910, device='cuda:0', dtype=torch.float16)
tensor(1.2920, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.2910, device='cuda:0', dtype=torch.float16) tensor(0.1499, device='cuda:0', dtype=torch.float16)
tensor(1.2100, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
tensor(1.1992, device='cuda:0', dtype=torch.float16) tensor(0.1504, device='cuda:0', dtype=torch.float16)
tensor(0.1000, device='cuda:0')
old_score: tensor(0.1519, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1399, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.199333667755127
Validation after dual ascent:
out_inf: tensor(17.9375, device='cuda:0', dtype=torch.float16) tensor(0.7910, device='cuda:0', dtype=torch.float16)
tensor(1.1826, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1370, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.1433, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
12 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.3516, device='cuda:0', dtype=torch.float16) tensor(1.0420, device='cuda:0', dtype=torch.float16)
tensor(1.1689, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(1.3340, device='cuda:0', dtype=torch.float16) tensor(0.1521, device='cuda:0', dtype=torch.float16)
tensor(1.1914, device='cuda:0', dtype=torch.float16) tensor(0.1586, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
tensor(0.1021, device='cuda:0')
old_score: tensor(0.1543, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1416, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.248920917510986
Validation after dual ascent:
out_inf: tensor(15.3516, device='cuda:0', dtype=torch.float16) tensor(1.0420, device='cuda:0', dtype=torch.float16)
tensor(1.1084, device='cuda:0', dtype=torch.float16) tensor(0.1417, device='cuda:0', dtype=torch.float16)
tensor(1.1904, device='cuda:0', dtype=torch.float16) tensor(0.1387, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
12 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.2852, device='cuda:0', dtype=torch.float16) tensor(0.3228, device='cuda:0', dtype=torch.float16)
tensor(0.7720, device='cuda:0', dtype=torch.float16) tensor(0.0965, device='cuda:0', dtype=torch.float16)
tensor(0.6831, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.7148, device='cuda:0', dtype=torch.float16) tensor(0.0991, device='cuda:0', dtype=torch.float16)
tensor(0.7021, device='cuda:0', dtype=torch.float16) tensor(0.0960, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0172, device='cuda:0')
tensor(0.0981, device='cuda:0')
old_score: tensor(0.0966, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0895, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.258500337600708
Validation after dual ascent:
out_inf: tensor(6.2852, device='cuda:0', dtype=torch.float16) tensor(0.3228, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(0.6499, device='cuda:0', dtype=torch.float16) tensor(0.0873, device='cuda:0', dtype=torch.float16)
tensor(0.6836, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
tensor(0.6865, device='cuda:0', dtype=torch.float16) tensor(0.0895, device='cuda:0', dtype=torch.float16)
12 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9414, device='cuda:0', dtype=torch.float16) tensor(0.0849, device='cuda:0', dtype=torch.float16)
tensor(0.2529, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
tensor(0.2676, device='cuda:0', dtype=torch.float16) tensor(0.0300, device='cuda:0', dtype=torch.float16)
tensor(0.2974, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(0.2607, device='cuda:0', dtype=torch.float16) tensor(0.0275, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0109, device='cuda:0')
tensor(0.0203, device='cuda:0')
old_score: tensor(0.0297, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0273, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.00345516204834
Validation after dual ascent:
out_inf: tensor(5.9414, device='cuda:0', dtype=torch.float16) tensor(0.0849, device='cuda:0', dtype=torch.float16)
tensor(0.2581, device='cuda:0', dtype=torch.float16) tensor(0.0260, device='cuda:0', dtype=torch.float16)
tensor(0.2371, device='cuda:0', dtype=torch.float16) tensor(0.0273, device='cuda:0', dtype=torch.float16)
tensor(0.2554, device='cuda:0', dtype=torch.float16) tensor(0.0305, device='cuda:0', dtype=torch.float16)
tensor(0.2671, device='cuda:0', dtype=torch.float16) tensor(0.0253, device='cuda:0', dtype=torch.float16)
12 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4297, device='cuda:0', dtype=torch.float16) tensor(0.3403, device='cuda:0', dtype=torch.float16)
tensor(0.7031, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(0.7305, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0807, device='cuda:0', dtype=torch.float16)
tensor(0.8389, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0062, device='cuda:0')
tensor(0.0579, device='cuda:0')
old_score: tensor(0.0784, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0724, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.234925746917725
Validation after dual ascent:
out_inf: tensor(6.4297, device='cuda:0', dtype=torch.float16) tensor(0.3403, device='cuda:0', dtype=torch.float16)
tensor(0.6523, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
tensor(0.6504, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0744, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
12 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7461, device='cuda:0', dtype=torch.float16) tensor(0.2445, device='cuda:0', dtype=torch.float16)
tensor(0.7207, device='cuda:0', dtype=torch.float16) tensor(0.0761, device='cuda:0', dtype=torch.float16)
tensor(0.6357, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0785, device='cuda:0', dtype=torch.float16)
tensor(0.5977, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0046, device='cuda:0')
tensor(0.0543, device='cuda:0')
old_score: tensor(0.0762, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0706, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.239600419998169
Validation after dual ascent:
out_inf: tensor(4.7461, device='cuda:0', dtype=torch.float16) tensor(0.2445, device='cuda:0', dtype=torch.float16)
tensor(0.6631, device='cuda:0', dtype=torch.float16) tensor(0.0708, device='cuda:0', dtype=torch.float16)
tensor(0.6035, device='cuda:0', dtype=torch.float16) tensor(0.0684, device='cuda:0', dtype=torch.float16)
tensor(0.6123, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(0.5664, device='cuda:0', dtype=torch.float16) tensor(0.0707, device='cuda:0', dtype=torch.float16)
12 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.5488, device='cuda:0', dtype=torch.float16) tensor(0.0890, device='cuda:0', dtype=torch.float16)
tensor(0.2651, device='cuda:0', dtype=torch.float16) tensor(0.0315, device='cuda:0', dtype=torch.float16)
tensor(0.2529, device='cuda:0', dtype=torch.float16) tensor(0.0302, device='cuda:0', dtype=torch.float16)
tensor(0.2478, device='cuda:0', dtype=torch.float16) tensor(0.0319, device='cuda:0', dtype=torch.float16)
tensor(0.3025, device='cuda:0', dtype=torch.float16) tensor(0.0317, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0074, device='cuda:0')
tensor(0.0309, device='cuda:0')
old_score: tensor(0.0313, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0301, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.459729433059692
Validation after dual ascent:
out_inf: tensor(2.5488, device='cuda:0', dtype=torch.float16) tensor(0.0890, device='cuda:0', dtype=torch.float16)
tensor(0.2507, device='cuda:0', dtype=torch.float16) tensor(0.0303, device='cuda:0', dtype=torch.float16)
tensor(0.2395, device='cuda:0', dtype=torch.float16) tensor(0.0289, device='cuda:0', dtype=torch.float16)
tensor(0.2495, device='cuda:0', dtype=torch.float16) tensor(0.0305, device='cuda:0', dtype=torch.float16)
tensor(0.3145, device='cuda:0', dtype=torch.float16) tensor(0.0305, device='cuda:0', dtype=torch.float16)
layer 12 done
13 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.7422, device='cuda:0', dtype=torch.float16) tensor(0.7993, device='cuda:0', dtype=torch.float16)
tensor(1.3262, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
tensor(1.2549, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
tensor(0.1917, device='cuda:0')
old_score: tensor(0.1538, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1420, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.209045648574829
Validation after dual ascent:
out_inf: tensor(14.7422, device='cuda:0', dtype=torch.float16) tensor(0.7993, device='cuda:0', dtype=torch.float16)
tensor(1.2002, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(1.1416, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(1.1611, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
13 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.6875, device='cuda:0', dtype=torch.float16) tensor(0.9995, device='cuda:0', dtype=torch.float16)
tensor(1.1631, device='cuda:0', dtype=torch.float16) tensor(0.1533, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.1527, device='cuda:0', dtype=torch.float16)
tensor(1.1855, device='cuda:0', dtype=torch.float16) tensor(0.1587, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(0.1915, device='cuda:0')
old_score: tensor(0.1545, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1426, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.25344967842102
Validation after dual ascent:
out_inf: tensor(17.6875, device='cuda:0', dtype=torch.float16) tensor(0.9995, device='cuda:0', dtype=torch.float16)
tensor(1.0723, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1396, device='cuda:0', dtype=torch.float16)
tensor(1.0869, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
13 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0586, device='cuda:0', dtype=torch.float16) tensor(0.3252, device='cuda:0', dtype=torch.float16)
tensor(0.7573, device='cuda:0', dtype=torch.float16) tensor(0.1015, device='cuda:0', dtype=torch.float16)
tensor(0.7900, device='cuda:0', dtype=torch.float16) tensor(0.1001, device='cuda:0', dtype=torch.float16)
tensor(0.8652, device='cuda:0', dtype=torch.float16) tensor(0.1042, device='cuda:0', dtype=torch.float16)
tensor(0.7329, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(0.0899, device='cuda:0')
old_score: tensor(0.1018, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0945, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.21014666557312
Validation after dual ascent:
out_inf: tensor(5.0586, device='cuda:0', dtype=torch.float16) tensor(0.3252, device='cuda:0', dtype=torch.float16)
tensor(0.7183, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(0.7622, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0965, device='cuda:0', dtype=torch.float16)
tensor(0.7412, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
13 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4922, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.2671, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.2576, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.2832, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.2974, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0131, device='cuda:0')
tensor(0.0260, device='cuda:0')
old_score: tensor(0.0296, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0270, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.747777462005615
Validation after dual ascent:
out_inf: tensor(5.4922, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.2480, device='cuda:0', dtype=torch.float16) tensor(0.0257, device='cuda:0', dtype=torch.float16)
tensor(0.2472, device='cuda:0', dtype=torch.float16) tensor(0.0262, device='cuda:0', dtype=torch.float16)
tensor(0.2834, device='cuda:0', dtype=torch.float16) tensor(0.0298, device='cuda:0', dtype=torch.float16)
tensor(0.2742, device='cuda:0', dtype=torch.float16) tensor(0.0262, device='cuda:0', dtype=torch.float16)
13 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.9844, device='cuda:0', dtype=torch.float16) tensor(0.3594, device='cuda:0', dtype=torch.float16)
tensor(0.8770, device='cuda:0', dtype=torch.float16) tensor(0.0803, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0784, device='cuda:0', dtype=torch.float16)
tensor(0.8008, device='cuda:0', dtype=torch.float16) tensor(0.0828, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0807, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0066, device='cuda:0')
tensor(0.0656, device='cuda:0')
old_score: tensor(0.0806, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0745, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.246200323104858
Validation after dual ascent:
out_inf: tensor(6.9844, device='cuda:0', dtype=torch.float16) tensor(0.3594, device='cuda:0', dtype=torch.float16)
tensor(0.8223, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0721, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(0.8164, device='cuda:0', dtype=torch.float16) tensor(0.0751, device='cuda:0', dtype=torch.float16)
13 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0664, device='cuda:0', dtype=torch.float16) tensor(0.2598, device='cuda:0', dtype=torch.float16)
tensor(0.7832, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
tensor(0.6089, device='cuda:0', dtype=torch.float16) tensor(0.0775, device='cuda:0', dtype=torch.float16)
tensor(0.6104, device='cuda:0', dtype=torch.float16) tensor(0.0815, device='cuda:0', dtype=torch.float16)
tensor(0.6494, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0052, device='cuda:0')
tensor(0.0619, device='cuda:0')
old_score: tensor(0.0795, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0736, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.243873834609985
Validation after dual ascent:
out_inf: tensor(5.0664, device='cuda:0', dtype=torch.float16) tensor(0.2598, device='cuda:0', dtype=torch.float16)
tensor(0.7383, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
tensor(0.5679, device='cuda:0', dtype=torch.float16) tensor(0.0713, device='cuda:0', dtype=torch.float16)
tensor(0.5942, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0742, device='cuda:0', dtype=torch.float16)
13 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.1953, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(0.3057, device='cuda:0', dtype=torch.float16) tensor(0.0355, device='cuda:0', dtype=torch.float16)
tensor(0.2930, device='cuda:0', dtype=torch.float16) tensor(0.0336, device='cuda:0', dtype=torch.float16)
tensor(0.2744, device='cuda:0', dtype=torch.float16) tensor(0.0346, device='cuda:0', dtype=torch.float16)
tensor(0.3306, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0037, device='cuda:0')
tensor(0.0375, device='cuda:0')
old_score: tensor(0.0350, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0335, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.442909240722656
Validation after dual ascent:
out_inf: tensor(4.1953, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(0.2966, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.2864, device='cuda:0', dtype=torch.float16) tensor(0.0320, device='cuda:0', dtype=torch.float16)
tensor(0.2678, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(0.3428, device='cuda:0', dtype=torch.float16) tensor(0.0348, device='cuda:0', dtype=torch.float16)
layer 13 done
14 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.7734, device='cuda:0', dtype=torch.float16) tensor(0.8037, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.1553, device='cuda:0', dtype=torch.float16)
tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(1.5742, device='cuda:0', dtype=torch.float16) tensor(0.1602, device='cuda:0', dtype=torch.float16)
tensor(1.2559, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(0.1231, device='cuda:0')
old_score: tensor(0.1562, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1440, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.209877490997314
Validation after dual ascent:
out_inf: tensor(13.7734, device='cuda:0', dtype=torch.float16) tensor(0.8037, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.7168, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
14 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.6094, device='cuda:0', dtype=torch.float16) tensor(1.0781, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.1566, device='cuda:0', dtype=torch.float16)
tensor(1.8027, device='cuda:0', dtype=torch.float16) tensor(0.1547, device='cuda:0', dtype=torch.float16)
tensor(1.2129, device='cuda:0', dtype=torch.float16) tensor(0.1611, device='cuda:0', dtype=torch.float16)
tensor(1.4424, device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
tensor(0.1125, device='cuda:0')
old_score: tensor(0.1575, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1448, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.248932123184204
Validation after dual ascent:
out_inf: tensor(18.6094, device='cuda:0', dtype=torch.float16) tensor(1.0781, device='cuda:0', dtype=torch.float16)
tensor(1.0986, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.6895, device='cuda:0', dtype=torch.float16) tensor(0.1409, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
14 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4961, device='cuda:0', dtype=torch.float16) tensor(0.3240, device='cuda:0', dtype=torch.float16)
tensor(0.8467, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(0.7559, device='cuda:0', dtype=torch.float16) tensor(0.0995, device='cuda:0', dtype=torch.float16)
tensor(0.7793, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
tensor(0.7822, device='cuda:0', dtype=torch.float16) tensor(0.1027, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0191, device='cuda:0')
tensor(0.1089, device='cuda:0')
old_score: tensor(0.1019, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0945, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2572896480560303
Validation after dual ascent:
out_inf: tensor(4.4961, device='cuda:0', dtype=torch.float16) tensor(0.3240, device='cuda:0', dtype=torch.float16)
tensor(0.8799, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0915, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
tensor(0.7793, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
14 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.3867, device='cuda:0', dtype=torch.float16) tensor(0.0971, device='cuda:0', dtype=torch.float16)
tensor(0.3284, device='cuda:0', dtype=torch.float16) tensor(0.0330, device='cuda:0', dtype=torch.float16)
tensor(0.2993, device='cuda:0', dtype=torch.float16) tensor(0.0309, device='cuda:0', dtype=torch.float16)
tensor(0.3127, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
tensor(0.3293, device='cuda:0', dtype=torch.float16) tensor(0.0322, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0109, device='cuda:0')
tensor(0.0774, device='cuda:0')
old_score: tensor(0.0328, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0302, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7626090049743652
Validation after dual ascent:
out_inf: tensor(7.3867, device='cuda:0', dtype=torch.float16) tensor(0.0971, device='cuda:0', dtype=torch.float16)
tensor(0.2798, device='cuda:0', dtype=torch.float16) tensor(0.0302, device='cuda:0', dtype=torch.float16)
tensor(0.2537, device='cuda:0', dtype=torch.float16) tensor(0.0283, device='cuda:0', dtype=torch.float16)
tensor(0.3291, device='cuda:0', dtype=torch.float16) tensor(0.0323, device='cuda:0', dtype=torch.float16)
tensor(0.2988, device='cuda:0', dtype=torch.float16) tensor(0.0299, device='cuda:0', dtype=torch.float16)
14 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.3867, device='cuda:0', dtype=torch.float16) tensor(0.3689, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
tensor(0.8311, device='cuda:0', dtype=torch.float16) tensor(0.0811, device='cuda:0', dtype=torch.float16)
tensor(0.7988, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.9727, device='cuda:0', dtype=torch.float16) tensor(0.0848, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0070, device='cuda:0')
tensor(0.0749, device='cuda:0')
old_score: tensor(0.0844, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0784, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.236873388290405
Validation after dual ascent:
out_inf: tensor(7.3867, device='cuda:0', dtype=torch.float16) tensor(0.3689, device='cuda:0', dtype=torch.float16)
tensor(0.8047, device='cuda:0', dtype=torch.float16) tensor(0.0786, device='cuda:0', dtype=torch.float16)
tensor(0.7812, device='cuda:0', dtype=torch.float16) tensor(0.0749, device='cuda:0', dtype=torch.float16)
tensor(0.7144, device='cuda:0', dtype=torch.float16) tensor(0.0808, device='cuda:0', dtype=torch.float16)
tensor(0.8535, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
14 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0234, device='cuda:0', dtype=torch.float16) tensor(0.2725, device='cuda:0', dtype=torch.float16)
tensor(0.7285, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0802, device='cuda:0', dtype=torch.float16)
tensor(0.6787, device='cuda:0', dtype=torch.float16) tensor(0.0862, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0057, device='cuda:0')
tensor(0.0716, device='cuda:0')
old_score: tensor(0.0835, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0776, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.233468532562256
Validation after dual ascent:
out_inf: tensor(5.0234, device='cuda:0', dtype=torch.float16) tensor(0.2725, device='cuda:0', dtype=torch.float16)
tensor(0.7197, device='cuda:0', dtype=torch.float16) tensor(0.0778, device='cuda:0', dtype=torch.float16)
tensor(0.8086, device='cuda:0', dtype=torch.float16) tensor(0.0741, device='cuda:0', dtype=torch.float16)
tensor(0.6436, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(0.7988, device='cuda:0', dtype=torch.float16) tensor(0.0786, device='cuda:0', dtype=torch.float16)
14 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.8164, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(0.3611, device='cuda:0', dtype=torch.float16) tensor(0.0390, device='cuda:0', dtype=torch.float16)
tensor(0.3127, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.3113, device='cuda:0', dtype=torch.float16) tensor(0.0371, device='cuda:0', dtype=torch.float16)
tensor(0.3447, device='cuda:0', dtype=torch.float16) tensor(0.0389, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0032, device='cuda:0')
tensor(0.0437, device='cuda:0')
old_score: tensor(0.0376, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0361, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.451336860656738
Validation after dual ascent:
out_inf: tensor(2.8164, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(0.3516, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.3015, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.2966, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.3064, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
layer 14 done
15 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.6484, device='cuda:0', dtype=torch.float16) tensor(0.7910, device='cuda:0', dtype=torch.float16)
tensor(1.2451, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
tensor(1.3018, device='cuda:0', dtype=torch.float16) tensor(0.1562, device='cuda:0', dtype=torch.float16)
tensor(1.3613, device='cuda:0', dtype=torch.float16) tensor(0.1527, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0155, device='cuda:0')
tensor(0.2905, device='cuda:0')
old_score: tensor(0.1519, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1404, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.50584077835083
Validation after dual ascent:
out_inf: tensor(15.6484, device='cuda:0', dtype=torch.float16) tensor(0.7910, device='cuda:0', dtype=torch.float16)
tensor(1.2129, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
tensor(1.2344, device='cuda:0', dtype=torch.float16) tensor(0.1350, device='cuda:0', dtype=torch.float16)
tensor(1.2627, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(1.2471, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
15 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.4531, device='cuda:0', dtype=torch.float16) tensor(1.0410, device='cuda:0', dtype=torch.float16)
tensor(1.1855, device='cuda:0', dtype=torch.float16) tensor(0.1542, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(1.1768, device='cuda:0', dtype=torch.float16) tensor(0.1593, device='cuda:0', dtype=torch.float16)
tensor(1.3340, device='cuda:0', dtype=torch.float16) tensor(0.1558, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0168, device='cuda:0')
tensor(0.3032, device='cuda:0')
old_score: tensor(0.1549, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1428, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.50909686088562
Validation after dual ascent:
out_inf: tensor(15.4531, device='cuda:0', dtype=torch.float16) tensor(1.0410, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.1429, device='cuda:0', dtype=torch.float16)
tensor(1.0381, device='cuda:0', dtype=torch.float16) tensor(0.1375, device='cuda:0', dtype=torch.float16)
tensor(1.1309, device='cuda:0', dtype=torch.float16) tensor(0.1465, device='cuda:0', dtype=torch.float16)
tensor(1.2080, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
15 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9688, device='cuda:0', dtype=torch.float16) tensor(0.3335, device='cuda:0', dtype=torch.float16)
tensor(0.7432, device='cuda:0', dtype=torch.float16) tensor(0.1041, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(0.8018, device='cuda:0', dtype=torch.float16) tensor(0.1067, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0092, device='cuda:0')
tensor(0.1850, device='cuda:0')
old_score: tensor(0.1041, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0967, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4990501403808594
Validation after dual ascent:
out_inf: tensor(4.9688, device='cuda:0', dtype=torch.float16) tensor(0.3335, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.0971, device='cuda:0', dtype=torch.float16)
tensor(0.7505, device='cuda:0', dtype=torch.float16) tensor(0.0926, device='cuda:0', dtype=torch.float16)
tensor(0.6929, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0984, device='cuda:0', dtype=torch.float16)
15 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.8203, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
tensor(0.3123, device='cuda:0', dtype=torch.float16) tensor(0.0336, device='cuda:0', dtype=torch.float16)
tensor(0.2998, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(0.3687, device='cuda:0', dtype=torch.float16) tensor(0.0355, device='cuda:0', dtype=torch.float16)
tensor(0.3318, device='cuda:0', dtype=torch.float16) tensor(0.0337, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0148, device='cuda:0')
tensor(0.1194, device='cuda:0')
old_score: tensor(0.0340, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0313, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.755157232284546
Validation after dual ascent:
out_inf: tensor(6.8203, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
tensor(0.3035, device='cuda:0', dtype=torch.float16) tensor(0.0309, device='cuda:0', dtype=torch.float16)
tensor(0.2722, device='cuda:0', dtype=torch.float16) tensor(0.0306, device='cuda:0', dtype=torch.float16)
tensor(0.3198, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.3179, device='cuda:0', dtype=torch.float16) tensor(0.0312, device='cuda:0', dtype=torch.float16)
15 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8203, device='cuda:0', dtype=torch.float16) tensor(0.3862, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.0862, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0822, device='cuda:0', dtype=torch.float16)
tensor(0.8066, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
tensor(0.9639, device='cuda:0', dtype=torch.float16) tensor(0.0869, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0077, device='cuda:0')
tensor(0.0826, device='cuda:0')
old_score: tensor(0.0861, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0797, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.213445663452148
Validation after dual ascent:
out_inf: tensor(7.8203, device='cuda:0', dtype=torch.float16) tensor(0.3862, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.0802, device='cuda:0', dtype=torch.float16)
tensor(0.7285, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
tensor(0.7285, device='cuda:0', dtype=torch.float16) tensor(0.0822, device='cuda:0', dtype=torch.float16)
tensor(0.9863, device='cuda:0', dtype=torch.float16) tensor(0.0811, device='cuda:0', dtype=torch.float16)
15 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.2854, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(0.6973, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
tensor(0.7002, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
tensor(0.9883, device='cuda:0', dtype=torch.float16) tensor(0.0860, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0064, device='cuda:0')
tensor(0.0787, device='cuda:0')
old_score: tensor(0.0852, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0790, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.215274810791016
Validation after dual ascent:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.2854, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.6743, device='cuda:0', dtype=torch.float16) tensor(0.0747, device='cuda:0', dtype=torch.float16)
tensor(0.6294, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
tensor(0.9473, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
15 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9336, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(0.4282, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.3123, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
tensor(0.3662, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
tensor(0.3542, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0037, device='cuda:0')
tensor(0.0517, device='cuda:0')
old_score: tensor(0.0402, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0385, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.378143548965454
Validation after dual ascent:
out_inf: tensor(4.9336, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(0.4075, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.3003, device='cuda:0', dtype=torch.float16) tensor(0.0360, device='cuda:0', dtype=torch.float16)
tensor(0.3535, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
tensor(0.3555, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
layer 15 done
16 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.6094, device='cuda:0', dtype=torch.float16) tensor(0.7935, device='cuda:0', dtype=torch.float16)
tensor(2.0820, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
tensor(2.1562, device='cuda:0', dtype=torch.float16) tensor(0.1449, device='cuda:0', dtype=torch.float16)
tensor(1.2646, device='cuda:0', dtype=torch.float16) tensor(0.1547, device='cuda:0', dtype=torch.float16)
tensor(1.5020, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0159, device='cuda:0')
tensor(0.2986, device='cuda:0')
old_score: tensor(0.1501, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1383, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5043177604675293
Validation after dual ascent:
out_inf: tensor(15.6094, device='cuda:0', dtype=torch.float16) tensor(0.7935, device='cuda:0', dtype=torch.float16)
tensor(1.9834, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(2.0352, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(1.1895, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
16 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.7812, device='cuda:0', dtype=torch.float16) tensor(1.0645, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
tensor(1.3682, device='cuda:0', dtype=torch.float16) tensor(0.1466, device='cuda:0', dtype=torch.float16)
tensor(1.2744, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0175, device='cuda:0')
tensor(0.3087, device='cuda:0')
old_score: tensor(0.1521, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1398, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5041611194610596
Validation after dual ascent:
out_inf: tensor(16.7812, device='cuda:0', dtype=torch.float16) tensor(1.0645, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.1407, device='cuda:0', dtype=torch.float16)
tensor(1.2432, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.1543, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
tensor(1.1650, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
16 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8945, device='cuda:0', dtype=torch.float16) tensor(0.3386, device='cuda:0', dtype=torch.float16)
tensor(0.8799, device='cuda:0', dtype=torch.float16) tensor(0.1088, device='cuda:0', dtype=torch.float16)
tensor(0.8296, device='cuda:0', dtype=torch.float16) tensor(0.1036, device='cuda:0', dtype=torch.float16)
tensor(0.7803, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(0.8032, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0097, device='cuda:0')
tensor(0.1939, device='cuda:0')
old_score: tensor(0.1081, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1002, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.491361379623413
Validation after dual ascent:
out_inf: tensor(4.8945, device='cuda:0', dtype=torch.float16) tensor(0.3386, device='cuda:0', dtype=torch.float16)
tensor(0.8066, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(0.8262, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.7676, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.8032, device='cuda:0', dtype=torch.float16) tensor(0.1020, device='cuda:0', dtype=torch.float16)
16 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.5195, device='cuda:0', dtype=torch.float16) tensor(0.1315, device='cuda:0', dtype=torch.float16)
tensor(0.3655, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.3484, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(0.3892, device='cuda:0', dtype=torch.float16) tensor(0.0418, device='cuda:0', dtype=torch.float16)
tensor(0.4307, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0153, device='cuda:0')
tensor(0.1208, device='cuda:0')
old_score: tensor(0.0402, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0371, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 1.7516698837280273
Validation after dual ascent:
out_inf: tensor(7.5195, device='cuda:0', dtype=torch.float16) tensor(0.1315, device='cuda:0', dtype=torch.float16)
tensor(0.3584, device='cuda:0', dtype=torch.float16) tensor(0.0369, device='cuda:0', dtype=torch.float16)
tensor(0.3271, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.3643, device='cuda:0', dtype=torch.float16) tensor(0.0387, device='cuda:0', dtype=torch.float16)
tensor(0.4771, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
16 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.9258, device='cuda:0', dtype=torch.float16) tensor(0.4124, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.0912, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(0.9746, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(1.3984, device='cuda:0', dtype=torch.float16) tensor(0.0912, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0091, device='cuda:0')
tensor(0.0963, device='cuda:0')
old_score: tensor(0.0903, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0831, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.1844322681427
Validation after dual ascent:
out_inf: tensor(7.9258, device='cuda:0', dtype=torch.float16) tensor(0.4124, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.0840, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.0778, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.0847, device='cuda:0', dtype=torch.float16)
16 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.1836, device='cuda:0', dtype=torch.float16) tensor(0.3037, device='cuda:0', dtype=torch.float16)
tensor(0.8291, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(0.6836, device='cuda:0', dtype=torch.float16) tensor(0.0838, device='cuda:0', dtype=torch.float16)
tensor(0.7056, device='cuda:0', dtype=torch.float16) tensor(0.0917, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.0895, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0074, device='cuda:0')
tensor(0.0907, device='cuda:0')
old_score: tensor(0.0886, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0816, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.1855857372283936
Validation after dual ascent:
out_inf: tensor(5.1836, device='cuda:0', dtype=torch.float16) tensor(0.3037, device='cuda:0', dtype=torch.float16)
tensor(0.8301, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.6826, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(0.6768, device='cuda:0', dtype=torch.float16) tensor(0.0843, device='cuda:0', dtype=torch.float16)
tensor(0.9824, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
16 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6719, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(0.4336, device='cuda:0', dtype=torch.float16) tensor(0.0460, device='cuda:0', dtype=torch.float16)
tensor(0.3516, device='cuda:0', dtype=torch.float16) tensor(0.0405, device='cuda:0', dtype=torch.float16)
tensor(0.3823, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.4192, device='cuda:0', dtype=torch.float16) tensor(0.0455, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0048, device='cuda:0')
tensor(0.0646, device='cuda:0')
old_score: tensor(0.0440, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0420, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.308883905410767
Validation after dual ascent:
out_inf: tensor(5.6719, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(0.4207, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
tensor(0.3267, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
tensor(0.3518, device='cuda:0', dtype=torch.float16) tensor(0.0418, device='cuda:0', dtype=torch.float16)
tensor(0.3945, device='cuda:0', dtype=torch.float16) tensor(0.0438, device='cuda:0', dtype=torch.float16)
layer 16 done
17 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.3750, device='cuda:0', dtype=torch.float16) tensor(0.7993, device='cuda:0', dtype=torch.float16)
tensor(1.5449, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(1.5400, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.1483, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0185, device='cuda:0')
tensor(0.1306, device='cuda:0')
old_score: tensor(0.1469, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1343, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2395811080932617
Validation after dual ascent:
out_inf: tensor(16.3750, device='cuda:0', dtype=torch.float16) tensor(0.7993, device='cuda:0', dtype=torch.float16)
tensor(1.4189, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
tensor(1.3330, device='cuda:0', dtype=torch.float16) tensor(0.1389, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1372, device='cuda:0', dtype=torch.float16)
17 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.8750, device='cuda:0', dtype=torch.float16) tensor(1.0195, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
tensor(1.1943, device='cuda:0', dtype=torch.float16) tensor(0.1407, device='cuda:0', dtype=torch.float16)
tensor(1.3467, device='cuda:0', dtype=torch.float16) tensor(0.1541, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.1497, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0191, device='cuda:0')
tensor(0.0493, device='cuda:0')
old_score: tensor(0.1484, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1355, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 9.932294368743896
Validation after dual ascent:
out_inf: tensor(16.8750, device='cuda:0', dtype=torch.float16) tensor(1.0195, device='cuda:0', dtype=torch.float16)
tensor(1.2012, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1266, device='cuda:0', dtype=torch.float16)
tensor(1.0908, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.1382, device='cuda:0', dtype=torch.float16)
17 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2930, device='cuda:0', dtype=torch.float16) tensor(0.3486, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.1070, device='cuda:0', dtype=torch.float16)
tensor(0.7705, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(0.8066, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0083, device='cuda:0')
tensor(0.0779, device='cuda:0')
old_score: tensor(0.1059, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0973, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2349019050598145
Validation after dual ascent:
out_inf: tensor(4.2930, device='cuda:0', dtype=torch.float16) tensor(0.3486, device='cuda:0', dtype=torch.float16)
tensor(0.7783, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
tensor(0.8564, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
tensor(0.8311, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(0.8413, device='cuda:0', dtype=torch.float16) tensor(0.0997, device='cuda:0', dtype=torch.float16)
17 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4297, device='cuda:0', dtype=torch.float16) tensor(0.1074, device='cuda:0', dtype=torch.float16)
tensor(0.3513, device='cuda:0', dtype=torch.float16) tensor(0.0346, device='cuda:0', dtype=torch.float16)
tensor(0.3328, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(0.3203, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
tensor(0.3896, device='cuda:0', dtype=torch.float16) tensor(0.0340, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0104, device='cuda:0')
tensor(0.0145, device='cuda:0')
old_score: tensor(0.0350, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0318, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.231009006500244
Validation after dual ascent:
out_inf: tensor(6.4297, device='cuda:0', dtype=torch.float16) tensor(0.1074, device='cuda:0', dtype=torch.float16)
tensor(0.3467, device='cuda:0', dtype=torch.float16) tensor(0.0312, device='cuda:0', dtype=torch.float16)
tensor(0.2959, device='cuda:0', dtype=torch.float16) tensor(0.0298, device='cuda:0', dtype=torch.float16)
tensor(0.3159, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.3601, device='cuda:0', dtype=torch.float16) tensor(0.0313, device='cuda:0', dtype=torch.float16)
17 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.9609, device='cuda:0', dtype=torch.float16) tensor(0.4336, device='cuda:0', dtype=torch.float16)
tensor(1.0430, device='cuda:0', dtype=torch.float16) tensor(0.0964, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.0885, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.0982, device='cuda:0', dtype=torch.float16)
tensor(0.9922, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0099, device='cuda:0')
tensor(0.1101, device='cuda:0')
old_score: tensor(0.0946, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0870, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.189162254333496
Validation after dual ascent:
out_inf: tensor(8.9609, device='cuda:0', dtype=torch.float16) tensor(0.4336, device='cuda:0', dtype=torch.float16)
tensor(0.9160, device='cuda:0', dtype=torch.float16) tensor(0.0891, device='cuda:0', dtype=torch.float16)
tensor(0.9375, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0899, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0886, device='cuda:0', dtype=torch.float16)
17 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6602, device='cuda:0', dtype=torch.float16) tensor(0.3037, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.0933, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(0.8594, device='cuda:0', dtype=torch.float16) tensor(0.0949, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0079, device='cuda:0')
tensor(0.1017, device='cuda:0')
old_score: tensor(0.0914, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0844, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.190857410430908
Validation after dual ascent:
out_inf: tensor(5.6602, device='cuda:0', dtype=torch.float16) tensor(0.3037, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.0863, device='cuda:0', dtype=torch.float16)
tensor(0.7500, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(0.6870, device='cuda:0', dtype=torch.float16) tensor(0.0870, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
17 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5352, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
tensor(0.4941, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.4023, device='cuda:0', dtype=torch.float16) tensor(0.0395, device='cuda:0', dtype=torch.float16)
tensor(0.3779, device='cuda:0', dtype=torch.float16) tensor(0.0438, device='cuda:0', dtype=torch.float16)
tensor(0.4282, device='cuda:0', dtype=torch.float16) tensor(0.0451, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0046, device='cuda:0')
tensor(0.0637, device='cuda:0')
old_score: tensor(0.0437, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0417, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.343091249465942
Validation after dual ascent:
out_inf: tensor(4.5352, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
tensor(0.4485, device='cuda:0', dtype=torch.float16) tensor(0.0444, device='cuda:0', dtype=torch.float16)
tensor(0.3945, device='cuda:0', dtype=torch.float16) tensor(0.0373, device='cuda:0', dtype=torch.float16)
tensor(0.3503, device='cuda:0', dtype=torch.float16) tensor(0.0417, device='cuda:0', dtype=torch.float16)
tensor(0.4370, device='cuda:0', dtype=torch.float16) tensor(0.0433, device='cuda:0', dtype=torch.float16)
layer 17 done
18 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.5469, device='cuda:0', dtype=torch.float16) tensor(0.8145, device='cuda:0', dtype=torch.float16)
tensor(1.3213, device='cuda:0', dtype=torch.float16) tensor(0.1527, device='cuda:0', dtype=torch.float16)
tensor(1.6680, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(1.3408, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(2.6777, device='cuda:0', dtype=torch.float16) tensor(0.1510, device='cuda:0', dtype=torch.float16)
tensor(0.1419, device='cuda:0')
old_score: tensor(0.1504, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1376, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.216490268707275
Validation after dual ascent:
out_inf: tensor(13.5469, device='cuda:0', dtype=torch.float16) tensor(0.8145, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.1405, device='cuda:0', dtype=torch.float16)
tensor(1.5293, device='cuda:0', dtype=torch.float16) tensor(0.1274, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(2.4180, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
18 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.5938, device='cuda:0', dtype=torch.float16) tensor(0.9888, device='cuda:0', dtype=torch.float16)
tensor(1.2480, device='cuda:0', dtype=torch.float16) tensor(0.1544, device='cuda:0', dtype=torch.float16)
tensor(1.2256, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1586, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(0.1454, device='cuda:0')
old_score: tensor(0.1519, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1384, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.253621816635132
Validation after dual ascent:
out_inf: tensor(18.5938, device='cuda:0', dtype=torch.float16) tensor(0.9888, device='cuda:0', dtype=torch.float16)
tensor(1.1621, device='cuda:0', dtype=torch.float16) tensor(0.1417, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
tensor(1.2227, device='cuda:0', dtype=torch.float16) tensor(0.1438, device='cuda:0', dtype=torch.float16)
tensor(1.6367, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
18 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7227, device='cuda:0', dtype=torch.float16) tensor(0.3635, device='cuda:0', dtype=torch.float16)
tensor(0.9097, device='cuda:0', dtype=torch.float16) tensor(0.1171, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
tensor(0.9375, device='cuda:0', dtype=torch.float16) tensor(0.1196, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.1156, device='cuda:0', dtype=torch.float16)
tensor(0.1047, device='cuda:0')
old_score: tensor(0.1150, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1056, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.231882572174072
Validation after dual ascent:
out_inf: tensor(4.7227, device='cuda:0', dtype=torch.float16) tensor(0.3635, device='cuda:0', dtype=torch.float16)
tensor(0.9536, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.0973, device='cuda:0', dtype=torch.float16)
tensor(0.8418, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.1074, device='cuda:0', dtype=torch.float16)
18 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9141, device='cuda:0', dtype=torch.float16) tensor(0.1058, device='cuda:0', dtype=torch.float16)
tensor(0.3860, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.3447, device='cuda:0', dtype=torch.float16) tensor(0.0337, device='cuda:0', dtype=torch.float16)
tensor(0.4812, device='cuda:0', dtype=torch.float16) tensor(0.0386, device='cuda:0', dtype=torch.float16)
tensor(0.3589, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0104, device='cuda:0')
tensor(0.0205, device='cuda:0')
old_score: tensor(0.0355, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0327, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.753656387329102
Validation after dual ascent:
out_inf: tensor(4.9141, device='cuda:0', dtype=torch.float16) tensor(0.1058, device='cuda:0', dtype=torch.float16)
tensor(0.3770, device='cuda:0', dtype=torch.float16) tensor(0.0330, device='cuda:0', dtype=torch.float16)
tensor(0.3403, device='cuda:0', dtype=torch.float16) tensor(0.0304, device='cuda:0', dtype=torch.float16)
tensor(0.3796, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.3694, device='cuda:0', dtype=torch.float16) tensor(0.0318, device='cuda:0', dtype=torch.float16)
18 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.4297, device='cuda:0', dtype=torch.float16) tensor(0.4485, device='cuda:0', dtype=torch.float16)
tensor(1.1992, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.0915, device='cuda:0', dtype=torch.float16)
tensor(0.8369, device='cuda:0', dtype=torch.float16) tensor(0.1021, device='cuda:0', dtype=torch.float16)
tensor(0.9785, device='cuda:0', dtype=torch.float16) tensor(0.0982, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0109, device='cuda:0')
tensor(0.1271, device='cuda:0')
old_score: tensor(0.0980, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0897, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.253183126449585
Validation after dual ascent:
out_inf: tensor(8.4297, device='cuda:0', dtype=torch.float16) tensor(0.4485, device='cuda:0', dtype=torch.float16)
tensor(1.1504, device='cuda:0', dtype=torch.float16) tensor(0.0923, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.0826, device='cuda:0', dtype=torch.float16)
tensor(0.7969, device='cuda:0', dtype=torch.float16) tensor(0.0928, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
18 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.2930, device='cuda:0', dtype=torch.float16) tensor(0.3054, device='cuda:0', dtype=torch.float16)
tensor(0.9961, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(0.9961, device='cuda:0', dtype=torch.float16) tensor(0.0874, device='cuda:0', dtype=torch.float16)
tensor(0.8320, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0088, device='cuda:0')
tensor(0.1158, device='cuda:0')
old_score: tensor(0.0936, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0858, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.246702194213867
Validation after dual ascent:
out_inf: tensor(6.2930, device='cuda:0', dtype=torch.float16) tensor(0.3054, device='cuda:0', dtype=torch.float16)
tensor(0.9932, device='cuda:0', dtype=torch.float16) tensor(0.0882, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
tensor(0.7793, device='cuda:0', dtype=torch.float16) tensor(0.0888, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.0870, device='cuda:0', dtype=torch.float16)
18 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.3789, device='cuda:0', dtype=torch.float16) tensor(0.1475, device='cuda:0', dtype=torch.float16)
tensor(0.4907, device='cuda:0', dtype=torch.float16) tensor(0.0478, device='cuda:0', dtype=torch.float16)
tensor(0.4128, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.4663, device='cuda:0', dtype=torch.float16) tensor(0.0462, device='cuda:0', dtype=torch.float16)
tensor(0.4878, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0057, device='cuda:0')
tensor(0.0719, device='cuda:0')
old_score: tensor(0.0454, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0432, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.42236590385437
Validation after dual ascent:
out_inf: tensor(5.3789, device='cuda:0', dtype=torch.float16) tensor(0.1475, device='cuda:0', dtype=torch.float16)
tensor(0.4907, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.4443, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(0.4973, device='cuda:0', dtype=torch.float16) tensor(0.0440, device='cuda:0', dtype=torch.float16)
tensor(0.4546, device='cuda:0', dtype=torch.float16) tensor(0.0445, device='cuda:0', dtype=torch.float16)
layer 18 done
19 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.2969, device='cuda:0', dtype=torch.float16) tensor(0.7803, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.1458, device='cuda:0', dtype=torch.float16)
tensor(2.2695, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
tensor(1.6191, device='cuda:0', dtype=torch.float16) tensor(0.1503, device='cuda:0', dtype=torch.float16)
tensor(1.7490, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0166, device='cuda:0')
tensor(0.2931, device='cuda:0')
old_score: tensor(0.1438, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1307, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4974794387817383
Validation after dual ascent:
out_inf: tensor(13.2969, device='cuda:0', dtype=torch.float16) tensor(0.7803, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1335, device='cuda:0', dtype=torch.float16)
tensor(2.0586, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(1.5283, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.5889, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
19 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.4688, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(1.2471, device='cuda:0', dtype=torch.float16) tensor(0.1470, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.1514, device='cuda:0', dtype=torch.float16)
tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.1447, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0188, device='cuda:0')
tensor(0.3017, device='cuda:0')
old_score: tensor(0.1448, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1312, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.498840093612671
Validation after dual ascent:
out_inf: tensor(18.4688, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(1.1260, device='cuda:0', dtype=torch.float16) tensor(0.1343, device='cuda:0', dtype=torch.float16)
tensor(1.7070, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.2158, device='cuda:0', dtype=torch.float16) tensor(0.1328, device='cuda:0', dtype=torch.float16)
19 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.8633, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(0.9927, device='cuda:0', dtype=torch.float16) tensor(0.1158, device='cuda:0', dtype=torch.float16)
tensor(0.9443, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(0.9204, device='cuda:0', dtype=torch.float16) tensor(0.1184, device='cuda:0', dtype=torch.float16)
tensor(0.9160, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0111, device='cuda:0')
tensor(0.2103, device='cuda:0')
old_score: tensor(0.1137, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1039, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.489457845687866
Validation after dual ascent:
out_inf: tensor(3.8633, device='cuda:0', dtype=torch.float16) tensor(0.3762, device='cuda:0', dtype=torch.float16)
tensor(0.9839, device='cuda:0', dtype=torch.float16) tensor(0.1065, device='cuda:0', dtype=torch.float16)
tensor(0.9268, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
tensor(0.8379, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(0.9429, device='cuda:0', dtype=torch.float16) tensor(0.1054, device='cuda:0', dtype=torch.float16)
19 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.3281, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
tensor(0.3867, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
tensor(0.3945, device='cuda:0', dtype=torch.float16) tensor(0.0373, device='cuda:0', dtype=torch.float16)
tensor(0.3918, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
tensor(0.3711, device='cuda:0', dtype=torch.float16) tensor(0.0353, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0163, device='cuda:0')
tensor(0.0217, device='cuda:0')
old_score: tensor(0.0374, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0344, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.235292434692383
Validation after dual ascent:
out_inf: tensor(6.3281, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
tensor(0.3564, device='cuda:0', dtype=torch.float16) tensor(0.0344, device='cuda:0', dtype=torch.float16)
tensor(0.3850, device='cuda:0', dtype=torch.float16) tensor(0.0337, device='cuda:0', dtype=torch.float16)
tensor(0.3657, device='cuda:0', dtype=torch.float16) tensor(0.0366, device='cuda:0', dtype=torch.float16)
tensor(0.3694, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
19 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.0703, device='cuda:0', dtype=torch.float16) tensor(0.4377, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1030, device='cuda:0', dtype=torch.float16)
tensor(1.2217, device='cuda:0', dtype=torch.float16) tensor(0.0940, device='cuda:0', dtype=torch.float16)
tensor(0.9238, device='cuda:0', dtype=torch.float16) tensor(0.1051, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0113, device='cuda:0')
tensor(0.1385, device='cuda:0')
old_score: tensor(0.1007, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0921, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.17879581451416
Validation after dual ascent:
out_inf: tensor(8.0703, device='cuda:0', dtype=torch.float16) tensor(0.4377, device='cuda:0', dtype=torch.float16)
tensor(1.1211, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(1.1982, device='cuda:0', dtype=torch.float16) tensor(0.0850, device='cuda:0', dtype=torch.float16)
tensor(0.8750, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
tensor(0.9785, device='cuda:0', dtype=torch.float16) tensor(0.0930, device='cuda:0', dtype=torch.float16)
19 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.9141, device='cuda:0', dtype=torch.float16) tensor(0.3123, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.0979, device='cuda:0', dtype=torch.float16)
tensor(0.8296, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0998, device='cuda:0', dtype=torch.float16)
tensor(1.0400, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0095, device='cuda:0')
tensor(0.1266, device='cuda:0')
old_score: tensor(0.0957, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0876, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.185185432434082
Validation after dual ascent:
out_inf: tensor(7.9141, device='cuda:0', dtype=torch.float16) tensor(0.3123, device='cuda:0', dtype=torch.float16)
tensor(1.0508, device='cuda:0', dtype=torch.float16) tensor(0.0902, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0808, device='cuda:0', dtype=torch.float16)
tensor(0.7451, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
tensor(0.9160, device='cuda:0', dtype=torch.float16) tensor(0.0884, device='cuda:0', dtype=torch.float16)
19 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.1504, device='cuda:0', dtype=torch.float16)
tensor(0.4810, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
tensor(0.4141, device='cuda:0', dtype=torch.float16) tensor(0.0422, device='cuda:0', dtype=torch.float16)
tensor(0.4402, device='cuda:0', dtype=torch.float16) tensor(0.0475, device='cuda:0', dtype=torch.float16)
tensor(0.5103, device='cuda:0', dtype=torch.float16) tensor(0.0472, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0058, device='cuda:0')
tensor(0.0743, device='cuda:0')
old_score: tensor(0.0464, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0443, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.289483070373535
Validation after dual ascent:
out_inf: tensor(4.6992, device='cuda:0', dtype=torch.float16) tensor(0.1504, device='cuda:0', dtype=torch.float16)
tensor(0.4692, device='cuda:0', dtype=torch.float16) tensor(0.0466, device='cuda:0', dtype=torch.float16)
tensor(0.3955, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.4377, device='cuda:0', dtype=torch.float16) tensor(0.0453, device='cuda:0', dtype=torch.float16)
tensor(0.5400, device='cuda:0', dtype=torch.float16) tensor(0.0453, device='cuda:0', dtype=torch.float16)
layer 19 done
20 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.9141, device='cuda:0', dtype=torch.float16) tensor(0.8066, device='cuda:0', dtype=torch.float16)
tensor(1.5508, device='cuda:0', dtype=torch.float16) tensor(0.1466, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
tensor(1.3701, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.4541, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(0.1749, device='cuda:0')
old_score: tensor(0.1443, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1309, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.21019172668457
Validation after dual ascent:
out_inf: tensor(14.9141, device='cuda:0', dtype=torch.float16) tensor(0.8066, device='cuda:0', dtype=torch.float16)
tensor(1.4121, device='cuda:0', dtype=torch.float16) tensor(0.1339, device='cuda:0', dtype=torch.float16)
tensor(1.7324, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.2695, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
tensor(1.2734, device='cuda:0', dtype=torch.float16) tensor(0.1317, device='cuda:0', dtype=torch.float16)
20 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.8438, device='cuda:0', dtype=torch.float16) tensor(1.0312, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.1476, device='cuda:0', dtype=torch.float16)
tensor(1.1436, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.2002, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(1.3389, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(0.1634, device='cuda:0')
old_score: tensor(0.1449, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1311, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.259812831878662
Validation after dual ascent:
out_inf: tensor(18.8438, device='cuda:0', dtype=torch.float16) tensor(1.0312, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.1345, device='cuda:0', dtype=torch.float16)
tensor(1.0312, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.1465, device='cuda:0', dtype=torch.float16) tensor(0.1367, device='cuda:0', dtype=torch.float16)
tensor(1.2734, device='cuda:0', dtype=torch.float16) tensor(0.1318, device='cuda:0', dtype=torch.float16)
20 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5352, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(1.3682, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(1.0264, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
tensor(0.8662, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.1151, device='cuda:0', dtype=torch.float16)
tensor(0.0721, device='cuda:0')
old_score: tensor(0.1152, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1050, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.23413896560669
Validation after dual ascent:
out_inf: tensor(4.5352, device='cuda:0', dtype=torch.float16) tensor(0.3650, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(0.8931, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(1.0098, device='cuda:0', dtype=torch.float16) tensor(0.1060, device='cuda:0', dtype=torch.float16)
20 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.5938, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
tensor(0.4321, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.4570, device='cuda:0', dtype=torch.float16) tensor(0.0478, device='cuda:0', dtype=torch.float16)
tensor(0.5298, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.4712, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0085, device='cuda:0')
tensor(0.0154, device='cuda:0')
old_score: tensor(0.0454, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0410, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.516508102416992
Validation after dual ascent:
out_inf: tensor(12.5938, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
tensor(0.3887, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(0.4363, device='cuda:0', dtype=torch.float16) tensor(0.0418, device='cuda:0', dtype=torch.float16)
tensor(0.4563, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
tensor(0.4429, device='cuda:0', dtype=torch.float16) tensor(0.0415, device='cuda:0', dtype=torch.float16)
20 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.7500, device='cuda:0', dtype=torch.float16) tensor(0.4412, device='cuda:0', dtype=torch.float16)
tensor(0.9961, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
tensor(1.0703, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.0996, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0116, device='cuda:0')
tensor(0.1358, device='cuda:0')
old_score: tensor(0.1008, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0919, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.245031356811523
Validation after dual ascent:
out_inf: tensor(12.7500, device='cuda:0', dtype=torch.float16) tensor(0.4412, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
tensor(1.2188, device='cuda:0', dtype=torch.float16) tensor(0.0843, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
tensor(1.1035, device='cuda:0', dtype=torch.float16) tensor(0.0916, device='cuda:0', dtype=torch.float16)
20 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.2422, device='cuda:0', dtype=torch.float16) tensor(0.3145, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0972, device='cuda:0', dtype=torch.float16)
tensor(0.9883, device='cuda:0', dtype=torch.float16) tensor(0.0883, device='cuda:0', dtype=torch.float16)
tensor(0.8330, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0939, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0095, device='cuda:0')
tensor(0.1240, device='cuda:0')
old_score: tensor(0.0950, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0866, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.251099348068237
Validation after dual ascent:
out_inf: tensor(6.2422, device='cuda:0', dtype=torch.float16) tensor(0.3145, device='cuda:0', dtype=torch.float16)
tensor(1.0469, device='cuda:0', dtype=torch.float16) tensor(0.0892, device='cuda:0', dtype=torch.float16)
tensor(0.8281, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.7954, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.0864, device='cuda:0', dtype=torch.float16)
20 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4297, device='cuda:0', dtype=torch.float16) tensor(0.1532, device='cuda:0', dtype=torch.float16)
tensor(0.5601, device='cuda:0', dtype=torch.float16) tensor(0.0485, device='cuda:0', dtype=torch.float16)
tensor(0.6094, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
tensor(0.4817, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
tensor(0.6777, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0058, device='cuda:0')
tensor(0.0760, device='cuda:0')
old_score: tensor(0.0465, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0443, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.32755732536316
Validation after dual ascent:
out_inf: tensor(5.4297, device='cuda:0', dtype=torch.float16) tensor(0.1532, device='cuda:0', dtype=torch.float16)
tensor(0.5576, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.5498, device='cuda:0', dtype=torch.float16) tensor(0.0393, device='cuda:0', dtype=torch.float16)
tensor(0.4927, device='cuda:0', dtype=torch.float16) tensor(0.0465, device='cuda:0', dtype=torch.float16)
tensor(0.6675, device='cuda:0', dtype=torch.float16) tensor(0.0449, device='cuda:0', dtype=torch.float16)
layer 20 done
21 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.2500, device='cuda:0', dtype=torch.float16) tensor(0.7803, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.1429, device='cuda:0', dtype=torch.float16)
tensor(1.9795, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
tensor(1.3105, device='cuda:0', dtype=torch.float16) tensor(0.1495, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.1376, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0174, device='cuda:0')
tensor(0.3034, device='cuda:0')
old_score: tensor(0.1404, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1272, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4979093074798584
Validation after dual ascent:
out_inf: tensor(17.2500, device='cuda:0', dtype=torch.float16) tensor(0.7803, device='cuda:0', dtype=torch.float16)
tensor(1.2002, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
tensor(1.8691, device='cuda:0', dtype=torch.float16) tensor(0.1173, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1350, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.1260, device='cuda:0', dtype=torch.float16)
21 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.1406, device='cuda:0', dtype=torch.float16) tensor(0.9839, device='cuda:0', dtype=torch.float16)
tensor(1.3301, device='cuda:0', dtype=torch.float16) tensor(0.1431, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1315, device='cuda:0', dtype=torch.float16)
tensor(1.3584, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
tensor(1.6680, device='cuda:0', dtype=torch.float16) tensor(0.1372, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0200, device='cuda:0')
tensor(0.3172, device='cuda:0')
old_score: tensor(0.1403, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1270, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4968907833099365
Validation after dual ascent:
out_inf: tensor(18.1406, device='cuda:0', dtype=torch.float16) tensor(0.9839, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.1171, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1346, device='cuda:0', dtype=torch.float16)
tensor(1.4746, device='cuda:0', dtype=torch.float16) tensor(0.1256, device='cuda:0', dtype=torch.float16)
21 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4336, device='cuda:0', dtype=torch.float16) tensor(0.3784, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(0.9604, device='cuda:0', dtype=torch.float16) tensor(0.1115, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(1.0459, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0118, device='cuda:0')
tensor(0.2223, device='cuda:0')
old_score: tensor(0.1196, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1088, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4914743900299072
Validation after dual ascent:
out_inf: tensor(5.4336, device='cuda:0', dtype=torch.float16) tensor(0.3784, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
tensor(0.9834, device='cuda:0', dtype=torch.float16) tensor(0.0998, device='cuda:0', dtype=torch.float16)
tensor(0.9985, device='cuda:0', dtype=torch.float16) tensor(0.1152, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.1080, device='cuda:0', dtype=torch.float16)
21 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.2578, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
tensor(0.4902, device='cuda:0', dtype=torch.float16) tensor(0.0463, device='cuda:0', dtype=torch.float16)
tensor(0.5146, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.5317, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.5063, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0133, device='cuda:0')
tensor(0.0243, device='cuda:0')
old_score: tensor(0.0462, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0422, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.414105415344238
Validation after dual ascent:
out_inf: tensor(9.2578, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
tensor(0.4966, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(0.5098, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
tensor(0.5269, device='cuda:0', dtype=torch.float16) tensor(0.0445, device='cuda:0', dtype=torch.float16)
tensor(0.4697, device='cuda:0', dtype=torch.float16) tensor(0.0389, device='cuda:0', dtype=torch.float16)
21 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.2500, device='cuda:0', dtype=torch.float16) tensor(0.4304, device='cuda:0', dtype=torch.float16)
tensor(1.1621, device='cuda:0', dtype=torch.float16) tensor(0.1054, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0960, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.1098, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0119, device='cuda:0')
tensor(0.1444, device='cuda:0')
old_score: tensor(0.1030, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0941, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.193459987640381
Validation after dual ascent:
out_inf: tensor(9.2500, device='cuda:0', dtype=torch.float16) tensor(0.4304, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.0864, device='cuda:0', dtype=torch.float16)
tensor(0.8989, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
21 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9414, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0984, device='cuda:0', dtype=torch.float16)
tensor(0.8086, device='cuda:0', dtype=torch.float16) tensor(0.0897, device='cuda:0', dtype=torch.float16)
tensor(0.8896, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0099, device='cuda:0')
tensor(0.1311, device='cuda:0')
old_score: tensor(0.0962, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0880, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.195322513580322
Validation after dual ascent:
out_inf: tensor(5.9414, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(0.8916, device='cuda:0', dtype=torch.float16) tensor(0.0905, device='cuda:0', dtype=torch.float16)
tensor(0.8193, device='cuda:0', dtype=torch.float16) tensor(0.0807, device='cuda:0', dtype=torch.float16)
tensor(0.8457, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.8965, device='cuda:0', dtype=torch.float16) tensor(0.0871, device='cuda:0', dtype=torch.float16)
21 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.1055, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(0.6128, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.4553, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0477, device='cuda:0', dtype=torch.float16)
tensor(0.5786, device='cuda:0', dtype=torch.float16) tensor(0.0444, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0055, device='cuda:0')
tensor(0.0707, device='cuda:0')
old_score: tensor(0.0448, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0428, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.267912149429321
Validation after dual ascent:
out_inf: tensor(4.1055, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(0.6377, device='cuda:0', dtype=torch.float16) tensor(0.0448, device='cuda:0', dtype=torch.float16)
tensor(0.4504, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
tensor(0.6177, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.5688, device='cuda:0', dtype=torch.float16) tensor(0.0426, device='cuda:0', dtype=torch.float16)
layer 21 done
22 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.2812, device='cuda:0', dtype=torch.float16) tensor(0.8345, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1484, device='cuda:0', dtype=torch.float16)
tensor(1.5254, device='cuda:0', dtype=torch.float16) tensor(0.1367, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(1.6230, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
tensor(0.2681, device='cuda:0')
old_score: tensor(0.1462, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1326, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.145567893981934
Validation after dual ascent:
out_inf: tensor(17.2812, device='cuda:0', dtype=torch.float16) tensor(0.8345, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.4209, device='cuda:0', dtype=torch.float16) tensor(0.1219, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(1.5527, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
22 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.2031, device='cuda:0', dtype=torch.float16) tensor(1.0068, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1488, device='cuda:0', dtype=torch.float16)
tensor(1.2314, device='cuda:0', dtype=torch.float16) tensor(0.1370, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
tensor(0.2821, device='cuda:0')
old_score: tensor(0.1464, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1323, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.166224002838135
Validation after dual ascent:
out_inf: tensor(20.2031, device='cuda:0', dtype=torch.float16) tensor(1.0068, device='cuda:0', dtype=torch.float16)
tensor(1.4951, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.1219, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.1420, device='cuda:0', dtype=torch.float16)
tensor(1.3096, device='cuda:0', dtype=torch.float16) tensor(0.1301, device='cuda:0', dtype=torch.float16)
22 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.1328, device='cuda:0', dtype=torch.float16) tensor(0.3960, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(0.9824, device='cuda:0', dtype=torch.float16) tensor(0.1129, device='cuda:0', dtype=torch.float16)
tensor(1.0107, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(1.1934, device='cuda:0', dtype=torch.float16) tensor(0.1186, device='cuda:0', dtype=torch.float16)
tensor(0.1629, device='cuda:0')
old_score: tensor(0.1212, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1102, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.145612478256226
Validation after dual ascent:
out_inf: tensor(8.1328, device='cuda:0', dtype=torch.float16) tensor(0.3960, device='cuda:0', dtype=torch.float16)
tensor(1.1064, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(0.9385, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
tensor(0.9795, device='cuda:0', dtype=torch.float16) tensor(0.1176, device='cuda:0', dtype=torch.float16)
tensor(1.1191, device='cuda:0', dtype=torch.float16) tensor(0.1088, device='cuda:0', dtype=torch.float16)
22 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(11.7422, device='cuda:0', dtype=torch.float16) tensor(0.1487, device='cuda:0', dtype=torch.float16)
tensor(0.4729, device='cuda:0', dtype=torch.float16) tensor(0.0499, device='cuda:0', dtype=torch.float16)
tensor(0.6289, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
tensor(0.6045, device='cuda:0', dtype=torch.float16) tensor(0.0505, device='cuda:0', dtype=torch.float16)
tensor(0.5493, device='cuda:0', dtype=torch.float16) tensor(0.0504, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0152, device='cuda:0')
tensor(0.0306, device='cuda:0')
old_score: tensor(0.0504, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0465, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.453670740127563
Validation after dual ascent:
out_inf: tensor(11.7422, device='cuda:0', dtype=torch.float16) tensor(0.1487, device='cuda:0', dtype=torch.float16)
tensor(0.4741, device='cuda:0', dtype=torch.float16) tensor(0.0458, device='cuda:0', dtype=torch.float16)
tensor(0.6353, device='cuda:0', dtype=torch.float16) tensor(0.0465, device='cuda:0', dtype=torch.float16)
tensor(0.5605, device='cuda:0', dtype=torch.float16) tensor(0.0466, device='cuda:0', dtype=torch.float16)
tensor(0.5029, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
22 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(11.1172, device='cuda:0', dtype=torch.float16) tensor(0.4250, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.1052, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(1.0410, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0118, device='cuda:0')
tensor(0.1417, device='cuda:0')
old_score: tensor(0.1034, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0941, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.22252082824707
Validation after dual ascent:
out_inf: tensor(11.1172, device='cuda:0', dtype=torch.float16) tensor(0.4250, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.0963, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.0870, device='cuda:0', dtype=torch.float16)
tensor(0.9316, device='cuda:0', dtype=torch.float16) tensor(0.1007, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
22 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.7383, device='cuda:0', dtype=torch.float16) tensor(0.3145, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
tensor(1.0020, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(0.8511, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
tensor(0.8799, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0098, device='cuda:0')
tensor(0.1278, device='cuda:0')
old_score: tensor(0.0958, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0873, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.215940713882446
Validation after dual ascent:
out_inf: tensor(6.7383, device='cuda:0', dtype=torch.float16) tensor(0.3145, device='cuda:0', dtype=torch.float16)
tensor(1.1064, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(0.8613, device='cuda:0', dtype=torch.float16) tensor(0.0807, device='cuda:0', dtype=torch.float16)
tensor(0.8281, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.8271, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
22 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.9727, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(0.7183, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
tensor(0.5488, device='cuda:0', dtype=torch.float16) tensor(0.0419, device='cuda:0', dtype=torch.float16)
tensor(0.5718, device='cuda:0', dtype=torch.float16) tensor(0.0495, device='cuda:0', dtype=torch.float16)
tensor(0.5464, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0060, device='cuda:0')
tensor(0.0761, device='cuda:0')
old_score: tensor(0.0464, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0443, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.327680826187134
Validation after dual ascent:
out_inf: tensor(2.9727, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(0.7070, device='cuda:0', dtype=torch.float16) tensor(0.0466, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0397, device='cuda:0', dtype=torch.float16)
tensor(0.5601, device='cuda:0', dtype=torch.float16) tensor(0.0475, device='cuda:0', dtype=torch.float16)
tensor(0.5576, device='cuda:0', dtype=torch.float16) tensor(0.0434, device='cuda:0', dtype=torch.float16)
layer 22 done
23 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.7969, device='cuda:0', dtype=torch.float16) tensor(0.8174, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1565, device='cuda:0', dtype=torch.float16)
tensor(2.0898, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.6025, device='cuda:0', dtype=torch.float16) tensor(0.1669, device='cuda:0', dtype=torch.float16)
tensor(1.4219, device='cuda:0', dtype=torch.float16) tensor(0.1490, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0198, device='cuda:0')
tensor(0.3596, device='cuda:0')
old_score: tensor(0.1543, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1403, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.50821852684021
Validation after dual ascent:
out_inf: tensor(16.7969, device='cuda:0', dtype=torch.float16) tensor(0.8174, device='cuda:0', dtype=torch.float16)
tensor(1.4512, device='cuda:0', dtype=torch.float16) tensor(0.1429, device='cuda:0', dtype=torch.float16)
tensor(1.9355, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
tensor(1.5830, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.3828, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
23 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.2656, device='cuda:0', dtype=torch.float16) tensor(0.9702, device='cuda:0', dtype=torch.float16)
tensor(1.6426, device='cuda:0', dtype=torch.float16) tensor(0.1564, device='cuda:0', dtype=torch.float16)
tensor(1.2646, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
tensor(1.4307, device='cuda:0', dtype=torch.float16) tensor(0.1670, device='cuda:0', dtype=torch.float16)
tensor(1.3975, device='cuda:0', dtype=torch.float16) tensor(0.1489, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0153, device='cuda:0')
tensor(0.1652, device='cuda:0')
old_score: tensor(0.1544, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1400, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2479560375213623
Validation after dual ascent:
out_inf: tensor(19.2656, device='cuda:0', dtype=torch.float16) tensor(0.9702, device='cuda:0', dtype=torch.float16)
tensor(1.5664, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(1.1660, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.3613, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
23 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2617, device='cuda:0', dtype=torch.float16) tensor(0.4341, device='cuda:0', dtype=torch.float16)
tensor(1.2607, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(1.0928, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1449, device='cuda:0', dtype=torch.float16)
tensor(1.1475, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0142, device='cuda:0')
tensor(0.2814, device='cuda:0')
old_score: tensor(0.1345, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1226, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.500469923019409
Validation after dual ascent:
out_inf: tensor(5.2617, device='cuda:0', dtype=torch.float16) tensor(0.4341, device='cuda:0', dtype=torch.float16)
tensor(1.2734, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
tensor(1.0342, device='cuda:0', dtype=torch.float16) tensor(0.1133, device='cuda:0', dtype=torch.float16)
tensor(1.1943, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1195, device='cuda:0', dtype=torch.float16)
23 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.0156, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(0.5137, device='cuda:0', dtype=torch.float16) tensor(0.0496, device='cuda:0', dtype=torch.float16)
tensor(0.5342, device='cuda:0', dtype=torch.float16) tensor(0.0529, device='cuda:0', dtype=torch.float16)
tensor(0.5430, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
tensor(0.4849, device='cuda:0', dtype=torch.float16) tensor(0.0460, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0152, device='cuda:0')
tensor(0.0233, device='cuda:0')
old_score: tensor(0.0493, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0454, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.424851894378662
Validation after dual ascent:
out_inf: tensor(17.0156, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(0.6099, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.5010, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.4912, device='cuda:0', dtype=torch.float16) tensor(0.0460, device='cuda:0', dtype=torch.float16)
tensor(0.4902, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
23 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.4062, device='cuda:0', dtype=torch.float16) tensor(0.4355, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(1.6445, device='cuda:0', dtype=torch.float16) tensor(0.1021, device='cuda:0', dtype=torch.float16)
tensor(0.9746, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.1044, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0134, device='cuda:0')
tensor(0.1736, device='cuda:0')
old_score: tensor(0.1088, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0992, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.198453664779663
Validation after dual ascent:
out_inf: tensor(10.4062, device='cuda:0', dtype=torch.float16) tensor(0.4355, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(1.7852, device='cuda:0', dtype=torch.float16) tensor(0.0917, device='cuda:0', dtype=torch.float16)
tensor(0.9570, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
tensor(1.0928, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
23 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.3984, device='cuda:0', dtype=torch.float16) tensor(0.3230, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1027, device='cuda:0', dtype=torch.float16)
tensor(0.9067, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(0.8623, device='cuda:0', dtype=torch.float16) tensor(0.1097, device='cuda:0', dtype=torch.float16)
tensor(0.9653, device='cuda:0', dtype=torch.float16) tensor(0.0972, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0114, device='cuda:0')
tensor(0.1577, device='cuda:0')
old_score: tensor(0.1012, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0923, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2038187980651855
Validation after dual ascent:
out_inf: tensor(6.3984, device='cuda:0', dtype=torch.float16) tensor(0.3230, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.0943, device='cuda:0', dtype=torch.float16)
tensor(0.9126, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(0.8853, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
23 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.8984, device='cuda:0', dtype=torch.float16) tensor(0.1633, device='cuda:0', dtype=torch.float16)
tensor(0.7456, device='cuda:0', dtype=torch.float16) tensor(0.0523, device='cuda:0', dtype=torch.float16)
tensor(0.6602, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.5952, device='cuda:0', dtype=torch.float16) tensor(0.0542, device='cuda:0', dtype=torch.float16)
tensor(0.6411, device='cuda:0', dtype=torch.float16) tensor(0.0485, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0066, device='cuda:0')
tensor(0.0899, device='cuda:0')
old_score: tensor(0.0501, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0479, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.337729454040527
Validation after dual ascent:
out_inf: tensor(6.8984, device='cuda:0', dtype=torch.float16) tensor(0.1633, device='cuda:0', dtype=torch.float16)
tensor(0.6909, device='cuda:0', dtype=torch.float16) tensor(0.0502, device='cuda:0', dtype=torch.float16)
tensor(0.7461, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
tensor(0.6338, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
layer 23 done
24 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.3281, device='cuda:0', dtype=torch.float16) tensor(0.7905, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(2.3438, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
tensor(1.6104, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1375, device='cuda:0', dtype=torch.float16)
tensor(0.2912, device='cuda:0')
old_score: tensor(0.1436, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1304, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.215663194656372
Validation after dual ascent:
out_inf: tensor(16.3281, device='cuda:0', dtype=torch.float16) tensor(0.7905, device='cuda:0', dtype=torch.float16)
tensor(1.3545, device='cuda:0', dtype=torch.float16) tensor(0.1326, device='cuda:0', dtype=torch.float16)
tensor(2.3594, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.4951, device='cuda:0', dtype=torch.float16) tensor(0.1420, device='cuda:0', dtype=torch.float16)
tensor(1.5342, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
24 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.6719, device='cuda:0', dtype=torch.float16) tensor(1.0020, device='cuda:0', dtype=torch.float16)
tensor(1.3193, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
tensor(1.2363, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(1.2178, device='cuda:0', dtype=torch.float16) tensor(0.1367, device='cuda:0', dtype=torch.float16)
tensor(0.2858, device='cuda:0')
old_score: tensor(0.1431, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1295, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.26139497756958
Validation after dual ascent:
out_inf: tensor(17.6719, device='cuda:0', dtype=torch.float16) tensor(1.0020, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1318, device='cuda:0', dtype=torch.float16)
tensor(1.1777, device='cuda:0', dtype=torch.float16) tensor(0.1206, device='cuda:0', dtype=torch.float16)
tensor(1.1895, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
24 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.7344, device='cuda:0', dtype=torch.float16) tensor(0.4229, device='cuda:0', dtype=torch.float16)
tensor(1.2471, device='cuda:0', dtype=torch.float16) tensor(0.1327, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.1230, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.1420, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1254, device='cuda:0', dtype=torch.float16)
tensor(0.1653, device='cuda:0')
old_score: tensor(0.1307, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1190, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.227012634277344
Validation after dual ascent:
out_inf: tensor(5.7344, device='cuda:0', dtype=torch.float16) tensor(0.4229, device='cuda:0', dtype=torch.float16)
tensor(1.3506, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1104, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
tensor(1.1914, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
24 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.2812, device='cuda:0', dtype=torch.float16) tensor(0.1809, device='cuda:0', dtype=torch.float16)
tensor(0.5742, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.5830, device='cuda:0', dtype=torch.float16) tensor(0.0628, device='cuda:0', dtype=torch.float16)
tensor(0.7158, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
tensor(0.6245, device='cuda:0', dtype=torch.float16) tensor(0.0571, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0146, device='cuda:0')
tensor(0.0318, device='cuda:0')
old_score: tensor(0.0607, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0561, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.751244306564331
Validation after dual ascent:
out_inf: tensor(13.2812, device='cuda:0', dtype=torch.float16) tensor(0.1809, device='cuda:0', dtype=torch.float16)
tensor(0.5444, device='cuda:0', dtype=torch.float16) tensor(0.0530, device='cuda:0', dtype=torch.float16)
tensor(0.5840, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
tensor(0.6904, device='cuda:0', dtype=torch.float16) tensor(0.0604, device='cuda:0', dtype=torch.float16)
tensor(0.5508, device='cuda:0', dtype=torch.float16) tensor(0.0536, device='cuda:0', dtype=torch.float16)
24 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.2500, device='cuda:0', dtype=torch.float16) tensor(0.4390, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
tensor(1.0273, device='cuda:0', dtype=torch.float16) tensor(0.1197, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1061, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0139, device='cuda:0')
tensor(0.1810, device='cuda:0')
old_score: tensor(0.1106, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1011, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2625343799591064
Validation after dual ascent:
out_inf: tensor(12.2500, device='cuda:0', dtype=torch.float16) tensor(0.4390, device='cuda:0', dtype=torch.float16)
tensor(1.2324, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
tensor(0.9385, device='cuda:0', dtype=torch.float16) tensor(0.0942, device='cuda:0', dtype=torch.float16)
tensor(0.9692, device='cuda:0', dtype=torch.float16) tensor(0.1095, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
24 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.6953, device='cuda:0', dtype=torch.float16) tensor(0.3291, device='cuda:0', dtype=torch.float16)
tensor(1.0977, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
tensor(0.9053, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
tensor(0.9463, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0118, device='cuda:0')
tensor(0.1648, device='cuda:0')
old_score: tensor(0.1031, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0942, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.260019063949585
Validation after dual ascent:
out_inf: tensor(6.6953, device='cuda:0', dtype=torch.float16) tensor(0.3291, device='cuda:0', dtype=torch.float16)
tensor(1.0889, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
tensor(0.8550, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(0.9238, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(0.9766, device='cuda:0', dtype=torch.float16) tensor(0.0911, device='cuda:0', dtype=torch.float16)
24 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4297, device='cuda:0', dtype=torch.float16) tensor(0.1708, device='cuda:0', dtype=torch.float16)
tensor(0.8506, device='cuda:0', dtype=torch.float16) tensor(0.0539, device='cuda:0', dtype=torch.float16)
tensor(0.6143, device='cuda:0', dtype=torch.float16) tensor(0.0471, device='cuda:0', dtype=torch.float16)
tensor(0.6196, device='cuda:0', dtype=torch.float16) tensor(0.0551, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0496, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0071, device='cuda:0')
tensor(0.0954, device='cuda:0')
old_score: tensor(0.0515, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0493, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.358978033065796
Validation after dual ascent:
out_inf: tensor(4.4297, device='cuda:0', dtype=torch.float16) tensor(0.1708, device='cuda:0', dtype=torch.float16)
tensor(0.7817, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
tensor(0.6104, device='cuda:0', dtype=torch.float16) tensor(0.0447, device='cuda:0', dtype=torch.float16)
tensor(0.6343, device='cuda:0', dtype=torch.float16) tensor(0.0531, device='cuda:0', dtype=torch.float16)
tensor(0.6025, device='cuda:0', dtype=torch.float16) tensor(0.0475, device='cuda:0', dtype=torch.float16)
layer 24 done
25 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.4375, device='cuda:0', dtype=torch.float16) tensor(0.7920, device='cuda:0', dtype=torch.float16)
tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.1578, device='cuda:0', dtype=torch.float16)
tensor(1.5176, device='cuda:0', dtype=torch.float16) tensor(0.1479, device='cuda:0', dtype=torch.float16)
tensor(1.7266, device='cuda:0', dtype=torch.float16) tensor(0.1704, device='cuda:0', dtype=torch.float16)
tensor(1.9219, device='cuda:0', dtype=torch.float16) tensor(0.1489, device='cuda:0', dtype=torch.float16)
tensor(0.2869, device='cuda:0')
old_score: tensor(0.1562, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1423, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.222516298294067
Validation after dual ascent:
out_inf: tensor(12.4375, device='cuda:0', dtype=torch.float16) tensor(0.7920, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.1445, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.6230, device='cuda:0', dtype=torch.float16) tensor(0.1556, device='cuda:0', dtype=torch.float16)
tensor(1.7949, device='cuda:0', dtype=torch.float16) tensor(0.1365, device='cuda:0', dtype=torch.float16)
25 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.6719, device='cuda:0', dtype=torch.float16) tensor(0.9390, device='cuda:0', dtype=torch.float16)
tensor(1.4941, device='cuda:0', dtype=torch.float16) tensor(0.1583, device='cuda:0', dtype=torch.float16)
tensor(1.4229, device='cuda:0', dtype=torch.float16) tensor(0.1481, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1705, device='cuda:0', dtype=torch.float16)
tensor(1.5293, device='cuda:0', dtype=torch.float16) tensor(0.1488, device='cuda:0', dtype=torch.float16)
tensor(0.2575, device='cuda:0')
old_score: tensor(0.1565, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1422, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.26303482055664
Validation after dual ascent:
out_inf: tensor(17.6719, device='cuda:0', dtype=torch.float16) tensor(0.9390, device='cuda:0', dtype=torch.float16)
tensor(1.4893, device='cuda:0', dtype=torch.float16) tensor(0.1447, device='cuda:0', dtype=torch.float16)
tensor(1.4326, device='cuda:0', dtype=torch.float16) tensor(0.1327, device='cuda:0', dtype=torch.float16)
tensor(1.4150, device='cuda:0', dtype=torch.float16) tensor(0.1553, device='cuda:0', dtype=torch.float16)
tensor(1.4004, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
25 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.3516, device='cuda:0', dtype=torch.float16) tensor(0.4553, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(1.2168, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(1.4932, device='cuda:0', dtype=torch.float16) tensor(0.1570, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1375, device='cuda:0', dtype=torch.float16)
tensor(0.0946, device='cuda:0')
old_score: tensor(0.1443, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1316, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.252723693847656
Validation after dual ascent:
out_inf: tensor(5.3516, device='cuda:0', dtype=torch.float16) tensor(0.4553, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1339, device='cuda:0', dtype=torch.float16)
tensor(1.1846, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(1.2510, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(1.2207, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
25 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7773, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
tensor(0.5176, device='cuda:0', dtype=torch.float16) tensor(0.0451, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0506, device='cuda:0', dtype=torch.float16)
tensor(0.5430, device='cuda:0', dtype=torch.float16) tensor(0.0508, device='cuda:0', dtype=torch.float16)
tensor(0.5400, device='cuda:0', dtype=torch.float16) tensor(0.0456, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0180, device='cuda:0')
tensor(0.0392, device='cuda:0')
old_score: tensor(0.0480, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0440, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.506882905960083
Validation after dual ascent:
out_inf: tensor(4.7773, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
tensor(0.4595, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
tensor(0.5269, device='cuda:0', dtype=torch.float16) tensor(0.0447, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0475, device='cuda:0', dtype=torch.float16)
tensor(0.4678, device='cuda:0', dtype=torch.float16) tensor(0.0423, device='cuda:0', dtype=torch.float16)
25 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.2422, device='cuda:0', dtype=torch.float16) tensor(0.4651, device='cuda:0', dtype=torch.float16)
tensor(1.1602, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.0762, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
tensor(1.1123, device='cuda:0', dtype=torch.float16) tensor(0.1237, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1086, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0153, device='cuda:0')
tensor(0.2029, device='cuda:0')
old_score: tensor(0.1139, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1039, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.268717527389526
Validation after dual ascent:
out_inf: tensor(10.2422, device='cuda:0', dtype=torch.float16) tensor(0.4651, device='cuda:0', dtype=torch.float16)
tensor(1.2402, device='cuda:0', dtype=torch.float16) tensor(0.1059, device='cuda:0', dtype=torch.float16)
tensor(1.0605, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(1.0400, device='cuda:0', dtype=torch.float16) tensor(0.1133, device='cuda:0', dtype=torch.float16)
tensor(1.0010, device='cuda:0', dtype=torch.float16) tensor(0.0997, device='cuda:0', dtype=torch.float16)
25 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.7734, device='cuda:0', dtype=torch.float16) tensor(0.3433, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1080, device='cuda:0', dtype=torch.float16)
tensor(0.9512, device='cuda:0', dtype=torch.float16) tensor(0.1007, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.1158, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.1017, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0130, device='cuda:0')
tensor(0.1851, device='cuda:0')
old_score: tensor(0.1066, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0974, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.274007558822632
Validation after dual ascent:
out_inf: tensor(8.7734, device='cuda:0', dtype=torch.float16) tensor(0.3433, device='cuda:0', dtype=torch.float16)
tensor(1.1631, device='cuda:0', dtype=torch.float16) tensor(0.0991, device='cuda:0', dtype=torch.float16)
tensor(0.9062, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.1061, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
25 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4062, device='cuda:0', dtype=torch.float16) tensor(0.1895, device='cuda:0', dtype=torch.float16)
tensor(0.7563, device='cuda:0', dtype=torch.float16) tensor(0.0563, device='cuda:0', dtype=torch.float16)
tensor(0.7271, device='cuda:0', dtype=torch.float16) tensor(0.0497, device='cuda:0', dtype=torch.float16)
tensor(0.6387, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(0.7393, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0086, device='cuda:0')
tensor(0.1097, device='cuda:0')
old_score: tensor(0.0539, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0516, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.253058433532715
Validation after dual ascent:
out_inf: tensor(4.4062, device='cuda:0', dtype=torch.float16) tensor(0.1895, device='cuda:0', dtype=torch.float16)
tensor(0.7466, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
tensor(0.7056, device='cuda:0', dtype=torch.float16) tensor(0.0471, device='cuda:0', dtype=torch.float16)
tensor(0.6372, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.7256, device='cuda:0', dtype=torch.float16) tensor(0.0492, device='cuda:0', dtype=torch.float16)
layer 25 done
26 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.5391, device='cuda:0', dtype=torch.float16) tensor(0.8398, device='cuda:0', dtype=torch.float16)
tensor(1.5947, device='cuda:0', dtype=torch.float16) tensor(0.1548, device='cuda:0', dtype=torch.float16)
tensor(2.4668, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
tensor(1.3965, device='cuda:0', dtype=torch.float16) tensor(0.1671, device='cuda:0', dtype=torch.float16)
tensor(1.5146, device='cuda:0', dtype=torch.float16) tensor(0.1464, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0126, device='cuda:0')
tensor(0.0606, device='cuda:0')
old_score: tensor(0.1539, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1399, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.01930856704712
Validation after dual ascent:
out_inf: tensor(14.5391, device='cuda:0', dtype=torch.float16) tensor(0.8398, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(2.2773, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.2646, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
tensor(1.4453, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
26 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.6094, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(1.3721, device='cuda:0', dtype=torch.float16) tensor(0.1553, device='cuda:0', dtype=torch.float16)
tensor(1.2119, device='cuda:0', dtype=torch.float16) tensor(0.1479, device='cuda:0', dtype=torch.float16)
tensor(1.3926, device='cuda:0', dtype=torch.float16) tensor(0.1670, device='cuda:0', dtype=torch.float16)
tensor(1.3926, device='cuda:0', dtype=torch.float16) tensor(0.1462, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0193, device='cuda:0')
tensor(0.0593, device='cuda:0')
old_score: tensor(0.1541, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1398, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.038343906402588
Validation after dual ascent:
out_inf: tensor(18.6094, device='cuda:0', dtype=torch.float16) tensor(1.0303, device='cuda:0', dtype=torch.float16)
tensor(1.3887, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(1.1611, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.3828, device='cuda:0', dtype=torch.float16) tensor(0.1523, device='cuda:0', dtype=torch.float16)
tensor(1.4678, device='cuda:0', dtype=torch.float16) tensor(0.1334, device='cuda:0', dtype=torch.float16)
26 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.9375, device='cuda:0', dtype=torch.float16) tensor(0.4653, device='cuda:0', dtype=torch.float16)
tensor(1.3164, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(1.2900, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.1389, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0086, device='cuda:0')
tensor(0.1142, device='cuda:0')
old_score: tensor(0.1458, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1332, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2655532360076904
Validation after dual ascent:
out_inf: tensor(7.9375, device='cuda:0', dtype=torch.float16) tensor(0.4653, device='cuda:0', dtype=torch.float16)
tensor(1.3330, device='cuda:0', dtype=torch.float16) tensor(0.1350, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
tensor(1.1924, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.2734, device='cuda:0', dtype=torch.float16) tensor(0.1276, device='cuda:0', dtype=torch.float16)
26 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(24.5625, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0629, device='cuda:0', dtype=torch.float16)
tensor(0.6426, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
tensor(0.6826, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(0.0186, device='cuda:0')
old_score: tensor(0.0667, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0611, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.227430582046509
Validation after dual ascent:
out_inf: tensor(24.5625, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.5776, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0623, device='cuda:0', dtype=torch.float16)
tensor(0.6382, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
tensor(0.5576, device='cuda:0', dtype=torch.float16) tensor(0.0590, device='cuda:0', dtype=torch.float16)
26 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.0469, device='cuda:0', dtype=torch.float16) tensor(0.4866, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.0596, device='cuda:0', dtype=torch.float16) tensor(0.1088, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.1243, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0162, device='cuda:0')
tensor(0.2089, device='cuda:0')
old_score: tensor(0.1144, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1042, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.275841236114502
Validation after dual ascent:
out_inf: tensor(9.0469, device='cuda:0', dtype=torch.float16) tensor(0.4866, device='cuda:0', dtype=torch.float16)
tensor(1.2139, device='cuda:0', dtype=torch.float16) tensor(0.1055, device='cuda:0', dtype=torch.float16)
tensor(1.0215, device='cuda:0', dtype=torch.float16) tensor(0.0977, device='cuda:0', dtype=torch.float16)
tensor(1.1182, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.1689, device='cuda:0', dtype=torch.float16) tensor(0.1001, device='cuda:0', dtype=torch.float16)
26 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.3164, device='cuda:0', dtype=torch.float16) tensor(0.3613, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.1023, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1166, device='cuda:0', dtype=torch.float16)
tensor(0.9902, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0136, device='cuda:0')
tensor(0.1901, device='cuda:0')
old_score: tensor(0.1075, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0980, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.278224229812622
Validation after dual ascent:
out_inf: tensor(7.3164, device='cuda:0', dtype=torch.float16) tensor(0.3613, device='cuda:0', dtype=torch.float16)
tensor(1.1748, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(0.9551, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
tensor(1.0771, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
tensor(0.9160, device='cuda:0', dtype=torch.float16) tensor(0.0943, device='cuda:0', dtype=torch.float16)
26 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.1971, device='cuda:0', dtype=torch.float16)
tensor(0.6973, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.7480, device='cuda:0', dtype=torch.float16) tensor(0.0523, device='cuda:0', dtype=torch.float16)
tensor(0.7031, device='cuda:0', dtype=torch.float16) tensor(0.0603, device='cuda:0', dtype=torch.float16)
tensor(0.7061, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0100, device='cuda:0')
tensor(0.1250, device='cuda:0')
old_score: tensor(0.0561, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0536, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.32737684249878
Validation after dual ascent:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.1971, device='cuda:0', dtype=torch.float16)
tensor(0.6885, device='cuda:0', dtype=torch.float16) tensor(0.0554, device='cuda:0', dtype=torch.float16)
tensor(0.8110, device='cuda:0', dtype=torch.float16) tensor(0.0495, device='cuda:0', dtype=torch.float16)
tensor(0.7515, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
tensor(0.6523, device='cuda:0', dtype=torch.float16) tensor(0.0516, device='cuda:0', dtype=torch.float16)
layer 26 done
27 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.1094, device='cuda:0', dtype=torch.float16) tensor(0.8159, device='cuda:0', dtype=torch.float16)
tensor(1.6309, device='cuda:0', dtype=torch.float16) tensor(0.1608, device='cuda:0', dtype=torch.float16)
tensor(1.3613, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(1.4971, device='cuda:0', dtype=torch.float16) tensor(0.1742, device='cuda:0', dtype=torch.float16)
tensor(1.3643, device='cuda:0', dtype=torch.float16) tensor(0.1515, device='cuda:0', dtype=torch.float16)
tensor(0.1410, device='cuda:0')
old_score: tensor(0.1598, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1451, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.25070858001709
Validation after dual ascent:
out_inf: tensor(15.1094, device='cuda:0', dtype=torch.float16) tensor(0.8159, device='cuda:0', dtype=torch.float16)
tensor(1.5537, device='cuda:0', dtype=torch.float16) tensor(0.1465, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1366, device='cuda:0', dtype=torch.float16)
tensor(1.4521, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(1.3916, device='cuda:0', dtype=torch.float16) tensor(0.1384, device='cuda:0', dtype=torch.float16)
27 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.5000, device='cuda:0', dtype=torch.float16) tensor(0.9585, device='cuda:0', dtype=torch.float16)
tensor(1.5488, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(1.4053, device='cuda:0', dtype=torch.float16) tensor(0.1539, device='cuda:0', dtype=torch.float16)
tensor(1.4248, device='cuda:0', dtype=torch.float16) tensor(0.1753, device='cuda:0', dtype=torch.float16)
tensor(1.3555, device='cuda:0', dtype=torch.float16) tensor(0.1527, device='cuda:0', dtype=torch.float16)
tensor(0.1488, device='cuda:0')
old_score: tensor(0.1609, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1460, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.292055606842041
Validation after dual ascent:
out_inf: tensor(18.5000, device='cuda:0', dtype=torch.float16) tensor(0.9585, device='cuda:0', dtype=torch.float16)
tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1375, device='cuda:0', dtype=torch.float16)
tensor(1.4668, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
tensor(1.3115, device='cuda:0', dtype=torch.float16) tensor(0.1394, device='cuda:0', dtype=torch.float16)
27 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.3984, device='cuda:0', dtype=torch.float16) tensor(0.4570, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.1440, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.1368, device='cuda:0', dtype=torch.float16)
tensor(1.2402, device='cuda:0', dtype=torch.float16) tensor(0.1559, device='cuda:0', dtype=torch.float16)
tensor(1.1973, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(0.1020, device='cuda:0')
old_score: tensor(0.1432, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1305, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.285178899765015
Validation after dual ascent:
out_inf: tensor(9.3984, device='cuda:0', dtype=torch.float16) tensor(0.4570, device='cuda:0', dtype=torch.float16)
tensor(1.2627, device='cuda:0', dtype=torch.float16) tensor(0.1318, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.2559, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
tensor(1.2725, device='cuda:0', dtype=torch.float16) tensor(0.1247, device='cuda:0', dtype=torch.float16)
27 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1562, device='cuda:0', dtype=torch.float16) tensor(0.1081, device='cuda:0', dtype=torch.float16)
tensor(0.6978, device='cuda:0', dtype=torch.float16) tensor(0.0336, device='cuda:0', dtype=torch.float16)
tensor(0.4375, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.5703, device='cuda:0', dtype=torch.float16) tensor(0.0353, device='cuda:0', dtype=torch.float16)
tensor(0.5454, device='cuda:0', dtype=torch.float16) tensor(0.0360, device='cuda:0', dtype=torch.float16)
Converged at iteration 700
tensor(0.0089, device='cuda:0')
tensor(0.0201, device='cuda:0')
old_score: tensor(0.0349, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0323, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.77372145652771
Validation after dual ascent:
out_inf: tensor(7.1562, device='cuda:0', dtype=torch.float16) tensor(0.1081, device='cuda:0', dtype=torch.float16)
tensor(0.5464, device='cuda:0', dtype=torch.float16) tensor(0.0313, device='cuda:0', dtype=torch.float16)
tensor(0.3770, device='cuda:0', dtype=torch.float16) tensor(0.0316, device='cuda:0', dtype=torch.float16)
tensor(0.5654, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(0.4912, device='cuda:0', dtype=torch.float16) tensor(0.0329, device='cuda:0', dtype=torch.float16)
27 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.3594, device='cuda:0', dtype=torch.float16) tensor(0.5142, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(1.1416, device='cuda:0', dtype=torch.float16) tensor(0.1273, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.1111, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0177, device='cuda:0')
tensor(0.2316, device='cuda:0')
old_score: tensor(0.1169, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1061, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.277157306671143
Validation after dual ascent:
out_inf: tensor(10.3594, device='cuda:0', dtype=torch.float16) tensor(0.5142, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.0995, device='cuda:0', dtype=torch.float16)
tensor(1.0967, device='cuda:0', dtype=torch.float16) tensor(0.1163, device='cuda:0', dtype=torch.float16)
tensor(1.0498, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
27 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.2266, device='cuda:0', dtype=torch.float16) tensor(0.3887, device='cuda:0', dtype=torch.float16)
tensor(1.3047, device='cuda:0', dtype=torch.float16) tensor(0.1119, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
tensor(1.0713, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(1.1934, device='cuda:0', dtype=torch.float16) tensor(0.1053, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0151, device='cuda:0')
tensor(0.2114, device='cuda:0')
old_score: tensor(0.1108, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1007, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.273921012878418
Validation after dual ascent:
out_inf: tensor(7.2266, device='cuda:0', dtype=torch.float16) tensor(0.3887, device='cuda:0', dtype=torch.float16)
tensor(1.3662, device='cuda:0', dtype=torch.float16) tensor(0.1021, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
tensor(1.0693, device='cuda:0', dtype=torch.float16) tensor(0.1101, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
27 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.2203, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0625, device='cuda:0', dtype=torch.float16)
tensor(0.7578, device='cuda:0', dtype=torch.float16) tensor(0.0573, device='cuda:0', dtype=torch.float16)
tensor(0.6943, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
tensor(0.7891, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0123, device='cuda:0')
tensor(0.1520, device='cuda:0')
old_score: tensor(0.0607, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0578, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.306462049484253
Validation after dual ascent:
out_inf: tensor(3.0312, device='cuda:0', dtype=torch.float16) tensor(0.2203, device='cuda:0', dtype=torch.float16)
tensor(0.9995, device='cuda:0', dtype=torch.float16) tensor(0.0597, device='cuda:0', dtype=torch.float16)
tensor(0.7402, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
tensor(0.7124, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(0.8208, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
layer 27 done
28 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.1406, device='cuda:0', dtype=torch.float16) tensor(0.8423, device='cuda:0', dtype=torch.float16)
tensor(1.5195, device='cuda:0', dtype=torch.float16) tensor(0.1597, device='cuda:0', dtype=torch.float16)
tensor(1.8496, device='cuda:0', dtype=torch.float16) tensor(0.1523, device='cuda:0', dtype=torch.float16)
tensor(2.0293, device='cuda:0', dtype=torch.float16) tensor(0.1729, device='cuda:0', dtype=torch.float16)
tensor(1.8213, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
tensor(0.1762, device='cuda:0')
old_score: tensor(0.1589, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1438, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.178261756896973
Validation after dual ascent:
out_inf: tensor(15.1406, device='cuda:0', dtype=torch.float16) tensor(0.8423, device='cuda:0', dtype=torch.float16)
tensor(1.5156, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(1.6621, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.9033, device='cuda:0', dtype=torch.float16) tensor(0.1575, device='cuda:0', dtype=torch.float16)
tensor(1.7539, device='cuda:0', dtype=torch.float16) tensor(0.1370, device='cuda:0', dtype=torch.float16)
28 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(21.3125, device='cuda:0', dtype=torch.float16) tensor(1.0088, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.1614, device='cuda:0', dtype=torch.float16)
tensor(1.2393, device='cuda:0', dtype=torch.float16) tensor(0.1536, device='cuda:0', dtype=torch.float16)
tensor(1.4326, device='cuda:0', dtype=torch.float16) tensor(0.1746, device='cuda:0', dtype=torch.float16)
tensor(1.3271, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(0.1983, device='cuda:0')
old_score: tensor(0.1604, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1450, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.220463991165161
Validation after dual ascent:
out_inf: tensor(21.3125, device='cuda:0', dtype=torch.float16) tensor(1.0088, device='cuda:0', dtype=torch.float16)
tensor(1.4785, device='cuda:0', dtype=torch.float16) tensor(0.1464, device='cuda:0', dtype=torch.float16)
tensor(1.2939, device='cuda:0', dtype=torch.float16) tensor(0.1365, device='cuda:0', dtype=torch.float16)
tensor(1.4932, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(1.2764, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
28 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.9844, device='cuda:0', dtype=torch.float16) tensor(0.5039, device='cuda:0', dtype=torch.float16)
tensor(1.4268, device='cuda:0', dtype=torch.float16) tensor(0.1530, device='cuda:0', dtype=torch.float16)
tensor(1.2568, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(1.3340, device='cuda:0', dtype=torch.float16) tensor(0.1445, device='cuda:0', dtype=torch.float16)
tensor(0.1395, device='cuda:0')
old_score: tensor(0.1521, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1382, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.201244115829468
Validation after dual ascent:
out_inf: tensor(6.9844, device='cuda:0', dtype=torch.float16) tensor(0.5039, device='cuda:0', dtype=torch.float16)
tensor(1.3730, device='cuda:0', dtype=torch.float16) tensor(0.1394, device='cuda:0', dtype=torch.float16)
tensor(1.2715, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
tensor(1.3496, device='cuda:0', dtype=torch.float16) tensor(0.1512, device='cuda:0', dtype=torch.float16)
tensor(1.4287, device='cuda:0', dtype=torch.float16) tensor(0.1318, device='cuda:0', dtype=torch.float16)
28 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.1406, device='cuda:0', dtype=torch.float16) tensor(0.1550, device='cuda:0', dtype=torch.float16)
tensor(0.8247, device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
tensor(0.6621, device='cuda:0', dtype=torch.float16) tensor(0.0596, device='cuda:0', dtype=torch.float16)
tensor(0.8838, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(0.7310, device='cuda:0', dtype=torch.float16) tensor(0.0563, device='cuda:0', dtype=torch.float16)
tensor(0.0309, device='cuda:0')
old_score: tensor(0.0568, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0520, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.157721996307373
Validation after dual ascent:
out_inf: tensor(10.1406, device='cuda:0', dtype=torch.float16) tensor(0.1550, device='cuda:0', dtype=torch.float16)
tensor(0.6631, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.7461, device='cuda:0', dtype=torch.float16) tensor(0.0534, device='cuda:0', dtype=torch.float16)
tensor(1.0645, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
tensor(0.9512, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
28 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.4766, device='cuda:0', dtype=torch.float16) tensor(0.5415, device='cuda:0', dtype=torch.float16)
tensor(1.2158, device='cuda:0', dtype=torch.float16) tensor(0.1211, device='cuda:0', dtype=torch.float16)
tensor(1.1455, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(1.1768, device='cuda:0', dtype=torch.float16) tensor(0.1301, device='cuda:0', dtype=torch.float16)
tensor(1.0996, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0192, device='cuda:0')
tensor(0.2652, device='cuda:0')
old_score: tensor(0.1201, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1085, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.243514537811279
Validation after dual ascent:
out_inf: tensor(10.4766, device='cuda:0', dtype=torch.float16) tensor(0.5415, device='cuda:0', dtype=torch.float16)
tensor(1.2979, device='cuda:0', dtype=torch.float16) tensor(0.1102, device='cuda:0', dtype=torch.float16)
tensor(1.1270, device='cuda:0', dtype=torch.float16) tensor(0.1017, device='cuda:0', dtype=torch.float16)
tensor(1.1807, device='cuda:0', dtype=torch.float16) tensor(0.1183, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
28 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.6875, device='cuda:0', dtype=torch.float16) tensor(0.4314, device='cuda:0', dtype=torch.float16)
tensor(1.1465, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
tensor(1.2188, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(1.2344, device='cuda:0', dtype=torch.float16) tensor(0.1257, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1103, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0174, device='cuda:0')
tensor(0.2473, device='cuda:0')
old_score: tensor(0.1160, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1048, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.240533351898193
Validation after dual ascent:
out_inf: tensor(12.6875, device='cuda:0', dtype=torch.float16) tensor(0.4314, device='cuda:0', dtype=torch.float16)
tensor(1.1992, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
tensor(1.0098, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
tensor(1.0479, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
28 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.3438, device='cuda:0', dtype=torch.float16) tensor(0.2571, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0705, device='cuda:0', dtype=torch.float16)
tensor(0.8853, device='cuda:0', dtype=torch.float16) tensor(0.0655, device='cuda:0', dtype=torch.float16)
tensor(0.8145, device='cuda:0', dtype=torch.float16) tensor(0.0741, device='cuda:0', dtype=torch.float16)
tensor(0.8506, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0171, device='cuda:0')
tensor(0.2146, device='cuda:0')
old_score: tensor(0.0692, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0659, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.208542585372925
Validation after dual ascent:
out_inf: tensor(7.3438, device='cuda:0', dtype=torch.float16) tensor(0.2571, device='cuda:0', dtype=torch.float16)
tensor(0.9536, device='cuda:0', dtype=torch.float16) tensor(0.0673, device='cuda:0', dtype=torch.float16)
tensor(0.9209, device='cuda:0', dtype=torch.float16) tensor(0.0616, device='cuda:0', dtype=torch.float16)
tensor(0.8105, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.8311, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
layer 28 done
29 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.0781, device='cuda:0', dtype=torch.float16) tensor(0.8271, device='cuda:0', dtype=torch.float16)
tensor(1.9746, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
tensor(1.7275, device='cuda:0', dtype=torch.float16) tensor(0.1432, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1627, device='cuda:0', dtype=torch.float16)
tensor(2.1113, device='cuda:0', dtype=torch.float16) tensor(0.1409, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0192, device='cuda:0')
tensor(0.0758, device='cuda:0')
old_score: tensor(0.1489, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1345, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.49981427192688
Validation after dual ascent:
out_inf: tensor(13.0781, device='cuda:0', dtype=torch.float16) tensor(0.8271, device='cuda:0', dtype=torch.float16)
tensor(1.9355, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1271, device='cuda:0', dtype=torch.float16)
tensor(1.3926, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.9102, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
29 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(21.0625, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(1.2490, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(1.4238, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0154, device='cuda:0')
tensor(0.0488, device='cuda:0')
old_score: tensor(0.1504, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1353, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.502455472946167
Validation after dual ascent:
out_inf: tensor(21.0625, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.1365, device='cuda:0', dtype=torch.float16)
tensor(1.5410, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.1483, device='cuda:0', dtype=torch.float16)
tensor(1.2588, device='cuda:0', dtype=torch.float16) tensor(0.1284, device='cuda:0', dtype=torch.float16)
29 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.7734, device='cuda:0', dtype=torch.float16) tensor(0.4827, device='cuda:0', dtype=torch.float16)
tensor(1.4629, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.1439, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.1633, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0144, device='cuda:0')
tensor(0.0977, device='cuda:0')
old_score: tensor(0.1499, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1359, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2565596103668213
Validation after dual ascent:
out_inf: tensor(7.7734, device='cuda:0', dtype=torch.float16) tensor(0.4827, device='cuda:0', dtype=torch.float16)
tensor(1.3730, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
tensor(1.3428, device='cuda:0', dtype=torch.float16) tensor(0.1488, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
29 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.0469, device='cuda:0', dtype=torch.float16) tensor(0.1859, device='cuda:0', dtype=torch.float16)
tensor(0.6880, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.6865, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.7173, device='cuda:0', dtype=torch.float16) tensor(0.0652, device='cuda:0', dtype=torch.float16)
tensor(0.5713, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
tensor(0.0341, device='cuda:0')
old_score: tensor(0.0630, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0582, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.1820068359375
Validation after dual ascent:
out_inf: tensor(19.0469, device='cuda:0', dtype=torch.float16) tensor(0.1859, device='cuda:0', dtype=torch.float16)
tensor(0.6865, device='cuda:0', dtype=torch.float16) tensor(0.0566, device='cuda:0', dtype=torch.float16)
tensor(0.7041, device='cuda:0', dtype=torch.float16) tensor(0.0611, device='cuda:0', dtype=torch.float16)
tensor(0.7139, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.6318, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
29 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.5625, device='cuda:0', dtype=torch.float16) tensor(0.5532, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1230, device='cuda:0', dtype=torch.float16)
tensor(1.7148, device='cuda:0', dtype=torch.float16) tensor(0.1168, device='cuda:0', dtype=torch.float16)
tensor(1.4756, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1163, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0103, device='cuda:0')
tensor(0.0415, device='cuda:0')
old_score: tensor(0.1219, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1101, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.230893850326538
Validation after dual ascent:
out_inf: tensor(12.5625, device='cuda:0', dtype=torch.float16) tensor(0.5532, device='cuda:0', dtype=torch.float16)
tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(1.3906, device='cuda:0', dtype=torch.float16) tensor(0.1034, device='cuda:0', dtype=torch.float16)
tensor(1.4082, device='cuda:0', dtype=torch.float16) tensor(0.1199, device='cuda:0', dtype=torch.float16)
tensor(1.3047, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
29 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.6719, device='cuda:0', dtype=torch.float16) tensor(0.4856, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1200, device='cuda:0', dtype=torch.float16)
tensor(1.1680, device='cuda:0', dtype=torch.float16) tensor(0.1140, device='cuda:0', dtype=torch.float16)
tensor(1.1426, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1134, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0193, device='cuda:0')
tensor(0.2666, device='cuda:0')
old_score: tensor(0.1190, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1074, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.260648727416992
Validation after dual ascent:
out_inf: tensor(9.6719, device='cuda:0', dtype=torch.float16) tensor(0.4856, device='cuda:0', dtype=torch.float16)
tensor(1.2314, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(1.1748, device='cuda:0', dtype=torch.float16) tensor(0.1008, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.1170, device='cuda:0', dtype=torch.float16)
tensor(1.2002, device='cuda:0', dtype=torch.float16) tensor(0.1030, device='cuda:0', dtype=torch.float16)
29 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(23.4531, device='cuda:0', dtype=torch.float16) tensor(0.3176, device='cuda:0', dtype=torch.float16)
tensor(0.9448, device='cuda:0', dtype=torch.float16) tensor(0.0786, device='cuda:0', dtype=torch.float16)
tensor(1.0020, device='cuda:0', dtype=torch.float16) tensor(0.0732, device='cuda:0', dtype=torch.float16)
tensor(0.8672, device='cuda:0', dtype=torch.float16) tensor(0.0828, device='cuda:0', dtype=torch.float16)
tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0042, device='cuda:0')
tensor(0.0306, device='cuda:0')
old_score: tensor(0.0774, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0734, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.137934923171997
Validation after dual ascent:
out_inf: tensor(23.4531, device='cuda:0', dtype=torch.float16) tensor(0.3176, device='cuda:0', dtype=torch.float16)
tensor(0.9102, device='cuda:0', dtype=torch.float16) tensor(0.0748, device='cuda:0', dtype=torch.float16)
tensor(0.8291, device='cuda:0', dtype=torch.float16) tensor(0.0687, device='cuda:0', dtype=torch.float16)
tensor(0.8633, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0713, device='cuda:0', dtype=torch.float16)
layer 29 done
30 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.6250, device='cuda:0', dtype=torch.float16) tensor(0.8589, device='cuda:0', dtype=torch.float16)
tensor(1.6309, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1500, device='cuda:0', dtype=torch.float16)
tensor(1.5166, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(1.4082, device='cuda:0', dtype=torch.float16) tensor(0.1488, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0160, device='cuda:0')
tensor(0.0973, device='cuda:0')
old_score: tensor(0.1565, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1405, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2571194171905518
Validation after dual ascent:
out_inf: tensor(14.6250, device='cuda:0', dtype=torch.float16) tensor(0.8589, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
tensor(1.3877, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1344, device='cuda:0', dtype=torch.float16)
30 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(1.0098, device='cuda:0', dtype=torch.float16)
tensor(1.5332, device='cuda:0', dtype=torch.float16) tensor(0.1598, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.1530, device='cuda:0', dtype=torch.float16)
tensor(1.3975, device='cuda:0', dtype=torch.float16) tensor(0.1726, device='cuda:0', dtype=torch.float16)
tensor(1.3330, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0200, device='cuda:0')
tensor(0.1058, device='cuda:0')
old_score: tensor(0.1589, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1426, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2563905715942383
Validation after dual ascent:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(1.0098, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1440, device='cuda:0', dtype=torch.float16)
tensor(1.3906, device='cuda:0', dtype=torch.float16) tensor(0.1343, device='cuda:0', dtype=torch.float16)
tensor(1.4004, device='cuda:0', dtype=torch.float16) tensor(0.1558, device='cuda:0', dtype=torch.float16)
tensor(1.3740, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
30 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.5469, device='cuda:0', dtype=torch.float16) tensor(0.5376, device='cuda:0', dtype=torch.float16)
tensor(1.3896, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(1.3848, device='cuda:0', dtype=torch.float16) tensor(0.1704, device='cuda:0', dtype=torch.float16)
tensor(1.3916, device='cuda:0', dtype=torch.float16) tensor(0.1495, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0178, device='cuda:0')
tensor(0.3261, device='cuda:0')
old_score: tensor(0.1571, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1416, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.507671356201172
Validation after dual ascent:
out_inf: tensor(9.5469, device='cuda:0', dtype=torch.float16) tensor(0.5376, device='cuda:0', dtype=torch.float16)
tensor(1.3457, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
tensor(1.3076, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.3047, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
30 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.5625, device='cuda:0', dtype=torch.float16) tensor(0.1584, device='cuda:0', dtype=torch.float16)
tensor(0.7407, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.6689, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(1.2529, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.7349, device='cuda:0', dtype=torch.float16) tensor(0.0485, device='cuda:0', dtype=torch.float16)
tensor(0.0432, device='cuda:0')
old_score: tensor(0.0490, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0444, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.171940803527832
Validation after dual ascent:
out_inf: tensor(19.5625, device='cuda:0', dtype=torch.float16) tensor(0.1584, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.7690, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(1.1396, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.7261, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
30 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(35.1562, device='cuda:0', dtype=torch.float16) tensor(0.6040, device='cuda:0', dtype=torch.float16)
tensor(1.3359, device='cuda:0', dtype=torch.float16) tensor(0.1234, device='cuda:0', dtype=torch.float16)
tensor(1.3828, device='cuda:0', dtype=torch.float16) tensor(0.1171, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
tensor(1.3867, device='cuda:0', dtype=torch.float16) tensor(0.1164, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0144, device='cuda:0')
tensor(0.0425, device='cuda:0')
old_score: tensor(0.1225, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1099, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.235835552215576
Validation after dual ascent:
out_inf: tensor(35.1562, device='cuda:0', dtype=torch.float16) tensor(0.6040, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1114, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
tensor(1.1602, device='cuda:0', dtype=torch.float16) tensor(0.1049, device='cuda:0', dtype=torch.float16)
30 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(35.6875, device='cuda:0', dtype=torch.float16) tensor(0.5669, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.1199, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(1.1494, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.1131, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0140, device='cuda:0')
tensor(0.0377, device='cuda:0')
old_score: tensor(0.1189, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1066, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.247072219848633
Validation after dual ascent:
out_inf: tensor(35.6875, device='cuda:0', dtype=torch.float16) tensor(0.5669, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.1081, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(1.1768, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(1.1611, device='cuda:0', dtype=torch.float16) tensor(0.1019, device='cuda:0', dtype=torch.float16)
30 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1535., device='cuda:0', dtype=torch.float16) tensor(0.5312, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0869, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(0.9839, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0167, device='cuda:0')
tensor(0.0334, device='cuda:0')
old_score: tensor(0.0863, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0814, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.974198579788208
Validation after dual ascent:
out_inf: tensor(1535., device='cuda:0', dtype=torch.float16) tensor(0.5312, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.0822, device='cuda:0', dtype=torch.float16)
tensor(1.1104, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0870, device='cuda:0', dtype=torch.float16)
tensor(1.0264, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
layer 30 done
31 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(21.5156, device='cuda:0', dtype=torch.float16) tensor(0.8672, device='cuda:0', dtype=torch.float16)
tensor(4.1875, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
tensor(3.7188, device='cuda:0', dtype=torch.float16) tensor(0.1246, device='cuda:0', dtype=torch.float16)
tensor(3.4922, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(2.5625, device='cuda:0', dtype=torch.float16) tensor(0.1219, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0195, device='cuda:0')
tensor(0.1993, device='cuda:0')
old_score: tensor(0.1294, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1145, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.50778865814209
Validation after dual ascent:
out_inf: tensor(21.5156, device='cuda:0', dtype=torch.float16) tensor(0.8672, device='cuda:0', dtype=torch.float16)
tensor(4.0078, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(3.5312, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
tensor(3.3359, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(2.4375, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
31 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(22.3594, device='cuda:0', dtype=torch.float16) tensor(1.1006, device='cuda:0', dtype=torch.float16)
tensor(3.8984, device='cuda:0', dtype=torch.float16) tensor(0.1332, device='cuda:0', dtype=torch.float16)
tensor(3.5938, device='cuda:0', dtype=torch.float16) tensor(0.1276, device='cuda:0', dtype=torch.float16)
tensor(3.2773, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(2.4180, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0179, device='cuda:0')
tensor(0.0384, device='cuda:0')
old_score: tensor(0.1327, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1172, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.0055718421936035
Validation after dual ascent:
out_inf: tensor(22.3594, device='cuda:0', dtype=torch.float16) tensor(1.1006, device='cuda:0', dtype=torch.float16)
tensor(3.6406, device='cuda:0', dtype=torch.float16) tensor(0.1184, device='cuda:0', dtype=torch.float16)
tensor(3.2031, device='cuda:0', dtype=torch.float16) tensor(0.1102, device='cuda:0', dtype=torch.float16)
tensor(3.0156, device='cuda:0', dtype=torch.float16) tensor(0.1292, device='cuda:0', dtype=torch.float16)
tensor(2.0742, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
31 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.6562, device='cuda:0', dtype=torch.float16) tensor(0.4170, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1171, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.1120, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1268, device='cuda:0', dtype=torch.float16)
tensor(1.3184, device='cuda:0', dtype=torch.float16) tensor(0.1102, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0107, device='cuda:0')
tensor(0.1617, device='cuda:0')
old_score: tensor(0.1165, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1036, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.5089426040649414
Validation after dual ascent:
out_inf: tensor(8.6562, device='cuda:0', dtype=torch.float16) tensor(0.4170, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.1049, device='cuda:0', dtype=torch.float16)
tensor(1.3164, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(1.3359, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
31 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(127.2500, device='cuda:0', dtype=torch.float16) tensor(0.2561, device='cuda:0', dtype=torch.float16)
tensor(0.6758, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
tensor(0.6699, device='cuda:0', dtype=torch.float16) tensor(0.0592, device='cuda:0', dtype=torch.float16)
tensor(0.9287, device='cuda:0', dtype=torch.float16) tensor(0.0582, device='cuda:0', dtype=torch.float16)
tensor(0.7197, device='cuda:0', dtype=torch.float16) tensor(0.0595, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0200, device='cuda:0')
tensor(0.0272, device='cuda:0')
old_score: tensor(0.0590, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0501, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.235107660293579
Validation after dual ascent:
out_inf: tensor(127.2500, device='cuda:0', dtype=torch.float16) tensor(0.2561, device='cuda:0', dtype=torch.float16)
tensor(0.6885, device='cuda:0', dtype=torch.float16) tensor(0.0503, device='cuda:0', dtype=torch.float16)
tensor(0.5947, device='cuda:0', dtype=torch.float16) tensor(0.0485, device='cuda:0', dtype=torch.float16)
tensor(0.7139, device='cuda:0', dtype=torch.float16) tensor(0.0506, device='cuda:0', dtype=torch.float16)
tensor(0.5361, device='cuda:0', dtype=torch.float16) tensor(0.0510, device='cuda:0', dtype=torch.float16)
31 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(31.1875, device='cuda:0', dtype=torch.float16) tensor(0.6548, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.1129, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1087, device='cuda:0', dtype=torch.float16)
tensor(1.3359, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0188, device='cuda:0')
tensor(0.0180, device='cuda:0')
old_score: tensor(0.1127, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0992, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.198256254196167
Validation after dual ascent:
out_inf: tensor(31.1875, device='cuda:0', dtype=torch.float16) tensor(0.6548, device='cuda:0', dtype=torch.float16)
tensor(1.0762, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(1.1602, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(1.3066, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
31 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(34.2188, device='cuda:0', dtype=torch.float16) tensor(0.6724, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1044, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.1176, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.1024, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0179, device='cuda:0')
tensor(0.0171, device='cuda:0')
old_score: tensor(0.1081, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0951, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.217489957809448
Validation after dual ascent:
out_inf: tensor(34.2188, device='cuda:0', dtype=torch.float16) tensor(0.6724, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
tensor(1.0068, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1044, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0905, device='cuda:0', dtype=torch.float16)
31 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(154.8750, device='cuda:0', dtype=torch.float16) tensor(1.5996, device='cuda:0', dtype=torch.float16)
tensor(1.2549, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(1.1660, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
tensor(1.2471, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
layer 31 done
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.08it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.08it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.90it/s]
{'model.embed_tokens': 0, 'model.layers.0': 0, 'model.layers.1': 0, 'model.layers.2': 0, 'model.layers.3': 0, 'model.layers.4': 0, 'model.layers.5': 0, 'model.layers.6': 0, 'model.layers.7': 0, 'model.layers.8': 0, 'model.layers.9': 0, 'model.layers.10': 0, 'model.layers.11': 0, 'model.layers.12': 0, 'model.layers.13': 0, 'model.layers.14': 0, 'model.layers.15': 0, 'model.layers.16': 0, 'model.layers.17': 0, 'model.layers.18': 0, 'model.layers.19': 0, 'model.layers.20': 0, 'model.layers.21': 0, 'model.layers.22': 0, 'model.layers.23': 0, 'model.layers.24': 0, 'model.layers.25': 0, 'model.layers.26': 0, 'model.layers.27': 1, 'model.layers.28': 1, 'model.layers.29': 1, 'model.layers.30': 1, 'model.layers.31': 1, 'model.norm': 1, 'model.rotary_emb': 1, 'lm_head': 1}
use device  1
******************************
layer 0 sparsity 0.700001
layer 1 sparsity 0.700001
layer 2 sparsity 0.700001
layer 3 sparsity 0.700001
layer 4 sparsity 0.700001
layer 5 sparsity 0.700001
layer 6 sparsity 0.700001
layer 7 sparsity 0.700001
layer 8 sparsity 0.700001
layer 9 sparsity 0.700001
layer 10 sparsity 0.700001
layer 11 sparsity 0.700001
layer 12 sparsity 0.700001
layer 13 sparsity 0.700001
layer 14 sparsity 0.700001
layer 15 sparsity 0.700001
layer 16 sparsity 0.700001
layer 17 sparsity 0.700001
layer 18 sparsity 0.700001
layer 19 sparsity 0.700001
layer 20 sparsity 0.700001
layer 21 sparsity 0.700001
layer 22 sparsity 0.700001
layer 23 sparsity 0.700001
layer 24 sparsity 0.700001
layer 25 sparsity 0.700001
layer 26 sparsity 0.700001
layer 27 sparsity 0.700001
layer 28 sparsity 0.700001
layer 29 sparsity 0.700001
layer 30 sparsity 0.700001
layer 31 sparsity 0.700001
sparsity sanity check 0.7000
******************************
evaluating on wikitext2
nsamples 83
sample 0
sample 50
wikitext perplexity 20.237829208374023
sparsegpt_dual_3	0.7000	20.2378	256
Namespace(model='/h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf', seed=0, nsamples=256, dual_theld=0.03, n_batch=8, sparsity_ratio=0.7, epsilon=0.02, n_flod=1, sparsity_type='unstructured', prune_method='sparsegpt_dual_3', cache_dir='llm_weights', use_variant=False, save='/h3cstore_ns/jcxie/LISA/nips2024/log', save_model=None, exclude='gate_proj', ww_metric='alpha_peak', ww_metric_cache='/h3cstore_ns/jcxie/LISA/wanda-main/data/llama2-7b-hf', wanda_scale=0.01, ww_epsilon=0.02, mapping_type='block_wise', dual_sp_theld=0.0, Hyper_m=3, Lamda=0.2, eval_zero_shot=0, save_ckpt=0)
2025-04-24 02:46:14.843087: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-24 02:46:15.031278: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-24 02:46:15.036788: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 02:46:15.036817: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2025-04-24 02:46:18.557879: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 02:46:18.558407: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 02:46:18.558426: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
torch 2.3.1+cu121
transformers 4.47.1
accelerate 0.29.1
# of gpus:  2
loading llm model /h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.92it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.37it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.29it/s]
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
model.embed_tokens.weight torch.Size([32000, 4096])
model.layers.0.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.0.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.0.input_layernorm.weight torch.Size([4096])
model.layers.0.post_attention_layernorm.weight torch.Size([4096])
model.layers.1.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.1.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.1.input_layernorm.weight torch.Size([4096])
model.layers.1.post_attention_layernorm.weight torch.Size([4096])
model.layers.2.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.2.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.2.input_layernorm.weight torch.Size([4096])
model.layers.2.post_attention_layernorm.weight torch.Size([4096])
model.layers.3.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.3.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.3.input_layernorm.weight torch.Size([4096])
model.layers.3.post_attention_layernorm.weight torch.Size([4096])
model.layers.4.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.4.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.4.input_layernorm.weight torch.Size([4096])
model.layers.4.post_attention_layernorm.weight torch.Size([4096])
model.layers.5.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.5.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.5.input_layernorm.weight torch.Size([4096])
model.layers.5.post_attention_layernorm.weight torch.Size([4096])
model.layers.6.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.6.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.6.input_layernorm.weight torch.Size([4096])
model.layers.6.post_attention_layernorm.weight torch.Size([4096])
model.layers.7.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.7.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.7.input_layernorm.weight torch.Size([4096])
model.layers.7.post_attention_layernorm.weight torch.Size([4096])
model.layers.8.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.8.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.8.input_layernorm.weight torch.Size([4096])
model.layers.8.post_attention_layernorm.weight torch.Size([4096])
model.layers.9.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.9.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.9.input_layernorm.weight torch.Size([4096])
model.layers.9.post_attention_layernorm.weight torch.Size([4096])
model.layers.10.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.10.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.10.input_layernorm.weight torch.Size([4096])
model.layers.10.post_attention_layernorm.weight torch.Size([4096])
model.layers.11.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.11.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.11.input_layernorm.weight torch.Size([4096])
model.layers.11.post_attention_layernorm.weight torch.Size([4096])
model.layers.12.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.12.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.12.input_layernorm.weight torch.Size([4096])
model.layers.12.post_attention_layernorm.weight torch.Size([4096])
model.layers.13.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.13.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.13.input_layernorm.weight torch.Size([4096])
model.layers.13.post_attention_layernorm.weight torch.Size([4096])
model.layers.14.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.14.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.14.input_layernorm.weight torch.Size([4096])
model.layers.14.post_attention_layernorm.weight torch.Size([4096])
model.layers.15.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.15.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.15.input_layernorm.weight torch.Size([4096])
model.layers.15.post_attention_layernorm.weight torch.Size([4096])
model.layers.16.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.16.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.16.input_layernorm.weight torch.Size([4096])
model.layers.16.post_attention_layernorm.weight torch.Size([4096])
model.layers.17.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.17.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.17.input_layernorm.weight torch.Size([4096])
model.layers.17.post_attention_layernorm.weight torch.Size([4096])
model.layers.18.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.18.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.18.input_layernorm.weight torch.Size([4096])
model.layers.18.post_attention_layernorm.weight torch.Size([4096])
model.layers.19.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.19.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.19.input_layernorm.weight torch.Size([4096])
model.layers.19.post_attention_layernorm.weight torch.Size([4096])
model.layers.20.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.20.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.20.input_layernorm.weight torch.Size([4096])
model.layers.20.post_attention_layernorm.weight torch.Size([4096])
model.layers.21.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.21.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.21.input_layernorm.weight torch.Size([4096])
model.layers.21.post_attention_layernorm.weight torch.Size([4096])
model.layers.22.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.22.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.22.input_layernorm.weight torch.Size([4096])
model.layers.22.post_attention_layernorm.weight torch.Size([4096])
model.layers.23.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.23.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.23.input_layernorm.weight torch.Size([4096])
model.layers.23.post_attention_layernorm.weight torch.Size([4096])
model.layers.24.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.24.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.24.input_layernorm.weight torch.Size([4096])
model.layers.24.post_attention_layernorm.weight torch.Size([4096])
model.layers.25.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.25.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.25.input_layernorm.weight torch.Size([4096])
model.layers.25.post_attention_layernorm.weight torch.Size([4096])
model.layers.26.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.26.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.26.input_layernorm.weight torch.Size([4096])
model.layers.26.post_attention_layernorm.weight torch.Size([4096])
model.layers.27.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.27.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.27.input_layernorm.weight torch.Size([4096])
model.layers.27.post_attention_layernorm.weight torch.Size([4096])
model.layers.28.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.28.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.28.input_layernorm.weight torch.Size([4096])
model.layers.28.post_attention_layernorm.weight torch.Size([4096])
model.layers.29.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.29.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.29.input_layernorm.weight torch.Size([4096])
model.layers.29.post_attention_layernorm.weight torch.Size([4096])
model.layers.30.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.30.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.30.input_layernorm.weight torch.Size([4096])
model.layers.30.post_attention_layernorm.weight torch.Size([4096])
model.layers.31.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.31.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.31.input_layernorm.weight torch.Size([4096])
model.layers.31.post_attention_layernorm.weight torch.Size([4096])
model.norm.weight torch.Size([4096])
lm_head.weight torch.Size([32000, 4096])
use device  cpu
loading calibdation data
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<03:20,  1.27it/s]  1%|          | 2/256 [00:01<03:11,  1.32it/s]  2%|▏         | 4/256 [00:01<01:36,  2.61it/s]  2%|▏         | 5/256 [00:02<01:43,  2.43it/s]  2%|▏         | 6/256 [00:02<01:20,  3.10it/s]  3%|▎         | 7/256 [00:03<01:52,  2.21it/s]  3%|▎         | 8/256 [00:03<01:26,  2.85it/s]  4%|▎         | 9/256 [00:03<01:08,  3.63it/s]  4%|▍         | 11/256 [00:03<00:45,  5.37it/s]  5%|▍         | 12/256 [00:03<00:41,  5.85it/s]  5%|▌         | 13/256 [00:04<01:28,  2.75it/s]  5%|▌         | 14/256 [00:04<01:26,  2.78it/s]  6%|▌         | 15/256 [00:05<01:13,  3.26it/s]  6%|▋         | 16/256 [00:05<01:04,  3.74it/s]  7%|▋         | 18/256 [00:05<01:07,  3.53it/s]  8%|▊         | 20/256 [00:06<00:50,  4.67it/s]  8%|▊         | 21/256 [00:06<00:44,  5.29it/s]  9%|▊         | 22/256 [00:06<00:47,  4.93it/s]  9%|▉         | 24/256 [00:06<00:41,  5.63it/s] 10%|▉         | 25/256 [00:06<00:39,  5.89it/s] 10%|█         | 26/256 [00:07<00:52,  4.41it/s] 11%|█         | 28/256 [00:07<00:43,  5.18it/s] 11%|█▏        | 29/256 [00:07<00:45,  5.01it/s] 12%|█▏        | 31/256 [00:08<00:37,  5.93it/s] 12%|█▎        | 32/256 [00:08<00:45,  4.89it/s] 13%|█▎        | 33/256 [00:08<00:57,  3.90it/s] 13%|█▎        | 34/256 [00:09<01:00,  3.64it/s] 14%|█▎        | 35/256 [00:09<01:07,  3.25it/s] 14%|█▍        | 36/256 [00:10<01:18,  2.79it/s] 14%|█▍        | 37/256 [00:10<01:13,  2.99it/s] 15%|█▍        | 38/256 [00:10<01:07,  3.21it/s] 16%|█▌        | 40/256 [00:11<01:03,  3.42it/s] 16%|█▋        | 42/256 [00:11<00:44,  4.86it/s] 17%|█▋        | 43/256 [00:11<00:38,  5.46it/s] 17%|█▋        | 44/256 [00:11<00:38,  5.44it/s] 18%|█▊        | 46/256 [00:11<00:33,  6.35it/s] 18%|█▊        | 47/256 [00:11<00:33,  6.15it/s] 19%|█▉        | 48/256 [00:12<00:37,  5.58it/s] 19%|█▉        | 49/256 [00:12<00:33,  6.13it/s] 20%|█▉        | 50/256 [00:12<00:48,  4.25it/s] 21%|██        | 53/256 [00:13<00:47,  4.29it/s] 21%|██        | 54/256 [00:13<00:46,  4.33it/s] 21%|██▏       | 55/256 [00:13<00:40,  4.94it/s] 22%|██▏       | 56/256 [00:14<00:47,  4.18it/s] 22%|██▏       | 57/256 [00:14<00:44,  4.48it/s] 23%|██▎       | 58/256 [00:14<00:50,  3.94it/s] 23%|██▎       | 59/256 [00:14<00:43,  4.50it/s] 23%|██▎       | 60/256 [00:15<00:46,  4.23it/s] 24%|██▍       | 61/256 [00:15<00:53,  3.64it/s] 24%|██▍       | 62/256 [00:15<00:58,  3.33it/s] 25%|██▍       | 63/256 [00:15<00:50,  3.82it/s] 25%|██▌       | 64/256 [00:16<00:41,  4.62it/s] 25%|██▌       | 65/256 [00:16<01:07,  2.82it/s] 26%|██▌       | 67/256 [00:16<00:43,  4.32it/s] 27%|██▋       | 68/256 [00:17<00:42,  4.43it/s] 27%|██▋       | 69/256 [00:17<00:42,  4.37it/s] 28%|██▊       | 71/256 [00:17<00:33,  5.51it/s] 29%|██▊       | 73/256 [00:17<00:26,  6.83it/s] 29%|██▉       | 74/256 [00:17<00:26,  6.91it/s] 29%|██▉       | 75/256 [00:18<00:31,  5.79it/s] 30%|██▉       | 76/256 [00:18<00:43,  4.12it/s] 30%|███       | 78/256 [00:18<00:29,  5.95it/s] 31%|███       | 79/256 [00:19<00:37,  4.71it/s] 31%|███▏      | 80/256 [00:19<00:48,  3.64it/s] 32%|███▏      | 81/256 [00:19<00:53,  3.27it/s] 32%|███▏      | 82/256 [00:20<00:44,  3.93it/s] 32%|███▏      | 83/256 [00:20<00:54,  3.17it/s] 33%|███▎      | 84/256 [00:20<00:51,  3.34it/s] 33%|███▎      | 85/256 [00:20<00:46,  3.64it/s] 34%|███▎      | 86/256 [00:21<00:42,  3.96it/s] 34%|███▍      | 87/256 [00:21<01:00,  2.82it/s] 34%|███▍      | 88/256 [00:22<01:02,  2.70it/s] 35%|███▍      | 89/256 [00:22<00:58,  2.87it/s] 35%|███▌      | 90/256 [00:22<00:59,  2.81it/s] 36%|███▌      | 91/256 [00:23<00:56,  2.90it/s] 36%|███▌      | 92/256 [00:23<00:48,  3.40it/s] 36%|███▋      | 93/256 [00:23<00:42,  3.83it/s] 37%|███▋      | 94/256 [00:23<00:50,  3.23it/s] 37%|███▋      | 95/256 [00:24<01:04,  2.51it/s] 38%|███▊      | 96/256 [00:24<00:51,  3.12it/s] 38%|███▊      | 97/256 [00:25<00:54,  2.91it/s] 38%|███▊      | 98/256 [00:25<00:45,  3.47it/s] 39%|███▊      | 99/256 [00:25<00:44,  3.55it/s] 39%|███▉      | 100/256 [00:25<00:42,  3.66it/s] 39%|███▉      | 101/256 [00:26<01:14,  2.08it/s] 40%|███▉      | 102/256 [00:27<01:03,  2.41it/s] 41%|████      | 104/256 [00:27<00:40,  3.73it/s] 41%|████▏     | 106/256 [00:27<00:33,  4.48it/s] 42%|████▏     | 107/256 [00:27<00:33,  4.49it/s] 42%|████▏     | 108/256 [00:28<00:47,  3.13it/s] 43%|████▎     | 111/256 [00:28<00:29,  4.84it/s] 44%|████▍     | 112/256 [00:28<00:31,  4.56it/s] 44%|████▍     | 113/256 [00:29<00:31,  4.55it/s] 45%|████▍     | 114/256 [00:29<00:28,  4.97it/s] 45%|████▍     | 115/256 [00:29<00:27,  5.11it/s] 45%|████▌     | 116/256 [00:29<00:38,  3.67it/s] 46%|████▌     | 117/256 [00:30<00:31,  4.44it/s] 46%|████▌     | 118/256 [00:30<00:29,  4.72it/s] 47%|████▋     | 120/256 [00:30<00:20,  6.61it/s] 47%|████▋     | 121/256 [00:30<00:19,  6.97it/s] 48%|████▊     | 122/256 [00:31<00:36,  3.69it/s] 48%|████▊     | 123/256 [00:31<00:39,  3.36it/s] 48%|████▊     | 124/256 [00:32<00:51,  2.55it/s] 49%|████▉     | 125/256 [00:33<01:21,  1.61it/s] 49%|████▉     | 126/256 [00:33<01:08,  1.90it/s] 50%|████▉     | 127/256 [00:34<01:13,  1.75it/s] 50%|█████     | 129/256 [00:34<00:44,  2.85it/s] 51%|█████     | 130/256 [00:34<00:41,  3.07it/s] 51%|█████     | 131/256 [00:35<00:38,  3.21it/s] 52%|█████▏    | 132/256 [00:35<00:37,  3.35it/s] 52%|█████▏    | 133/256 [00:35<00:45,  2.71it/s] 52%|█████▏    | 134/256 [00:36<00:44,  2.73it/s] 53%|█████▎    | 135/256 [00:36<00:35,  3.36it/s] 53%|█████▎    | 136/256 [00:36<00:35,  3.33it/s] 54%|█████▎    | 137/256 [00:36<00:30,  3.96it/s] 54%|█████▍    | 138/256 [00:36<00:26,  4.47it/s] 54%|█████▍    | 139/256 [00:37<00:23,  4.88it/s] 55%|█████▍    | 140/256 [00:37<00:22,  5.27it/s] 55%|█████▌    | 141/256 [00:37<00:19,  6.01it/s] 55%|█████▌    | 142/256 [00:37<00:16,  6.80it/s] 56%|█████▌    | 143/256 [00:37<00:16,  6.93it/s] 57%|█████▋    | 145/256 [00:38<00:37,  2.95it/s] 57%|█████▋    | 146/256 [00:39<00:41,  2.68it/s] 57%|█████▋    | 147/256 [00:39<00:37,  2.94it/s] 58%|█████▊    | 148/256 [00:39<00:37,  2.86it/s] 59%|█████▊    | 150/256 [00:40<00:29,  3.59it/s] 59%|█████▉    | 151/256 [00:40<00:25,  4.12it/s] 59%|█████▉    | 152/256 [00:40<00:28,  3.61it/s] 60%|█████▉    | 153/256 [00:40<00:25,  4.01it/s] 60%|██████    | 154/256 [00:41<00:29,  3.44it/s] 61%|██████    | 155/256 [00:41<00:26,  3.80it/s] 61%|██████    | 156/256 [00:41<00:22,  4.46it/s] 61%|██████▏   | 157/256 [00:42<00:27,  3.60it/s] 62%|██████▏   | 158/256 [00:42<00:23,  4.10it/s] 62%|██████▏   | 159/256 [00:43<00:42,  2.29it/s] 62%|██████▎   | 160/256 [00:43<00:32,  2.94it/s] 63%|██████▎   | 162/256 [00:44<00:36,  2.56it/s] 64%|██████▎   | 163/256 [00:44<00:32,  2.84it/s] 64%|██████▍   | 164/256 [00:44<00:27,  3.36it/s] 65%|██████▍   | 166/256 [00:44<00:22,  3.95it/s] 65%|██████▌   | 167/256 [00:45<00:25,  3.51it/s] 66%|██████▌   | 168/256 [00:45<00:28,  3.09it/s] 66%|██████▌   | 169/256 [00:46<00:31,  2.74it/s] 66%|██████▋   | 170/256 [00:46<00:31,  2.72it/s] 67%|██████▋   | 171/256 [00:46<00:24,  3.40it/s] 67%|██████▋   | 172/256 [00:46<00:21,  3.88it/s] 68%|██████▊   | 173/256 [00:47<00:20,  4.02it/s] 68%|██████▊   | 174/256 [00:47<00:29,  2.77it/s] 68%|██████▊   | 175/256 [00:48<00:42,  1.89it/s] 69%|██████▉   | 176/256 [00:48<00:36,  2.17it/s] 69%|██████▉   | 177/256 [00:49<00:29,  2.65it/s] 70%|██████▉   | 179/256 [00:49<00:20,  3.85it/s] 70%|███████   | 180/256 [00:50<00:38,  1.97it/s] 71%|███████   | 181/256 [00:50<00:30,  2.47it/s] 71%|███████   | 182/256 [00:51<00:39,  1.88it/s] 72%|███████▏  | 184/256 [00:52<00:36,  1.99it/s] 72%|███████▏  | 185/256 [00:52<00:28,  2.46it/s] 73%|███████▎  | 186/256 [00:52<00:23,  3.02it/s] 73%|███████▎  | 187/256 [00:53<00:28,  2.45it/s] 73%|███████▎  | 188/256 [00:53<00:23,  2.84it/s] 74%|███████▍  | 189/256 [00:53<00:23,  2.91it/s] 74%|███████▍  | 190/256 [00:54<00:21,  3.13it/s] 75%|███████▍  | 191/256 [00:54<00:18,  3.47it/s] 75%|███████▌  | 192/256 [00:54<00:22,  2.88it/s] 75%|███████▌  | 193/256 [00:55<00:20,  3.01it/s] 77%|███████▋  | 196/256 [00:55<00:13,  4.51it/s] 77%|███████▋  | 197/256 [00:55<00:15,  3.86it/s] 78%|███████▊  | 199/256 [00:56<00:11,  4.86it/s] 79%|███████▊  | 201/256 [00:56<00:09,  5.50it/s] 79%|███████▉  | 202/256 [00:56<00:11,  4.55it/s] 80%|███████▉  | 204/256 [00:56<00:08,  5.80it/s] 80%|████████  | 206/256 [00:57<00:06,  7.19it/s] 81%|████████  | 207/256 [00:57<00:06,  7.53it/s] 81%|████████▏ | 208/256 [00:57<00:07,  6.48it/s] 82%|████████▏ | 210/256 [00:57<00:05,  8.61it/s] 83%|████████▎ | 212/256 [00:57<00:05,  8.35it/s] 83%|████████▎ | 213/256 [00:58<00:05,  7.42it/s] 84%|████████▎ | 214/256 [00:58<00:07,  5.66it/s] 84%|████████▍ | 215/256 [00:58<00:09,  4.51it/s] 84%|████████▍ | 216/256 [00:58<00:09,  4.42it/s] 85%|████████▌ | 218/256 [00:59<00:07,  5.28it/s] 86%|████████▌ | 219/256 [01:00<00:14,  2.55it/s] 86%|████████▌ | 220/256 [01:00<00:11,  3.00it/s] 86%|████████▋ | 221/256 [01:00<00:11,  2.94it/s] 87%|████████▋ | 222/256 [01:01<00:11,  2.91it/s] 87%|████████▋ | 223/256 [01:01<00:11,  2.78it/s] 88%|████████▊ | 224/256 [01:03<00:23,  1.35it/s] 88%|████████▊ | 225/256 [01:03<00:22,  1.38it/s] 88%|████████▊ | 226/256 [01:04<00:16,  1.79it/s] 89%|████████▊ | 227/256 [01:04<00:13,  2.14it/s] 89%|████████▉ | 228/256 [01:04<00:12,  2.27it/s] 89%|████████▉ | 229/256 [01:05<00:18,  1.44it/s] 90%|████████▉ | 230/256 [01:06<00:13,  1.90it/s] 90%|█████████ | 231/256 [01:06<00:12,  1.96it/s] 91%|█████████ | 232/256 [01:06<00:10,  2.24it/s] 91%|█████████ | 233/256 [01:07<00:08,  2.72it/s] 92%|█████████▏| 235/256 [01:07<00:05,  3.79it/s] 92%|█████████▏| 236/256 [01:07<00:05,  3.59it/s] 93%|█████████▎| 237/256 [01:07<00:04,  3.98it/s] 93%|█████████▎| 238/256 [01:07<00:03,  4.65it/s] 93%|█████████▎| 239/256 [01:08<00:03,  4.58it/s] 94%|█████████▍| 241/256 [01:08<00:02,  5.81it/s] 95%|█████████▍| 242/256 [01:09<00:04,  2.89it/s] 95%|█████████▌| 244/256 [01:09<00:02,  4.40it/s] 96%|█████████▌| 245/256 [01:09<00:02,  4.34it/s] 96%|█████████▌| 246/256 [01:09<00:02,  4.83it/s] 97%|█████████▋| 248/256 [01:09<00:01,  6.54it/s] 97%|█████████▋| 249/256 [01:10<00:01,  3.93it/s] 98%|█████████▊| 251/256 [01:10<00:00,  5.44it/s] 98%|█████████▊| 252/256 [01:11<00:01,  3.47it/s] 99%|█████████▉| 253/256 [01:11<00:01,  2.94it/s]100%|█████████▉| 255/256 [01:12<00:00,  3.08it/s]100%|██████████| 256/256 [01:12<00:00,  3.16it/s]100%|██████████| 256/256 [01:12<00:00,  3.52it/s]
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
dataset loading complete
0 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8555, device='cuda:0', dtype=torch.float16) tensor(0.6099, device='cuda:0', dtype=torch.float16)
tensor(0.0410, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
tensor(0.0635, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
tensor(0.0762, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.0645, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
0 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.0779, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.0859, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.0889, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0859, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
0 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.0425, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.0332, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.0464, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0400, device='cuda:0', dtype=torch.float16) tensor(0.0020, device='cuda:0', dtype=torch.float16)
tensor(0.0479, device='cuda:0')
old_score: tensor(0.0021, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0016, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.001298904418945
Validation after dual ascent:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.0341, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0286, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0415, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
tensor(0.0349, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
0 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0200, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0212, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0205, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0246, device='cuda:0', dtype=torch.float16) tensor(0.0010, device='cuda:0', dtype=torch.float16)
tensor(0.0269, device='cuda:0')
old_score: tensor(0.0010, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0008, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.089025259017944
Validation after dual ascent:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0194, device='cuda:0', dtype=torch.float16) tensor(0.0007, device='cuda:0', dtype=torch.float16)
tensor(0.0208, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
tensor(0.0191, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
tensor(0.0236, device='cuda:0', dtype=torch.float16) tensor(0.0008, device='cuda:0', dtype=torch.float16)
0 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.4375, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
tensor(0.4287, device='cuda:0', dtype=torch.float16) tensor(0.0126, device='cuda:0', dtype=torch.float16)
tensor(0.4429, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.4419, device='cuda:0', dtype=torch.float16) tensor(0.0127, device='cuda:0', dtype=torch.float16)
tensor(0.0161, device='cuda:0')
old_score: tensor(0.0130, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0108, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.48298788070679
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.4014, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
tensor(0.3711, device='cuda:0', dtype=torch.float16) tensor(0.0103, device='cuda:0', dtype=torch.float16)
tensor(0.4141, device='cuda:0', dtype=torch.float16) tensor(0.0120, device='cuda:0', dtype=torch.float16)
tensor(0.3940, device='cuda:0', dtype=torch.float16) tensor(0.0107, device='cuda:0', dtype=torch.float16)
0 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.3979, device='cuda:0', dtype=torch.float16) tensor(0.0124, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0124, device='cuda:0', dtype=torch.float16)
tensor(0.4639, device='cuda:0', dtype=torch.float16) tensor(0.0138, device='cuda:0', dtype=torch.float16)
tensor(0.3906, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.0156, device='cuda:0')
old_score: tensor(0.0128, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0107, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.511534452438354
Validation after dual ascent:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.3750, device='cuda:0', dtype=torch.float16) tensor(0.0103, device='cuda:0', dtype=torch.float16)
tensor(0.3706, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.4570, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
tensor(0.3540, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
0 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0274, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0383, device='cuda:0', dtype=torch.float16) tensor(0.0017, device='cuda:0', dtype=torch.float16)
tensor(0.0349, device='cuda:0', dtype=torch.float16) tensor(0.0021, device='cuda:0', dtype=torch.float16)
tensor(0.0440, device='cuda:0', dtype=torch.float16) tensor(0.0017, device='cuda:0', dtype=torch.float16)
tensor(0.1048, device='cuda:0')
old_score: tensor(0.0018, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0016, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.28508925437927
Validation after dual ascent:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0283, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0356, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0345, device='cuda:0', dtype=torch.float16) tensor(0.0018, device='cuda:0', dtype=torch.float16)
tensor(0.0443, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
layer 0 done
1 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.4062, device='cuda:0', dtype=torch.float16) tensor(0.7939, device='cuda:0', dtype=torch.float16)
tensor(0.8203, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.8413, device='cuda:0', dtype=torch.float16) tensor(0.0195, device='cuda:0', dtype=torch.float16)
tensor(0.8198, device='cuda:0', dtype=torch.float16) tensor(0.0209, device='cuda:0', dtype=torch.float16)
tensor(0.8403, device='cuda:0', dtype=torch.float16) tensor(0.0192, device='cuda:0', dtype=torch.float16)
1 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.6914, device='cuda:0', dtype=torch.float16) tensor(0.7993, device='cuda:0', dtype=torch.float16)
tensor(0.7974, device='cuda:0', dtype=torch.float16) tensor(0.0197, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0204, device='cuda:0', dtype=torch.float16)
tensor(0.8691, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
tensor(0.7949, device='cuda:0', dtype=torch.float16) tensor(0.0201, device='cuda:0', dtype=torch.float16)
1 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(0.1658, device='cuda:0', dtype=torch.float16) tensor(0.0075, device='cuda:0', dtype=torch.float16)
tensor(0.1672, device='cuda:0', dtype=torch.float16) tensor(0.0076, device='cuda:0', dtype=torch.float16)
tensor(0.1772, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(0.1694, device='cuda:0', dtype=torch.float16) tensor(0.0076, device='cuda:0', dtype=torch.float16)
Converged at iteration 950
tensor(0.0173, device='cuda:0')
tensor(0.0264, device='cuda:0')
old_score: tensor(0.0077, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0065, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.386929512023926
Validation after dual ascent:
out_inf: tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(0.1296, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.1287, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.1721, device='cuda:0', dtype=torch.float16) tensor(0.0070, device='cuda:0', dtype=torch.float16)
tensor(0.1331, device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
1 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.5283, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
tensor(0.0588, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0411, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0562, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.0470, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0332, device='cuda:0')
old_score: tensor(0.0030, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0028, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.167972326278687
Validation after dual ascent:
out_inf: tensor(0.5283, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
tensor(0.0502, device='cuda:0', dtype=torch.float16) tensor(0.0028, device='cuda:0', dtype=torch.float16)
tensor(0.0435, device='cuda:0', dtype=torch.float16) tensor(0.0028, device='cuda:0', dtype=torch.float16)
tensor(0.0462, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0491, device='cuda:0', dtype=torch.float16) tensor(0.0027, device='cuda:0', dtype=torch.float16)
1 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(43.5312, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(0.8203, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
tensor(0.7930, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
tensor(0.7559, device='cuda:0', dtype=torch.float16) tensor(0.0311, device='cuda:0', dtype=torch.float16)
tensor(0.8320, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
tensor(0.0373, device='cuda:0')
old_score: tensor(0.0292, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0253, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.45206356048584
Validation after dual ascent:
out_inf: tensor(43.5312, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(0.5391, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
tensor(0.6299, device='cuda:0', dtype=torch.float16) tensor(0.0245, device='cuda:0', dtype=torch.float16)
tensor(0.7041, device='cuda:0', dtype=torch.float16) tensor(0.0271, device='cuda:0', dtype=torch.float16)
tensor(0.6621, device='cuda:0', dtype=torch.float16) tensor(0.0249, device='cuda:0', dtype=torch.float16)
1 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(37.6250, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.6797, device='cuda:0', dtype=torch.float16) tensor(0.0262, device='cuda:0', dtype=torch.float16)
tensor(0.6582, device='cuda:0', dtype=torch.float16) tensor(0.0262, device='cuda:0', dtype=torch.float16)
tensor(0.6621, device='cuda:0', dtype=torch.float16) tensor(0.0284, device='cuda:0', dtype=torch.float16)
tensor(0.7168, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.0314, device='cuda:0')
old_score: tensor(0.0267, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0234, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.548208475112915
Validation after dual ascent:
out_inf: tensor(37.6250, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.5195, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0226, device='cuda:0', dtype=torch.float16)
tensor(0.6089, device='cuda:0', dtype=torch.float16) tensor(0.0250, device='cuda:0', dtype=torch.float16)
tensor(0.6123, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
1 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2656., device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
tensor(0.1049, device='cuda:0', dtype=torch.float16) tensor(0.0066, device='cuda:0', dtype=torch.float16)
tensor(0.1250, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0074, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
tensor(0.3852, device='cuda:0')
old_score: tensor(0.0067, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0075, device='cuda:0', dtype=torch.float16)
Not converged!
Dual ascent finished!
Time: 100.1126320362091
Validation after dual ascent:
out_inf: tensor(2656., device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
tensor(0.1049, device='cuda:0', dtype=torch.float16) tensor(0.0066, device='cuda:0', dtype=torch.float16)
tensor(0.1250, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0074, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0064, device='cuda:0', dtype=torch.float16)
layer 1 done
2 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.6250, device='cuda:0', dtype=torch.float16) tensor(0.9512, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.0665, device='cuda:0', dtype=torch.float16)
tensor(1.0635, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
tensor(1.3896, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(0.9590, device='cuda:0', dtype=torch.float16) tensor(0.0672, device='cuda:0', dtype=torch.float16)
2 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.9531, device='cuda:0', dtype=torch.float16) tensor(1.1152, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(1.3262, device='cuda:0', dtype=torch.float16) tensor(0.0678, device='cuda:0', dtype=torch.float16)
tensor(1.9717, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(1.3359, device='cuda:0', dtype=torch.float16) tensor(0.0673, device='cuda:0', dtype=torch.float16)
2 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.7559, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(0.4375, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.3892, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.3855, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(0.4678, device='cuda:0', dtype=torch.float16) tensor(0.0383, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0166, device='cuda:0')
tensor(0.0479, device='cuda:0')
old_score: tensor(0.0390, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0345, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.224104166030884
Validation after dual ascent:
out_inf: tensor(2.7559, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(0.3628, device='cuda:0', dtype=torch.float16) tensor(0.0337, device='cuda:0', dtype=torch.float16)
tensor(0.4062, device='cuda:0', dtype=torch.float16) tensor(0.0333, device='cuda:0', dtype=torch.float16)
tensor(0.4036, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
tensor(0.3882, device='cuda:0', dtype=torch.float16) tensor(0.0339, device='cuda:0', dtype=torch.float16)
2 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(0.0537, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0575, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
tensor(0.0601, device='cuda:0', dtype=torch.float16) tensor(0.0027, device='cuda:0', dtype=torch.float16)
tensor(0.0537, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
tensor(0.0611, device='cuda:0')
old_score: tensor(0.0025, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0024, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.193141222000122
Validation after dual ascent:
out_inf: tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(0.0461, device='cuda:0', dtype=torch.float16) tensor(0.0022, device='cuda:0', dtype=torch.float16)
tensor(0.0526, device='cuda:0', dtype=torch.float16) tensor(0.0023, device='cuda:0', dtype=torch.float16)
tensor(0.0549, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
tensor(0.0497, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
2 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.1015, device='cuda:0', dtype=torch.float16)
tensor(0.4316, device='cuda:0', dtype=torch.float16) tensor(0.0404, device='cuda:0', dtype=torch.float16)
tensor(0.4487, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.4839, device='cuda:0', dtype=torch.float16) tensor(0.0445, device='cuda:0', dtype=torch.float16)
tensor(0.4893, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.0344, device='cuda:0')
old_score: tensor(0.0413, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0376, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.501837491989136
Validation after dual ascent:
out_inf: tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.1015, device='cuda:0', dtype=torch.float16)
tensor(0.4185, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.4424, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
tensor(0.4277, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.4639, device='cuda:0', dtype=torch.float16) tensor(0.0371, device='cuda:0', dtype=torch.float16)
2 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2715, device='cuda:0', dtype=torch.float16) tensor(0.0885, device='cuda:0', dtype=torch.float16)
tensor(0.4951, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.4590, device='cuda:0', dtype=torch.float16) tensor(0.0366, device='cuda:0', dtype=torch.float16)
tensor(0.4326, device='cuda:0', dtype=torch.float16) tensor(0.0408, device='cuda:0', dtype=torch.float16)
tensor(0.5552, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.0279, device='cuda:0')
old_score: tensor(0.0381, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0347, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.5287868976593
Validation after dual ascent:
out_inf: tensor(2.2715, device='cuda:0', dtype=torch.float16) tensor(0.0885, device='cuda:0', dtype=torch.float16)
tensor(0.4038, device='cuda:0', dtype=torch.float16) tensor(0.0340, device='cuda:0', dtype=torch.float16)
tensor(0.4497, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(0.3691, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.4941, device='cuda:0', dtype=torch.float16) tensor(0.0343, device='cuda:0', dtype=torch.float16)
2 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2266, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.0823, device='cuda:0', dtype=torch.float16) tensor(0.0062, device='cuda:0', dtype=torch.float16)
tensor(0.0882, device='cuda:0', dtype=torch.float16) tensor(0.0060, device='cuda:0', dtype=torch.float16)
tensor(0.0869, device='cuda:0', dtype=torch.float16) tensor(0.0075, device='cuda:0', dtype=torch.float16)
tensor(0.0878, device='cuda:0', dtype=torch.float16) tensor(0.0063, device='cuda:0', dtype=torch.float16)
tensor(0.1306, device='cuda:0')
old_score: tensor(0.0065, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0061, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.46051573753357
Validation after dual ascent:
out_inf: tensor(4.2266, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.0828, device='cuda:0', dtype=torch.float16) tensor(0.0058, device='cuda:0', dtype=torch.float16)
tensor(0.0870, device='cuda:0', dtype=torch.float16) tensor(0.0057, device='cuda:0', dtype=torch.float16)
tensor(0.0929, device='cuda:0', dtype=torch.float16) tensor(0.0071, device='cuda:0', dtype=torch.float16)
tensor(0.0853, device='cuda:0', dtype=torch.float16) tensor(0.0060, device='cuda:0', dtype=torch.float16)
layer 2 done
3 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.2969, device='cuda:0', dtype=torch.float16) tensor(0.8535, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(1.1543, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(1.1377, device='cuda:0', dtype=torch.float16) tensor(0.1265, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.1158, device='cuda:0', dtype=torch.float16)
tensor(0.0451, device='cuda:0')
old_score: tensor(0.1177, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1057, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.218249320983887
Validation after dual ascent:
out_inf: tensor(17.2969, device='cuda:0', dtype=torch.float16) tensor(0.8535, device='cuda:0', dtype=torch.float16)
tensor(1.3447, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.1019, device='cuda:0', dtype=torch.float16)
tensor(1.0771, device='cuda:0', dtype=torch.float16) tensor(0.1149, device='cuda:0', dtype=torch.float16)
tensor(1.1211, device='cuda:0', dtype=torch.float16) tensor(0.1040, device='cuda:0', dtype=torch.float16)
3 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.0938, device='cuda:0', dtype=torch.float16) tensor(1.0254, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.1163, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
tensor(1.1514, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(1.3350, device='cuda:0', dtype=torch.float16) tensor(0.1182, device='cuda:0', dtype=torch.float16)
tensor(0.0449, device='cuda:0')
old_score: tensor(0.1202, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1078, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.216408967971802
Validation after dual ascent:
out_inf: tensor(16.0938, device='cuda:0', dtype=torch.float16) tensor(1.0254, device='cuda:0', dtype=torch.float16)
tensor(1.5791, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
tensor(1.0400, device='cuda:0', dtype=torch.float16) tensor(0.1041, device='cuda:0', dtype=torch.float16)
tensor(1.1475, device='cuda:0', dtype=torch.float16) tensor(0.1171, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1059, device='cuda:0', dtype=torch.float16)
3 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.8027, device='cuda:0', dtype=torch.float16) tensor(0.1857, device='cuda:0', dtype=torch.float16)
tensor(0.6396, device='cuda:0', dtype=torch.float16) tensor(0.0641, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(0.5854, device='cuda:0', dtype=torch.float16) tensor(0.0708, device='cuda:0', dtype=torch.float16)
tensor(0.5542, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0066, device='cuda:0')
tensor(0.0518, device='cuda:0')
old_score: tensor(0.0660, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0601, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2381086349487305
Validation after dual ascent:
out_inf: tensor(2.8027, device='cuda:0', dtype=torch.float16) tensor(0.1857, device='cuda:0', dtype=torch.float16)
tensor(0.6387, device='cuda:0', dtype=torch.float16) tensor(0.0581, device='cuda:0', dtype=torch.float16)
tensor(0.5845, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.5640, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(0.5645, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
3 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.9907, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
tensor(0.0751, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.0756, device='cuda:0', dtype=torch.float16) tensor(0.0042, device='cuda:0', dtype=torch.float16)
tensor(0.0793, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0736, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(0.0568, device='cuda:0')
old_score: tensor(0.0038, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0035, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.153795957565308
Validation after dual ascent:
out_inf: tensor(0.9907, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
tensor(0.0685, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
tensor(0.0673, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0671, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
tensor(0.0753, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
3 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8242, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(0.6260, device='cuda:0', dtype=torch.float16) tensor(0.0520, device='cuda:0', dtype=torch.float16)
tensor(0.6904, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
tensor(0.5684, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.6826, device='cuda:0', dtype=torch.float16) tensor(0.0527, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0174, device='cuda:0')
tensor(0.0173, device='cuda:0')
old_score: tensor(0.0536, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0495, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 19.917579174041748
Validation after dual ascent:
out_inf: tensor(4.8242, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(0.6318, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.6670, device='cuda:0', dtype=torch.float16) tensor(0.0474, device='cuda:0', dtype=torch.float16)
tensor(0.5078, device='cuda:0', dtype=torch.float16) tensor(0.0539, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
3 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.3984, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(0.6504, device='cuda:0', dtype=torch.float16) tensor(0.0480, device='cuda:0', dtype=torch.float16)
tensor(0.5654, device='cuda:0', dtype=torch.float16) tensor(0.0478, device='cuda:0', dtype=torch.float16)
tensor(0.5068, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.6650, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0174, device='cuda:0')
tensor(0.0252, device='cuda:0')
old_score: tensor(0.0495, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0458, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.050337553024292
Validation after dual ascent:
out_inf: tensor(2.3984, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(0.6592, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.4658, device='cuda:0', dtype=torch.float16) tensor(0.0438, device='cuda:0', dtype=torch.float16)
tensor(0.4585, device='cuda:0', dtype=torch.float16) tensor(0.0499, device='cuda:0', dtype=torch.float16)
tensor(0.5986, device='cuda:0', dtype=torch.float16) tensor(0.0451, device='cuda:0', dtype=torch.float16)
3 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(0.0968, device='cuda:0', dtype=torch.float16) tensor(0.0094, device='cuda:0', dtype=torch.float16)
tensor(0.0925, device='cuda:0', dtype=torch.float16) tensor(0.0094, device='cuda:0', dtype=torch.float16)
tensor(0.0998, device='cuda:0', dtype=torch.float16) tensor(0.0105, device='cuda:0', dtype=torch.float16)
tensor(0.0927, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.1318, device='cuda:0')
old_score: tensor(0.0097, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0093, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.51756978034973
Validation after dual ascent:
out_inf: tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.0231, device='cuda:0', dtype=torch.float16)
tensor(0.0924, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
tensor(0.0914, device='cuda:0', dtype=torch.float16) tensor(0.0089, device='cuda:0', dtype=torch.float16)
tensor(0.0986, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.0935, device='cuda:0', dtype=torch.float16) tensor(0.0092, device='cuda:0', dtype=torch.float16)
layer 3 done
4 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.8125, device='cuda:0', dtype=torch.float16) tensor(0.8320, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.1193, device='cuda:0', dtype=torch.float16)
tensor(1.3730, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(1.3828, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(0.1291, device='cuda:0')
old_score: tensor(0.1235, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1107, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.191196203231812
Validation after dual ascent:
out_inf: tensor(13.8125, device='cuda:0', dtype=torch.float16) tensor(0.8320, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.1063, device='cuda:0', dtype=torch.float16)
tensor(1.1855, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
tensor(1.2861, device='cuda:0', dtype=torch.float16) tensor(0.1192, device='cuda:0', dtype=torch.float16)
tensor(1.0312, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
4 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.4219, device='cuda:0', dtype=torch.float16) tensor(1.0693, device='cuda:0', dtype=torch.float16)
tensor(1.6240, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1218, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(0.1123, device='cuda:0')
old_score: tensor(0.1237, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1107, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.191955089569092
Validation after dual ascent:
out_inf: tensor(19.4219, device='cuda:0', dtype=torch.float16) tensor(1.0693, device='cuda:0', dtype=torch.float16)
tensor(1.4746, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(1.3809, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.1191, device='cuda:0', dtype=torch.float16)
tensor(1.4346, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
4 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.3379, device='cuda:0', dtype=torch.float16) tensor(0.1965, device='cuda:0', dtype=torch.float16)
tensor(0.5820, device='cuda:0', dtype=torch.float16) tensor(0.0670, device='cuda:0', dtype=torch.float16)
tensor(0.5708, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.5522, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.6108, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0172, device='cuda:0')
tensor(0.0823, device='cuda:0')
old_score: tensor(0.0690, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0627, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2317073345184326
Validation after dual ascent:
out_inf: tensor(3.3379, device='cuda:0', dtype=torch.float16) tensor(0.1965, device='cuda:0', dtype=torch.float16)
tensor(0.5356, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.5674, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(0.5693, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.5845, device='cuda:0', dtype=torch.float16) tensor(0.0619, device='cuda:0', dtype=torch.float16)
4 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.9121, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
tensor(0.1158, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
tensor(0.1160, device='cuda:0', dtype=torch.float16) tensor(0.0087, device='cuda:0', dtype=torch.float16)
tensor(0.1144, device='cuda:0', dtype=torch.float16) tensor(0.0077, device='cuda:0', dtype=torch.float16)
tensor(0.1213, device='cuda:0', dtype=torch.float16) tensor(0.0086, device='cuda:0', dtype=torch.float16)
tensor(0.0438, device='cuda:0')
old_score: tensor(0.0083, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0077, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.18207836151123
Validation after dual ascent:
out_inf: tensor(3.9121, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
tensor(0.1068, device='cuda:0', dtype=torch.float16) tensor(0.0075, device='cuda:0', dtype=torch.float16)
tensor(0.1090, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
tensor(0.1072, device='cuda:0', dtype=torch.float16) tensor(0.0072, device='cuda:0', dtype=torch.float16)
tensor(0.1122, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
4 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7617, device='cuda:0', dtype=torch.float16) tensor(0.1799, device='cuda:0', dtype=torch.float16)
tensor(0.7764, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.8921, device='cuda:0', dtype=torch.float16) tensor(0.0627, device='cuda:0', dtype=torch.float16)
tensor(0.6182, device='cuda:0', dtype=torch.float16) tensor(0.0689, device='cuda:0', dtype=torch.float16)
tensor(0.7539, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0153, device='cuda:0')
tensor(0.0323, device='cuda:0')
old_score: tensor(0.0651, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0601, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.215885877609253
Validation after dual ascent:
out_inf: tensor(4.7617, device='cuda:0', dtype=torch.float16) tensor(0.1799, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
tensor(0.9033, device='cuda:0', dtype=torch.float16) tensor(0.0573, device='cuda:0', dtype=torch.float16)
tensor(0.5791, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.6797, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
4 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.1289, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(0.6445, device='cuda:0', dtype=torch.float16) tensor(0.0574, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.5967, device='cuda:0', dtype=torch.float16) tensor(0.0618, device='cuda:0', dtype=torch.float16)
tensor(0.7300, device='cuda:0', dtype=torch.float16) tensor(0.0581, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0105, device='cuda:0')
tensor(0.0283, device='cuda:0')
old_score: tensor(0.0584, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0540, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.216527700424194
Validation after dual ascent:
out_inf: tensor(3.1289, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(0.5908, device='cuda:0', dtype=torch.float16) tensor(0.0528, device='cuda:0', dtype=torch.float16)
tensor(0.6113, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.4932, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.7739, device='cuda:0', dtype=torch.float16) tensor(0.0537, device='cuda:0', dtype=torch.float16)
4 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.3438, device='cuda:0', dtype=torch.float16) tensor(0.0368, device='cuda:0', dtype=torch.float16)
tensor(0.1376, device='cuda:0', dtype=torch.float16) tensor(0.0153, device='cuda:0', dtype=torch.float16)
tensor(0.1329, device='cuda:0', dtype=torch.float16) tensor(0.0146, device='cuda:0', dtype=torch.float16)
tensor(0.1425, device='cuda:0', dtype=torch.float16) tensor(0.0155, device='cuda:0', dtype=torch.float16)
tensor(0.1539, device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0116, device='cuda:0')
tensor(0.0280, device='cuda:0')
old_score: tensor(0.0152, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0146, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 85.97478938102722
Validation after dual ascent:
out_inf: tensor(9.3438, device='cuda:0', dtype=torch.float16) tensor(0.0368, device='cuda:0', dtype=torch.float16)
tensor(0.1287, device='cuda:0', dtype=torch.float16) tensor(0.0146, device='cuda:0', dtype=torch.float16)
tensor(0.1355, device='cuda:0', dtype=torch.float16) tensor(0.0139, device='cuda:0', dtype=torch.float16)
tensor(0.1289, device='cuda:0', dtype=torch.float16) tensor(0.0149, device='cuda:0', dtype=torch.float16)
tensor(0.1349, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
layer 4 done
5 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.5703, device='cuda:0', dtype=torch.float16) tensor(0.8438, device='cuda:0', dtype=torch.float16)
tensor(1.0977, device='cuda:0', dtype=torch.float16) tensor(0.1243, device='cuda:0', dtype=torch.float16)
tensor(1.4961, device='cuda:0', dtype=torch.float16) tensor(0.1265, device='cuda:0', dtype=torch.float16)
tensor(1.3682, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
tensor(1.2334, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(0.0886, device='cuda:0')
old_score: tensor(0.1274, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1145, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.18922758102417
Validation after dual ascent:
out_inf: tensor(15.5703, device='cuda:0', dtype=torch.float16) tensor(0.8438, device='cuda:0', dtype=torch.float16)
tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(1.4814, device='cuda:0', dtype=torch.float16) tensor(0.1124, device='cuda:0', dtype=torch.float16)
tensor(1.2295, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
5 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.9844, device='cuda:0', dtype=torch.float16) tensor(1.1016, device='cuda:0', dtype=torch.float16)
tensor(1.1602, device='cuda:0', dtype=torch.float16) tensor(0.1274, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
tensor(1.1680, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
tensor(0.0940, device='cuda:0')
old_score: tensor(0.1305, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1169, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.222167730331421
Validation after dual ascent:
out_inf: tensor(18.9844, device='cuda:0', dtype=torch.float16) tensor(1.1016, device='cuda:0', dtype=torch.float16)
tensor(0.9922, device='cuda:0', dtype=torch.float16) tensor(0.1140, device='cuda:0', dtype=torch.float16)
tensor(1.0771, device='cuda:0', dtype=torch.float16) tensor(0.1149, device='cuda:0', dtype=torch.float16)
tensor(1.1191, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.1163, device='cuda:0', dtype=torch.float16)
5 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.4844, device='cuda:0', dtype=torch.float16) tensor(0.2026, device='cuda:0', dtype=torch.float16)
tensor(0.5996, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(0.5728, device='cuda:0', dtype=torch.float16) tensor(0.0708, device='cuda:0', dtype=torch.float16)
tensor(0.5596, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
tensor(0.5479, device='cuda:0', dtype=torch.float16) tensor(0.0711, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0151, device='cuda:0')
tensor(0.0823, device='cuda:0')
old_score: tensor(0.0715, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0652, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.238651752471924
Validation after dual ascent:
out_inf: tensor(2.4844, device='cuda:0', dtype=torch.float16) tensor(0.2026, device='cuda:0', dtype=torch.float16)
tensor(0.5596, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
tensor(0.5391, device='cuda:0', dtype=torch.float16) tensor(0.0638, device='cuda:0', dtype=torch.float16)
tensor(0.5503, device='cuda:0', dtype=torch.float16) tensor(0.0682, device='cuda:0', dtype=torch.float16)
tensor(0.5571, device='cuda:0', dtype=torch.float16) tensor(0.0649, device='cuda:0', dtype=torch.float16)
5 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.5410, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.1420, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.1658, device='cuda:0', dtype=torch.float16) tensor(0.0107, device='cuda:0', dtype=torch.float16)
tensor(0.1586, device='cuda:0', dtype=torch.float16) tensor(0.0104, device='cuda:0', dtype=torch.float16)
tensor(0.1285, device='cuda:0', dtype=torch.float16) tensor(0.0104, device='cuda:0', dtype=torch.float16)
tensor(0.0476, device='cuda:0')
old_score: tensor(0.0104, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0096, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.172682046890259
Validation after dual ascent:
out_inf: tensor(3.5410, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.1360, device='cuda:0', dtype=torch.float16) tensor(0.0093, device='cuda:0', dtype=torch.float16)
tensor(0.1467, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
tensor(0.1407, device='cuda:0', dtype=torch.float16) tensor(0.0095, device='cuda:0', dtype=torch.float16)
tensor(0.1229, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
5 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.4688, device='cuda:0', dtype=torch.float16) tensor(0.2089, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(0.7148, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
tensor(0.6118, device='cuda:0', dtype=torch.float16) tensor(0.0675, device='cuda:0', dtype=torch.float16)
tensor(0.8047, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0189, device='cuda:0')
tensor(0.0212, device='cuda:0')
old_score: tensor(0.0665, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0602, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.075961589813232
Validation after dual ascent:
out_inf: tensor(3.4688, device='cuda:0', dtype=torch.float16) tensor(0.2089, device='cuda:0', dtype=torch.float16)
tensor(0.6055, device='cuda:0', dtype=torch.float16) tensor(0.0596, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
tensor(0.5259, device='cuda:0', dtype=torch.float16) tensor(0.0617, device='cuda:0', dtype=torch.float16)
tensor(0.6455, device='cuda:0', dtype=torch.float16) tensor(0.0604, device='cuda:0', dtype=torch.float16)
5 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.9648, device='cuda:0', dtype=torch.float16) tensor(0.1547, device='cuda:0', dtype=torch.float16)
tensor(0.5781, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
tensor(0.6260, device='cuda:0', dtype=torch.float16) tensor(0.0602, device='cuda:0', dtype=torch.float16)
tensor(0.6621, device='cuda:0', dtype=torch.float16) tensor(0.0595, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0159, device='cuda:0')
tensor(0.0264, device='cuda:0')
old_score: tensor(0.0593, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0539, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.184751033782959
Validation after dual ascent:
out_inf: tensor(3.9648, device='cuda:0', dtype=torch.float16) tensor(0.1547, device='cuda:0', dtype=torch.float16)
tensor(0.6396, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.7842, device='cuda:0', dtype=torch.float16) tensor(0.0528, device='cuda:0', dtype=torch.float16)
tensor(0.5688, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
tensor(0.5278, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
5 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.7275, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.1564, device='cuda:0', dtype=torch.float16) tensor(0.0166, device='cuda:0', dtype=torch.float16)
tensor(0.1460, device='cuda:0', dtype=torch.float16) tensor(0.0165, device='cuda:0', dtype=torch.float16)
tensor(0.1411, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1663, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0110, device='cuda:0')
tensor(0.0268, device='cuda:0')
old_score: tensor(0.0164, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0157, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 85.72528672218323
Validation after dual ascent:
out_inf: tensor(1.7275, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.1447, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.1377, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1307, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.1592, device='cuda:0', dtype=torch.float16) tensor(0.0161, device='cuda:0', dtype=torch.float16)
layer 5 done
6 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.3750, device='cuda:0', dtype=torch.float16) tensor(0.8623, device='cuda:0', dtype=torch.float16)
tensor(1.1670, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
tensor(1.3135, device='cuda:0', dtype=torch.float16) tensor(0.1423, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
tensor(0.2356, device='cuda:0')
old_score: tensor(0.1417, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1248, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.202513217926025
Validation after dual ascent:
out_inf: tensor(15.3750, device='cuda:0', dtype=torch.float16) tensor(0.8623, device='cuda:0', dtype=torch.float16)
tensor(1.0762, device='cuda:0', dtype=torch.float16) tensor(0.1243, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.1243, device='cuda:0', dtype=torch.float16)
tensor(1.2959, device='cuda:0', dtype=torch.float16) tensor(0.1266, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1243, device='cuda:0', dtype=torch.float16)
6 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.6875, device='cuda:0', dtype=torch.float16) tensor(1.0498, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(1.4531, device='cuda:0', dtype=torch.float16) tensor(0.1433, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.1431, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1418, device='cuda:0', dtype=torch.float16)
tensor(0.2302, device='cuda:0')
old_score: tensor(0.1426, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1255, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.22058367729187
Validation after dual ascent:
out_inf: tensor(17.6875, device='cuda:0', dtype=torch.float16) tensor(1.0498, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.1251, device='cuda:0', dtype=torch.float16)
tensor(1.3135, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
tensor(1.0654, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1248, device='cuda:0', dtype=torch.float16)
6 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.3789, device='cuda:0', dtype=torch.float16) tensor(0.2510, device='cuda:0', dtype=torch.float16)
tensor(0.6670, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
tensor(0.6172, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0787, device='cuda:0', dtype=torch.float16)
tensor(0.0862, device='cuda:0')
old_score: tensor(0.0790, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0706, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.114112615585327
Validation after dual ascent:
out_inf: tensor(3.3789, device='cuda:0', dtype=torch.float16) tensor(0.2510, device='cuda:0', dtype=torch.float16)
tensor(0.6572, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.5493, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(0.6021, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.6729, device='cuda:0', dtype=torch.float16) tensor(0.0703, device='cuda:0', dtype=torch.float16)
6 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6602, device='cuda:0', dtype=torch.float16) tensor(0.0462, device='cuda:0', dtype=torch.float16)
tensor(0.1689, device='cuda:0', dtype=torch.float16) tensor(0.0130, device='cuda:0', dtype=torch.float16)
tensor(0.1766, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.1777, device='cuda:0', dtype=torch.float16) tensor(0.0153, device='cuda:0', dtype=torch.float16)
tensor(0.2263, device='cuda:0', dtype=torch.float16) tensor(0.0131, device='cuda:0', dtype=torch.float16)
tensor(0.0343, device='cuda:0')
old_score: tensor(0.0143, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0129, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.093750953674316
Validation after dual ascent:
out_inf: tensor(5.6602, device='cuda:0', dtype=torch.float16) tensor(0.0462, device='cuda:0', dtype=torch.float16)
tensor(0.1757, device='cuda:0', dtype=torch.float16) tensor(0.0117, device='cuda:0', dtype=torch.float16)
tensor(0.1569, device='cuda:0', dtype=torch.float16) tensor(0.0142, device='cuda:0', dtype=torch.float16)
tensor(0.1617, device='cuda:0', dtype=torch.float16) tensor(0.0138, device='cuda:0', dtype=torch.float16)
tensor(0.1497, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
6 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5312, device='cuda:0', dtype=torch.float16) tensor(0.2573, device='cuda:0', dtype=torch.float16)
tensor(0.8291, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(0.6455, device='cuda:0', dtype=torch.float16) tensor(0.0665, device='cuda:0', dtype=torch.float16)
tensor(0.6699, device='cuda:0', dtype=torch.float16) tensor(0.0684, device='cuda:0', dtype=torch.float16)
tensor(0.8115, device='cuda:0', dtype=torch.float16) tensor(0.0657, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0164, device='cuda:0')
tensor(0.0319, device='cuda:0')
old_score: tensor(0.0668, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0599, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.184082984924316
Validation after dual ascent:
out_inf: tensor(4.5312, device='cuda:0', dtype=torch.float16) tensor(0.2573, device='cuda:0', dtype=torch.float16)
tensor(0.7939, device='cuda:0', dtype=torch.float16) tensor(0.0601, device='cuda:0', dtype=torch.float16)
tensor(0.5537, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.5869, device='cuda:0', dtype=torch.float16) tensor(0.0617, device='cuda:0', dtype=torch.float16)
tensor(0.6904, device='cuda:0', dtype=torch.float16) tensor(0.0590, device='cuda:0', dtype=torch.float16)
6 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.9688, device='cuda:0', dtype=torch.float16) tensor(0.1648, device='cuda:0', dtype=torch.float16)
tensor(0.6172, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(0.6602, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.5781, device='cuda:0', dtype=torch.float16) tensor(0.0597, device='cuda:0', dtype=torch.float16)
tensor(0.6133, device='cuda:0', dtype=torch.float16) tensor(0.0573, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0122, device='cuda:0')
tensor(0.0254, device='cuda:0')
old_score: tensor(0.0583, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0525, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.175167083740234
Validation after dual ascent:
out_inf: tensor(2.9688, device='cuda:0', dtype=torch.float16) tensor(0.1648, device='cuda:0', dtype=torch.float16)
tensor(0.5879, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.5293, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.5371, device='cuda:0', dtype=torch.float16) tensor(0.0541, device='cuda:0', dtype=torch.float16)
tensor(0.5669, device='cuda:0', dtype=torch.float16) tensor(0.0517, device='cuda:0', dtype=torch.float16)
6 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.1611, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.1608, device='cuda:0', dtype=torch.float16) tensor(0.0167, device='cuda:0', dtype=torch.float16)
tensor(0.1665, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
tensor(0.1647, device='cuda:0', dtype=torch.float16) tensor(0.0162, device='cuda:0', dtype=torch.float16)
tensor(0.1964, device='cuda:0', dtype=torch.float16) tensor(0.0163, device='cuda:0', dtype=torch.float16)
Converged at iteration 900
tensor(0.0183, device='cuda:0')
tensor(0.0388, device='cuda:0')
old_score: tensor(0.0165, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0155, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 90.15198945999146
Validation after dual ascent:
out_inf: tensor(1.1611, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.1659, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1558, device='cuda:0', dtype=torch.float16) tensor(0.0157, device='cuda:0', dtype=torch.float16)
tensor(0.1646, device='cuda:0', dtype=torch.float16) tensor(0.0152, device='cuda:0', dtype=torch.float16)
tensor(0.1743, device='cuda:0', dtype=torch.float16) tensor(0.0152, device='cuda:0', dtype=torch.float16)
layer 6 done
7 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.2344, device='cuda:0', dtype=torch.float16) tensor(0.8574, device='cuda:0', dtype=torch.float16)
tensor(1.7012, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(2.2363, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
tensor(1.4482, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
tensor(1.1221, device='cuda:0', dtype=torch.float16) tensor(0.1417, device='cuda:0', dtype=torch.float16)
tensor(0.2938, device='cuda:0')
old_score: tensor(0.1434, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1248, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.171159505844116
Validation after dual ascent:
out_inf: tensor(19.2344, device='cuda:0', dtype=torch.float16) tensor(0.8574, device='cuda:0', dtype=torch.float16)
tensor(1.7480, device='cuda:0', dtype=torch.float16) tensor(0.1234, device='cuda:0', dtype=torch.float16)
tensor(2.3555, device='cuda:0', dtype=torch.float16) tensor(0.1237, device='cuda:0', dtype=torch.float16)
tensor(1.4561, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.1233, device='cuda:0', dtype=torch.float16)
7 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.4375, device='cuda:0', dtype=torch.float16) tensor(0.9980, device='cuda:0', dtype=torch.float16)
tensor(1.2080, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(1.5684, device='cuda:0', dtype=torch.float16) tensor(0.1464, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
tensor(0.2949, device='cuda:0')
old_score: tensor(0.1428, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1241, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.148416996002197
Validation after dual ascent:
out_inf: tensor(16.4375, device='cuda:0', dtype=torch.float16) tensor(0.9980, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1279, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
7 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.2524, device='cuda:0', dtype=torch.float16)
tensor(0.6465, device='cuda:0', dtype=torch.float16) tensor(0.0798, device='cuda:0', dtype=torch.float16)
tensor(0.6885, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
tensor(0.6626, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
tensor(0.6548, device='cuda:0', dtype=torch.float16) tensor(0.0794, device='cuda:0', dtype=torch.float16)
tensor(0.1207, device='cuda:0')
old_score: tensor(0.0804, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0710, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.089505195617676
Validation after dual ascent:
out_inf: tensor(4.6875, device='cuda:0', dtype=torch.float16) tensor(0.2524, device='cuda:0', dtype=torch.float16)
tensor(0.6133, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.6572, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
tensor(0.5977, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.5742, device='cuda:0', dtype=torch.float16) tensor(0.0702, device='cuda:0', dtype=torch.float16)
7 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.6055, device='cuda:0', dtype=torch.float16) tensor(0.0527, device='cuda:0', dtype=torch.float16)
tensor(0.1780, device='cuda:0', dtype=torch.float16) tensor(0.0167, device='cuda:0', dtype=torch.float16)
tensor(0.1748, device='cuda:0', dtype=torch.float16) tensor(0.0177, device='cuda:0', dtype=torch.float16)
tensor(0.2939, device='cuda:0', dtype=torch.float16) tensor(0.0206, device='cuda:0', dtype=torch.float16)
tensor(0.2014, device='cuda:0', dtype=torch.float16) tensor(0.0156, device='cuda:0', dtype=torch.float16)
tensor(0.0314, device='cuda:0')
old_score: tensor(0.0177, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0159, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.06182861328125
Validation after dual ascent:
out_inf: tensor(3.6055, device='cuda:0', dtype=torch.float16) tensor(0.0527, device='cuda:0', dtype=torch.float16)
tensor(0.1631, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.1604, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.2466, device='cuda:0', dtype=torch.float16) tensor(0.0185, device='cuda:0', dtype=torch.float16)
tensor(0.1627, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
7 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6367, device='cuda:0', dtype=torch.float16) tensor(0.2942, device='cuda:0', dtype=torch.float16)
tensor(0.9121, device='cuda:0', dtype=torch.float16) tensor(0.0713, device='cuda:0', dtype=torch.float16)
tensor(0.7871, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.7402, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0099, device='cuda:0')
tensor(0.0393, device='cuda:0')
old_score: tensor(0.0718, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0636, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.18572735786438
Validation after dual ascent:
out_inf: tensor(5.6367, device='cuda:0', dtype=torch.float16) tensor(0.2942, device='cuda:0', dtype=torch.float16)
tensor(0.7676, device='cuda:0', dtype=torch.float16) tensor(0.0633, device='cuda:0', dtype=torch.float16)
tensor(0.7402, device='cuda:0', dtype=torch.float16) tensor(0.0631, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
tensor(0.7021, device='cuda:0', dtype=torch.float16) tensor(0.0630, device='cuda:0', dtype=torch.float16)
7 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5859, device='cuda:0', dtype=torch.float16) tensor(0.1802, device='cuda:0', dtype=torch.float16)
tensor(0.7852, device='cuda:0', dtype=torch.float16) tensor(0.0626, device='cuda:0', dtype=torch.float16)
tensor(0.9492, device='cuda:0', dtype=torch.float16) tensor(0.0630, device='cuda:0', dtype=torch.float16)
tensor(0.6245, device='cuda:0', dtype=torch.float16) tensor(0.0642, device='cuda:0', dtype=torch.float16)
tensor(0.7559, device='cuda:0', dtype=torch.float16) tensor(0.0623, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0052, device='cuda:0')
tensor(0.0302, device='cuda:0')
old_score: tensor(0.0630, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0560, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.182890892028809
Validation after dual ascent:
out_inf: tensor(4.5859, device='cuda:0', dtype=torch.float16) tensor(0.1802, device='cuda:0', dtype=torch.float16)
tensor(0.5781, device='cuda:0', dtype=torch.float16) tensor(0.0558, device='cuda:0', dtype=torch.float16)
tensor(0.6543, device='cuda:0', dtype=torch.float16) tensor(0.0556, device='cuda:0', dtype=torch.float16)
tensor(0.6094, device='cuda:0', dtype=torch.float16) tensor(0.0572, device='cuda:0', dtype=torch.float16)
tensor(0.6729, device='cuda:0', dtype=torch.float16) tensor(0.0556, device='cuda:0', dtype=torch.float16)
7 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.4102, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.1903, device='cuda:0', dtype=torch.float16) tensor(0.0197, device='cuda:0', dtype=torch.float16)
tensor(0.1858, device='cuda:0', dtype=torch.float16) tensor(0.0196, device='cuda:0', dtype=torch.float16)
tensor(0.2003, device='cuda:0', dtype=torch.float16) tensor(0.0194, device='cuda:0', dtype=torch.float16)
tensor(0.2134, device='cuda:0', dtype=torch.float16) tensor(0.0192, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0072, device='cuda:0')
tensor(0.0176, device='cuda:0')
old_score: tensor(0.0195, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0182, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 85.36334609985352
Validation after dual ascent:
out_inf: tensor(1.4102, device='cuda:0', dtype=torch.float16) tensor(0.0579, device='cuda:0', dtype=torch.float16)
tensor(0.1974, device='cuda:0', dtype=torch.float16) tensor(0.0184, device='cuda:0', dtype=torch.float16)
tensor(0.1852, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.2063, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.2002, device='cuda:0', dtype=torch.float16) tensor(0.0179, device='cuda:0', dtype=torch.float16)
layer 7 done
8 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.6094, device='cuda:0', dtype=torch.float16) tensor(0.8115, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1469, device='cuda:0', dtype=torch.float16)
tensor(1.6592, device='cuda:0', dtype=torch.float16) tensor(0.1497, device='cuda:0', dtype=torch.float16)
tensor(1.8633, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
tensor(1.4785, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0146, device='cuda:0')
tensor(0.0700, device='cuda:0')
old_score: tensor(0.1483, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1292, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.22822117805481
Validation after dual ascent:
out_inf: tensor(20.6094, device='cuda:0', dtype=torch.float16) tensor(0.8115, device='cuda:0', dtype=torch.float16)
tensor(0.9961, device='cuda:0', dtype=torch.float16) tensor(0.1283, device='cuda:0', dtype=torch.float16)
tensor(1.4668, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
tensor(1.4824, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
tensor(1.0312, device='cuda:0', dtype=torch.float16) tensor(0.1273, device='cuda:0', dtype=torch.float16)
8 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.4375, device='cuda:0', dtype=torch.float16) tensor(1.0225, device='cuda:0', dtype=torch.float16)
tensor(1.3994, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
tensor(1.2754, device='cuda:0', dtype=torch.float16) tensor(0.1493, device='cuda:0', dtype=torch.float16)
tensor(2.0195, device='cuda:0', dtype=torch.float16) tensor(0.1503, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.1458, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0175, device='cuda:0')
tensor(0.0729, device='cuda:0')
old_score: tensor(0.1482, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1288, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.234703540802002
Validation after dual ascent:
out_inf: tensor(17.4375, device='cuda:0', dtype=torch.float16) tensor(1.0225, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(1.0703, device='cuda:0', dtype=torch.float16) tensor(0.1289, device='cuda:0', dtype=torch.float16)
tensor(1.5215, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1271, device='cuda:0', dtype=torch.float16)
8 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8320, device='cuda:0', dtype=torch.float16) tensor(0.2700, device='cuda:0', dtype=torch.float16)
tensor(0.7485, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
tensor(0.7471, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
tensor(0.6929, device='cuda:0', dtype=torch.float16) tensor(0.0869, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0155, device='cuda:0')
tensor(0.1159, device='cuda:0')
old_score: tensor(0.0855, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0754, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4909145832061768
Validation after dual ascent:
out_inf: tensor(4.8320, device='cuda:0', dtype=torch.float16) tensor(0.2700, device='cuda:0', dtype=torch.float16)
tensor(0.6436, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
tensor(0.6431, device='cuda:0', dtype=torch.float16) tensor(0.0753, device='cuda:0', dtype=torch.float16)
tensor(0.6313, device='cuda:0', dtype=torch.float16) tensor(0.0768, device='cuda:0', dtype=torch.float16)
tensor(0.5923, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
8 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7812, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(0.2144, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
tensor(0.2350, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
tensor(0.2251, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
tensor(0.2051, device='cuda:0', dtype=torch.float16) tensor(0.0207, device='cuda:0', dtype=torch.float16)
tensor(0.0168, device='cuda:0')
old_score: tensor(0.0229, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0204, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.064908742904663
Validation after dual ascent:
out_inf: tensor(4.7812, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
tensor(0.2170, device='cuda:0', dtype=torch.float16) tensor(0.0193, device='cuda:0', dtype=torch.float16)
tensor(0.2070, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
tensor(0.2064, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.2019, device='cuda:0', dtype=torch.float16) tensor(0.0185, device='cuda:0', dtype=torch.float16)
8 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1445, device='cuda:0', dtype=torch.float16) tensor(0.2944, device='cuda:0', dtype=torch.float16)
tensor(0.7461, device='cuda:0', dtype=torch.float16) tensor(0.0751, device='cuda:0', dtype=torch.float16)
tensor(0.8223, device='cuda:0', dtype=torch.float16) tensor(0.0759, device='cuda:0', dtype=torch.float16)
tensor(0.7969, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.8730, device='cuda:0', dtype=torch.float16) tensor(0.0736, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0100, device='cuda:0')
tensor(0.0461, device='cuda:0')
old_score: tensor(0.0748, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0662, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.175508975982666
Validation after dual ascent:
out_inf: tensor(7.1445, device='cuda:0', dtype=torch.float16) tensor(0.2944, device='cuda:0', dtype=torch.float16)
tensor(0.7031, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(0.7930, device='cuda:0', dtype=torch.float16) tensor(0.0668, device='cuda:0', dtype=torch.float16)
tensor(0.6543, device='cuda:0', dtype=torch.float16) tensor(0.0657, device='cuda:0', dtype=torch.float16)
tensor(0.7207, device='cuda:0', dtype=torch.float16) tensor(0.0653, device='cuda:0', dtype=torch.float16)
8 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4883, device='cuda:0', dtype=torch.float16) tensor(0.1962, device='cuda:0', dtype=torch.float16)
tensor(0.6846, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0687, device='cuda:0', dtype=torch.float16)
tensor(0.7686, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
tensor(0.7363, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0059, device='cuda:0')
tensor(0.0361, device='cuda:0')
old_score: tensor(0.0677, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0601, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.1903533935546875
Validation after dual ascent:
out_inf: tensor(6.4883, device='cuda:0', dtype=torch.float16) tensor(0.1962, device='cuda:0', dtype=torch.float16)
tensor(0.7246, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
tensor(0.6289, device='cuda:0', dtype=torch.float16) tensor(0.0607, device='cuda:0', dtype=torch.float16)
tensor(0.6914, device='cuda:0', dtype=torch.float16) tensor(0.0597, device='cuda:0', dtype=torch.float16)
tensor(0.6797, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
8 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.4629, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
tensor(0.2435, device='cuda:0', dtype=torch.float16) tensor(0.0232, device='cuda:0', dtype=torch.float16)
tensor(0.2075, device='cuda:0', dtype=torch.float16) tensor(0.0230, device='cuda:0', dtype=torch.float16)
tensor(0.2242, device='cuda:0', dtype=torch.float16) tensor(0.0221, device='cuda:0', dtype=torch.float16)
tensor(0.2295, device='cuda:0', dtype=torch.float16) tensor(0.0222, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0090, device='cuda:0')
tensor(0.0173, device='cuda:0')
old_score: tensor(0.0226, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0213, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 65.79769110679626
Validation after dual ascent:
out_inf: tensor(2.4629, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
tensor(0.2474, device='cuda:0', dtype=torch.float16) tensor(0.0219, device='cuda:0', dtype=torch.float16)
tensor(0.2124, device='cuda:0', dtype=torch.float16) tensor(0.0216, device='cuda:0', dtype=torch.float16)
tensor(0.2257, device='cuda:0', dtype=torch.float16) tensor(0.0207, device='cuda:0', dtype=torch.float16)
tensor(0.2220, device='cuda:0', dtype=torch.float16) tensor(0.0209, device='cuda:0', dtype=torch.float16)
layer 8 done
9 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.6016, device='cuda:0', dtype=torch.float16) tensor(0.8130, device='cuda:0', dtype=torch.float16)
tensor(1.2412, device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(1.6191, device='cuda:0', dtype=torch.float16) tensor(0.1609, device='cuda:0', dtype=torch.float16)
tensor(1.5293, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(0.1835, device='cuda:0')
old_score: tensor(0.1589, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.161150455474854
Validation after dual ascent:
out_inf: tensor(14.6016, device='cuda:0', dtype=torch.float16) tensor(0.8130, device='cuda:0', dtype=torch.float16)
tensor(1.2178, device='cuda:0', dtype=torch.float16) tensor(0.1384, device='cuda:0', dtype=torch.float16)
tensor(1.2549, device='cuda:0', dtype=torch.float16) tensor(0.1405, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(1.3311, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
9 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.1406, device='cuda:0', dtype=torch.float16) tensor(1.0479, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(2.1172, device='cuda:0', dtype=torch.float16) tensor(0.1628, device='cuda:0', dtype=torch.float16)
tensor(1.5576, device='cuda:0', dtype=torch.float16) tensor(0.1611, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
tensor(0.1790, device='cuda:0')
old_score: tensor(0.1598, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1393, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.146550416946411
Validation after dual ascent:
out_inf: tensor(18.1406, device='cuda:0', dtype=torch.float16) tensor(1.0479, device='cuda:0', dtype=torch.float16)
tensor(1.1748, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
tensor(1.8418, device='cuda:0', dtype=torch.float16) tensor(0.1414, device='cuda:0', dtype=torch.float16)
tensor(1.2510, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1364, device='cuda:0', dtype=torch.float16)
9 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.6953, device='cuda:0', dtype=torch.float16) tensor(0.2764, device='cuda:0', dtype=torch.float16)
tensor(0.7275, device='cuda:0', dtype=torch.float16) tensor(0.0908, device='cuda:0', dtype=torch.float16)
tensor(0.7983, device='cuda:0', dtype=torch.float16) tensor(0.0920, device='cuda:0', dtype=torch.float16)
tensor(0.6904, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
tensor(0.7222, device='cuda:0', dtype=torch.float16) tensor(0.0888, device='cuda:0', dtype=torch.float16)
tensor(0.0855, device='cuda:0')
old_score: tensor(0.0908, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0801, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.09927773475647
Validation after dual ascent:
out_inf: tensor(6.6953, device='cuda:0', dtype=torch.float16) tensor(0.2764, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
tensor(0.7021, device='cuda:0', dtype=torch.float16) tensor(0.0811, device='cuda:0', dtype=torch.float16)
tensor(0.6772, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
tensor(0.6392, device='cuda:0', dtype=torch.float16) tensor(0.0786, device='cuda:0', dtype=torch.float16)
9 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9609, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(0.2302, device='cuda:0', dtype=torch.float16) tensor(0.0227, device='cuda:0', dtype=torch.float16)
tensor(0.2495, device='cuda:0', dtype=torch.float16) tensor(0.0244, device='cuda:0', dtype=torch.float16)
tensor(0.2402, device='cuda:0', dtype=torch.float16) tensor(0.0260, device='cuda:0', dtype=torch.float16)
tensor(0.2159, device='cuda:0', dtype=torch.float16) tensor(0.0209, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0150, device='cuda:0')
tensor(0.0309, device='cuda:0')
old_score: tensor(0.0235, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0210, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.392839431762695
Validation after dual ascent:
out_inf: tensor(4.9609, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(0.2224, device='cuda:0', dtype=torch.float16) tensor(0.0204, device='cuda:0', dtype=torch.float16)
tensor(0.2244, device='cuda:0', dtype=torch.float16) tensor(0.0218, device='cuda:0', dtype=torch.float16)
tensor(0.2263, device='cuda:0', dtype=torch.float16) tensor(0.0232, device='cuda:0', dtype=torch.float16)
tensor(0.1910, device='cuda:0', dtype=torch.float16) tensor(0.0187, device='cuda:0', dtype=torch.float16)
9 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8320, device='cuda:0', dtype=torch.float16) tensor(0.2952, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0780, device='cuda:0', dtype=torch.float16)
tensor(0.7793, device='cuda:0', dtype=torch.float16) tensor(0.0778, device='cuda:0', dtype=torch.float16)
tensor(0.9863, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.8438, device='cuda:0', dtype=torch.float16) tensor(0.0747, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0095, device='cuda:0')
tensor(0.0516, device='cuda:0')
old_score: tensor(0.0770, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0686, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.1950156688690186
Validation after dual ascent:
out_inf: tensor(7.8320, device='cuda:0', dtype=torch.float16) tensor(0.2952, device='cuda:0', dtype=torch.float16)
tensor(0.7109, device='cuda:0', dtype=torch.float16) tensor(0.0698, device='cuda:0', dtype=torch.float16)
tensor(0.7231, device='cuda:0', dtype=torch.float16) tensor(0.0691, device='cuda:0', dtype=torch.float16)
tensor(0.7939, device='cuda:0', dtype=torch.float16) tensor(0.0689, device='cuda:0', dtype=torch.float16)
tensor(0.8643, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
9 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8398, device='cuda:0', dtype=torch.float16) tensor(0.2040, device='cuda:0', dtype=torch.float16)
tensor(0.7266, device='cuda:0', dtype=torch.float16) tensor(0.0720, device='cuda:0', dtype=torch.float16)
tensor(0.6680, device='cuda:0', dtype=torch.float16) tensor(0.0719, device='cuda:0', dtype=torch.float16)
tensor(0.7715, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0689, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0059, device='cuda:0')
tensor(0.0416, device='cuda:0')
old_score: tensor(0.0711, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0635, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.190361499786377
Validation after dual ascent:
out_inf: tensor(4.8398, device='cuda:0', dtype=torch.float16) tensor(0.2040, device='cuda:0', dtype=torch.float16)
tensor(0.6748, device='cuda:0', dtype=torch.float16) tensor(0.0647, device='cuda:0', dtype=torch.float16)
tensor(0.5684, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.6318, device='cuda:0', dtype=torch.float16) tensor(0.0638, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0617, device='cuda:0', dtype=torch.float16)
9 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.7490, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.2581, device='cuda:0', dtype=torch.float16) tensor(0.0256, device='cuda:0', dtype=torch.float16)
tensor(0.2607, device='cuda:0', dtype=torch.float16) tensor(0.0250, device='cuda:0', dtype=torch.float16)
tensor(0.2639, device='cuda:0', dtype=torch.float16) tensor(0.0243, device='cuda:0', dtype=torch.float16)
tensor(0.2656, device='cuda:0', dtype=torch.float16) tensor(0.0235, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0168, device='cuda:0')
tensor(0.0383, device='cuda:0')
old_score: tensor(0.0246, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0232, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.39864468574524
Validation after dual ascent:
out_inf: tensor(1.7490, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.2388, device='cuda:0', dtype=torch.float16) tensor(0.0242, device='cuda:0', dtype=torch.float16)
tensor(0.2502, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(0.2563, device='cuda:0', dtype=torch.float16) tensor(0.0230, device='cuda:0', dtype=torch.float16)
tensor(0.2605, device='cuda:0', dtype=torch.float16) tensor(0.0222, device='cuda:0', dtype=torch.float16)
layer 9 done
10 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.2969, device='cuda:0', dtype=torch.float16) tensor(0.7974, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.1625, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1643, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1664, device='cuda:0', dtype=torch.float16)
tensor(1.9668, device='cuda:0', dtype=torch.float16) tensor(0.1576, device='cuda:0', dtype=torch.float16)
tensor(0.3576, device='cuda:0')
old_score: tensor(0.1627, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1428, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.158968210220337
Validation after dual ascent:
out_inf: tensor(14.2969, device='cuda:0', dtype=torch.float16) tensor(0.7974, device='cuda:0', dtype=torch.float16)
tensor(1.3730, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(1.4170, device='cuda:0', dtype=torch.float16) tensor(0.1459, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1382, device='cuda:0', dtype=torch.float16)
10 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.1094, device='cuda:0', dtype=torch.float16) tensor(1.0566, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1635, device='cuda:0', dtype=torch.float16)
tensor(1.6445, device='cuda:0', dtype=torch.float16) tensor(0.1646, device='cuda:0', dtype=torch.float16)
tensor(1.5176, device='cuda:0', dtype=torch.float16) tensor(0.1665, device='cuda:0', dtype=torch.float16)
tensor(1.3018, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(0.3536, device='cuda:0')
old_score: tensor(0.1632, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1432, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.148468732833862
Validation after dual ascent:
out_inf: tensor(17.1094, device='cuda:0', dtype=torch.float16) tensor(1.0566, device='cuda:0', dtype=torch.float16)
tensor(1.2793, device='cuda:0', dtype=torch.float16) tensor(0.1443, device='cuda:0', dtype=torch.float16)
tensor(1.5576, device='cuda:0', dtype=torch.float16) tensor(0.1439, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1461, device='cuda:0', dtype=torch.float16)
tensor(1.2168, device='cuda:0', dtype=torch.float16) tensor(0.1387, device='cuda:0', dtype=torch.float16)
10 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.0664, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(0.8271, device='cuda:0', dtype=torch.float16) tensor(0.0932, device='cuda:0', dtype=torch.float16)
tensor(0.8003, device='cuda:0', dtype=torch.float16) tensor(0.0929, device='cuda:0', dtype=torch.float16)
tensor(0.7354, device='cuda:0', dtype=torch.float16) tensor(0.0943, device='cuda:0', dtype=torch.float16)
tensor(0.7290, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(0.1548, device='cuda:0')
old_score: tensor(0.0925, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0822, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.111960172653198
Validation after dual ascent:
out_inf: tensor(7.0664, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(0.7637, device='cuda:0', dtype=torch.float16) tensor(0.0832, device='cuda:0', dtype=torch.float16)
tensor(0.7173, device='cuda:0', dtype=torch.float16) tensor(0.0824, device='cuda:0', dtype=torch.float16)
tensor(0.7505, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.6606, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
10 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.3945, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
tensor(0.2864, device='cuda:0', dtype=torch.float16) tensor(0.0272, device='cuda:0', dtype=torch.float16)
tensor(0.2571, device='cuda:0', dtype=torch.float16) tensor(0.0281, device='cuda:0', dtype=torch.float16)
tensor(0.3115, device='cuda:0', dtype=torch.float16) tensor(0.0325, device='cuda:0', dtype=torch.float16)
tensor(0.2620, device='cuda:0', dtype=torch.float16) tensor(0.0248, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0134, device='cuda:0')
tensor(0.0273, device='cuda:0')
old_score: tensor(0.0282, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0253, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.68932580947876
Validation after dual ascent:
out_inf: tensor(6.3945, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
tensor(0.2839, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.2321, device='cuda:0', dtype=torch.float16) tensor(0.0253, device='cuda:0', dtype=torch.float16)
tensor(0.2859, device='cuda:0', dtype=torch.float16) tensor(0.0290, device='cuda:0', dtype=torch.float16)
tensor(0.2542, device='cuda:0', dtype=torch.float16) tensor(0.0224, device='cuda:0', dtype=torch.float16)
10 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9609, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(1.2559, device='cuda:0', dtype=torch.float16) tensor(0.0796, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.0776, device='cuda:0', dtype=torch.float16)
tensor(0.8838, device='cuda:0', dtype=torch.float16) tensor(0.0808, device='cuda:0', dtype=torch.float16)
tensor(0.8682, device='cuda:0', dtype=torch.float16) tensor(0.0755, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0097, device='cuda:0')
tensor(0.0573, device='cuda:0')
old_score: tensor(0.0784, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0700, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.20356011390686
Validation after dual ascent:
out_inf: tensor(5.9609, device='cuda:0', dtype=torch.float16) tensor(0.3076, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.7480, device='cuda:0', dtype=torch.float16) tensor(0.0692, device='cuda:0', dtype=torch.float16)
tensor(0.7949, device='cuda:0', dtype=torch.float16) tensor(0.0721, device='cuda:0', dtype=torch.float16)
tensor(0.7480, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
10 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5312, device='cuda:0', dtype=torch.float16) tensor(0.2157, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0748, device='cuda:0', dtype=torch.float16)
tensor(0.6934, device='cuda:0', dtype=torch.float16) tensor(0.0730, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
tensor(0.7441, device='cuda:0', dtype=torch.float16) tensor(0.0711, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0062, device='cuda:0')
tensor(0.0449, device='cuda:0')
old_score: tensor(0.0737, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0661, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.20373797416687
Validation after dual ascent:
out_inf: tensor(4.5312, device='cuda:0', dtype=torch.float16) tensor(0.2157, device='cuda:0', dtype=torch.float16)
tensor(0.7998, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
tensor(0.5635, device='cuda:0', dtype=torch.float16) tensor(0.0652, device='cuda:0', dtype=torch.float16)
tensor(0.7305, device='cuda:0', dtype=torch.float16) tensor(0.0680, device='cuda:0', dtype=torch.float16)
tensor(0.6230, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
10 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2891, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
tensor(0.2827, device='cuda:0', dtype=torch.float16) tensor(0.0279, device='cuda:0', dtype=torch.float16)
tensor(0.2656, device='cuda:0', dtype=torch.float16) tensor(0.0259, device='cuda:0', dtype=torch.float16)
tensor(0.3438, device='cuda:0', dtype=torch.float16) tensor(0.0274, device='cuda:0', dtype=torch.float16)
tensor(0.3176, device='cuda:0', dtype=torch.float16) tensor(0.0254, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0144, device='cuda:0')
tensor(0.0256, device='cuda:0')
old_score: tensor(0.0266, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0252, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.45245409011841
Validation after dual ascent:
out_inf: tensor(2.2891, device='cuda:0', dtype=torch.float16) tensor(0.0735, device='cuda:0', dtype=torch.float16)
tensor(0.2666, device='cuda:0', dtype=torch.float16) tensor(0.0264, device='cuda:0', dtype=torch.float16)
tensor(0.2423, device='cuda:0', dtype=torch.float16) tensor(0.0244, device='cuda:0', dtype=torch.float16)
tensor(0.3232, device='cuda:0', dtype=torch.float16) tensor(0.0259, device='cuda:0', dtype=torch.float16)
tensor(0.2898, device='cuda:0', dtype=torch.float16) tensor(0.0239, device='cuda:0', dtype=torch.float16)
layer 10 done
11 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.8125, device='cuda:0', dtype=torch.float16) tensor(0.8057, device='cuda:0', dtype=torch.float16)
tensor(3.1133, device='cuda:0', dtype=torch.float16) tensor(0.1678, device='cuda:0', dtype=torch.float16)
tensor(1.7793, device='cuda:0', dtype=torch.float16) tensor(0.1666, device='cuda:0', dtype=torch.float16)
tensor(1.4316, device='cuda:0', dtype=torch.float16) tensor(0.1719, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.1611, device='cuda:0', dtype=torch.float16)
tensor(0.1484, device='cuda:0')
old_score: tensor(0.1669, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1475, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.225048303604126
Validation after dual ascent:
out_inf: tensor(19.8125, device='cuda:0', dtype=torch.float16) tensor(0.8057, device='cuda:0', dtype=torch.float16)
tensor(2.8047, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
tensor(1.7871, device='cuda:0', dtype=torch.float16) tensor(0.1467, device='cuda:0', dtype=torch.float16)
tensor(1.3506, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(1.1768, device='cuda:0', dtype=torch.float16) tensor(0.1420, device='cuda:0', dtype=torch.float16)
11 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.3750, device='cuda:0', dtype=torch.float16) tensor(1.0391, device='cuda:0', dtype=torch.float16)
tensor(1.3594, device='cuda:0', dtype=torch.float16) tensor(0.1671, device='cuda:0', dtype=torch.float16)
tensor(1.2852, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(1.3320, device='cuda:0', dtype=torch.float16) tensor(0.1699, device='cuda:0', dtype=torch.float16)
tensor(1.3916, device='cuda:0', dtype=torch.float16) tensor(0.1597, device='cuda:0', dtype=torch.float16)
tensor(0.1401, device='cuda:0')
old_score: tensor(0.1655, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1458, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.248295307159424
Validation after dual ascent:
out_inf: tensor(15.3750, device='cuda:0', dtype=torch.float16) tensor(1.0391, device='cuda:0', dtype=torch.float16)
tensor(1.2168, device='cuda:0', dtype=torch.float16) tensor(0.1479, device='cuda:0', dtype=torch.float16)
tensor(1.2627, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.1895, device='cuda:0', dtype=torch.float16) tensor(0.1498, device='cuda:0', dtype=torch.float16)
tensor(1.1582, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
11 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.9531, device='cuda:0', dtype=torch.float16) tensor(0.3208, device='cuda:0', dtype=torch.float16)
tensor(0.8447, device='cuda:0', dtype=torch.float16) tensor(0.1104, device='cuda:0', dtype=torch.float16)
tensor(0.8438, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(0.8726, device='cuda:0', dtype=torch.float16) tensor(0.1113, device='cuda:0', dtype=torch.float16)
tensor(0.7969, device='cuda:0', dtype=torch.float16) tensor(0.1052, device='cuda:0', dtype=torch.float16)
tensor(0.0795, device='cuda:0')
old_score: tensor(0.1088, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0968, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.217617511749268
Validation after dual ascent:
out_inf: tensor(7.9531, device='cuda:0', dtype=torch.float16) tensor(0.3208, device='cuda:0', dtype=torch.float16)
tensor(0.8267, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
tensor(0.8145, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(0.7998, device='cuda:0', dtype=torch.float16) tensor(0.0933, device='cuda:0', dtype=torch.float16)
11 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4883, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(0.3105, device='cuda:0', dtype=torch.float16) tensor(0.0306, device='cuda:0', dtype=torch.float16)
tensor(0.3196, device='cuda:0', dtype=torch.float16) tensor(0.0328, device='cuda:0', dtype=torch.float16)
tensor(0.4177, device='cuda:0', dtype=torch.float16) tensor(0.0397, device='cuda:0', dtype=torch.float16)
tensor(0.3857, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0123, device='cuda:0')
tensor(0.0179, device='cuda:0')
old_score: tensor(0.0323, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0294, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.980956077575684
Validation after dual ascent:
out_inf: tensor(5.4883, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(0.3052, device='cuda:0', dtype=torch.float16) tensor(0.0278, device='cuda:0', dtype=torch.float16)
tensor(0.3083, device='cuda:0', dtype=torch.float16) tensor(0.0298, device='cuda:0', dtype=torch.float16)
tensor(0.4167, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(0.3235, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
11 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.9961, device='cuda:0', dtype=torch.float16) tensor(0.3254, device='cuda:0', dtype=torch.float16)
tensor(0.9629, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(0.8535, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(1.3906, device='cuda:0', dtype=torch.float16) tensor(0.0811, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0108, device='cuda:0')
tensor(0.0737, device='cuda:0')
old_score: tensor(0.0846, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0759, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.239249229431152
Validation after dual ascent:
out_inf: tensor(6.9961, device='cuda:0', dtype=torch.float16) tensor(0.3254, device='cuda:0', dtype=torch.float16)
tensor(0.8428, device='cuda:0', dtype=torch.float16) tensor(0.0773, device='cuda:0', dtype=torch.float16)
tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0749, device='cuda:0', dtype=torch.float16)
tensor(0.7754, device='cuda:0', dtype=torch.float16) tensor(0.0786, device='cuda:0', dtype=torch.float16)
tensor(1.3574, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
11 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7617, device='cuda:0', dtype=torch.float16) tensor(0.2262, device='cuda:0', dtype=torch.float16)
tensor(0.8105, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.0798, device='cuda:0', dtype=torch.float16)
tensor(0.9121, device='cuda:0', dtype=torch.float16) tensor(0.0834, device='cuda:0', dtype=torch.float16)
tensor(0.7051, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0072, device='cuda:0')
tensor(0.0598, device='cuda:0')
old_score: tensor(0.0804, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0724, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.237083673477173
Validation after dual ascent:
out_inf: tensor(4.7617, device='cuda:0', dtype=torch.float16) tensor(0.2262, device='cuda:0', dtype=torch.float16)
tensor(0.7090, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.8066, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.7305, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
tensor(0.6592, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
11 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.0742, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
tensor(0.2834, device='cuda:0', dtype=torch.float16) tensor(0.0307, device='cuda:0', dtype=torch.float16)
tensor(0.2905, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(0.3181, device='cuda:0', dtype=torch.float16) tensor(0.0312, device='cuda:0', dtype=torch.float16)
tensor(0.3403, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0065, device='cuda:0')
tensor(0.0143, device='cuda:0')
old_score: tensor(0.0299, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0283, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.72283053398132
Validation after dual ascent:
out_inf: tensor(4.0742, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
tensor(0.2810, device='cuda:0', dtype=torch.float16) tensor(0.0291, device='cuda:0', dtype=torch.float16)
tensor(0.2954, device='cuda:0', dtype=torch.float16) tensor(0.0279, device='cuda:0', dtype=torch.float16)
tensor(0.3098, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(0.3218, device='cuda:0', dtype=torch.float16) tensor(0.0265, device='cuda:0', dtype=torch.float16)
layer 11 done
12 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.3594, device='cuda:0', dtype=torch.float16) tensor(0.8003, device='cuda:0', dtype=torch.float16)
tensor(1.4814, device='cuda:0', dtype=torch.float16) tensor(0.1803, device='cuda:0', dtype=torch.float16)
tensor(1.6182, device='cuda:0', dtype=torch.float16) tensor(0.1787, device='cuda:0', dtype=torch.float16)
tensor(1.4580, device='cuda:0', dtype=torch.float16) tensor(0.1881, device='cuda:0', dtype=torch.float16)
tensor(1.5322, device='cuda:0', dtype=torch.float16) tensor(0.1710, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0191, device='cuda:0')
tensor(0.0930, device='cuda:0')
old_score: tensor(0.1794, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1595, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.968789100646973
Validation after dual ascent:
out_inf: tensor(18.3594, device='cuda:0', dtype=torch.float16) tensor(0.8003, device='cuda:0', dtype=torch.float16)
tensor(1.3975, device='cuda:0', dtype=torch.float16) tensor(0.1614, device='cuda:0', dtype=torch.float16)
tensor(1.4287, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
tensor(1.3125, device='cuda:0', dtype=torch.float16) tensor(0.1675, device='cuda:0', dtype=torch.float16)
tensor(1.3730, device='cuda:0', dtype=torch.float16) tensor(0.1514, device='cuda:0', dtype=torch.float16)
12 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.0156, device='cuda:0', dtype=torch.float16) tensor(1.0459, device='cuda:0', dtype=torch.float16)
tensor(1.4414, device='cuda:0', dtype=torch.float16) tensor(0.1838, device='cuda:0', dtype=torch.float16)
tensor(1.5586, device='cuda:0', dtype=torch.float16) tensor(0.1818, device='cuda:0', dtype=torch.float16)
tensor(1.5049, device='cuda:0', dtype=torch.float16) tensor(0.1912, device='cuda:0', dtype=torch.float16)
tensor(1.7852, device='cuda:0', dtype=torch.float16) tensor(0.1741, device='cuda:0', dtype=torch.float16)
tensor(0.0817, device='cuda:0')
old_score: tensor(0.1826, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1619, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.232012271881104
Validation after dual ascent:
out_inf: tensor(16.0156, device='cuda:0', dtype=torch.float16) tensor(1.0459, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.3965, device='cuda:0', dtype=torch.float16) tensor(0.1602, device='cuda:0', dtype=torch.float16)
tensor(1.3682, device='cuda:0', dtype=torch.float16) tensor(0.1696, device='cuda:0', dtype=torch.float16)
tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.1536, device='cuda:0', dtype=torch.float16)
12 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.0742, device='cuda:0', dtype=torch.float16) tensor(0.3176, device='cuda:0', dtype=torch.float16)
tensor(0.8555, device='cuda:0', dtype=torch.float16) tensor(0.1112, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(0.8833, device='cuda:0', dtype=torch.float16) tensor(0.1151, device='cuda:0', dtype=torch.float16)
tensor(0.8125, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0129, device='cuda:0')
tensor(0.0986, device='cuda:0')
old_score: tensor(0.1101, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0988, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.247016429901123
Validation after dual ascent:
out_inf: tensor(6.0742, device='cuda:0', dtype=torch.float16) tensor(0.3176, device='cuda:0', dtype=torch.float16)
tensor(0.8086, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(0.8169, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
tensor(0.7778, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
tensor(0.7578, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
12 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.0664, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
tensor(0.3506, device='cuda:0', dtype=torch.float16) tensor(0.0339, device='cuda:0', dtype=torch.float16)
tensor(0.3740, device='cuda:0', dtype=torch.float16) tensor(0.0353, device='cuda:0', dtype=torch.float16)
tensor(0.3640, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.3237, device='cuda:0', dtype=torch.float16) tensor(0.0303, device='cuda:0', dtype=torch.float16)
Converged at iteration 500
tensor(0.0101, device='cuda:0')
tensor(0.0236, device='cuda:0')
old_score: tensor(0.0352, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0320, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 7.714013338088989
Validation after dual ascent:
out_inf: tensor(7.0664, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
tensor(0.3049, device='cuda:0', dtype=torch.float16) tensor(0.0309, device='cuda:0', dtype=torch.float16)
tensor(0.3113, device='cuda:0', dtype=torch.float16) tensor(0.0320, device='cuda:0', dtype=torch.float16)
tensor(0.3462, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
tensor(0.3257, device='cuda:0', dtype=torch.float16) tensor(0.0274, device='cuda:0', dtype=torch.float16)
12 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.9766, device='cuda:0', dtype=torch.float16) tensor(0.3147, device='cuda:0', dtype=torch.float16)
tensor(0.9033, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(0.8301, device='cuda:0', dtype=torch.float16) tensor(0.0851, device='cuda:0', dtype=torch.float16)
tensor(1.2275, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0106, device='cuda:0')
tensor(0.0793, device='cuda:0')
old_score: tensor(0.0866, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0778, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.230142831802368
Validation after dual ascent:
out_inf: tensor(6.9766, device='cuda:0', dtype=torch.float16) tensor(0.3147, device='cuda:0', dtype=torch.float16)
tensor(0.7983, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.7383, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
tensor(1.3164, device='cuda:0', dtype=torch.float16) tensor(0.0818, device='cuda:0', dtype=torch.float16)
tensor(0.9014, device='cuda:0', dtype=torch.float16) tensor(0.0739, device='cuda:0', dtype=torch.float16)
12 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4805, device='cuda:0', dtype=torch.float16) tensor(0.2296, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.0849, device='cuda:0', dtype=torch.float16)
tensor(0.8926, device='cuda:0', dtype=torch.float16) tensor(0.0822, device='cuda:0', dtype=torch.float16)
tensor(0.7959, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(0.7715, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0076, device='cuda:0')
tensor(0.0669, device='cuda:0')
old_score: tensor(0.0836, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0754, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.224973678588867
Validation after dual ascent:
out_inf: tensor(4.4805, device='cuda:0', dtype=torch.float16) tensor(0.2296, device='cuda:0', dtype=torch.float16)
tensor(0.9570, device='cuda:0', dtype=torch.float16) tensor(0.0771, device='cuda:0', dtype=torch.float16)
tensor(0.9307, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.7646, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0717, device='cuda:0', dtype=torch.float16)
12 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.1230, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
tensor(0.2832, device='cuda:0', dtype=torch.float16) tensor(0.0322, device='cuda:0', dtype=torch.float16)
tensor(0.3267, device='cuda:0', dtype=torch.float16) tensor(0.0305, device='cuda:0', dtype=torch.float16)
tensor(0.3118, device='cuda:0', dtype=torch.float16) tensor(0.0336, device='cuda:0', dtype=torch.float16)
tensor(0.3389, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0106, device='cuda:0')
tensor(0.0154, device='cuda:0')
old_score: tensor(0.0315, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0299, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 36.838974952697754
Validation after dual ascent:
out_inf: tensor(2.1230, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
tensor(0.2983, device='cuda:0', dtype=torch.float16) tensor(0.0307, device='cuda:0', dtype=torch.float16)
tensor(0.3264, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.2979, device='cuda:0', dtype=torch.float16) tensor(0.0320, device='cuda:0', dtype=torch.float16)
tensor(0.3276, device='cuda:0', dtype=torch.float16) tensor(0.0279, device='cuda:0', dtype=torch.float16)
layer 12 done
13 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.3594, device='cuda:0', dtype=torch.float16) tensor(0.8027, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.1814, device='cuda:0', dtype=torch.float16)
tensor(1.5488, device='cuda:0', dtype=torch.float16) tensor(0.1790, device='cuda:0', dtype=torch.float16)
tensor(1.5459, device='cuda:0', dtype=torch.float16) tensor(0.1898, device='cuda:0', dtype=torch.float16)
tensor(1.4639, device='cuda:0', dtype=torch.float16) tensor(0.1724, device='cuda:0', dtype=torch.float16)
tensor(0.1689, device='cuda:0')
old_score: tensor(0.1807, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1613, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.175344705581665
Validation after dual ascent:
out_inf: tensor(14.3594, device='cuda:0', dtype=torch.float16) tensor(0.8027, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(1.6680, device='cuda:0', dtype=torch.float16) tensor(0.1587, device='cuda:0', dtype=torch.float16)
tensor(1.4697, device='cuda:0', dtype=torch.float16) tensor(0.1702, device='cuda:0', dtype=torch.float16)
tensor(1.2725, device='cuda:0', dtype=torch.float16) tensor(0.1530, device='cuda:0', dtype=torch.float16)
13 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1., device='cuda:0', dtype=torch.float16)
tensor(1.4512, device='cuda:0', dtype=torch.float16) tensor(0.1826, device='cuda:0', dtype=torch.float16)
tensor(1.3359, device='cuda:0', dtype=torch.float16) tensor(0.1797, device='cuda:0', dtype=torch.float16)
tensor(1.5889, device='cuda:0', dtype=torch.float16) tensor(0.1904, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1730, device='cuda:0', dtype=torch.float16)
tensor(0.1525, device='cuda:0')
old_score: tensor(0.1814, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1616, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.213985204696655
Validation after dual ascent:
out_inf: tensor(17.2656, device='cuda:0', dtype=torch.float16) tensor(1., device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.1638, device='cuda:0', dtype=torch.float16)
tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(1.4561, device='cuda:0', dtype=torch.float16) tensor(0.1703, device='cuda:0', dtype=torch.float16)
tensor(1.2783, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
13 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8516, device='cuda:0', dtype=torch.float16) tensor(0.3174, device='cuda:0', dtype=torch.float16)
tensor(0.9019, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(0.8848, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(0.9766, device='cuda:0', dtype=torch.float16) tensor(0.1207, device='cuda:0', dtype=torch.float16)
tensor(0.8369, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
tensor(0.0960, device='cuda:0')
old_score: tensor(0.1151, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1037, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.184621095657349
Validation after dual ascent:
out_inf: tensor(4.8516, device='cuda:0', dtype=torch.float16) tensor(0.3174, device='cuda:0', dtype=torch.float16)
tensor(0.8540, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(0.8579, device='cuda:0', dtype=torch.float16) tensor(0.0984, device='cuda:0', dtype=torch.float16)
13 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1797, device='cuda:0', dtype=torch.float16) tensor(0.0832, device='cuda:0', dtype=torch.float16)
tensor(0.3467, device='cuda:0', dtype=torch.float16) tensor(0.0318, device='cuda:0', dtype=torch.float16)
tensor(0.3228, device='cuda:0', dtype=torch.float16) tensor(0.0318, device='cuda:0', dtype=torch.float16)
tensor(0.3706, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
tensor(0.3105, device='cuda:0', dtype=torch.float16) tensor(0.0297, device='cuda:0', dtype=torch.float16)
tensor(0.0187, device='cuda:0')
old_score: tensor(0.0329, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0297, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.174129247665405
Validation after dual ascent:
out_inf: tensor(6.1797, device='cuda:0', dtype=torch.float16) tensor(0.0832, device='cuda:0', dtype=torch.float16)
tensor(0.3293, device='cuda:0', dtype=torch.float16) tensor(0.0288, device='cuda:0', dtype=torch.float16)
tensor(0.2913, device='cuda:0', dtype=torch.float16) tensor(0.0285, device='cuda:0', dtype=torch.float16)
tensor(0.3264, device='cuda:0', dtype=torch.float16) tensor(0.0348, device='cuda:0', dtype=torch.float16)
tensor(0.2737, device='cuda:0', dtype=torch.float16) tensor(0.0267, device='cuda:0', dtype=torch.float16)
13 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8359, device='cuda:0', dtype=torch.float16) tensor(0.3352, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.0910, device='cuda:0', dtype=torch.float16)
tensor(0.9316, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(1.0859, device='cuda:0', dtype=torch.float16) tensor(0.0942, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0113, device='cuda:0')
tensor(0.0903, device='cuda:0')
old_score: tensor(0.0892, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0803, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2383482456207275
Validation after dual ascent:
out_inf: tensor(7.8359, device='cuda:0', dtype=torch.float16) tensor(0.3352, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.7988, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
tensor(1.0244, device='cuda:0', dtype=torch.float16) tensor(0.0851, device='cuda:0', dtype=torch.float16)
tensor(0.9766, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
13 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8086, device='cuda:0', dtype=torch.float16) tensor(0.2437, device='cuda:0', dtype=torch.float16)
tensor(0.9058, device='cuda:0', dtype=torch.float16) tensor(0.0891, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0843, device='cuda:0', dtype=torch.float16)
tensor(0.7842, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(0.9434, device='cuda:0', dtype=torch.float16) tensor(0.0838, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0084, device='cuda:0')
tensor(0.0773, device='cuda:0')
old_score: tensor(0.0873, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0788, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.233015775680542
Validation after dual ascent:
out_inf: tensor(4.8086, device='cuda:0', dtype=torch.float16) tensor(0.2437, device='cuda:0', dtype=torch.float16)
tensor(0.7979, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
tensor(0.7466, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
tensor(0.7188, device='cuda:0', dtype=torch.float16) tensor(0.0835, device='cuda:0', dtype=torch.float16)
tensor(0.9551, device='cuda:0', dtype=torch.float16) tensor(0.0753, device='cuda:0', dtype=torch.float16)
13 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4648, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(0.3601, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.3096, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(0.3682, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.3589, device='cuda:0', dtype=torch.float16) tensor(0.0339, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0177, device='cuda:0')
tensor(0.0391, device='cuda:0')
old_score: tensor(0.0353, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0334, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.090038299560547
Validation after dual ascent:
out_inf: tensor(4.4648, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(0.3433, device='cuda:0', dtype=torch.float16) tensor(0.0349, device='cuda:0', dtype=torch.float16)
tensor(0.2881, device='cuda:0', dtype=torch.float16) tensor(0.0311, device='cuda:0', dtype=torch.float16)
tensor(0.3647, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
tensor(0.3271, device='cuda:0', dtype=torch.float16) tensor(0.0319, device='cuda:0', dtype=torch.float16)
layer 13 done
14 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.5391, device='cuda:0', dtype=torch.float16) tensor(0.8027, device='cuda:0', dtype=torch.float16)
tensor(2.0527, device='cuda:0', dtype=torch.float16) tensor(0.1860, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1779, device='cuda:0', dtype=torch.float16)
tensor(1.7676, device='cuda:0', dtype=torch.float16) tensor(0.1949, device='cuda:0', dtype=torch.float16)
tensor(1.5479, device='cuda:0', dtype=torch.float16) tensor(0.1753, device='cuda:0', dtype=torch.float16)
tensor(0.0677, device='cuda:0')
old_score: tensor(0.1835, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1635, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.186769247055054
Validation after dual ascent:
out_inf: tensor(14.5391, device='cuda:0', dtype=torch.float16) tensor(0.8027, device='cuda:0', dtype=torch.float16)
tensor(1.9316, device='cuda:0', dtype=torch.float16) tensor(0.1666, device='cuda:0', dtype=torch.float16)
tensor(1.6123, device='cuda:0', dtype=torch.float16) tensor(0.1575, device='cuda:0', dtype=torch.float16)
tensor(1.5020, device='cuda:0', dtype=torch.float16) tensor(0.1744, device='cuda:0', dtype=torch.float16)
tensor(1.2979, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
14 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.5312, device='cuda:0', dtype=torch.float16) tensor(1.0762, device='cuda:0', dtype=torch.float16)
tensor(1.5371, device='cuda:0', dtype=torch.float16) tensor(0.1873, device='cuda:0', dtype=torch.float16)
tensor(1.5693, device='cuda:0', dtype=torch.float16) tensor(0.1802, device='cuda:0', dtype=torch.float16)
tensor(1.5117, device='cuda:0', dtype=torch.float16) tensor(0.1957, device='cuda:0', dtype=torch.float16)
tensor(1.3730, device='cuda:0', dtype=torch.float16) tensor(0.1768, device='cuda:0', dtype=torch.float16)
tensor(0.0708, device='cuda:0')
old_score: tensor(0.1849, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1641, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.226727724075317
Validation after dual ascent:
out_inf: tensor(16.5312, device='cuda:0', dtype=torch.float16) tensor(1.0762, device='cuda:0', dtype=torch.float16)
tensor(1.3594, device='cuda:0', dtype=torch.float16) tensor(0.1672, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.1583, device='cuda:0', dtype=torch.float16)
tensor(1.3604, device='cuda:0', dtype=torch.float16) tensor(0.1747, device='cuda:0', dtype=torch.float16)
tensor(1.3164, device='cuda:0', dtype=torch.float16) tensor(0.1559, device='cuda:0', dtype=torch.float16)
14 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3179, device='cuda:0', dtype=torch.float16)
tensor(0.9531, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(0.7939, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(0.8804, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0144, device='cuda:0')
tensor(0.1100, device='cuda:0')
old_score: tensor(0.1146, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1031, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.248779535293579
Validation after dual ascent:
out_inf: tensor(4.4453, device='cuda:0', dtype=torch.float16) tensor(0.3179, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
tensor(0.7568, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(0.8379, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(0.8057, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
14 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.3516, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(0.3550, device='cuda:0', dtype=torch.float16) tensor(0.0373, device='cuda:0', dtype=torch.float16)
tensor(0.2969, device='cuda:0', dtype=torch.float16) tensor(0.0329, device='cuda:0', dtype=torch.float16)
tensor(0.3674, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(0.3762, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0149, device='cuda:0')
tensor(0.0166, device='cuda:0')
old_score: tensor(0.0360, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0327, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.23822021484375
Validation after dual ascent:
out_inf: tensor(9.3516, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(0.3657, device='cuda:0', dtype=torch.float16) tensor(0.0339, device='cuda:0', dtype=torch.float16)
tensor(0.2866, device='cuda:0', dtype=torch.float16) tensor(0.0294, device='cuda:0', dtype=torch.float16)
tensor(0.3535, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
tensor(0.3684, device='cuda:0', dtype=torch.float16) tensor(0.0297, device='cuda:0', dtype=torch.float16)
14 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.6719, device='cuda:0', dtype=torch.float16) tensor(0.3452, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.0940, device='cuda:0', dtype=torch.float16)
tensor(1.0918, device='cuda:0', dtype=torch.float16) tensor(0.0862, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.0873, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0118, device='cuda:0')
tensor(0.0974, device='cuda:0')
old_score: tensor(0.0917, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0829, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.223158597946167
Validation after dual ascent:
out_inf: tensor(7.6719, device='cuda:0', dtype=torch.float16) tensor(0.3452, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(0.9336, device='cuda:0', dtype=torch.float16) tensor(0.0774, device='cuda:0', dtype=torch.float16)
tensor(1.2559, device='cuda:0', dtype=torch.float16) tensor(0.0903, device='cuda:0', dtype=torch.float16)
tensor(0.9092, device='cuda:0', dtype=torch.float16) tensor(0.0785, device='cuda:0', dtype=torch.float16)
14 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9023, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(0.9414, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(0.7583, device='cuda:0', dtype=torch.float16) tensor(0.0848, device='cuda:0', dtype=torch.float16)
tensor(0.8721, device='cuda:0', dtype=torch.float16) tensor(0.0975, device='cuda:0', dtype=torch.float16)
tensor(0.9805, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0090, device='cuda:0')
tensor(0.0857, device='cuda:0')
old_score: tensor(0.0901, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0817, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.220632791519165
Validation after dual ascent:
out_inf: tensor(5.9023, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(0.8682, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
tensor(0.6611, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(0.7861, device='cuda:0', dtype=torch.float16) tensor(0.0890, device='cuda:0', dtype=torch.float16)
tensor(0.8066, device='cuda:0', dtype=torch.float16) tensor(0.0773, device='cuda:0', dtype=torch.float16)
14 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.3828, device='cuda:0', dtype=torch.float16) tensor(0.0998, device='cuda:0', dtype=torch.float16)
tensor(0.3823, device='cuda:0', dtype=torch.float16) tensor(0.0394, device='cuda:0', dtype=torch.float16)
tensor(0.3032, device='cuda:0', dtype=torch.float16) tensor(0.0333, device='cuda:0', dtype=torch.float16)
tensor(0.3364, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.4009, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0119, device='cuda:0')
tensor(0.0196, device='cuda:0')
old_score: tensor(0.0370, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0350, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.082120418548584
Validation after dual ascent:
out_inf: tensor(2.3828, device='cuda:0', dtype=torch.float16) tensor(0.0998, device='cuda:0', dtype=torch.float16)
tensor(0.3689, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.2834, device='cuda:0', dtype=torch.float16) tensor(0.0312, device='cuda:0', dtype=torch.float16)
tensor(0.3252, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
tensor(0.4070, device='cuda:0', dtype=torch.float16) tensor(0.0335, device='cuda:0', dtype=torch.float16)
layer 14 done
15 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.9688, device='cuda:0', dtype=torch.float16) tensor(0.7876, device='cuda:0', dtype=torch.float16)
tensor(1.7812, device='cuda:0', dtype=torch.float16) tensor(0.1768, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1656, device='cuda:0', dtype=torch.float16)
tensor(1.7578, device='cuda:0', dtype=torch.float16) tensor(0.1875, device='cuda:0', dtype=torch.float16)
tensor(1.6514, device='cuda:0', dtype=torch.float16) tensor(0.1664, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0158, device='cuda:0')
tensor(0.1984, device='cuda:0')
old_score: tensor(0.1741, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1558, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2486910820007324
Validation after dual ascent:
out_inf: tensor(15.9688, device='cuda:0', dtype=torch.float16) tensor(0.7876, device='cuda:0', dtype=torch.float16)
tensor(1.4678, device='cuda:0', dtype=torch.float16) tensor(0.1595, device='cuda:0', dtype=torch.float16)
tensor(1.2686, device='cuda:0', dtype=torch.float16) tensor(0.1467, device='cuda:0', dtype=torch.float16)
tensor(1.4570, device='cuda:0', dtype=torch.float16) tensor(0.1692, device='cuda:0', dtype=torch.float16)
tensor(1.4600, device='cuda:0', dtype=torch.float16) tensor(0.1479, device='cuda:0', dtype=torch.float16)
15 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.3281, device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.1813, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.1918, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.1703, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0197, device='cuda:0')
tensor(0.2224, device='cuda:0')
old_score: tensor(0.1783, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1589, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2514283657073975
Validation after dual ascent:
out_inf: tensor(15.3281, device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(1.3252, device='cuda:0', dtype=torch.float16) tensor(0.1628, device='cuda:0', dtype=torch.float16)
tensor(1.2979, device='cuda:0', dtype=torch.float16) tensor(0.1498, device='cuda:0', dtype=torch.float16)
tensor(1.4346, device='cuda:0', dtype=torch.float16) tensor(0.1722, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
15 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9414, device='cuda:0', dtype=torch.float16) tensor(0.3230, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
tensor(0.9385, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.1240, device='cuda:0', dtype=torch.float16)
tensor(0.8721, device='cuda:0', dtype=torch.float16) tensor(0.1104, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0126, device='cuda:0')
tensor(0.2226, device='cuda:0')
old_score: tensor(0.1154, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1041, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4981865882873535
Validation after dual ascent:
out_inf: tensor(4.9414, device='cuda:0', dtype=torch.float16) tensor(0.3230, device='cuda:0', dtype=torch.float16)
tensor(0.8413, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
tensor(0.8423, device='cuda:0', dtype=torch.float16) tensor(0.0976, device='cuda:0', dtype=torch.float16)
tensor(0.8701, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(0.7715, device='cuda:0', dtype=torch.float16) tensor(0.0991, device='cuda:0', dtype=torch.float16)
15 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.6172, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
tensor(0.3743, device='cuda:0', dtype=torch.float16) tensor(0.0389, device='cuda:0', dtype=torch.float16)
tensor(0.3857, device='cuda:0', dtype=torch.float16) tensor(0.0365, device='cuda:0', dtype=torch.float16)
tensor(0.3975, device='cuda:0', dtype=torch.float16) tensor(0.0432, device='cuda:0', dtype=torch.float16)
tensor(0.3550, device='cuda:0', dtype=torch.float16) tensor(0.0353, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0195, device='cuda:0')
tensor(0.0268, device='cuda:0')
old_score: tensor(0.0385, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0351, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 5.467714548110962
Validation after dual ascent:
out_inf: tensor(7.6172, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
tensor(0.3247, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.3032, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(0.3462, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.3284, device='cuda:0', dtype=torch.float16) tensor(0.0321, device='cuda:0', dtype=torch.float16)
15 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.8047, device='cuda:0', dtype=torch.float16) tensor(0.3728, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.0951, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.0864, device='cuda:0', dtype=torch.float16)
tensor(0.9277, device='cuda:0', dtype=torch.float16) tensor(0.1008, device='cuda:0', dtype=torch.float16)
tensor(1.2168, device='cuda:0', dtype=torch.float16) tensor(0.0886, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0132, device='cuda:0')
tensor(0.1056, device='cuda:0')
old_score: tensor(0.0927, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0833, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2274956703186035
Validation after dual ascent:
out_inf: tensor(6.8047, device='cuda:0', dtype=torch.float16) tensor(0.3728, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.0767, device='cuda:0', dtype=torch.float16)
tensor(0.8320, device='cuda:0', dtype=torch.float16) tensor(0.0911, device='cuda:0', dtype=torch.float16)
tensor(1.3711, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
15 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5547, device='cuda:0', dtype=torch.float16) tensor(0.2676, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0933, device='cuda:0', dtype=torch.float16)
tensor(0.8926, device='cuda:0', dtype=torch.float16) tensor(0.0850, device='cuda:0', dtype=torch.float16)
tensor(0.9585, device='cuda:0', dtype=torch.float16) tensor(0.0990, device='cuda:0', dtype=torch.float16)
tensor(0.9512, device='cuda:0', dtype=torch.float16) tensor(0.0871, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0101, device='cuda:0')
tensor(0.0928, device='cuda:0')
old_score: tensor(0.0911, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0820, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.224372148513794
Validation after dual ascent:
out_inf: tensor(4.5547, device='cuda:0', dtype=torch.float16) tensor(0.2676, device='cuda:0', dtype=torch.float16)
tensor(0.8838, device='cuda:0', dtype=torch.float16) tensor(0.0848, device='cuda:0', dtype=torch.float16)
tensor(0.7480, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0897, device='cuda:0', dtype=torch.float16)
tensor(0.9941, device='cuda:0', dtype=torch.float16) tensor(0.0781, device='cuda:0', dtype=torch.float16)
15 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.7461, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(0.3750, device='cuda:0', dtype=torch.float16) tensor(0.0415, device='cuda:0', dtype=torch.float16)
tensor(0.3682, device='cuda:0', dtype=torch.float16) tensor(0.0360, device='cuda:0', dtype=torch.float16)
tensor(0.4006, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
tensor(0.4131, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0119, device='cuda:0')
tensor(0.0194, device='cuda:0')
old_score: tensor(0.0396, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0372, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 22.067477464675903
Validation after dual ascent:
out_inf: tensor(5.7461, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(0.3662, device='cuda:0', dtype=torch.float16) tensor(0.0391, device='cuda:0', dtype=torch.float16)
tensor(0.3613, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(0.3630, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.3816, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
layer 15 done
16 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.8672, device='cuda:0', dtype=torch.float16) tensor(0.7832, device='cuda:0', dtype=torch.float16)
tensor(1.7432, device='cuda:0', dtype=torch.float16) tensor(0.1741, device='cuda:0', dtype=torch.float16)
tensor(2.0723, device='cuda:0', dtype=torch.float16) tensor(0.1608, device='cuda:0', dtype=torch.float16)
tensor(1.8926, device='cuda:0', dtype=torch.float16) tensor(0.1848, device='cuda:0', dtype=torch.float16)
tensor(1.4756, device='cuda:0', dtype=torch.float16) tensor(0.1619, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0170, device='cuda:0')
tensor(0.2118, device='cuda:0')
old_score: tensor(0.1704, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1517, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2364678382873535
Validation after dual ascent:
out_inf: tensor(15.8672, device='cuda:0', dtype=torch.float16) tensor(0.7832, device='cuda:0', dtype=torch.float16)
tensor(1.6660, device='cuda:0', dtype=torch.float16) tensor(0.1562, device='cuda:0', dtype=torch.float16)
tensor(1.9082, device='cuda:0', dtype=torch.float16) tensor(0.1414, device='cuda:0', dtype=torch.float16)
tensor(1.8242, device='cuda:0', dtype=torch.float16) tensor(0.1661, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.1432, device='cuda:0', dtype=torch.float16)
16 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.7656, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1774, device='cuda:0', dtype=torch.float16)
tensor(1.3467, device='cuda:0', dtype=torch.float16) tensor(0.1643, device='cuda:0', dtype=torch.float16)
tensor(1.5234, device='cuda:0', dtype=torch.float16) tensor(0.1875, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.1648, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0194, device='cuda:0')
tensor(0.1719, device='cuda:0')
old_score: tensor(0.1736, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1536, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.9778459072113037
Validation after dual ascent:
out_inf: tensor(16.7656, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(1.4277, device='cuda:0', dtype=torch.float16) tensor(0.1584, device='cuda:0', dtype=torch.float16)
tensor(1.3164, device='cuda:0', dtype=torch.float16) tensor(0.1432, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1676, device='cuda:0', dtype=torch.float16)
tensor(1.2725, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
16 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9648, device='cuda:0', dtype=torch.float16) tensor(0.3245, device='cuda:0', dtype=torch.float16)
tensor(1.1143, device='cuda:0', dtype=torch.float16) tensor(0.1207, device='cuda:0', dtype=torch.float16)
tensor(0.9277, device='cuda:0', dtype=torch.float16) tensor(0.1104, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(0.8853, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0134, device='cuda:0')
tensor(0.2250, device='cuda:0')
old_score: tensor(0.1176, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1056, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4865081310272217
Validation after dual ascent:
out_inf: tensor(4.9648, device='cuda:0', dtype=torch.float16) tensor(0.3245, device='cuda:0', dtype=torch.float16)
tensor(1.2725, device='cuda:0', dtype=torch.float16) tensor(0.1095, device='cuda:0', dtype=torch.float16)
tensor(0.9478, device='cuda:0', dtype=torch.float16) tensor(0.0978, device='cuda:0', dtype=torch.float16)
tensor(0.9512, device='cuda:0', dtype=torch.float16) tensor(0.1151, device='cuda:0', dtype=torch.float16)
tensor(0.8657, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
16 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.4219, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
tensor(0.4385, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.4287, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.5205, device='cuda:0', dtype=torch.float16) tensor(0.0505, device='cuda:0', dtype=torch.float16)
tensor(0.4417, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0182, device='cuda:0')
tensor(0.0390, device='cuda:0')
old_score: tensor(0.0435, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0397, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.400117635726929
Validation after dual ascent:
out_inf: tensor(7.4219, device='cuda:0', dtype=torch.float16) tensor(0.1263, device='cuda:0', dtype=torch.float16)
tensor(0.4429, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.4348, device='cuda:0', dtype=torch.float16) tensor(0.0364, device='cuda:0', dtype=torch.float16)
tensor(0.4717, device='cuda:0', dtype=torch.float16) tensor(0.0463, device='cuda:0', dtype=torch.float16)
tensor(0.4385, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
16 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.6133, device='cuda:0', dtype=torch.float16) tensor(0.3887, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.2441, device='cuda:0', dtype=torch.float16) tensor(0.0895, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.1053, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.0911, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0153, device='cuda:0')
tensor(0.1183, device='cuda:0')
old_score: tensor(0.0963, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0859, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.180557489395142
Validation after dual ascent:
out_inf: tensor(7.6133, device='cuda:0', dtype=torch.float16) tensor(0.3887, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.0892, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0789, device='cuda:0', dtype=torch.float16)
tensor(1.1250, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.0811, device='cuda:0', dtype=torch.float16)
16 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0039, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(0.8535, device='cuda:0', dtype=torch.float16) tensor(0.0873, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.1027, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0888, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0115, device='cuda:0')
tensor(0.1047, device='cuda:0')
old_score: tensor(0.0939, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0840, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.181793451309204
Validation after dual ascent:
out_inf: tensor(5.0039, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(0.9541, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.7871, device='cuda:0', dtype=torch.float16) tensor(0.0771, device='cuda:0', dtype=torch.float16)
tensor(0.9600, device='cuda:0', dtype=torch.float16) tensor(0.0925, device='cuda:0', dtype=torch.float16)
tensor(1.1934, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
16 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6602, device='cuda:0', dtype=torch.float16) tensor(0.1274, device='cuda:0', dtype=torch.float16)
tensor(0.4644, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
tensor(0.4346, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.4141, device='cuda:0', dtype=torch.float16) tensor(0.0449, device='cuda:0', dtype=torch.float16)
tensor(0.3870, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0107, device='cuda:0')
tensor(0.0142, device='cuda:0')
old_score: tensor(0.0410, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0384, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.9073965549469
Validation after dual ascent:
out_inf: tensor(5.6602, device='cuda:0', dtype=torch.float16) tensor(0.1274, device='cuda:0', dtype=torch.float16)
tensor(0.4329, device='cuda:0', dtype=torch.float16) tensor(0.0411, device='cuda:0', dtype=torch.float16)
tensor(0.4102, device='cuda:0', dtype=torch.float16) tensor(0.0340, device='cuda:0', dtype=torch.float16)
tensor(0.3989, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.3940, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
layer 16 done
17 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.8828, device='cuda:0', dtype=torch.float16) tensor(0.7832, device='cuda:0', dtype=torch.float16)
tensor(1.6689, device='cuda:0', dtype=torch.float16) tensor(0.1639, device='cuda:0', dtype=torch.float16)
tensor(1.9619, device='cuda:0', dtype=torch.float16) tensor(0.1510, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.1768, device='cuda:0', dtype=torch.float16)
tensor(2.0820, device='cuda:0', dtype=torch.float16) tensor(0.1522, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0196, device='cuda:0')
tensor(0.0704, device='cuda:0')
old_score: tensor(0.1610, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1414, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.913151741027832
Validation after dual ascent:
out_inf: tensor(15.8828, device='cuda:0', dtype=torch.float16) tensor(0.7832, device='cuda:0', dtype=torch.float16)
tensor(1.4678, device='cuda:0', dtype=torch.float16) tensor(0.1453, device='cuda:0', dtype=torch.float16)
tensor(1.7129, device='cuda:0', dtype=torch.float16) tensor(0.1305, device='cuda:0', dtype=torch.float16)
tensor(1.6201, device='cuda:0', dtype=torch.float16) tensor(0.1564, device='cuda:0', dtype=torch.float16)
tensor(1.8457, device='cuda:0', dtype=torch.float16) tensor(0.1332, device='cuda:0', dtype=torch.float16)
17 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.5625, device='cuda:0', dtype=torch.float16) tensor(1.0059, device='cuda:0', dtype=torch.float16)
tensor(1.8389, device='cuda:0', dtype=torch.float16) tensor(0.1666, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(1.6055, device='cuda:0', dtype=torch.float16) tensor(0.1787, device='cuda:0', dtype=torch.float16)
tensor(2.2344, device='cuda:0', dtype=torch.float16) tensor(0.1544, device='cuda:0', dtype=torch.float16)
tensor(0.0540, device='cuda:0')
old_score: tensor(0.1633, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1427, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.157992124557495
Validation after dual ascent:
out_inf: tensor(16.5625, device='cuda:0', dtype=torch.float16) tensor(1.0059, device='cuda:0', dtype=torch.float16)
tensor(1.6133, device='cuda:0', dtype=torch.float16) tensor(0.1470, device='cuda:0', dtype=torch.float16)
tensor(1.2324, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1577, device='cuda:0', dtype=torch.float16)
tensor(2.0020, device='cuda:0', dtype=torch.float16) tensor(0.1344, device='cuda:0', dtype=torch.float16)
17 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7695, device='cuda:0', dtype=torch.float16) tensor(0.3315, device='cuda:0', dtype=torch.float16)
tensor(1.1934, device='cuda:0', dtype=torch.float16) tensor(0.1149, device='cuda:0', dtype=torch.float16)
tensor(0.8770, device='cuda:0', dtype=torch.float16) tensor(0.1051, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(0.9146, device='cuda:0', dtype=torch.float16) tensor(0.1065, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0100, device='cuda:0')
tensor(0.0839, device='cuda:0')
old_score: tensor(0.1122, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0995, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2323036193847656
Validation after dual ascent:
out_inf: tensor(4.7695, device='cuda:0', dtype=torch.float16) tensor(0.3315, device='cuda:0', dtype=torch.float16)
tensor(0.9824, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
tensor(0.8276, device='cuda:0', dtype=torch.float16) tensor(0.0916, device='cuda:0', dtype=torch.float16)
tensor(0.9600, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
17 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1367, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(0.4590, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
tensor(0.4119, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
tensor(0.4604, device='cuda:0', dtype=torch.float16) tensor(0.0462, device='cuda:0', dtype=torch.float16)
tensor(0.3970, device='cuda:0', dtype=torch.float16) tensor(0.0344, device='cuda:0', dtype=torch.float16)
Converged at iteration 550
tensor(0.0199, device='cuda:0')
tensor(0.0209, device='cuda:0')
old_score: tensor(0.0393, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0348, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.422348260879517
Validation after dual ascent:
out_inf: tensor(6.1367, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(0.4087, device='cuda:0', dtype=torch.float16) tensor(0.0345, device='cuda:0', dtype=torch.float16)
tensor(0.3745, device='cuda:0', dtype=torch.float16) tensor(0.0322, device='cuda:0', dtype=torch.float16)
tensor(0.4250, device='cuda:0', dtype=torch.float16) tensor(0.0418, device='cuda:0', dtype=torch.float16)
tensor(0.3625, device='cuda:0', dtype=torch.float16) tensor(0.0305, device='cuda:0', dtype=torch.float16)
17 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.8906, device='cuda:0', dtype=torch.float16) tensor(0.4097, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.0930, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(1.2832, device='cuda:0', dtype=torch.float16) tensor(0.0952, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0162, device='cuda:0')
tensor(0.1358, device='cuda:0')
old_score: tensor(0.1002, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0891, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.206598997116089
Validation after dual ascent:
out_inf: tensor(8.8906, device='cuda:0', dtype=torch.float16) tensor(0.4097, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0927, device='cuda:0', dtype=torch.float16)
tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
tensor(1.2598, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
17 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.6602, device='cuda:0', dtype=torch.float16) tensor(0.2761, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.0892, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(0.9863, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0119, device='cuda:0')
tensor(0.1187, device='cuda:0')
old_score: tensor(0.0962, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0859, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.209824323654175
Validation after dual ascent:
out_inf: tensor(6.6602, device='cuda:0', dtype=torch.float16) tensor(0.2761, device='cuda:0', dtype=torch.float16)
tensor(1.5977, device='cuda:0', dtype=torch.float16) tensor(0.0894, device='cuda:0', dtype=torch.float16)
tensor(0.8477, device='cuda:0', dtype=torch.float16) tensor(0.0784, device='cuda:0', dtype=torch.float16)
tensor(0.8594, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(0.8789, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
17 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.6035, device='cuda:0', dtype=torch.float16) tensor(0.1196, device='cuda:0', dtype=torch.float16)
tensor(0.5410, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
tensor(0.4087, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.4316, device='cuda:0', dtype=torch.float16) tensor(0.0437, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0098, device='cuda:0')
tensor(0.0097, device='cuda:0')
old_score: tensor(0.0405, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0378, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 21.9872624874115
Validation after dual ascent:
out_inf: tensor(3.6035, device='cuda:0', dtype=torch.float16) tensor(0.1196, device='cuda:0', dtype=torch.float16)
tensor(0.4873, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.3777, device='cuda:0', dtype=torch.float16) tensor(0.0334, device='cuda:0', dtype=torch.float16)
tensor(0.4219, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.4731, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
layer 17 done
18 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.4375, device='cuda:0', dtype=torch.float16) tensor(0.8008, device='cuda:0', dtype=torch.float16)
tensor(1.9697, device='cuda:0', dtype=torch.float16) tensor(0.1697, device='cuda:0', dtype=torch.float16)
tensor(1.6973, device='cuda:0', dtype=torch.float16) tensor(0.1542, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1819, device='cuda:0', dtype=torch.float16)
tensor(2.0977, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(0.1841, device='cuda:0')
old_score: tensor(0.1656, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1455, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.116400241851807
Validation after dual ascent:
out_inf: tensor(14.4375, device='cuda:0', dtype=torch.float16) tensor(0.8008, device='cuda:0', dtype=torch.float16)
tensor(1.6992, device='cuda:0', dtype=torch.float16) tensor(0.1505, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.5977, device='cuda:0', dtype=torch.float16) tensor(0.1610, device='cuda:0', dtype=torch.float16)
tensor(1.9199, device='cuda:0', dtype=torch.float16) tensor(0.1372, device='cuda:0', dtype=torch.float16)
18 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.4062, device='cuda:0', dtype=torch.float16) tensor(0.9819, device='cuda:0', dtype=torch.float16)
tensor(1.4863, device='cuda:0', dtype=torch.float16) tensor(0.1716, device='cuda:0', dtype=torch.float16)
tensor(1.4365, device='cuda:0', dtype=torch.float16) tensor(0.1556, device='cuda:0', dtype=torch.float16)
tensor(1.4561, device='cuda:0', dtype=torch.float16) tensor(0.1832, device='cuda:0', dtype=torch.float16)
tensor(1.6484, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(0.1982, device='cuda:0')
old_score: tensor(0.1671, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1462, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.1465904712677
Validation after dual ascent:
out_inf: tensor(17.4062, device='cuda:0', dtype=torch.float16) tensor(0.9819, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.1514, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
tensor(1.3496, device='cuda:0', dtype=torch.float16) tensor(0.1619, device='cuda:0', dtype=torch.float16)
tensor(1.4473, device='cuda:0', dtype=torch.float16) tensor(0.1381, device='cuda:0', dtype=torch.float16)
18 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.3450, device='cuda:0', dtype=torch.float16)
tensor(1.1367, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
tensor(1.0498, device='cuda:0', dtype=torch.float16) tensor(0.1345, device='cuda:0', dtype=torch.float16)
tensor(1.1025, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0181, device='cuda:0')
tensor(0.1417, device='cuda:0')
old_score: tensor(0.1229, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1089, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.911224126815796
Validation after dual ascent:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.3450, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1129, device='cuda:0', dtype=torch.float16)
tensor(0.9160, device='cuda:0', dtype=torch.float16) tensor(0.0993, device='cuda:0', dtype=torch.float16)
tensor(1.0049, device='cuda:0', dtype=torch.float16) tensor(0.1201, device='cuda:0', dtype=torch.float16)
tensor(1.0547, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
18 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2148, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
tensor(0.4751, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(0.4204, device='cuda:0', dtype=torch.float16) tensor(0.0357, device='cuda:0', dtype=torch.float16)
tensor(0.4548, device='cuda:0', dtype=torch.float16) tensor(0.0437, device='cuda:0', dtype=torch.float16)
tensor(0.4270, device='cuda:0', dtype=torch.float16) tensor(0.0343, device='cuda:0', dtype=torch.float16)
tensor(0.0346, device='cuda:0')
old_score: tensor(0.0381, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0347, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.095170736312866
Validation after dual ascent:
out_inf: tensor(5.2148, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
tensor(0.4333, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.3975, device='cuda:0', dtype=torch.float16) tensor(0.0320, device='cuda:0', dtype=torch.float16)
tensor(0.5161, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
tensor(0.4043, device='cuda:0', dtype=torch.float16) tensor(0.0314, device='cuda:0', dtype=torch.float16)
18 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.1172, device='cuda:0', dtype=torch.float16) tensor(0.4180, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.1067, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0962, device='cuda:0', dtype=torch.float16)
tensor(1.1895, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.1270, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0174, device='cuda:0')
tensor(0.1547, device='cuda:0')
old_score: tensor(0.1036, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0916, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.204016923904419
Validation after dual ascent:
out_inf: tensor(10.1172, device='cuda:0', dtype=torch.float16) tensor(0.4180, device='cuda:0', dtype=torch.float16)
tensor(1.4795, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
tensor(1.1426, device='cuda:0', dtype=torch.float16) tensor(0.0865, device='cuda:0', dtype=torch.float16)
18 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4375, device='cuda:0', dtype=torch.float16) tensor(0.2742, device='cuda:0', dtype=torch.float16)
tensor(1.5879, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(0.8418, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
tensor(0.9531, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
tensor(1.2324, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0129, device='cuda:0')
tensor(0.1344, device='cuda:0')
old_score: tensor(0.0984, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0874, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.196035385131836
Validation after dual ascent:
out_inf: tensor(6.4375, device='cuda:0', dtype=torch.float16) tensor(0.2742, device='cuda:0', dtype=torch.float16)
tensor(1.4814, device='cuda:0', dtype=torch.float16) tensor(0.0908, device='cuda:0', dtype=torch.float16)
tensor(0.7607, device='cuda:0', dtype=torch.float16) tensor(0.0798, device='cuda:0', dtype=torch.float16)
tensor(0.8828, device='cuda:0', dtype=torch.float16) tensor(0.0963, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
18 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7734, device='cuda:0', dtype=torch.float16) tensor(0.1248, device='cuda:0', dtype=torch.float16)
tensor(0.4878, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.4255, device='cuda:0', dtype=torch.float16) tensor(0.0377, device='cuda:0', dtype=torch.float16)
tensor(0.5542, device='cuda:0', dtype=torch.float16) tensor(0.0458, device='cuda:0', dtype=torch.float16)
tensor(0.4526, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0103, device='cuda:0')
tensor(0.0212, device='cuda:0')
old_score: tensor(0.0418, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0391, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.083872079849243
Validation after dual ascent:
out_inf: tensor(4.7734, device='cuda:0', dtype=torch.float16) tensor(0.1248, device='cuda:0', dtype=torch.float16)
tensor(0.4651, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.4126, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.4849, device='cuda:0', dtype=torch.float16) tensor(0.0434, device='cuda:0', dtype=torch.float16)
tensor(0.4453, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
layer 18 done
19 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.9531, device='cuda:0', dtype=torch.float16) tensor(0.7739, device='cuda:0', dtype=torch.float16)
tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
tensor(2.0215, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
tensor(1.6279, device='cuda:0', dtype=torch.float16) tensor(0.1758, device='cuda:0', dtype=torch.float16)
tensor(1.7744, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(0.2282, device='cuda:0')
old_score: tensor(0.1606, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1404, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.123856544494629
Validation after dual ascent:
out_inf: tensor(12.9531, device='cuda:0', dtype=torch.float16) tensor(0.7739, device='cuda:0', dtype=torch.float16)
tensor(1.3770, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(1.8350, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
tensor(1.5557, device='cuda:0', dtype=torch.float16) tensor(0.1547, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
19 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18., device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(1.5918, device='cuda:0', dtype=torch.float16) tensor(0.1663, device='cuda:0', dtype=torch.float16)
tensor(1.6445, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1776, device='cuda:0', dtype=torch.float16)
tensor(1.4971, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(0.2462, device='cuda:0')
old_score: tensor(0.1627, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1412, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.148513555526733
Validation after dual ascent:
out_inf: tensor(18., device='cuda:0', dtype=torch.float16) tensor(1.0352, device='cuda:0', dtype=torch.float16)
tensor(1.2832, device='cuda:0', dtype=torch.float16) tensor(0.1459, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1305, device='cuda:0', dtype=torch.float16)
tensor(1.3301, device='cuda:0', dtype=torch.float16) tensor(0.1556, device='cuda:0', dtype=torch.float16)
tensor(1.3799, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
19 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.7891, device='cuda:0', dtype=torch.float16) tensor(0.3630, device='cuda:0', dtype=torch.float16)
tensor(1.0420, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(0.9678, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
tensor(1.0371, device='cuda:0', dtype=torch.float16) tensor(0.1182, device='cuda:0', dtype=torch.float16)
tensor(0.1512, device='cuda:0')
old_score: tensor(0.1243, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1090, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.127006769180298
Validation after dual ascent:
out_inf: tensor(3.7891, device='cuda:0', dtype=torch.float16) tensor(0.3630, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.1129, device='cuda:0', dtype=torch.float16)
tensor(0.8525, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(0.8872, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
tensor(0.9048, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
19 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.7266, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
tensor(0.4810, device='cuda:0', dtype=torch.float16) tensor(0.0456, device='cuda:0', dtype=torch.float16)
tensor(0.4829, device='cuda:0', dtype=torch.float16) tensor(0.0452, device='cuda:0', dtype=torch.float16)
tensor(0.4634, device='cuda:0', dtype=torch.float16) tensor(0.0474, device='cuda:0', dtype=torch.float16)
tensor(0.4851, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(0.0285, device='cuda:0')
old_score: tensor(0.0448, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0408, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.110729694366455
Validation after dual ascent:
out_inf: tensor(7.7266, device='cuda:0', dtype=torch.float16) tensor(0.1144, device='cuda:0', dtype=torch.float16)
tensor(0.4570, device='cuda:0', dtype=torch.float16) tensor(0.0415, device='cuda:0', dtype=torch.float16)
tensor(0.4570, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.4504, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.4685, device='cuda:0', dtype=torch.float16) tensor(0.0371, device='cuda:0', dtype=torch.float16)
19 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.5547, device='cuda:0', dtype=torch.float16) tensor(0.3989, device='cuda:0', dtype=torch.float16)
tensor(1.2363, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
tensor(1.2676, device='cuda:0', dtype=torch.float16) tensor(0.1000, device='cuda:0', dtype=torch.float16)
tensor(1.2949, device='cuda:0', dtype=torch.float16) tensor(0.1170, device='cuda:0', dtype=torch.float16)
tensor(1.5322, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0173, device='cuda:0')
tensor(0.1699, device='cuda:0')
old_score: tensor(0.1072, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0951, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.204599380493164
Validation after dual ascent:
out_inf: tensor(9.5547, device='cuda:0', dtype=torch.float16) tensor(0.3989, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(1.0547, device='cuda:0', dtype=torch.float16) tensor(0.0874, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
tensor(1.4512, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
19 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.3047, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(1.1680, device='cuda:0', dtype=torch.float16) tensor(0.1043, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(1.1191, device='cuda:0', dtype=torch.float16) tensor(0.1107, device='cuda:0', dtype=torch.float16)
tensor(1.1973, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0139, device='cuda:0')
tensor(0.1500, device='cuda:0')
old_score: tensor(0.1014, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0903, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2063586711883545
Validation after dual ascent:
out_inf: tensor(8.3047, device='cuda:0', dtype=torch.float16) tensor(0.2798, device='cuda:0', dtype=torch.float16)
tensor(1.2588, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
tensor(0.9062, device='cuda:0', dtype=torch.float16) tensor(0.0829, device='cuda:0', dtype=torch.float16)
tensor(1.0566, device='cuda:0', dtype=torch.float16) tensor(0.0994, device='cuda:0', dtype=torch.float16)
tensor(1.2656, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
19 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6797, device='cuda:0', dtype=torch.float16) tensor(0.1211, device='cuda:0', dtype=torch.float16)
tensor(0.4966, device='cuda:0', dtype=torch.float16) tensor(0.0446, device='cuda:0', dtype=torch.float16)
tensor(0.4458, device='cuda:0', dtype=torch.float16) tensor(0.0387, device='cuda:0', dtype=torch.float16)
tensor(0.4465, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.4395, device='cuda:0', dtype=torch.float16) tensor(0.0408, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0055, device='cuda:0')
tensor(0.0094, device='cuda:0')
old_score: tensor(0.0426, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0400, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.07408571243286
Validation after dual ascent:
out_inf: tensor(4.6797, device='cuda:0', dtype=torch.float16) tensor(0.1211, device='cuda:0', dtype=torch.float16)
tensor(0.5298, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
tensor(0.4109, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.4097, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
tensor(0.4409, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
layer 19 done
20 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.0156, device='cuda:0', dtype=torch.float16) tensor(0.7915, device='cuda:0', dtype=torch.float16)
tensor(1.5361, device='cuda:0', dtype=torch.float16) tensor(0.1644, device='cuda:0', dtype=torch.float16)
tensor(1.6689, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(1.6367, device='cuda:0', dtype=torch.float16) tensor(0.1758, device='cuda:0', dtype=torch.float16)
tensor(1.5381, device='cuda:0', dtype=torch.float16) tensor(0.1523, device='cuda:0', dtype=torch.float16)
tensor(0.2412, device='cuda:0')
old_score: tensor(0.1611, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1407, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.189088582992554
Validation after dual ascent:
out_inf: tensor(15.0156, device='cuda:0', dtype=torch.float16) tensor(0.7915, device='cuda:0', dtype=torch.float16)
tensor(1.4590, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.6172, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
tensor(1.6260, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(1.4766, device='cuda:0', dtype=torch.float16) tensor(0.1324, device='cuda:0', dtype=torch.float16)
20 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.1562, device='cuda:0', dtype=torch.float16) tensor(1.0273, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1663, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(1.3984, device='cuda:0', dtype=torch.float16) tensor(0.1772, device='cuda:0', dtype=torch.float16)
tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.1536, device='cuda:0', dtype=torch.float16)
tensor(0.2508, device='cuda:0')
old_score: tensor(0.1625, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1412, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.230525016784668
Validation after dual ascent:
out_inf: tensor(18.1562, device='cuda:0', dtype=torch.float16) tensor(1.0273, device='cuda:0', dtype=torch.float16)
tensor(1.3662, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
tensor(1.2334, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1556, device='cuda:0', dtype=torch.float16)
tensor(1.5234, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
20 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3477, device='cuda:0', dtype=torch.float16)
tensor(1.0537, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.0293, device='cuda:0', dtype=torch.float16) tensor(0.1163, device='cuda:0', dtype=torch.float16)
tensor(1.0703, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.1180, device='cuda:0', dtype=torch.float16)
tensor(0.1629, device='cuda:0')
old_score: tensor(0.1241, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1092, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.201791524887085
Validation after dual ascent:
out_inf: tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3477, device='cuda:0', dtype=torch.float16)
tensor(0.9902, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(0.8652, device='cuda:0', dtype=torch.float16) tensor(0.1006, device='cuda:0', dtype=torch.float16)
tensor(0.9482, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
tensor(1.1064, device='cuda:0', dtype=torch.float16) tensor(0.1032, device='cuda:0', dtype=torch.float16)
20 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.4922, device='cuda:0', dtype=torch.float16) tensor(0.1541, device='cuda:0', dtype=torch.float16)
tensor(0.5933, device='cuda:0', dtype=torch.float16) tensor(0.0551, device='cuda:0', dtype=torch.float16)
tensor(0.6299, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.6274, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.5366, device='cuda:0', dtype=torch.float16) tensor(0.0522, device='cuda:0', dtype=torch.float16)
Converged at iteration 750
tensor(0.0141, device='cuda:0')
tensor(0.0218, device='cuda:0')
old_score: tensor(0.0544, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0481, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 11.466184616088867
Validation after dual ascent:
out_inf: tensor(12.4922, device='cuda:0', dtype=torch.float16) tensor(0.1541, device='cuda:0', dtype=torch.float16)
tensor(0.4897, device='cuda:0', dtype=torch.float16) tensor(0.0488, device='cuda:0', dtype=torch.float16)
tensor(0.5132, device='cuda:0', dtype=torch.float16) tensor(0.0497, device='cuda:0', dtype=torch.float16)
tensor(0.5669, device='cuda:0', dtype=torch.float16) tensor(0.0480, device='cuda:0', dtype=torch.float16)
tensor(0.4775, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
20 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.2812, device='cuda:0', dtype=torch.float16) tensor(0.3945, device='cuda:0', dtype=torch.float16)
tensor(1.2500, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1176, device='cuda:0', dtype=torch.float16)
tensor(1.4102, device='cuda:0', dtype=torch.float16) tensor(0.0996, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0173, device='cuda:0')
tensor(0.1597, device='cuda:0')
old_score: tensor(0.1061, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0942, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.2355735301971436
Validation after dual ascent:
out_inf: tensor(7.2812, device='cuda:0', dtype=torch.float16) tensor(0.3945, device='cuda:0', dtype=torch.float16)
tensor(1.0508, device='cuda:0', dtype=torch.float16) tensor(0.0968, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0867, device='cuda:0', dtype=torch.float16)
tensor(1.3926, device='cuda:0', dtype=torch.float16) tensor(0.1052, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.0880, device='cuda:0', dtype=torch.float16)
20 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.3789, device='cuda:0', dtype=torch.float16) tensor(0.2771, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.1104, device='cuda:0', dtype=torch.float16)
tensor(1.2012, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0136, device='cuda:0')
tensor(0.1415, device='cuda:0')
old_score: tensor(0.0996, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0887, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.235934495925903
Validation after dual ascent:
out_inf: tensor(5.3789, device='cuda:0', dtype=torch.float16) tensor(0.2771, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.0912, device='cuda:0', dtype=torch.float16)
tensor(0.8477, device='cuda:0', dtype=torch.float16) tensor(0.0818, device='cuda:0', dtype=torch.float16)
tensor(0.9297, device='cuda:0', dtype=torch.float16) tensor(0.0990, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.0828, device='cuda:0', dtype=torch.float16)
20 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4062, device='cuda:0', dtype=torch.float16) tensor(0.1178, device='cuda:0', dtype=torch.float16)
tensor(0.5088, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(0.3872, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.4519, device='cuda:0', dtype=torch.float16) tensor(0.0452, device='cuda:0', dtype=torch.float16)
tensor(0.6313, device='cuda:0', dtype=torch.float16) tensor(0.0392, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0056, device='cuda:0')
tensor(0.0095, device='cuda:0')
old_score: tensor(0.0409, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0384, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.130388498306274
Validation after dual ascent:
out_inf: tensor(6.4062, device='cuda:0', dtype=torch.float16) tensor(0.1178, device='cuda:0', dtype=torch.float16)
tensor(0.5029, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
tensor(0.3960, device='cuda:0', dtype=torch.float16) tensor(0.0341, device='cuda:0', dtype=torch.float16)
tensor(0.5005, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
tensor(0.5669, device='cuda:0', dtype=torch.float16) tensor(0.0365, device='cuda:0', dtype=torch.float16)
layer 20 done
21 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.6562, device='cuda:0', dtype=torch.float16) tensor(0.7583, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(1.6172, device='cuda:0', dtype=torch.float16) tensor(0.1447, device='cuda:0', dtype=torch.float16)
tensor(1.4229, device='cuda:0', dtype=torch.float16) tensor(0.1725, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.1438, device='cuda:0', dtype=torch.float16)
tensor(0.2742, device='cuda:0')
old_score: tensor(0.1543, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1349, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.109461069107056
Validation after dual ascent:
out_inf: tensor(16.6562, device='cuda:0', dtype=torch.float16) tensor(0.7583, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.5078, device='cuda:0', dtype=torch.float16) tensor(0.1247, device='cuda:0', dtype=torch.float16)
tensor(1.2656, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
21 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.2344, device='cuda:0', dtype=torch.float16) tensor(0.9658, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.1566, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.1454, device='cuda:0', dtype=torch.float16)
tensor(1.4014, device='cuda:0', dtype=torch.float16) tensor(0.1727, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(0.2858, device='cuda:0')
old_score: tensor(0.1547, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1348, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.12852144241333
Validation after dual ascent:
out_inf: tensor(18.2344, device='cuda:0', dtype=torch.float16) tensor(0.9658, device='cuda:0', dtype=torch.float16)
tensor(1.2559, device='cuda:0', dtype=torch.float16) tensor(0.1378, device='cuda:0', dtype=torch.float16)
tensor(1.3525, device='cuda:0', dtype=torch.float16) tensor(0.1248, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.9316, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
21 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4062, device='cuda:0', dtype=torch.float16) tensor(0.3611, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
tensor(1.1035, device='cuda:0', dtype=torch.float16) tensor(0.1198, device='cuda:0', dtype=torch.float16)
tensor(1.1523, device='cuda:0', dtype=torch.float16) tensor(0.1420, device='cuda:0', dtype=torch.float16)
tensor(1.0850, device='cuda:0', dtype=torch.float16) tensor(0.1200, device='cuda:0', dtype=torch.float16)
tensor(0.2146, device='cuda:0')
old_score: tensor(0.1279, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1123, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.118720769882202
Validation after dual ascent:
out_inf: tensor(5.4062, device='cuda:0', dtype=torch.float16) tensor(0.3611, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.1152, device='cuda:0', dtype=torch.float16)
tensor(0.9253, device='cuda:0', dtype=torch.float16) tensor(0.1036, device='cuda:0', dtype=torch.float16)
tensor(1.0518, device='cuda:0', dtype=torch.float16) tensor(0.1260, device='cuda:0', dtype=torch.float16)
tensor(1.0049, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
21 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.4219, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(0.5474, device='cuda:0', dtype=torch.float16) tensor(0.0581, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0632, device='cuda:0', dtype=torch.float16)
tensor(0.7197, device='cuda:0', dtype=torch.float16) tensor(0.0627, device='cuda:0', dtype=torch.float16)
tensor(0.5898, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.0306, device='cuda:0')
old_score: tensor(0.0594, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0530, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.08765721321106
Validation after dual ascent:
out_inf: tensor(10.4219, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(0.5176, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
tensor(0.5674, device='cuda:0', dtype=torch.float16) tensor(0.0547, device='cuda:0', dtype=torch.float16)
tensor(0.6611, device='cuda:0', dtype=torch.float16) tensor(0.0573, device='cuda:0', dtype=torch.float16)
tensor(0.5488, device='cuda:0', dtype=torch.float16) tensor(0.0481, device='cuda:0', dtype=torch.float16)
21 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.0664, device='cuda:0', dtype=torch.float16) tensor(0.3892, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.1020, device='cuda:0', dtype=torch.float16)
tensor(1.1270, device='cuda:0', dtype=torch.float16) tensor(0.1204, device='cuda:0', dtype=torch.float16)
tensor(1.3008, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0178, device='cuda:0')
tensor(0.1696, device='cuda:0')
old_score: tensor(0.1082, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0963, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.202306747436523
Validation after dual ascent:
out_inf: tensor(7.0664, device='cuda:0', dtype=torch.float16) tensor(0.3892, device='cuda:0', dtype=torch.float16)
tensor(1.2871, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
tensor(0.8604, device='cuda:0', dtype=torch.float16) tensor(0.0896, device='cuda:0', dtype=torch.float16)
tensor(1.0645, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
tensor(1.2793, device='cuda:0', dtype=torch.float16) tensor(0.0896, device='cuda:0', dtype=torch.float16)
21 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9844, device='cuda:0', dtype=torch.float16) tensor(0.2717, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1017, device='cuda:0', dtype=torch.float16)
tensor(0.9258, device='cuda:0', dtype=torch.float16) tensor(0.0952, device='cuda:0', dtype=torch.float16)
tensor(1.1123, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.0942, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0140, device='cuda:0')
tensor(0.1504, device='cuda:0')
old_score: tensor(0.1008, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0900, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.198753833770752
Validation after dual ascent:
out_inf: tensor(4.9844, device='cuda:0', dtype=torch.float16) tensor(0.2717, device='cuda:0', dtype=torch.float16)
tensor(1.0342, device='cuda:0', dtype=torch.float16) tensor(0.0916, device='cuda:0', dtype=torch.float16)
tensor(0.8228, device='cuda:0', dtype=torch.float16) tensor(0.0838, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.1007, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
21 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.1855, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(0.5161, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(0.4016, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.4236, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.4824, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0056, device='cuda:0')
tensor(0.0090, device='cuda:0')
old_score: tensor(0.0396, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0372, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.063190460205078
Validation after dual ascent:
out_inf: tensor(3.1855, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(0.4648, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
tensor(0.3975, device='cuda:0', dtype=torch.float16) tensor(0.0339, device='cuda:0', dtype=torch.float16)
tensor(0.4336, device='cuda:0', dtype=torch.float16) tensor(0.0423, device='cuda:0', dtype=torch.float16)
tensor(0.4602, device='cuda:0', dtype=torch.float16) tensor(0.0348, device='cuda:0', dtype=torch.float16)
layer 21 done
22 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.2344, device='cuda:0', dtype=torch.float16) tensor(0.8213, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1624, device='cuda:0', dtype=torch.float16)
tensor(1.4854, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1816, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.1503, device='cuda:0', dtype=torch.float16)
tensor(0.0470, device='cuda:0')
old_score: tensor(0.1617, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1418, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.21151876449585
Validation after dual ascent:
out_inf: tensor(17.2344, device='cuda:0', dtype=torch.float16) tensor(0.8213, device='cuda:0', dtype=torch.float16)
tensor(1.5176, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.2910, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
tensor(1.4521, device='cuda:0', dtype=torch.float16) tensor(0.1604, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
22 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.9375, device='cuda:0', dtype=torch.float16) tensor(0.9912, device='cuda:0', dtype=torch.float16)
tensor(1.7539, device='cuda:0', dtype=torch.float16) tensor(0.1626, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.1530, device='cuda:0', dtype=torch.float16)
tensor(1.9268, device='cuda:0', dtype=torch.float16) tensor(0.1814, device='cuda:0', dtype=torch.float16)
tensor(1.4531, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(0.0546, device='cuda:0')
old_score: tensor(0.1619, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1416, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.242161273956299
Validation after dual ascent:
out_inf: tensor(20.9375, device='cuda:0', dtype=torch.float16) tensor(0.9912, device='cuda:0', dtype=torch.float16)
tensor(1.5283, device='cuda:0', dtype=torch.float16) tensor(0.1433, device='cuda:0', dtype=torch.float16)
tensor(1.2178, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
tensor(1.3955, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
22 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.4180, device='cuda:0', dtype=torch.float16) tensor(0.3730, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.1777, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(1.1084, device='cuda:0', dtype=torch.float16) tensor(0.1216, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0123, device='cuda:0')
tensor(0.1361, device='cuda:0')
old_score: tensor(0.1302, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1152, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2493770122528076
Validation after dual ascent:
out_inf: tensor(7.4180, device='cuda:0', dtype=torch.float16) tensor(0.3730, device='cuda:0', dtype=torch.float16)
tensor(1.0996, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
tensor(0.9141, device='cuda:0', dtype=torch.float16) tensor(0.1073, device='cuda:0', dtype=torch.float16)
tensor(1.0723, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
tensor(1.1309, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
22 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.3438, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(0.6333, device='cuda:0', dtype=torch.float16) tensor(0.0615, device='cuda:0', dtype=torch.float16)
tensor(0.6616, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.8267, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(0.6997, device='cuda:0', dtype=torch.float16) tensor(0.0618, device='cuda:0', dtype=torch.float16)
tensor(0.0464, device='cuda:0')
old_score: tensor(0.0632, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0572, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.185794591903687
Validation after dual ascent:
out_inf: tensor(12.3438, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(0.6982, device='cuda:0', dtype=torch.float16) tensor(0.0559, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0572, device='cuda:0', dtype=torch.float16)
tensor(0.6626, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
tensor(0.5889, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
22 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.3516, device='cuda:0', dtype=torch.float16) tensor(0.3809, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1086, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1024, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.1207, device='cuda:0', dtype=torch.float16)
tensor(1.2168, device='cuda:0', dtype=torch.float16) tensor(0.1012, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0172, device='cuda:0')
tensor(0.1625, device='cuda:0')
old_score: tensor(0.1082, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0965, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.253399610519409
Validation after dual ascent:
out_inf: tensor(10.3516, device='cuda:0', dtype=torch.float16) tensor(0.3809, device='cuda:0', dtype=torch.float16)
tensor(1.3125, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.0903, device='cuda:0', dtype=torch.float16)
tensor(0.9238, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.0899, device='cuda:0', dtype=torch.float16)
22 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2070, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
tensor(1.3555, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(1.3379, device='cuda:0', dtype=torch.float16) tensor(0.0948, device='cuda:0', dtype=torch.float16)
tensor(1.0254, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(1.0469, device='cuda:0', dtype=torch.float16) tensor(0.0938, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0137, device='cuda:0')
tensor(0.1436, device='cuda:0')
old_score: tensor(0.1002, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0896, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.250049591064453
Validation after dual ascent:
out_inf: tensor(5.2070, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
tensor(1.0586, device='cuda:0', dtype=torch.float16) tensor(0.0905, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(0.8438, device='cuda:0', dtype=torch.float16) tensor(0.1005, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0835, device='cuda:0', dtype=torch.float16)
22 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.8672, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
tensor(0.5137, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.5205, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(0.4512, device='cuda:0', dtype=torch.float16) tensor(0.0449, device='cuda:0', dtype=torch.float16)
tensor(0.4448, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0190, device='cuda:0')
tensor(0.0516, device='cuda:0')
old_score: tensor(0.0401, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0379, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.262984275817871
Validation after dual ascent:
out_inf: tensor(2.8672, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
tensor(0.4963, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(0.5220, device='cuda:0', dtype=torch.float16) tensor(0.0343, device='cuda:0', dtype=torch.float16)
tensor(0.4199, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
tensor(0.4248, device='cuda:0', dtype=torch.float16) tensor(0.0355, device='cuda:0', dtype=torch.float16)
layer 22 done
23 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.8906, device='cuda:0', dtype=torch.float16) tensor(0.8198, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.1708, device='cuda:0', dtype=torch.float16)
tensor(1.8730, device='cuda:0', dtype=torch.float16) tensor(0.1620, device='cuda:0', dtype=torch.float16)
tensor(1.9941, device='cuda:0', dtype=torch.float16) tensor(0.1923, device='cuda:0', dtype=torch.float16)
tensor(1.5186, device='cuda:0', dtype=torch.float16) tensor(0.1593, device='cuda:0', dtype=torch.float16)
tensor(0.2045, device='cuda:0')
old_score: tensor(0.1710, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1506, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.133460521697998
Validation after dual ascent:
out_inf: tensor(18.8906, device='cuda:0', dtype=torch.float16) tensor(0.8198, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.1514, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
tensor(1.8018, device='cuda:0', dtype=torch.float16) tensor(0.1709, device='cuda:0', dtype=torch.float16)
tensor(1.2881, device='cuda:0', dtype=torch.float16) tensor(0.1394, device='cuda:0', dtype=torch.float16)
23 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(0.9692, device='cuda:0', dtype=torch.float16)
tensor(1.8301, device='cuda:0', dtype=torch.float16) tensor(0.1707, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(2.0430, device='cuda:0', dtype=torch.float16) tensor(0.1924, device='cuda:0', dtype=torch.float16)
tensor(1.4551, device='cuda:0', dtype=torch.float16) tensor(0.1595, device='cuda:0', dtype=torch.float16)
tensor(0.2151, device='cuda:0')
old_score: tensor(0.1715, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1506, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.15272045135498
Validation after dual ascent:
out_inf: tensor(18.8281, device='cuda:0', dtype=torch.float16) tensor(0.9692, device='cuda:0', dtype=torch.float16)
tensor(1.8379, device='cuda:0', dtype=torch.float16) tensor(0.1511, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1412, device='cuda:0', dtype=torch.float16)
tensor(1.9180, device='cuda:0', dtype=torch.float16) tensor(0.1707, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
23 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0156, device='cuda:0', dtype=torch.float16) tensor(0.4146, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1461, device='cuda:0', dtype=torch.float16)
tensor(1.2461, device='cuda:0', dtype=torch.float16) tensor(0.1387, device='cuda:0', dtype=torch.float16)
tensor(1.1943, device='cuda:0', dtype=torch.float16) tensor(0.1630, device='cuda:0', dtype=torch.float16)
tensor(1.1689, device='cuda:0', dtype=torch.float16) tensor(0.1365, device='cuda:0', dtype=torch.float16)
tensor(0.1704, device='cuda:0')
old_score: tensor(0.1460, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1292, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.150369644165039
Validation after dual ascent:
out_inf: tensor(5.0156, device='cuda:0', dtype=torch.float16) tensor(0.4146, device='cuda:0', dtype=torch.float16)
tensor(1.1299, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
tensor(1.1777, device='cuda:0', dtype=torch.float16) tensor(0.1210, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(1.1787, device='cuda:0', dtype=torch.float16) tensor(0.1197, device='cuda:0', dtype=torch.float16)
23 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.4688, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
tensor(0.6318, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(0.7373, device='cuda:0', dtype=torch.float16) tensor(0.0706, device='cuda:0', dtype=torch.float16)
tensor(0.7339, device='cuda:0', dtype=torch.float16) tensor(0.0619, device='cuda:0', dtype=torch.float16)
tensor(0.6084, device='cuda:0', dtype=torch.float16) tensor(0.0585, device='cuda:0', dtype=torch.float16)
tensor(0.0794, device='cuda:0')
old_score: tensor(0.0640, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0580, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.11206603050232
Validation after dual ascent:
out_inf: tensor(16.4688, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
tensor(0.5537, device='cuda:0', dtype=torch.float16) tensor(0.0578, device='cuda:0', dtype=torch.float16)
tensor(0.7070, device='cuda:0', dtype=torch.float16) tensor(0.0622, device='cuda:0', dtype=torch.float16)
tensor(0.6982, device='cuda:0', dtype=torch.float16) tensor(0.0581, device='cuda:0', dtype=torch.float16)
tensor(0.7051, device='cuda:0', dtype=torch.float16) tensor(0.0539, device='cuda:0', dtype=torch.float16)
23 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.5312, device='cuda:0', dtype=torch.float16) tensor(0.4023, device='cuda:0', dtype=torch.float16)
tensor(1.1211, device='cuda:0', dtype=torch.float16) tensor(0.1161, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
tensor(1.3232, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(1.1953, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0198, device='cuda:0')
tensor(0.2108, device='cuda:0')
old_score: tensor(0.1160, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1033, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.213373899459839
Validation after dual ascent:
out_inf: tensor(9.5312, device='cuda:0', dtype=torch.float16) tensor(0.4023, device='cuda:0', dtype=torch.float16)
tensor(1.0283, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
tensor(0.9434, device='cuda:0', dtype=torch.float16) tensor(0.0968, device='cuda:0', dtype=torch.float16)
tensor(1.2559, device='cuda:0', dtype=torch.float16) tensor(0.1168, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
23 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.8203, device='cuda:0', dtype=torch.float16) tensor(0.2935, device='cuda:0', dtype=torch.float16)
tensor(1.5000, device='cuda:0', dtype=torch.float16) tensor(0.1079, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.1024, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1208, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0162, device='cuda:0')
tensor(0.1889, device='cuda:0')
old_score: tensor(0.1078, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0963, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.212446928024292
Validation after dual ascent:
out_inf: tensor(6.8203, device='cuda:0', dtype=torch.float16) tensor(0.2935, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(0.9824, device='cuda:0', dtype=torch.float16) tensor(0.0903, device='cuda:0', dtype=torch.float16)
tensor(0.9126, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(0.8579, device='cuda:0', dtype=torch.float16) tensor(0.0891, device='cuda:0', dtype=torch.float16)
23 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.6992, device='cuda:0', dtype=torch.float16) tensor(0.1285, device='cuda:0', dtype=torch.float16)
tensor(0.5659, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.4595, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
tensor(0.5010, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.5337, device='cuda:0', dtype=torch.float16) tensor(0.0426, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0075, device='cuda:0')
tensor(0.0632, device='cuda:0')
old_score: tensor(0.0456, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0431, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.229971408843994
Validation after dual ascent:
out_inf: tensor(7.6992, device='cuda:0', dtype=torch.float16) tensor(0.1285, device='cuda:0', dtype=torch.float16)
tensor(0.5508, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.4341, device='cuda:0', dtype=torch.float16) tensor(0.0394, device='cuda:0', dtype=torch.float16)
tensor(0.5059, device='cuda:0', dtype=torch.float16) tensor(0.0492, device='cuda:0', dtype=torch.float16)
tensor(0.5635, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
layer 23 done
24 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.7344, device='cuda:0', dtype=torch.float16) tensor(0.7886, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.1608, device='cuda:0', dtype=torch.float16)
tensor(2.1367, device='cuda:0', dtype=torch.float16) tensor(0.1533, device='cuda:0', dtype=torch.float16)
tensor(1.7412, device='cuda:0', dtype=torch.float16) tensor(0.1819, device='cuda:0', dtype=torch.float16)
tensor(1.4355, device='cuda:0', dtype=torch.float16) tensor(0.1488, device='cuda:0', dtype=torch.float16)
tensor(0.3704, device='cuda:0')
old_score: tensor(0.1611, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1421, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.132893085479736
Validation after dual ascent:
out_inf: tensor(16.7344, device='cuda:0', dtype=torch.float16) tensor(0.7886, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.1335, device='cuda:0', dtype=torch.float16)
tensor(1.6367, device='cuda:0', dtype=torch.float16) tensor(0.1620, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.1304, device='cuda:0', dtype=torch.float16)
24 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.5156, device='cuda:0', dtype=torch.float16) tensor(0.9941, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1602, device='cuda:0', dtype=torch.float16)
tensor(1.2920, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.1815, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1486, device='cuda:0', dtype=torch.float16)
tensor(0.3944, device='cuda:0')
old_score: tensor(0.1610, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1415, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.163318634033203
Validation after dual ascent:
out_inf: tensor(17.5156, device='cuda:0', dtype=torch.float16) tensor(0.9941, device='cuda:0', dtype=torch.float16)
tensor(1.3184, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.1191, device='cuda:0', dtype=torch.float16) tensor(0.1332, device='cuda:0', dtype=torch.float16)
tensor(1.4307, device='cuda:0', dtype=torch.float16) tensor(0.1610, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.1298, device='cuda:0', dtype=torch.float16)
24 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2617, device='cuda:0', dtype=torch.float16) tensor(0.4102, device='cuda:0', dtype=torch.float16)
tensor(1.2119, device='cuda:0', dtype=torch.float16) tensor(0.1421, device='cuda:0', dtype=torch.float16)
tensor(1.1621, device='cuda:0', dtype=torch.float16) tensor(0.1356, device='cuda:0', dtype=torch.float16)
tensor(1.2402, device='cuda:0', dtype=torch.float16) tensor(0.1603, device='cuda:0', dtype=torch.float16)
tensor(1.1504, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(0.2627, device='cuda:0')
old_score: tensor(0.1426, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1261, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.164125442504883
Validation after dual ascent:
out_inf: tensor(5.2617, device='cuda:0', dtype=torch.float16) tensor(0.4102, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1265, device='cuda:0', dtype=torch.float16)
tensor(1.1475, device='cuda:0', dtype=torch.float16) tensor(0.1183, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.1433, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.1160, device='cuda:0', dtype=torch.float16)
24 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.0391, device='cuda:0', dtype=torch.float16) tensor(0.1899, device='cuda:0', dtype=torch.float16)
tensor(0.9189, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
tensor(0.7876, device='cuda:0', dtype=torch.float16) tensor(0.0826, device='cuda:0', dtype=torch.float16)
tensor(0.8916, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
tensor(0.7310, device='cuda:0', dtype=torch.float16) tensor(0.0756, device='cuda:0', dtype=torch.float16)
tensor(0.0745, device='cuda:0')
old_score: tensor(0.0807, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0742, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.130777359008789
Validation after dual ascent:
out_inf: tensor(15.0391, device='cuda:0', dtype=torch.float16) tensor(0.1899, device='cuda:0', dtype=torch.float16)
tensor(0.8506, device='cuda:0', dtype=torch.float16) tensor(0.0694, device='cuda:0', dtype=torch.float16)
tensor(0.7744, device='cuda:0', dtype=torch.float16) tensor(0.0751, device='cuda:0', dtype=torch.float16)
tensor(0.8008, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(0.7642, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
24 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.7344, device='cuda:0', dtype=torch.float16) tensor(0.4077, device='cuda:0', dtype=torch.float16)
tensor(1.2871, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0116, device='cuda:0')
tensor(0.0307, device='cuda:0')
old_score: tensor(0.1187, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1061, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.18571949005127
Validation after dual ascent:
out_inf: tensor(9.7344, device='cuda:0', dtype=torch.float16) tensor(0.4077, device='cuda:0', dtype=torch.float16)
tensor(1.0547, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.1190, device='cuda:0', dtype=torch.float16)
tensor(1.1191, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
24 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2852, device='cuda:0', dtype=torch.float16) tensor(0.2991, device='cuda:0', dtype=torch.float16)
tensor(1.1621, device='cuda:0', dtype=torch.float16) tensor(0.1102, device='cuda:0', dtype=torch.float16)
tensor(0.9590, device='cuda:0', dtype=torch.float16) tensor(0.1057, device='cuda:0', dtype=torch.float16)
tensor(1.1426, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.1030, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0167, device='cuda:0')
tensor(0.1970, device='cuda:0')
old_score: tensor(0.1105, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0989, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.21817684173584
Validation after dual ascent:
out_inf: tensor(5.2852, device='cuda:0', dtype=torch.float16) tensor(0.2991, device='cuda:0', dtype=torch.float16)
tensor(1.0449, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(0.9277, device='cuda:0', dtype=torch.float16) tensor(0.1109, device='cuda:0', dtype=torch.float16)
tensor(0.8965, device='cuda:0', dtype=torch.float16) tensor(0.0919, device='cuda:0', dtype=torch.float16)
24 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8867, device='cuda:0', dtype=torch.float16) tensor(0.1342, device='cuda:0', dtype=torch.float16)
tensor(0.5005, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
tensor(0.5249, device='cuda:0', dtype=torch.float16) tensor(0.0440, device='cuda:0', dtype=torch.float16)
tensor(0.5449, device='cuda:0', dtype=torch.float16) tensor(0.0524, device='cuda:0', dtype=torch.float16)
tensor(0.4976, device='cuda:0', dtype=torch.float16) tensor(0.0442, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0077, device='cuda:0')
tensor(0.0677, device='cuda:0')
old_score: tensor(0.0472, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0447, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.223373889923096
Validation after dual ascent:
out_inf: tensor(4.8867, device='cuda:0', dtype=torch.float16) tensor(0.1342, device='cuda:0', dtype=torch.float16)
tensor(0.5088, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.5303, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(0.5459, device='cuda:0', dtype=torch.float16) tensor(0.0504, device='cuda:0', dtype=torch.float16)
tensor(0.4841, device='cuda:0', dtype=torch.float16) tensor(0.0415, device='cuda:0', dtype=torch.float16)
layer 24 done
25 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.2031, device='cuda:0', dtype=torch.float16) tensor(0.7827, device='cuda:0', dtype=torch.float16)
tensor(1.8477, device='cuda:0', dtype=torch.float16) tensor(0.1710, device='cuda:0', dtype=torch.float16)
tensor(1.6934, device='cuda:0', dtype=torch.float16) tensor(0.1652, device='cuda:0', dtype=torch.float16)
tensor(1.9521, device='cuda:0', dtype=torch.float16) tensor(0.1943, device='cuda:0', dtype=torch.float16)
tensor(2.1719, device='cuda:0', dtype=torch.float16) tensor(0.1587, device='cuda:0', dtype=torch.float16)
tensor(0.1774, device='cuda:0')
old_score: tensor(0.1722, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1526, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.120549201965332
Validation after dual ascent:
out_inf: tensor(12.2031, device='cuda:0', dtype=torch.float16) tensor(0.7827, device='cuda:0', dtype=torch.float16)
tensor(1.5137, device='cuda:0', dtype=torch.float16) tensor(0.1523, device='cuda:0', dtype=torch.float16)
tensor(1.5605, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(1.8418, device='cuda:0', dtype=torch.float16) tensor(0.1737, device='cuda:0', dtype=torch.float16)
tensor(1.9287, device='cuda:0', dtype=torch.float16) tensor(0.1399, device='cuda:0', dtype=torch.float16)
25 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.1719, device='cuda:0', dtype=torch.float16) tensor(0.9277, device='cuda:0', dtype=torch.float16)
tensor(1.9551, device='cuda:0', dtype=torch.float16) tensor(0.1710, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.1938, device='cuda:0', dtype=torch.float16)
tensor(1.5859, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(0.2055, device='cuda:0')
old_score: tensor(0.1724, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1525, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.142428398132324
Validation after dual ascent:
out_inf: tensor(17.1719, device='cuda:0', dtype=torch.float16) tensor(0.9277, device='cuda:0', dtype=torch.float16)
tensor(1.7393, device='cuda:0', dtype=torch.float16) tensor(0.1523, device='cuda:0', dtype=torch.float16)
tensor(1.2822, device='cuda:0', dtype=torch.float16) tensor(0.1447, device='cuda:0', dtype=torch.float16)
tensor(1.5859, device='cuda:0', dtype=torch.float16) tensor(0.1731, device='cuda:0', dtype=torch.float16)
tensor(1.5000, device='cuda:0', dtype=torch.float16) tensor(0.1399, device='cuda:0', dtype=torch.float16)
25 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6406, device='cuda:0', dtype=torch.float16) tensor(0.4363, device='cuda:0', dtype=torch.float16)
tensor(1.3672, device='cuda:0', dtype=torch.float16) tensor(0.1549, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.1495, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1753, device='cuda:0', dtype=torch.float16)
tensor(1.2832, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(0.1282, device='cuda:0')
old_score: tensor(0.1558, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1385, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.147949695587158
Validation after dual ascent:
out_inf: tensor(5.6406, device='cuda:0', dtype=torch.float16) tensor(0.4363, device='cuda:0', dtype=torch.float16)
tensor(1.5732, device='cuda:0', dtype=torch.float16) tensor(0.1385, device='cuda:0', dtype=torch.float16)
tensor(1.2178, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
tensor(1.2432, device='cuda:0', dtype=torch.float16) tensor(0.1573, device='cuda:0', dtype=torch.float16)
tensor(1.2197, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
25 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.3594, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(0.6807, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.6792, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
tensor(0.6992, device='cuda:0', dtype=torch.float16) tensor(0.0641, device='cuda:0', dtype=torch.float16)
tensor(0.5928, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
tensor(0.0872, device='cuda:0')
old_score: tensor(0.0611, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0552, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.101977825164795
Validation after dual ascent:
out_inf: tensor(5.3594, device='cuda:0', dtype=torch.float16) tensor(0.1436, device='cuda:0', dtype=torch.float16)
tensor(0.6982, device='cuda:0', dtype=torch.float16) tensor(0.0525, device='cuda:0', dtype=torch.float16)
tensor(0.5806, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.6201, device='cuda:0', dtype=torch.float16) tensor(0.0591, device='cuda:0', dtype=torch.float16)
tensor(0.5728, device='cuda:0', dtype=torch.float16) tensor(0.0532, device='cuda:0', dtype=torch.float16)
25 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.1094, device='cuda:0', dtype=torch.float16) tensor(0.4355, device='cuda:0', dtype=torch.float16)
tensor(1.1445, device='cuda:0', dtype=torch.float16) tensor(0.1205, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(1.2227, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.4766, device='cuda:0', dtype=torch.float16) tensor(0.1120, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0130, device='cuda:0')
tensor(0.0351, device='cuda:0')
old_score: tensor(0.1212, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1080, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.173843145370483
Validation after dual ascent:
out_inf: tensor(9.1094, device='cuda:0', dtype=torch.float16) tensor(0.4355, device='cuda:0', dtype=torch.float16)
tensor(1.0518, device='cuda:0', dtype=torch.float16) tensor(0.1080, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
tensor(1.1562, device='cuda:0', dtype=torch.float16) tensor(0.0994, device='cuda:0', dtype=torch.float16)
25 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.1641, device='cuda:0', dtype=torch.float16) tensor(0.3142, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(1.1523, device='cuda:0', dtype=torch.float16) tensor(0.1085, device='cuda:0', dtype=torch.float16)
tensor(1.3633, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0179, device='cuda:0')
tensor(0.2131, device='cuda:0')
old_score: tensor(0.1130, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1011, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.211523056030273
Validation after dual ascent:
out_inf: tensor(8.1641, device='cuda:0', dtype=torch.float16) tensor(0.3142, device='cuda:0', dtype=torch.float16)
tensor(1.0879, device='cuda:0', dtype=torch.float16) tensor(0.1012, device='cuda:0', dtype=torch.float16)
tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(1.0156, device='cuda:0', dtype=torch.float16) tensor(0.0931, device='cuda:0', dtype=torch.float16)
25 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.0742, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(0.6172, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
tensor(0.6025, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.5571, device='cuda:0', dtype=torch.float16) tensor(0.0560, device='cuda:0', dtype=torch.float16)
tensor(0.5400, device='cuda:0', dtype=torch.float16) tensor(0.0460, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0098, device='cuda:0')
tensor(0.0790, device='cuda:0')
old_score: tensor(0.0499, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0471, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.086415767669678
Validation after dual ascent:
out_inf: tensor(3.0742, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(0.5967, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.6260, device='cuda:0', dtype=torch.float16) tensor(0.0437, device='cuda:0', dtype=torch.float16)
tensor(0.5352, device='cuda:0', dtype=torch.float16) tensor(0.0537, device='cuda:0', dtype=torch.float16)
tensor(0.4919, device='cuda:0', dtype=torch.float16) tensor(0.0431, device='cuda:0', dtype=torch.float16)
layer 25 done
26 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.0938, device='cuda:0', dtype=torch.float16) tensor(0.8467, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.1729, device='cuda:0', dtype=torch.float16)
tensor(1.9043, device='cuda:0', dtype=torch.float16) tensor(0.1693, device='cuda:0', dtype=torch.float16)
tensor(1.6123, device='cuda:0', dtype=torch.float16) tensor(0.1949, device='cuda:0', dtype=torch.float16)
tensor(1.5449, device='cuda:0', dtype=torch.float16) tensor(0.1598, device='cuda:0', dtype=torch.float16)
tensor(0.2020, device='cuda:0')
old_score: tensor(0.1742, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1537, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.108917951583862
Validation after dual ascent:
out_inf: tensor(14.0938, device='cuda:0', dtype=torch.float16) tensor(0.8467, device='cuda:0', dtype=torch.float16)
tensor(1.5254, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1475, device='cuda:0', dtype=torch.float16)
tensor(1.5225, device='cuda:0', dtype=torch.float16) tensor(0.1738, device='cuda:0', dtype=torch.float16)
tensor(1.3613, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
26 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.1875, device='cuda:0', dtype=torch.float16) tensor(1.0312, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.1729, device='cuda:0', dtype=torch.float16)
tensor(1.5371, device='cuda:0', dtype=torch.float16) tensor(0.1708, device='cuda:0', dtype=torch.float16)
tensor(1.5420, device='cuda:0', dtype=torch.float16) tensor(0.1947, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1602, device='cuda:0', dtype=torch.float16)
tensor(0.2021, device='cuda:0')
old_score: tensor(0.1747, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1536, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.130330801010132
Validation after dual ascent:
out_inf: tensor(18.1875, device='cuda:0', dtype=torch.float16) tensor(1.0312, device='cuda:0', dtype=torch.float16)
tensor(1.4414, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1733, device='cuda:0', dtype=torch.float16)
tensor(1.2158, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
26 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.6797, device='cuda:0', dtype=torch.float16) tensor(0.4578, device='cuda:0', dtype=torch.float16)
tensor(1.4121, device='cuda:0', dtype=torch.float16) tensor(0.1597, device='cuda:0', dtype=torch.float16)
tensor(1.5078, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(1.3916, device='cuda:0', dtype=torch.float16) tensor(0.1799, device='cuda:0', dtype=torch.float16)
tensor(1.3848, device='cuda:0', dtype=torch.float16) tensor(0.1488, device='cuda:0', dtype=torch.float16)
tensor(0.1558, device='cuda:0')
old_score: tensor(0.1613, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1431, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.144270181655884
Validation after dual ascent:
out_inf: tensor(6.6797, device='cuda:0', dtype=torch.float16) tensor(0.4578, device='cuda:0', dtype=torch.float16)
tensor(1.2617, device='cuda:0', dtype=torch.float16) tensor(0.1426, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(1.1279, device='cuda:0', dtype=torch.float16) tensor(0.1310, device='cuda:0', dtype=torch.float16)
26 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(27.2344, device='cuda:0', dtype=torch.float16) tensor(0.2139, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
tensor(0.8447, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.9575, device='cuda:0', dtype=torch.float16) tensor(0.0952, device='cuda:0', dtype=torch.float16)
tensor(0.7969, device='cuda:0', dtype=torch.float16) tensor(0.0764, device='cuda:0', dtype=torch.float16)
tensor(0.0439, device='cuda:0')
old_score: tensor(0.0847, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0762, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.096648693084717
Validation after dual ascent:
out_inf: tensor(27.2344, device='cuda:0', dtype=torch.float16) tensor(0.2139, device='cuda:0', dtype=torch.float16)
tensor(0.7837, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.8213, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(0.7539, device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
tensor(0.7212, device='cuda:0', dtype=torch.float16) tensor(0.0700, device='cuda:0', dtype=torch.float16)
26 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.0781, device='cuda:0', dtype=torch.float16) tensor(0.4675, device='cuda:0', dtype=torch.float16)
tensor(1.2031, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.1185, device='cuda:0', dtype=torch.float16)
tensor(1.2402, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.1128, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0156, device='cuda:0')
tensor(0.0375, device='cuda:0')
old_score: tensor(0.1222, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1085, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.173659086227417
Validation after dual ascent:
out_inf: tensor(8.0781, device='cuda:0', dtype=torch.float16) tensor(0.4675, device='cuda:0', dtype=torch.float16)
tensor(1.0098, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(0.9951, device='cuda:0', dtype=torch.float16) tensor(0.1038, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1218, device='cuda:0', dtype=torch.float16)
tensor(1.1035, device='cuda:0', dtype=torch.float16) tensor(0.1001, device='cuda:0', dtype=torch.float16)
26 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.0273, device='cuda:0', dtype=torch.float16) tensor(0.3342, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(1.3320, device='cuda:0', dtype=torch.float16) tensor(0.1110, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.2793, device='cuda:0', dtype=torch.float16) tensor(0.1058, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0190, device='cuda:0')
tensor(0.2184, device='cuda:0')
old_score: tensor(0.1144, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1020, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.212718725204468
Validation after dual ascent:
out_inf: tensor(6.0273, device='cuda:0', dtype=torch.float16) tensor(0.3342, device='cuda:0', dtype=torch.float16)
tensor(1.0928, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.0976, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.1145, device='cuda:0', dtype=torch.float16)
tensor(1.0752, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
26 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.6035, device='cuda:0', dtype=torch.float16) tensor(0.1635, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0531, device='cuda:0', dtype=torch.float16)
tensor(0.5991, device='cuda:0', dtype=torch.float16) tensor(0.0501, device='cuda:0', dtype=torch.float16)
tensor(0.5938, device='cuda:0', dtype=torch.float16) tensor(0.0582, device='cuda:0', dtype=torch.float16)
tensor(0.5718, device='cuda:0', dtype=torch.float16) tensor(0.0487, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0105, device='cuda:0')
tensor(0.0913, device='cuda:0')
old_score: tensor(0.0526, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0494, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.169823169708252
Validation after dual ascent:
out_inf: tensor(3.6035, device='cuda:0', dtype=torch.float16) tensor(0.1635, device='cuda:0', dtype=torch.float16)
tensor(0.6055, device='cuda:0', dtype=torch.float16) tensor(0.0500, device='cuda:0', dtype=torch.float16)
tensor(0.5684, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.5835, device='cuda:0', dtype=torch.float16) tensor(0.0556, device='cuda:0', dtype=torch.float16)
tensor(0.5474, device='cuda:0', dtype=torch.float16) tensor(0.0455, device='cuda:0', dtype=torch.float16)
layer 26 done
27 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15., device='cuda:0', dtype=torch.float16) tensor(0.8130, device='cuda:0', dtype=torch.float16)
tensor(1.5791, device='cuda:0', dtype=torch.float16) tensor(0.1735, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.1700, device='cuda:0', dtype=torch.float16)
tensor(1.6191, device='cuda:0', dtype=torch.float16) tensor(0.1956, device='cuda:0', dtype=torch.float16)
tensor(1.5137, device='cuda:0', dtype=torch.float16) tensor(0.1598, device='cuda:0', dtype=torch.float16)
tensor(0.2055, device='cuda:0')
old_score: tensor(0.1747, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1536, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.211582899093628
Validation after dual ascent:
out_inf: tensor(15., device='cuda:0', dtype=torch.float16) tensor(0.8130, device='cuda:0', dtype=torch.float16)
tensor(1.4746, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.1472, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1742, device='cuda:0', dtype=torch.float16)
tensor(1.2588, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
27 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.5781, device='cuda:0', dtype=torch.float16) tensor(0.9517, device='cuda:0', dtype=torch.float16)
tensor(1.5752, device='cuda:0', dtype=torch.float16) tensor(0.1742, device='cuda:0', dtype=torch.float16)
tensor(1.4551, device='cuda:0', dtype=torch.float16) tensor(0.1711, device='cuda:0', dtype=torch.float16)
tensor(1.7910, device='cuda:0', dtype=torch.float16) tensor(0.1963, device='cuda:0', dtype=torch.float16)
tensor(1.4414, device='cuda:0', dtype=torch.float16) tensor(0.1609, device='cuda:0', dtype=torch.float16)
tensor(0.2082, device='cuda:0')
old_score: tensor(0.1755, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1543, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.232669353485107
Validation after dual ascent:
out_inf: tensor(17.5781, device='cuda:0', dtype=torch.float16) tensor(0.9517, device='cuda:0', dtype=torch.float16)
tensor(1.4277, device='cuda:0', dtype=torch.float16) tensor(0.1534, device='cuda:0', dtype=torch.float16)
tensor(1.2715, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.4482, device='cuda:0', dtype=torch.float16) tensor(0.1748, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
27 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.7578, device='cuda:0', dtype=torch.float16) tensor(0.4390, device='cuda:0', dtype=torch.float16)
tensor(1.3154, device='cuda:0', dtype=torch.float16) tensor(0.1516, device='cuda:0', dtype=torch.float16)
tensor(1.4199, device='cuda:0', dtype=torch.float16) tensor(0.1493, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.1715, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1407, device='cuda:0', dtype=torch.float16)
tensor(0.1538, device='cuda:0')
old_score: tensor(0.1532, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1360, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.236676692962646
Validation after dual ascent:
out_inf: tensor(7.7578, device='cuda:0', dtype=torch.float16) tensor(0.4390, device='cuda:0', dtype=torch.float16)
tensor(1.2148, device='cuda:0', dtype=torch.float16) tensor(0.1351, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.1306, device='cuda:0', dtype=torch.float16)
tensor(1.2959, device='cuda:0', dtype=torch.float16) tensor(0.1541, device='cuda:0', dtype=torch.float16)
tensor(1.1992, device='cuda:0', dtype=torch.float16) tensor(0.1244, device='cuda:0', dtype=torch.float16)
27 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.3516, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(0.5547, device='cuda:0', dtype=torch.float16) tensor(0.0366, device='cuda:0', dtype=torch.float16)
tensor(0.5078, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.6675, device='cuda:0', dtype=torch.float16) tensor(0.0383, device='cuda:0', dtype=torch.float16)
tensor(0.6064, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
tensor(0.0802, device='cuda:0')
old_score: tensor(0.0383, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0345, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.190659284591675
Validation after dual ascent:
out_inf: tensor(5.3516, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(0.4883, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(0.4678, device='cuda:0', dtype=torch.float16) tensor(0.0352, device='cuda:0', dtype=torch.float16)
tensor(0.6318, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.5093, device='cuda:0', dtype=torch.float16) tensor(0.0343, device='cuda:0', dtype=torch.float16)
27 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.5078, device='cuda:0', dtype=torch.float16) tensor(0.4958, device='cuda:0', dtype=torch.float16)
tensor(1.1992, device='cuda:0', dtype=torch.float16) tensor(0.1229, device='cuda:0', dtype=torch.float16)
tensor(1.2754, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
tensor(1.1680, device='cuda:0', dtype=torch.float16) tensor(0.1384, device='cuda:0', dtype=torch.float16)
tensor(1.3125, device='cuda:0', dtype=torch.float16) tensor(0.1137, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0175, device='cuda:0')
tensor(0.0427, device='cuda:0')
old_score: tensor(0.1238, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1093, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.235098838806152
Validation after dual ascent:
out_inf: tensor(10.5078, device='cuda:0', dtype=torch.float16) tensor(0.4958, device='cuda:0', dtype=torch.float16)
tensor(1.2021, device='cuda:0', dtype=torch.float16) tensor(0.1090, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.1043, device='cuda:0', dtype=torch.float16)
tensor(1.0938, device='cuda:0', dtype=torch.float16) tensor(0.1240, device='cuda:0', dtype=torch.float16)
tensor(0.9902, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
27 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1641, device='cuda:0', dtype=torch.float16) tensor(0.3606, device='cuda:0', dtype=torch.float16)
tensor(1.2227, device='cuda:0', dtype=torch.float16) tensor(0.1161, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
tensor(1.2988, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(1.3809, device='cuda:0', dtype=torch.float16) tensor(0.1076, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0112, device='cuda:0')
tensor(0.0346, device='cuda:0')
old_score: tensor(0.1170, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1036, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.233502388000488
Validation after dual ascent:
out_inf: tensor(7.1641, device='cuda:0', dtype=torch.float16) tensor(0.3606, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
tensor(1.2109, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
tensor(1.1592, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
27 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.4121, device='cuda:0', dtype=torch.float16) tensor(0.1826, device='cuda:0', dtype=torch.float16)
tensor(0.7256, device='cuda:0', dtype=torch.float16) tensor(0.0576, device='cuda:0', dtype=torch.float16)
tensor(0.6865, device='cuda:0', dtype=torch.float16) tensor(0.0550, device='cuda:0', dtype=torch.float16)
tensor(0.6553, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(0.6001, device='cuda:0', dtype=torch.float16) tensor(0.0524, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0126, device='cuda:0')
tensor(0.1102, device='cuda:0')
old_score: tensor(0.0571, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0535, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.1986243724823
Validation after dual ascent:
out_inf: tensor(2.4121, device='cuda:0', dtype=torch.float16) tensor(0.1826, device='cuda:0', dtype=torch.float16)
tensor(0.6406, device='cuda:0', dtype=torch.float16) tensor(0.0539, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0509, device='cuda:0', dtype=torch.float16)
tensor(0.6323, device='cuda:0', dtype=torch.float16) tensor(0.0604, device='cuda:0', dtype=torch.float16)
tensor(0.5420, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
layer 27 done
28 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.5469, device='cuda:0', dtype=torch.float16) tensor(0.8384, device='cuda:0', dtype=torch.float16)
tensor(1.8262, device='cuda:0', dtype=torch.float16) tensor(0.1741, device='cuda:0', dtype=torch.float16)
tensor(1.6943, device='cuda:0', dtype=torch.float16) tensor(0.1714, device='cuda:0', dtype=torch.float16)
tensor(1.8965, device='cuda:0', dtype=torch.float16) tensor(0.1967, device='cuda:0', dtype=torch.float16)
tensor(1.8516, device='cuda:0', dtype=torch.float16) tensor(0.1610, device='cuda:0', dtype=torch.float16)
tensor(0.1955, device='cuda:0')
old_score: tensor(0.1758, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1539, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.188623189926147
Validation after dual ascent:
out_inf: tensor(15.5469, device='cuda:0', dtype=torch.float16) tensor(0.8384, device='cuda:0', dtype=torch.float16)
tensor(1.4609, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1477, device='cuda:0', dtype=torch.float16)
tensor(1.7451, device='cuda:0', dtype=torch.float16) tensor(0.1747, device='cuda:0', dtype=torch.float16)
tensor(1.7100, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
28 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.0156, device='cuda:0', dtype=torch.float16) tensor(1.0068, device='cuda:0', dtype=torch.float16)
tensor(1.8184, device='cuda:0', dtype=torch.float16) tensor(0.1757, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1730, device='cuda:0', dtype=torch.float16)
tensor(1.5742, device='cuda:0', dtype=torch.float16) tensor(0.1978, device='cuda:0', dtype=torch.float16)
tensor(1.5391, device='cuda:0', dtype=torch.float16) tensor(0.1616, device='cuda:0', dtype=torch.float16)
tensor(0.2006, device='cuda:0')
old_score: tensor(0.1770, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1548, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.214575290679932
Validation after dual ascent:
out_inf: tensor(20.0156, device='cuda:0', dtype=torch.float16) tensor(1.0068, device='cuda:0', dtype=torch.float16)
tensor(1.6279, device='cuda:0', dtype=torch.float16) tensor(0.1539, device='cuda:0', dtype=torch.float16)
tensor(1.3818, device='cuda:0', dtype=torch.float16) tensor(0.1486, device='cuda:0', dtype=torch.float16)
tensor(1.4863, device='cuda:0', dtype=torch.float16) tensor(0.1754, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
28 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.9883, device='cuda:0', dtype=torch.float16) tensor(0.4907, device='cuda:0', dtype=torch.float16)
tensor(1.7529, device='cuda:0', dtype=torch.float16) tensor(0.1626, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1603, device='cuda:0', dtype=torch.float16)
tensor(1.5664, device='cuda:0', dtype=torch.float16) tensor(0.1837, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
tensor(0.1636, device='cuda:0')
old_score: tensor(0.1643, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1448, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.238518476486206
Validation after dual ascent:
out_inf: tensor(6.9883, device='cuda:0', dtype=torch.float16) tensor(0.4907, device='cuda:0', dtype=torch.float16)
tensor(1.5518, device='cuda:0', dtype=torch.float16) tensor(0.1440, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.1388, device='cuda:0', dtype=torch.float16)
tensor(1.5889, device='cuda:0', dtype=torch.float16) tensor(0.1643, device='cuda:0', dtype=torch.float16)
tensor(1.4238, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
28 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.2812, device='cuda:0', dtype=torch.float16) tensor(0.1680, device='cuda:0', dtype=torch.float16)
tensor(0.8970, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
tensor(0.9482, device='cuda:0', dtype=torch.float16) tensor(0.0721, device='cuda:0', dtype=torch.float16)
tensor(1.3389, device='cuda:0', dtype=torch.float16) tensor(0.0763, device='cuda:0', dtype=torch.float16)
tensor(0.8140, device='cuda:0', dtype=torch.float16) tensor(0.0617, device='cuda:0', dtype=torch.float16)
tensor(0.1109, device='cuda:0')
old_score: tensor(0.0674, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0601, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.165035963058472
Validation after dual ascent:
out_inf: tensor(10.2812, device='cuda:0', dtype=torch.float16) tensor(0.1680, device='cuda:0', dtype=torch.float16)
tensor(0.8496, device='cuda:0', dtype=torch.float16) tensor(0.0531, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0627, device='cuda:0', dtype=torch.float16)
tensor(1.6748, device='cuda:0', dtype=torch.float16) tensor(0.0690, device='cuda:0', dtype=torch.float16)
tensor(1.1328, device='cuda:0', dtype=torch.float16) tensor(0.0555, device='cuda:0', dtype=torch.float16)
28 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.0234, device='cuda:0', dtype=torch.float16) tensor(0.5151, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.3594, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
tensor(1.6992, device='cuda:0', dtype=torch.float16) tensor(0.1427, device='cuda:0', dtype=torch.float16)
tensor(1.3320, device='cuda:0', dtype=torch.float16) tensor(0.1179, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0184, device='cuda:0')
tensor(0.0531, device='cuda:0')
old_score: tensor(0.1284, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1124, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.221282482147217
Validation after dual ascent:
out_inf: tensor(10.0234, device='cuda:0', dtype=torch.float16) tensor(0.5151, device='cuda:0', dtype=torch.float16)
tensor(1.2480, device='cuda:0', dtype=torch.float16) tensor(0.1123, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
tensor(1.3066, device='cuda:0', dtype=torch.float16) tensor(0.1266, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
28 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.7266, device='cuda:0', dtype=torch.float16) tensor(0.4041, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.1205, device='cuda:0', dtype=torch.float16)
tensor(2.1719, device='cuda:0', dtype=torch.float16) tensor(0.1375, device='cuda:0', dtype=torch.float16)
tensor(1.4453, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0140, device='cuda:0')
tensor(0.0447, device='cuda:0')
old_score: tensor(0.1235, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1084, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.235428810119629
Validation after dual ascent:
out_inf: tensor(10.7266, device='cuda:0', dtype=torch.float16) tensor(0.4041, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1084, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.1037, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.1218, device='cuda:0', dtype=torch.float16)
tensor(1.0977, device='cuda:0', dtype=torch.float16) tensor(0.0995, device='cuda:0', dtype=torch.float16)
28 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.2184, device='cuda:0', dtype=torch.float16)
tensor(0.9321, device='cuda:0', dtype=torch.float16) tensor(0.0667, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0648, device='cuda:0', dtype=torch.float16)
tensor(0.8286, device='cuda:0', dtype=torch.float16) tensor(0.0743, device='cuda:0', dtype=torch.float16)
tensor(0.8291, device='cuda:0', dtype=torch.float16) tensor(0.0616, device='cuda:0', dtype=torch.float16)
Converged at iteration 100
tensor(0.0174, device='cuda:0')
tensor(0.1651, device='cuda:0')
old_score: tensor(0.0668, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0626, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.193694353103638
Validation after dual ascent:
out_inf: tensor(4.5469, device='cuda:0', dtype=torch.float16) tensor(0.2184, device='cuda:0', dtype=torch.float16)
tensor(0.9268, device='cuda:0', dtype=torch.float16) tensor(0.0624, device='cuda:0', dtype=torch.float16)
tensor(0.7295, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(0.8232, device='cuda:0', dtype=torch.float16) tensor(0.0705, device='cuda:0', dtype=torch.float16)
tensor(0.7271, device='cuda:0', dtype=torch.float16) tensor(0.0573, device='cuda:0', dtype=torch.float16)
layer 28 done
29 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.5000, device='cuda:0', dtype=torch.float16) tensor(0.8438, device='cuda:0', dtype=torch.float16)
tensor(1.9072, device='cuda:0', dtype=torch.float16) tensor(0.1649, device='cuda:0', dtype=torch.float16)
tensor(1.8291, device='cuda:0', dtype=torch.float16) tensor(0.1630, device='cuda:0', dtype=torch.float16)
tensor(1.8643, device='cuda:0', dtype=torch.float16) tensor(0.1879, device='cuda:0', dtype=torch.float16)
tensor(2.2383, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0197, device='cuda:0')
tensor(0.0926, device='cuda:0')
old_score: tensor(0.1670, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1456, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.235285043716431
Validation after dual ascent:
out_inf: tensor(13.5000, device='cuda:0', dtype=torch.float16) tensor(0.8438, device='cuda:0', dtype=torch.float16)
tensor(1.6855, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(1.7158, device='cuda:0', dtype=torch.float16) tensor(0.1395, device='cuda:0', dtype=torch.float16)
tensor(1.7598, device='cuda:0', dtype=torch.float16) tensor(0.1656, device='cuda:0', dtype=torch.float16)
tensor(2.0391, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
29 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.0938, device='cuda:0', dtype=torch.float16) tensor(1.0674, device='cuda:0', dtype=torch.float16)
tensor(1.5137, device='cuda:0', dtype=torch.float16) tensor(0.1670, device='cuda:0', dtype=torch.float16)
tensor(1.8398, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(1.5479, device='cuda:0', dtype=torch.float16) tensor(0.1897, device='cuda:0', dtype=torch.float16)
tensor(1.6504, device='cuda:0', dtype=torch.float16) tensor(0.1541, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0188, device='cuda:0')
tensor(0.1043, device='cuda:0')
old_score: tensor(0.1692, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1466, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.238585472106934
Validation after dual ascent:
out_inf: tensor(20.0938, device='cuda:0', dtype=torch.float16) tensor(1.0674, device='cuda:0', dtype=torch.float16)
tensor(1.3535, device='cuda:0', dtype=torch.float16) tensor(0.1459, device='cuda:0', dtype=torch.float16)
tensor(1.7695, device='cuda:0', dtype=torch.float16) tensor(0.1405, device='cuda:0', dtype=torch.float16)
tensor(1.4902, device='cuda:0', dtype=torch.float16) tensor(0.1665, device='cuda:0', dtype=torch.float16)
tensor(1.4863, device='cuda:0', dtype=torch.float16) tensor(0.1335, device='cuda:0', dtype=torch.float16)
29 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4648, device='cuda:0', dtype=torch.float16) tensor(0.4773, device='cuda:0', dtype=torch.float16)
tensor(1.4561, device='cuda:0', dtype=torch.float16) tensor(0.1622, device='cuda:0', dtype=torch.float16)
tensor(1.4404, device='cuda:0', dtype=torch.float16) tensor(0.1598, device='cuda:0', dtype=torch.float16)
tensor(1.3896, device='cuda:0', dtype=torch.float16) tensor(0.1833, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1503, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0102, device='cuda:0')
tensor(0.1065, device='cuda:0')
old_score: tensor(0.1639, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1438, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2466328144073486
Validation after dual ascent:
out_inf: tensor(6.4648, device='cuda:0', dtype=torch.float16) tensor(0.4773, device='cuda:0', dtype=torch.float16)
tensor(1.3643, device='cuda:0', dtype=torch.float16) tensor(0.1433, device='cuda:0', dtype=torch.float16)
tensor(1.2744, device='cuda:0', dtype=torch.float16) tensor(0.1377, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.1630, device='cuda:0', dtype=torch.float16)
tensor(1.5527, device='cuda:0', dtype=torch.float16) tensor(0.1315, device='cuda:0', dtype=torch.float16)
29 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.8750, device='cuda:0', dtype=torch.float16) tensor(0.2037, device='cuda:0', dtype=torch.float16)
tensor(0.7651, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.7407, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
tensor(0.7749, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
tensor(0.6768, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.1449, device='cuda:0')
old_score: tensor(0.0775, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0705, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.152822494506836
Validation after dual ascent:
out_inf: tensor(18.8750, device='cuda:0', dtype=torch.float16) tensor(0.2037, device='cuda:0', dtype=torch.float16)
tensor(0.7217, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.6494, device='cuda:0', dtype=torch.float16) tensor(0.0753, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0738, device='cuda:0', dtype=torch.float16)
tensor(0.7021, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
29 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(11.1406, device='cuda:0', dtype=torch.float16) tensor(0.5327, device='cuda:0', dtype=torch.float16)
tensor(2.0781, device='cuda:0', dtype=torch.float16) tensor(0.1305, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.1287, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1464, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.1222, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0199, device='cuda:0')
tensor(0.0596, device='cuda:0')
old_score: tensor(0.1320, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1154, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.220126628875732
Validation after dual ascent:
out_inf: tensor(11.1406, device='cuda:0', dtype=torch.float16) tensor(0.5327, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.1151, device='cuda:0', dtype=torch.float16)
tensor(1.7500, device='cuda:0', dtype=torch.float16) tensor(0.1105, device='cuda:0', dtype=torch.float16)
tensor(1.2715, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
29 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.5547, device='cuda:0', dtype=torch.float16) tensor(0.4604, device='cuda:0', dtype=torch.float16)
tensor(1.8867, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.5391, device='cuda:0', dtype=torch.float16) tensor(0.1250, device='cuda:0', dtype=torch.float16)
tensor(1.6133, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(1.7109, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0180, device='cuda:0')
tensor(0.0518, device='cuda:0')
old_score: tensor(0.1283, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1124, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.229806661605835
Validation after dual ascent:
out_inf: tensor(9.5547, device='cuda:0', dtype=torch.float16) tensor(0.4604, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.1121, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(1.3477, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1038, device='cuda:0', dtype=torch.float16)
29 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(22.8750, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(0.9136, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
tensor(0.9238, device='cuda:0', dtype=torch.float16) tensor(0.0750, device='cuda:0', dtype=torch.float16)
tensor(0.9204, device='cuda:0', dtype=torch.float16) tensor(0.0862, device='cuda:0', dtype=torch.float16)
tensor(0.9370, device='cuda:0', dtype=torch.float16) tensor(0.0726, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0071, device='cuda:0')
tensor(0.0276, device='cuda:0')
old_score: tensor(0.0778, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0725, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 17.091522455215454
Validation after dual ascent:
out_inf: tensor(22.8750, device='cuda:0', dtype=torch.float16) tensor(0.2800, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.0721, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
tensor(0.9731, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(0.8408, device='cuda:0', dtype=torch.float16) tensor(0.0674, device='cuda:0', dtype=torch.float16)
layer 29 done
30 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.2031, device='cuda:0', dtype=torch.float16) tensor(0.8730, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.1724, device='cuda:0', dtype=torch.float16)
tensor(1.6162, device='cuda:0', dtype=torch.float16) tensor(0.1711, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.1948, device='cuda:0', dtype=torch.float16)
tensor(1.6504, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(0.1136, device='cuda:0')
old_score: tensor(0.1749, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1512, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.11375117301941
Validation after dual ascent:
out_inf: tensor(16.2031, device='cuda:0', dtype=torch.float16) tensor(0.8730, device='cuda:0', dtype=torch.float16)
tensor(1.6582, device='cuda:0', dtype=torch.float16) tensor(0.1503, device='cuda:0', dtype=torch.float16)
tensor(1.4014, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(1.5684, device='cuda:0', dtype=torch.float16) tensor(0.1705, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.1393, device='cuda:0', dtype=torch.float16)
30 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.1875, device='cuda:0', dtype=torch.float16) tensor(1.0244, device='cuda:0', dtype=torch.float16)
tensor(1.8398, device='cuda:0', dtype=torch.float16) tensor(0.1755, device='cuda:0', dtype=torch.float16)
tensor(1.6562, device='cuda:0', dtype=torch.float16) tensor(0.1735, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.1980, device='cuda:0', dtype=torch.float16)
tensor(1.8867, device='cuda:0', dtype=torch.float16) tensor(0.1636, device='cuda:0', dtype=torch.float16)
tensor(0.1187, device='cuda:0')
old_score: tensor(0.1776, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1532, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.139715909957886
Validation after dual ascent:
out_inf: tensor(18.1875, device='cuda:0', dtype=torch.float16) tensor(1.0244, device='cuda:0', dtype=torch.float16)
tensor(1.5332, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
tensor(1.4004, device='cuda:0', dtype=torch.float16) tensor(0.1467, device='cuda:0', dtype=torch.float16)
tensor(1.4971, device='cuda:0', dtype=torch.float16) tensor(0.1729, device='cuda:0', dtype=torch.float16)
tensor(1.6816, device='cuda:0', dtype=torch.float16) tensor(0.1407, device='cuda:0', dtype=torch.float16)
30 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.8203, device='cuda:0', dtype=torch.float16) tensor(0.5259, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.1697, device='cuda:0', dtype=torch.float16)
tensor(1.5596, device='cuda:0', dtype=torch.float16) tensor(0.1674, device='cuda:0', dtype=torch.float16)
tensor(1.5244, device='cuda:0', dtype=torch.float16) tensor(0.1908, device='cuda:0', dtype=torch.float16)
tensor(1.3535, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(0.0945, device='cuda:0')
old_score: tensor(0.1716, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1498, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.162503480911255
Validation after dual ascent:
out_inf: tensor(8.8203, device='cuda:0', dtype=torch.float16) tensor(0.5259, device='cuda:0', dtype=torch.float16)
tensor(1.5586, device='cuda:0', dtype=torch.float16) tensor(0.1492, device='cuda:0', dtype=torch.float16)
tensor(1.2910, device='cuda:0', dtype=torch.float16) tensor(0.1433, device='cuda:0', dtype=torch.float16)
tensor(1.4277, device='cuda:0', dtype=torch.float16) tensor(0.1686, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.1382, device='cuda:0', dtype=torch.float16)
30 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.8125, device='cuda:0', dtype=torch.float16) tensor(0.1705, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0528, device='cuda:0', dtype=torch.float16)
tensor(0.8345, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
tensor(1.2090, device='cuda:0', dtype=torch.float16) tensor(0.0617, device='cuda:0', dtype=torch.float16)
tensor(0.8252, device='cuda:0', dtype=torch.float16) tensor(0.0531, device='cuda:0', dtype=torch.float16)
tensor(0.1185, device='cuda:0')
old_score: tensor(0.0562, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0501, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.093886137008667
Validation after dual ascent:
out_inf: tensor(20.8125, device='cuda:0', dtype=torch.float16) tensor(0.1705, device='cuda:0', dtype=torch.float16)
tensor(0.7832, device='cuda:0', dtype=torch.float16) tensor(0.0469, device='cuda:0', dtype=torch.float16)
tensor(1.0361, device='cuda:0', dtype=torch.float16) tensor(0.0504, device='cuda:0', dtype=torch.float16)
tensor(1.1973, device='cuda:0', dtype=torch.float16) tensor(0.0558, device='cuda:0', dtype=torch.float16)
tensor(0.7495, device='cuda:0', dtype=torch.float16) tensor(0.0473, device='cuda:0', dtype=torch.float16)
30 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(35.6250, device='cuda:0', dtype=torch.float16) tensor(0.5767, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1316, device='cuda:0', dtype=torch.float16)
tensor(1.8828, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(1.6133, device='cuda:0', dtype=torch.float16) tensor(0.1479, device='cuda:0', dtype=torch.float16)
tensor(1.9805, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0151, device='cuda:0')
tensor(0.0164, device='cuda:0')
old_score: tensor(0.1329, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1152, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.121256589889526
Validation after dual ascent:
out_inf: tensor(35.6250, device='cuda:0', dtype=torch.float16) tensor(0.5767, device='cuda:0', dtype=torch.float16)
tensor(1.5352, device='cuda:0', dtype=torch.float16) tensor(0.1148, device='cuda:0', dtype=torch.float16)
tensor(1.5859, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(1.6055, device='cuda:0', dtype=torch.float16) tensor(0.1059, device='cuda:0', dtype=torch.float16)
30 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(36.1562, device='cuda:0', dtype=torch.float16) tensor(0.5352, device='cuda:0', dtype=torch.float16)
tensor(2.0625, device='cuda:0', dtype=torch.float16) tensor(0.1274, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.1432, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0146, device='cuda:0')
tensor(0.0158, device='cuda:0')
old_score: tensor(0.1288, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1116, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.131989479064941
Validation after dual ascent:
out_inf: tensor(36.1562, device='cuda:0', dtype=torch.float16) tensor(0.5352, device='cuda:0', dtype=torch.float16)
tensor(1.9766, device='cuda:0', dtype=torch.float16) tensor(0.1112, device='cuda:0', dtype=torch.float16)
tensor(1.1670, device='cuda:0', dtype=torch.float16) tensor(0.1066, device='cuda:0', dtype=torch.float16)
tensor(1.1035, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
30 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1569., device='cuda:0', dtype=torch.float16) tensor(0.4966, device='cuda:0', dtype=torch.float16)
tensor(1.0527, device='cuda:0', dtype=torch.float16) tensor(0.0867, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0865, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.0986, device='cuda:0', dtype=torch.float16)
tensor(1.0801, device='cuda:0', dtype=torch.float16) tensor(0.0829, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0196, device='cuda:0')
tensor(0.0211, device='cuda:0')
old_score: tensor(0.0887, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0820, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.625656843185425
Validation after dual ascent:
out_inf: tensor(1569., device='cuda:0', dtype=torch.float16) tensor(0.4966, device='cuda:0', dtype=torch.float16)
tensor(0.9961, device='cuda:0', dtype=torch.float16) tensor(0.0803, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0791, device='cuda:0', dtype=torch.float16)
tensor(1.1191, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(0.9946, device='cuda:0', dtype=torch.float16) tensor(0.0763, device='cuda:0', dtype=torch.float16)
layer 30 done
31 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.8906, device='cuda:0', dtype=torch.float16) tensor(0.8901, device='cuda:0', dtype=torch.float16)
tensor(2.3887, device='cuda:0', dtype=torch.float16) tensor(0.1433, device='cuda:0', dtype=torch.float16)
tensor(3.0449, device='cuda:0', dtype=torch.float16) tensor(0.1439, device='cuda:0', dtype=torch.float16)
tensor(3.0430, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(5.8320, device='cuda:0', dtype=torch.float16) tensor(0.1340, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0186, device='cuda:0')
tensor(0.0582, device='cuda:0')
old_score: tensor(0.1467, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1238, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.735090732574463
Validation after dual ascent:
out_inf: tensor(13.8906, device='cuda:0', dtype=torch.float16) tensor(0.8901, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.1224, device='cuda:0', dtype=torch.float16)
tensor(2.8086, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(2.7891, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(6.3125, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
31 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.4375, device='cuda:0', dtype=torch.float16) tensor(1.1172, device='cuda:0', dtype=torch.float16)
tensor(2.5117, device='cuda:0', dtype=torch.float16) tensor(0.1482, device='cuda:0', dtype=torch.float16)
tensor(3.3320, device='cuda:0', dtype=torch.float16) tensor(0.1493, device='cuda:0', dtype=torch.float16)
tensor(3.1797, device='cuda:0', dtype=torch.float16) tensor(0.1708, device='cuda:0', dtype=torch.float16)
tensor(6.3828, device='cuda:0', dtype=torch.float16) tensor(0.1390, device='cuda:0', dtype=torch.float16)
tensor(0.0233, device='cuda:0')
old_score: tensor(0.1519, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1272, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.196721076965332
Validation after dual ascent:
out_inf: tensor(19.4375, device='cuda:0', dtype=torch.float16) tensor(1.1172, device='cuda:0', dtype=torch.float16)
tensor(2.1758, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(2.8281, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
tensor(2.7285, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(5.9375, device='cuda:0', dtype=torch.float16) tensor(0.1157, device='cuda:0', dtype=torch.float16)
31 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.0156, device='cuda:0', dtype=torch.float16) tensor(0.4116, device='cuda:0', dtype=torch.float16)
tensor(1.3711, device='cuda:0', dtype=torch.float16) tensor(0.1271, device='cuda:0', dtype=torch.float16)
tensor(1.7383, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(1.8477, device='cuda:0', dtype=torch.float16) tensor(0.1450, device='cuda:0', dtype=torch.float16)
tensor(3.3242, device='cuda:0', dtype=torch.float16) tensor(0.1186, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0155, device='cuda:0')
tensor(0.1922, device='cuda:0')
old_score: tensor(0.1294, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1107, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.498502254486084
Validation after dual ascent:
out_inf: tensor(8.0156, device='cuda:0', dtype=torch.float16) tensor(0.4116, device='cuda:0', dtype=torch.float16)
tensor(1.1777, device='cuda:0', dtype=torch.float16) tensor(0.1098, device='cuda:0', dtype=torch.float16)
tensor(1.5586, device='cuda:0', dtype=torch.float16) tensor(0.1060, device='cuda:0', dtype=torch.float16)
tensor(1.5352, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(2.9453, device='cuda:0', dtype=torch.float16) tensor(0.1009, device='cuda:0', dtype=torch.float16)
31 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(218.2500, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
tensor(0.8140, device='cuda:0', dtype=torch.float16) tensor(0.0643, device='cuda:0', dtype=torch.float16)
tensor(0.8013, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
tensor(0.9180, device='cuda:0', dtype=torch.float16) tensor(0.0695, device='cuda:0', dtype=torch.float16)
tensor(1.1543, device='cuda:0', dtype=torch.float16) tensor(0.0666, device='cuda:0', dtype=torch.float16)
tensor(0.0294, device='cuda:0')
old_score: tensor(0.0665, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0547, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.160346984863281
Validation after dual ascent:
out_inf: tensor(218.2500, device='cuda:0', dtype=torch.float16) tensor(0.2759, device='cuda:0', dtype=torch.float16)
tensor(0.6382, device='cuda:0', dtype=torch.float16) tensor(0.0522, device='cuda:0', dtype=torch.float16)
tensor(0.5913, device='cuda:0', dtype=torch.float16) tensor(0.0531, device='cuda:0', dtype=torch.float16)
tensor(0.6943, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0550, device='cuda:0', dtype=torch.float16)
31 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(29.7969, device='cuda:0', dtype=torch.float16) tensor(0.6221, device='cuda:0', dtype=torch.float16)
tensor(1.8984, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(2.0859, device='cuda:0', dtype=torch.float16) tensor(0.1213, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.1389, device='cuda:0', dtype=torch.float16)
tensor(2.0664, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(0.0235, device='cuda:0')
old_score: tensor(0.1240, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1046, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.85472559928894
Validation after dual ascent:
out_inf: tensor(29.7969, device='cuda:0', dtype=torch.float16) tensor(0.6221, device='cuda:0', dtype=torch.float16)
tensor(1.6445, device='cuda:0', dtype=torch.float16) tensor(0.1034, device='cuda:0', dtype=torch.float16)
tensor(1.7266, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(1.6797, device='cuda:0', dtype=torch.float16) tensor(0.1186, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
31 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(30.9688, device='cuda:0', dtype=torch.float16) tensor(0.6323, device='cuda:0', dtype=torch.float16)
tensor(1.9375, device='cuda:0', dtype=torch.float16) tensor(0.1164, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1161, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.1337, device='cuda:0', dtype=torch.float16)
tensor(1.7969, device='cuda:0', dtype=torch.float16) tensor(0.1101, device='cuda:0', dtype=torch.float16)
tensor(0.0224, device='cuda:0')
old_score: tensor(0.1191, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1000, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.898502349853516
Validation after dual ascent:
out_inf: tensor(30.9688, device='cuda:0', dtype=torch.float16) tensor(0.6323, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.0990, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
tensor(1.1836, device='cuda:0', dtype=torch.float16) tensor(0.0920, device='cuda:0', dtype=torch.float16)
31 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(127.3750, device='cuda:0', dtype=torch.float16) tensor(1.4248, device='cuda:0', dtype=torch.float16)
tensor(1.5049, device='cuda:0', dtype=torch.float16) tensor(0.0995, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.1017, device='cuda:0', dtype=torch.float16)
tensor(1.4590, device='cuda:0', dtype=torch.float16) tensor(0.1205, device='cuda:0', dtype=torch.float16)
tensor(1.5234, device='cuda:0', dtype=torch.float16) tensor(0.0996, device='cuda:0', dtype=torch.float16)
layer 31 done
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  3.09it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.88it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  3.74it/s]
{'model.embed_tokens': 0, 'model.layers.0': 0, 'model.layers.1': 0, 'model.layers.2': 0, 'model.layers.3': 0, 'model.layers.4': 0, 'model.layers.5': 0, 'model.layers.6': 0, 'model.layers.7': 0, 'model.layers.8': 0, 'model.layers.9': 0, 'model.layers.10': 0, 'model.layers.11': 0, 'model.layers.12': 0, 'model.layers.13': 0, 'model.layers.14': 0, 'model.layers.15': 0, 'model.layers.16': 0, 'model.layers.17': 0, 'model.layers.18': 0, 'model.layers.19': 0, 'model.layers.20': 0, 'model.layers.21': 0, 'model.layers.22': 0, 'model.layers.23': 0, 'model.layers.24': 0, 'model.layers.25': 0, 'model.layers.26': 0, 'model.layers.27': 1, 'model.layers.28': 1, 'model.layers.29': 1, 'model.layers.30': 1, 'model.layers.31': 1, 'model.norm': 1, 'model.rotary_emb': 1, 'lm_head': 1}
use device  1
******************************
layer 0 sparsity 0.800001
layer 1 sparsity 0.800001
layer 2 sparsity 0.800001
layer 3 sparsity 0.800001
layer 4 sparsity 0.800001
layer 5 sparsity 0.800001
layer 6 sparsity 0.800001
layer 7 sparsity 0.800001
layer 8 sparsity 0.800001
layer 9 sparsity 0.800001
layer 10 sparsity 0.800001
layer 11 sparsity 0.800001
layer 12 sparsity 0.800001
layer 13 sparsity 0.800001
layer 14 sparsity 0.800001
layer 15 sparsity 0.800001
layer 16 sparsity 0.800001
layer 17 sparsity 0.800001
layer 18 sparsity 0.800001
layer 19 sparsity 0.800001
layer 20 sparsity 0.800001
layer 21 sparsity 0.800001
layer 22 sparsity 0.800001
layer 23 sparsity 0.800001
layer 24 sparsity 0.800001
layer 25 sparsity 0.800001
layer 26 sparsity 0.800001
layer 27 sparsity 0.800001
layer 28 sparsity 0.800001
layer 29 sparsity 0.800001
layer 30 sparsity 0.800001
layer 31 sparsity 0.800001
sparsity sanity check 0.8000
******************************
evaluating on wikitext2
nsamples 83
sample 0
sample 50
wikitext perplexity 77.3043441772461
sparsegpt_dual_3	0.8000	77.3043	256
Namespace(model='/h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf', seed=0, nsamples=256, dual_theld=0.03, n_batch=8, sparsity_ratio=0.8, epsilon=0.02, n_flod=1, sparsity_type='unstructured', prune_method='sparsegpt_dual_3', cache_dir='llm_weights', use_variant=False, save='/h3cstore_ns/jcxie/LISA/nips2024/log', save_model=None, exclude='gate_proj', ww_metric='alpha_peak', ww_metric_cache='/h3cstore_ns/jcxie/LISA/wanda-main/data/llama2-7b-hf', wanda_scale=0.01, ww_epsilon=0.02, mapping_type='block_wise', dual_sp_theld=0.0, Hyper_m=3, Lamda=0.2, eval_zero_shot=0, save_ckpt=0)
2025-04-24 04:34:52.703550: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-24 04:34:53.039191: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-24 04:34:53.046400: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 04:34:53.046425: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2025-04-24 04:35:04.915785: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 04:35:04.918069: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda-12.3/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
2025-04-24 04:35:04.918105: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
torch 2.3.1+cu121
transformers 4.47.1
accelerate 0.29.1
# of gpus:  2
loading llm model /h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.03it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.61it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.51it/s]
normalizer.cc(51) LOG(INFO) precompiled_charsmap is empty. use identity normalization.
model.embed_tokens.weight torch.Size([32000, 4096])
model.layers.0.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.0.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.0.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.0.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.0.input_layernorm.weight torch.Size([4096])
model.layers.0.post_attention_layernorm.weight torch.Size([4096])
model.layers.1.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.1.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.1.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.1.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.1.input_layernorm.weight torch.Size([4096])
model.layers.1.post_attention_layernorm.weight torch.Size([4096])
model.layers.2.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.2.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.2.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.2.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.2.input_layernorm.weight torch.Size([4096])
model.layers.2.post_attention_layernorm.weight torch.Size([4096])
model.layers.3.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.3.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.3.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.3.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.3.input_layernorm.weight torch.Size([4096])
model.layers.3.post_attention_layernorm.weight torch.Size([4096])
model.layers.4.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.4.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.4.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.4.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.4.input_layernorm.weight torch.Size([4096])
model.layers.4.post_attention_layernorm.weight torch.Size([4096])
model.layers.5.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.5.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.5.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.5.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.5.input_layernorm.weight torch.Size([4096])
model.layers.5.post_attention_layernorm.weight torch.Size([4096])
model.layers.6.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.6.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.6.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.6.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.6.input_layernorm.weight torch.Size([4096])
model.layers.6.post_attention_layernorm.weight torch.Size([4096])
model.layers.7.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.7.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.7.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.7.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.7.input_layernorm.weight torch.Size([4096])
model.layers.7.post_attention_layernorm.weight torch.Size([4096])
model.layers.8.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.8.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.8.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.8.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.8.input_layernorm.weight torch.Size([4096])
model.layers.8.post_attention_layernorm.weight torch.Size([4096])
model.layers.9.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.9.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.9.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.9.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.9.input_layernorm.weight torch.Size([4096])
model.layers.9.post_attention_layernorm.weight torch.Size([4096])
model.layers.10.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.10.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.10.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.10.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.10.input_layernorm.weight torch.Size([4096])
model.layers.10.post_attention_layernorm.weight torch.Size([4096])
model.layers.11.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.11.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.11.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.11.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.11.input_layernorm.weight torch.Size([4096])
model.layers.11.post_attention_layernorm.weight torch.Size([4096])
model.layers.12.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.12.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.12.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.12.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.12.input_layernorm.weight torch.Size([4096])
model.layers.12.post_attention_layernorm.weight torch.Size([4096])
model.layers.13.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.13.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.13.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.13.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.13.input_layernorm.weight torch.Size([4096])
model.layers.13.post_attention_layernorm.weight torch.Size([4096])
model.layers.14.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.14.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.14.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.14.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.14.input_layernorm.weight torch.Size([4096])
model.layers.14.post_attention_layernorm.weight torch.Size([4096])
model.layers.15.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.15.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.15.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.15.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.15.input_layernorm.weight torch.Size([4096])
model.layers.15.post_attention_layernorm.weight torch.Size([4096])
model.layers.16.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.16.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.16.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.16.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.16.input_layernorm.weight torch.Size([4096])
model.layers.16.post_attention_layernorm.weight torch.Size([4096])
model.layers.17.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.17.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.17.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.17.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.17.input_layernorm.weight torch.Size([4096])
model.layers.17.post_attention_layernorm.weight torch.Size([4096])
model.layers.18.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.18.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.18.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.18.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.18.input_layernorm.weight torch.Size([4096])
model.layers.18.post_attention_layernorm.weight torch.Size([4096])
model.layers.19.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.19.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.19.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.19.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.19.input_layernorm.weight torch.Size([4096])
model.layers.19.post_attention_layernorm.weight torch.Size([4096])
model.layers.20.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.20.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.20.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.20.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.20.input_layernorm.weight torch.Size([4096])
model.layers.20.post_attention_layernorm.weight torch.Size([4096])
model.layers.21.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.21.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.21.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.21.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.21.input_layernorm.weight torch.Size([4096])
model.layers.21.post_attention_layernorm.weight torch.Size([4096])
model.layers.22.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.22.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.22.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.22.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.22.input_layernorm.weight torch.Size([4096])
model.layers.22.post_attention_layernorm.weight torch.Size([4096])
model.layers.23.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.23.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.23.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.23.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.23.input_layernorm.weight torch.Size([4096])
model.layers.23.post_attention_layernorm.weight torch.Size([4096])
model.layers.24.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.24.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.24.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.24.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.24.input_layernorm.weight torch.Size([4096])
model.layers.24.post_attention_layernorm.weight torch.Size([4096])
model.layers.25.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.25.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.25.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.25.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.25.input_layernorm.weight torch.Size([4096])
model.layers.25.post_attention_layernorm.weight torch.Size([4096])
model.layers.26.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.26.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.26.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.26.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.26.input_layernorm.weight torch.Size([4096])
model.layers.26.post_attention_layernorm.weight torch.Size([4096])
model.layers.27.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.27.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.27.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.27.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.27.input_layernorm.weight torch.Size([4096])
model.layers.27.post_attention_layernorm.weight torch.Size([4096])
model.layers.28.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.28.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.28.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.28.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.28.input_layernorm.weight torch.Size([4096])
model.layers.28.post_attention_layernorm.weight torch.Size([4096])
model.layers.29.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.29.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.29.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.29.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.29.input_layernorm.weight torch.Size([4096])
model.layers.29.post_attention_layernorm.weight torch.Size([4096])
model.layers.30.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.30.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.30.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.30.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.30.input_layernorm.weight torch.Size([4096])
model.layers.30.post_attention_layernorm.weight torch.Size([4096])
model.layers.31.self_attn.q_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.k_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.v_proj.weight torch.Size([4096, 4096])
model.layers.31.self_attn.o_proj.weight torch.Size([4096, 4096])
model.layers.31.mlp.gate_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.up_proj.weight torch.Size([11008, 4096])
model.layers.31.mlp.down_proj.weight torch.Size([4096, 11008])
model.layers.31.input_layernorm.weight torch.Size([4096])
model.layers.31.post_attention_layernorm.weight torch.Size([4096])
model.norm.weight torch.Size([4096])
lm_head.weight torch.Size([32000, 4096])
use device  cpu
loading calibdation data
  0%|          | 0/256 [00:00<?, ?it/s]  0%|          | 1/256 [00:00<03:25,  1.24it/s]  1%|          | 2/256 [00:01<03:15,  1.30it/s]  2%|▏         | 4/256 [00:01<01:38,  2.56it/s]  2%|▏         | 5/256 [00:02<01:39,  2.51it/s]  2%|▏         | 6/256 [00:02<01:18,  3.20it/s]  3%|▎         | 7/256 [00:03<01:52,  2.20it/s]  3%|▎         | 8/256 [00:03<01:27,  2.84it/s]  4%|▎         | 9/256 [00:03<01:08,  3.61it/s]  4%|▍         | 11/256 [00:03<00:45,  5.33it/s]  5%|▍         | 12/256 [00:03<00:42,  5.78it/s]  5%|▌         | 13/256 [00:04<01:31,  2.67it/s]  5%|▌         | 14/256 [00:04<01:28,  2.73it/s]  6%|▌         | 15/256 [00:05<01:15,  3.21it/s]  6%|▋         | 16/256 [00:05<01:06,  3.62it/s]  7%|▋         | 18/256 [00:05<01:09,  3.44it/s]  8%|▊         | 20/256 [00:06<00:52,  4.48it/s]  8%|▊         | 21/256 [00:06<00:47,  5.00it/s]  9%|▊         | 22/256 [00:06<00:50,  4.61it/s]  9%|▉         | 24/256 [00:06<00:43,  5.35it/s] 10%|▉         | 25/256 [00:07<00:40,  5.64it/s] 10%|█         | 26/256 [00:07<00:54,  4.23it/s] 11%|█         | 28/256 [00:07<00:45,  5.00it/s] 11%|█▏        | 29/256 [00:07<00:46,  4.83it/s] 12%|█▏        | 31/256 [00:08<00:38,  5.77it/s] 12%|█▎        | 32/256 [00:08<00:47,  4.75it/s] 13%|█▎        | 33/256 [00:08<00:58,  3.83it/s] 13%|█▎        | 34/256 [00:09<01:01,  3.59it/s] 14%|█▎        | 35/256 [00:09<01:08,  3.23it/s] 14%|█▍        | 36/256 [00:10<01:18,  2.79it/s] 14%|█▍        | 37/256 [00:10<01:13,  2.97it/s] 15%|█▍        | 38/256 [00:10<01:09,  3.16it/s] 16%|█▌        | 40/256 [00:11<01:03,  3.40it/s] 16%|█▋        | 42/256 [00:11<00:44,  4.79it/s] 17%|█▋        | 43/256 [00:11<00:39,  5.38it/s] 17%|█▋        | 44/256 [00:11<00:38,  5.46it/s] 18%|█▊        | 45/256 [00:11<00:34,  6.17it/s] 18%|█▊        | 46/256 [00:11<00:32,  6.37it/s] 18%|█▊        | 47/256 [00:12<00:34,  6.14it/s] 19%|█▉        | 48/256 [00:12<00:37,  5.51it/s] 19%|█▉        | 49/256 [00:12<00:33,  6.12it/s] 20%|█▉        | 50/256 [00:12<00:49,  4.14it/s] 21%|██        | 53/256 [00:13<00:48,  4.17it/s] 21%|██        | 54/256 [00:13<00:48,  4.20it/s] 21%|██▏       | 55/256 [00:13<00:41,  4.81it/s] 22%|██▏       | 56/256 [00:14<00:48,  4.09it/s] 22%|██▏       | 57/256 [00:14<00:44,  4.43it/s] 23%|██▎       | 58/256 [00:14<00:49,  4.00it/s] 23%|██▎       | 59/256 [00:14<00:43,  4.54it/s] 23%|██▎       | 60/256 [00:15<00:46,  4.24it/s] 24%|██▍       | 61/256 [00:15<00:53,  3.63it/s] 24%|██▍       | 62/256 [00:15<00:59,  3.27it/s] 25%|██▍       | 63/256 [00:16<00:51,  3.77it/s] 25%|██▌       | 64/256 [00:16<00:42,  4.56it/s] 25%|██▌       | 65/256 [00:16<01:09,  2.73it/s] 26%|██▌       | 67/256 [00:17<00:44,  4.25it/s] 27%|██▋       | 68/256 [00:17<00:43,  4.31it/s] 27%|██▋       | 69/256 [00:17<00:43,  4.26it/s] 28%|██▊       | 71/256 [00:17<00:33,  5.49it/s] 29%|██▊       | 73/256 [00:17<00:26,  6.78it/s] 29%|██▉       | 74/256 [00:18<00:26,  6.86it/s] 29%|██▉       | 75/256 [00:18<00:31,  5.72it/s] 30%|██▉       | 76/256 [00:18<00:44,  4.09it/s] 30%|███       | 78/256 [00:18<00:30,  5.84it/s] 31%|███       | 79/256 [00:19<00:37,  4.67it/s] 31%|███▏      | 80/256 [00:19<00:49,  3.57it/s] 32%|███▏      | 81/256 [00:20<00:54,  3.24it/s] 32%|███▏      | 82/256 [00:20<00:44,  3.87it/s] 32%|███▏      | 83/256 [00:20<00:54,  3.17it/s] 33%|███▎      | 84/256 [00:21<00:51,  3.33it/s] 33%|███▎      | 85/256 [00:21<00:47,  3.62it/s] 34%|███▎      | 86/256 [00:21<00:42,  3.95it/s] 34%|███▍      | 87/256 [00:22<01:00,  2.80it/s] 34%|███▍      | 88/256 [00:22<01:03,  2.66it/s] 35%|███▍      | 89/256 [00:22<00:58,  2.84it/s] 35%|███▌      | 90/256 [00:23<00:59,  2.80it/s] 36%|███▌      | 91/256 [00:23<00:58,  2.84it/s] 36%|███▌      | 92/256 [00:23<00:48,  3.38it/s] 36%|███▋      | 93/256 [00:23<00:42,  3.85it/s] 37%|███▋      | 94/256 [00:24<00:51,  3.16it/s] 37%|███▋      | 95/256 [00:24<01:04,  2.49it/s] 38%|███▊      | 96/256 [00:25<00:51,  3.10it/s] 38%|███▊      | 97/256 [00:25<00:56,  2.83it/s] 38%|███▊      | 98/256 [00:25<00:46,  3.37it/s] 39%|███▊      | 99/256 [00:25<00:45,  3.45it/s] 39%|███▉      | 100/256 [00:26<00:43,  3.63it/s] 39%|███▉      | 101/256 [00:27<01:15,  2.04it/s] 40%|███▉      | 102/256 [00:27<01:04,  2.38it/s] 41%|████      | 104/256 [00:27<00:41,  3.68it/s] 41%|████▏     | 106/256 [00:27<00:33,  4.45it/s] 42%|████▏     | 107/256 [00:28<00:33,  4.47it/s] 42%|████▏     | 108/256 [00:28<00:48,  3.04it/s] 43%|████▎     | 111/256 [00:29<00:30,  4.74it/s] 44%|████▍     | 112/256 [00:29<00:31,  4.51it/s] 44%|████▍     | 113/256 [00:29<00:31,  4.49it/s] 45%|████▍     | 114/256 [00:29<00:28,  4.91it/s] 45%|████▍     | 115/256 [00:29<00:27,  5.14it/s] 45%|████▌     | 116/256 [00:30<00:38,  3.68it/s] 46%|████▌     | 117/256 [00:30<00:31,  4.44it/s] 46%|████▌     | 118/256 [00:30<00:29,  4.72it/s] 47%|████▋     | 120/256 [00:30<00:20,  6.62it/s] 47%|████▋     | 121/256 [00:30<00:19,  6.96it/s] 48%|████▊     | 122/256 [00:31<00:36,  3.63it/s] 48%|████▊     | 123/256 [00:31<00:40,  3.28it/s] 48%|████▊     | 124/256 [00:32<00:52,  2.52it/s] 49%|████▉     | 125/256 [00:33<01:21,  1.61it/s] 49%|████▉     | 126/256 [00:34<01:08,  1.90it/s] 50%|████▉     | 127/256 [00:34<01:14,  1.73it/s] 50%|█████     | 129/256 [00:34<00:45,  2.82it/s] 51%|█████     | 130/256 [00:35<00:41,  3.07it/s] 51%|█████     | 131/256 [00:35<00:38,  3.25it/s] 52%|█████▏    | 132/256 [00:35<00:36,  3.37it/s] 52%|█████▏    | 133/256 [00:36<00:44,  2.74it/s] 52%|█████▏    | 134/256 [00:36<00:44,  2.74it/s] 53%|█████▎    | 135/256 [00:36<00:35,  3.38it/s] 53%|█████▎    | 136/256 [00:37<00:35,  3.35it/s] 54%|█████▎    | 137/256 [00:37<00:29,  3.98it/s] 54%|█████▍    | 138/256 [00:37<00:26,  4.49it/s] 54%|█████▍    | 139/256 [00:37<00:24,  4.86it/s] 55%|█████▍    | 140/256 [00:37<00:22,  5.19it/s] 55%|█████▌    | 141/256 [00:37<00:19,  5.98it/s] 55%|█████▌    | 142/256 [00:37<00:16,  6.76it/s] 56%|█████▌    | 143/256 [00:38<00:16,  6.98it/s] 57%|█████▋    | 145/256 [00:39<00:36,  3.03it/s] 57%|█████▋    | 146/256 [00:39<00:40,  2.75it/s] 57%|█████▋    | 147/256 [00:39<00:36,  3.01it/s] 58%|█████▊    | 148/256 [00:40<00:37,  2.92it/s] 59%|█████▊    | 150/256 [00:40<00:29,  3.62it/s] 59%|█████▉    | 151/256 [00:40<00:25,  4.18it/s] 59%|█████▉    | 152/256 [00:41<00:28,  3.64it/s] 60%|█████▉    | 153/256 [00:41<00:25,  4.03it/s] 60%|██████    | 154/256 [00:41<00:29,  3.45it/s] 61%|██████    | 155/256 [00:41<00:26,  3.82it/s] 61%|██████    | 156/256 [00:41<00:22,  4.54it/s] 61%|██████▏   | 157/256 [00:42<00:27,  3.64it/s] 62%|██████▏   | 158/256 [00:42<00:23,  4.15it/s] 62%|██████▏   | 159/256 [00:43<00:42,  2.29it/s] 62%|██████▎   | 160/256 [00:43<00:33,  2.89it/s] 63%|██████▎   | 162/256 [00:44<00:37,  2.50it/s] 64%|██████▎   | 163/256 [00:44<00:33,  2.82it/s] 64%|██████▍   | 164/256 [00:44<00:27,  3.37it/s] 65%|██████▍   | 166/256 [00:45<00:22,  3.97it/s] 65%|██████▌   | 167/256 [00:45<00:24,  3.57it/s] 66%|██████▌   | 168/256 [00:46<00:27,  3.15it/s] 66%|██████▌   | 169/256 [00:46<00:31,  2.76it/s] 66%|██████▋   | 170/256 [00:46<00:31,  2.76it/s] 67%|██████▋   | 172/256 [00:47<00:21,  3.84it/s] 68%|██████▊   | 173/256 [00:47<00:21,  3.94it/s] 68%|██████▊   | 174/256 [00:47<00:28,  2.89it/s] 68%|██████▊   | 175/256 [00:48<00:40,  2.02it/s] 69%|██████▉   | 176/256 [00:49<00:34,  2.29it/s] 69%|██████▉   | 177/256 [00:49<00:28,  2.75it/s] 70%|██████▉   | 179/256 [00:49<00:19,  3.94it/s] 70%|███████   | 180/256 [00:50<00:36,  2.06it/s] 71%|███████   | 181/256 [00:50<00:29,  2.56it/s] 71%|███████   | 182/256 [00:51<00:37,  1.98it/s] 72%|███████▏  | 184/256 [00:52<00:35,  2.05it/s] 73%|███████▎  | 186/256 [00:52<00:23,  2.93it/s] 73%|███████▎  | 187/256 [00:53<00:27,  2.52it/s] 73%|███████▎  | 188/256 [00:53<00:23,  2.87it/s] 74%|███████▍  | 189/256 [00:53<00:22,  2.92it/s] 74%|███████▍  | 190/256 [00:54<00:20,  3.15it/s] 75%|███████▍  | 191/256 [00:54<00:18,  3.43it/s] 75%|███████▌  | 192/256 [00:54<00:22,  2.91it/s] 75%|███████▌  | 193/256 [00:55<00:20,  3.03it/s] 77%|███████▋  | 196/256 [00:55<00:13,  4.45it/s] 77%|███████▋  | 197/256 [00:56<00:15,  3.82it/s] 78%|███████▊  | 199/256 [00:56<00:11,  4.87it/s] 79%|███████▊  | 201/256 [00:56<00:10,  5.46it/s] 79%|███████▉  | 202/256 [00:56<00:11,  4.58it/s] 80%|███████▉  | 204/256 [00:57<00:08,  5.80it/s] 80%|████████  | 206/256 [00:57<00:06,  7.20it/s] 81%|████████  | 207/256 [00:57<00:06,  7.54it/s] 81%|████████▏ | 208/256 [00:57<00:07,  6.63it/s] 82%|████████▏ | 210/256 [00:57<00:05,  8.79it/s] 83%|████████▎ | 212/256 [00:57<00:05,  8.45it/s] 83%|████████▎ | 213/256 [00:58<00:05,  7.55it/s] 84%|████████▎ | 214/256 [00:58<00:07,  5.75it/s] 84%|████████▍ | 215/256 [00:58<00:09,  4.50it/s] 84%|████████▍ | 216/256 [00:59<00:09,  4.42it/s] 85%|████████▌ | 218/256 [00:59<00:07,  5.26it/s] 86%|████████▌ | 219/256 [01:00<00:14,  2.58it/s] 86%|████████▌ | 220/256 [01:00<00:11,  3.03it/s] 86%|████████▋ | 221/256 [01:00<00:11,  2.95it/s] 87%|████████▋ | 222/256 [01:01<00:11,  2.92it/s] 87%|████████▋ | 223/256 [01:01<00:11,  2.77it/s] 88%|████████▊ | 224/256 [01:03<00:23,  1.34it/s] 88%|████████▊ | 225/256 [01:04<00:22,  1.38it/s] 88%|████████▊ | 226/256 [01:04<00:16,  1.79it/s] 89%|████████▊ | 227/256 [01:04<00:13,  2.14it/s] 89%|████████▉ | 228/256 [01:04<00:12,  2.24it/s] 89%|████████▉ | 229/256 [01:06<00:18,  1.44it/s] 90%|████████▉ | 230/256 [01:06<00:13,  1.91it/s] 90%|█████████ | 231/256 [01:06<00:12,  1.97it/s] 91%|█████████ | 232/256 [01:07<00:10,  2.24it/s] 91%|█████████ | 233/256 [01:07<00:08,  2.72it/s] 92%|█████████▏| 235/256 [01:07<00:05,  3.76it/s] 92%|█████████▏| 236/256 [01:07<00:05,  3.54it/s] 93%|█████████▎| 237/256 [01:07<00:04,  3.93it/s] 93%|█████████▎| 238/256 [01:08<00:03,  4.60it/s] 93%|█████████▎| 239/256 [01:08<00:03,  4.55it/s] 94%|█████████▍| 241/256 [01:08<00:02,  5.81it/s] 95%|█████████▍| 242/256 [01:09<00:04,  2.91it/s] 95%|█████████▌| 244/256 [01:09<00:02,  4.44it/s] 96%|█████████▌| 245/256 [01:09<00:02,  4.38it/s] 96%|█████████▌| 246/256 [01:09<00:02,  4.85it/s] 97%|█████████▋| 248/256 [01:10<00:01,  6.57it/s] 97%|█████████▋| 249/256 [01:10<00:01,  3.88it/s] 98%|█████████▊| 251/256 [01:10<00:00,  5.38it/s] 98%|█████████▊| 252/256 [01:11<00:01,  3.48it/s] 99%|█████████▉| 253/256 [01:11<00:01,  2.95it/s]100%|█████████▉| 255/256 [01:12<00:00,  3.09it/s]100%|██████████| 256/256 [01:12<00:00,  3.17it/s]100%|██████████| 256/256 [01:12<00:00,  3.51it/s]
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
dataset loading complete
0 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8555, device='cuda:0', dtype=torch.float16) tensor(0.6099, device='cuda:0', dtype=torch.float16)
tensor(0.0723, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
tensor(0.1045, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.1113, device='cuda:0', dtype=torch.float16) tensor(0.0037, device='cuda:0', dtype=torch.float16)
tensor(0.1270, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
0 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1211, device='cuda:0', dtype=torch.float16) tensor(0.4609, device='cuda:0', dtype=torch.float16)
tensor(0.1763, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
tensor(0.1895, device='cuda:0', dtype=torch.float16) tensor(0.0051, device='cuda:0', dtype=torch.float16)
tensor(0.1406, device='cuda:0', dtype=torch.float16) tensor(0.0055, device='cuda:0', dtype=torch.float16)
tensor(0.1895, device='cuda:0', dtype=torch.float16) tensor(0.0050, device='cuda:0', dtype=torch.float16)
0 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.0903, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.0903, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.0903, device='cuda:0', dtype=torch.float16) tensor(0.0034, device='cuda:0', dtype=torch.float16)
tensor(0.0845, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.0601, device='cuda:0')
old_score: tensor(0.0032, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0027, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.959468841552734
Validation after dual ascent:
out_inf: tensor(0.7524, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.0688, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.0688, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.0738, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0786, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
0 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0339, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0358, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0349, device='cuda:0', dtype=torch.float16) tensor(0.0016, device='cuda:0', dtype=torch.float16)
tensor(0.0364, device='cuda:0', dtype=torch.float16) tensor(0.0015, device='cuda:0', dtype=torch.float16)
tensor(0.0343, device='cuda:0')
old_score: tensor(0.0015, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0012, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.074175357818604
Validation after dual ascent:
out_inf: tensor(0.9517, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0327, device='cuda:0', dtype=torch.float16) tensor(0.0011, device='cuda:0', dtype=torch.float16)
tensor(0.0313, device='cuda:0', dtype=torch.float16) tensor(0.0013, device='cuda:0', dtype=torch.float16)
tensor(0.0288, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
tensor(0.0341, device='cuda:0', dtype=torch.float16) tensor(0.0012, device='cuda:0', dtype=torch.float16)
0 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.6963, device='cuda:0', dtype=torch.float16) tensor(0.0189, device='cuda:0', dtype=torch.float16)
tensor(0.6865, device='cuda:0', dtype=torch.float16) tensor(0.0191, device='cuda:0', dtype=torch.float16)
tensor(0.6973, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
tensor(0.6919, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.0241, device='cuda:0')
old_score: tensor(0.0195, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0168, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.488093852996826
Validation after dual ascent:
out_inf: tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.0512, device='cuda:0', dtype=torch.float16)
tensor(0.6484, device='cuda:0', dtype=torch.float16) tensor(0.0163, device='cuda:0', dtype=torch.float16)
tensor(0.6182, device='cuda:0', dtype=torch.float16) tensor(0.0162, device='cuda:0', dtype=torch.float16)
tensor(0.6636, device='cuda:0', dtype=torch.float16) tensor(0.0183, device='cuda:0', dtype=torch.float16)
tensor(0.6504, device='cuda:0', dtype=torch.float16) tensor(0.0164, device='cuda:0', dtype=torch.float16)
0 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.6245, device='cuda:0', dtype=torch.float16) tensor(0.0184, device='cuda:0', dtype=torch.float16)
tensor(0.6792, device='cuda:0', dtype=torch.float16) tensor(0.0186, device='cuda:0', dtype=torch.float16)
tensor(0.6812, device='cuda:0', dtype=torch.float16) tensor(0.0206, device='cuda:0', dtype=torch.float16)
tensor(0.6201, device='cuda:0', dtype=torch.float16) tensor(0.0185, device='cuda:0', dtype=torch.float16)
tensor(0.0233, device='cuda:0')
old_score: tensor(0.0190, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0164, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.46449899673462
Validation after dual ascent:
out_inf: tensor(1.6016, device='cuda:0', dtype=torch.float16) tensor(0.0439, device='cuda:0', dtype=torch.float16)
tensor(0.5908, device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(0.6377, device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
tensor(0.6655, device='cuda:0', dtype=torch.float16) tensor(0.0179, device='cuda:0', dtype=torch.float16)
tensor(0.5850, device='cuda:0', dtype=torch.float16) tensor(0.0161, device='cuda:0', dtype=torch.float16)
0 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0444, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
tensor(0.0514, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.0505, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.0641, device='cuda:0', dtype=torch.float16) tensor(0.0026, device='cuda:0', dtype=torch.float16)
tensor(0.1411, device='cuda:0')
old_score: tensor(0.0027, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0025, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.15126419067383
Validation after dual ascent:
out_inf: tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0389, device='cuda:0', dtype=torch.float16) tensor(0.0023, device='cuda:0', dtype=torch.float16)
tensor(0.0595, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
tensor(0.0519, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0620, device='cuda:0', dtype=torch.float16) tensor(0.0024, device='cuda:0', dtype=torch.float16)
layer 0 done
1 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.4141, device='cuda:0', dtype=torch.float16) tensor(0.8086, device='cuda:0', dtype=torch.float16)
tensor(1.4238, device='cuda:0', dtype=torch.float16) tensor(0.0335, device='cuda:0', dtype=torch.float16)
tensor(1.5039, device='cuda:0', dtype=torch.float16) tensor(0.0350, device='cuda:0', dtype=torch.float16)
tensor(1.4600, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
tensor(1.4707, device='cuda:0', dtype=torch.float16) tensor(0.0340, device='cuda:0', dtype=torch.float16)
1 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.6758, device='cuda:0', dtype=torch.float16) tensor(0.8149, device='cuda:0', dtype=torch.float16)
tensor(1.4326, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(1.4785, device='cuda:0', dtype=torch.float16) tensor(0.0386, device='cuda:0', dtype=torch.float16)
tensor(1.4229, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
1 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.4824, device='cuda:0', dtype=torch.float16) tensor(0.0325, device='cuda:0', dtype=torch.float16)
tensor(0.3320, device='cuda:0', dtype=torch.float16) tensor(0.0112, device='cuda:0', dtype=torch.float16)
tensor(0.3469, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.3315, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
tensor(0.3398, device='cuda:0', dtype=torch.float16) tensor(0.0112, device='cuda:0', dtype=torch.float16)
tensor(0.0212, device='cuda:0')
old_score: tensor(0.0114, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0100, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.104621887207031
Validation after dual ascent:
out_inf: tensor(1.4824, device='cuda:0', dtype=torch.float16) tensor(0.0325, device='cuda:0', dtype=torch.float16)
tensor(0.3110, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
tensor(0.3232, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
tensor(0.3062, device='cuda:0', dtype=torch.float16) tensor(0.0106, device='cuda:0', dtype=torch.float16)
tensor(0.3176, device='cuda:0', dtype=torch.float16) tensor(0.0098, device='cuda:0', dtype=torch.float16)
1 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.4536, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
tensor(0.0685, device='cuda:0', dtype=torch.float16) tensor(0.0042, device='cuda:0', dtype=torch.float16)
tensor(0.0596, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.0769, device='cuda:0', dtype=torch.float16) tensor(0.0043, device='cuda:0', dtype=torch.float16)
tensor(0.0665, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.0422, device='cuda:0')
old_score: tensor(0.0042, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0039, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.167959690093994
Validation after dual ascent:
out_inf: tensor(0.4536, device='cuda:0', dtype=torch.float16) tensor(0.0096, device='cuda:0', dtype=torch.float16)
tensor(0.0610, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0576, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
tensor(0.0744, device='cuda:0', dtype=torch.float16) tensor(0.0041, device='cuda:0', dtype=torch.float16)
tensor(0.0608, device='cuda:0', dtype=torch.float16) tensor(0.0038, device='cuda:0', dtype=torch.float16)
1 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(42.6250, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(1.5527, device='cuda:0', dtype=torch.float16) tensor(0.0411, device='cuda:0', dtype=torch.float16)
tensor(1.4824, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
tensor(1.4121, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(1.5273, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.0475, device='cuda:0')
old_score: tensor(0.0422, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0375, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.4675452709198
Validation after dual ascent:
out_inf: tensor(42.6250, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(1.1016, device='cuda:0', dtype=torch.float16) tensor(0.0366, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.0366, device='cuda:0', dtype=torch.float16)
tensor(1.0908, device='cuda:0', dtype=torch.float16) tensor(0.0402, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.0367, device='cuda:0', dtype=torch.float16)
1 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(37.1875, device='cuda:0', dtype=torch.float16) tensor(0.0696, device='cuda:0', dtype=torch.float16)
tensor(1.2285, device='cuda:0', dtype=torch.float16) tensor(0.0368, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.0371, device='cuda:0', dtype=torch.float16)
tensor(1.1592, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.0369, device='cuda:0', dtype=torch.float16)
tensor(0.0381, device='cuda:0')
old_score: tensor(0.0377, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0340, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.51305055618286
Validation after dual ascent:
out_inf: tensor(37.1875, device='cuda:0', dtype=torch.float16) tensor(0.0696, device='cuda:0', dtype=torch.float16)
tensor(0.9785, device='cuda:0', dtype=torch.float16) tensor(0.0331, device='cuda:0', dtype=torch.float16)
tensor(1.0664, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
tensor(1.0244, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(1.0098, device='cuda:0', dtype=torch.float16) tensor(0.0332, device='cuda:0', dtype=torch.float16)
1 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2566., device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.5000, device='cuda:0', dtype=torch.float16) tensor(0.0084, device='cuda:0', dtype=torch.float16)
tensor(0.1244, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
tensor(0.1582, device='cuda:0', dtype=torch.float16) tensor(0.0095, device='cuda:0', dtype=torch.float16)
tensor(0.1641, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(0.5226, device='cuda:0')
old_score: tensor(0.0085, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0082, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 99.95540761947632
Validation after dual ascent:
out_inf: tensor(2566., device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0077, device='cuda:0', dtype=torch.float16)
tensor(2.5000, device='cuda:0', dtype=torch.float16) tensor(0.0092, device='cuda:0', dtype=torch.float16)
tensor(2.5000, device='cuda:0', dtype=torch.float16) tensor(0.0079, device='cuda:0', dtype=torch.float16)
layer 1 done
2 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.5859, device='cuda:0', dtype=torch.float16) tensor(0.9829, device='cuda:0', dtype=torch.float16)
tensor(2.1914, device='cuda:0', dtype=torch.float16) tensor(0.0970, device='cuda:0', dtype=torch.float16)
tensor(1.5820, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.5176, device='cuda:0', dtype=torch.float16) tensor(0.1060, device='cuda:0', dtype=torch.float16)
tensor(1.4082, device='cuda:0', dtype=torch.float16) tensor(0.0977, device='cuda:0', dtype=torch.float16)
2 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.6406, device='cuda:0', dtype=torch.float16) tensor(1.1641, device='cuda:0', dtype=torch.float16)
tensor(2.1719, device='cuda:0', dtype=torch.float16) tensor(0.0977, device='cuda:0', dtype=torch.float16)
tensor(2.2734, device='cuda:0', dtype=torch.float16) tensor(0.1004, device='cuda:0', dtype=torch.float16)
tensor(3.0449, device='cuda:0', dtype=torch.float16) tensor(0.1060, device='cuda:0', dtype=torch.float16)
tensor(2.2461, device='cuda:0', dtype=torch.float16) tensor(0.0984, device='cuda:0', dtype=torch.float16)
2 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.8730, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
tensor(0.6055, device='cuda:0', dtype=torch.float16) tensor(0.0506, device='cuda:0', dtype=torch.float16)
tensor(0.4990, device='cuda:0', dtype=torch.float16) tensor(0.0513, device='cuda:0', dtype=torch.float16)
tensor(0.5459, device='cuda:0', dtype=torch.float16) tensor(0.0543, device='cuda:0', dtype=torch.float16)
tensor(0.7129, device='cuda:0', dtype=torch.float16) tensor(0.0505, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0178, device='cuda:0')
tensor(0.0697, device='cuda:0')
old_score: tensor(0.0516, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0460, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.208672523498535
Validation after dual ascent:
out_inf: tensor(2.8730, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
tensor(0.4844, device='cuda:0', dtype=torch.float16) tensor(0.0449, device='cuda:0', dtype=torch.float16)
tensor(0.5181, device='cuda:0', dtype=torch.float16) tensor(0.0450, device='cuda:0', dtype=torch.float16)
tensor(0.5410, device='cuda:0', dtype=torch.float16) tensor(0.0494, device='cuda:0', dtype=torch.float16)
tensor(0.5918, device='cuda:0', dtype=torch.float16) tensor(0.0447, device='cuda:0', dtype=torch.float16)
2 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.1279, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0704, device='cuda:0', dtype=torch.float16) tensor(0.0027, device='cuda:0', dtype=torch.float16)
tensor(0.0861, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0775, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0883, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0753, device='cuda:0')
old_score: tensor(0.0029, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0028, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.152535438537598
Validation after dual ascent:
out_inf: tensor(1.1279, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0539, device='cuda:0', dtype=torch.float16) tensor(0.0025, device='cuda:0', dtype=torch.float16)
tensor(0.0788, device='cuda:0', dtype=torch.float16) tensor(0.0028, device='cuda:0', dtype=torch.float16)
tensor(0.0667, device='cuda:0', dtype=torch.float16) tensor(0.0029, device='cuda:0', dtype=torch.float16)
tensor(0.0636, device='cuda:0', dtype=torch.float16) tensor(0.0027, device='cuda:0', dtype=torch.float16)
2 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.0954, device='cuda:0', dtype=torch.float16)
tensor(0.7129, device='cuda:0', dtype=torch.float16) tensor(0.0515, device='cuda:0', dtype=torch.float16)
tensor(0.6836, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.6016, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
tensor(0.7319, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.0481, device='cuda:0')
old_score: tensor(0.0530, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0487, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.543915033340454
Validation after dual ascent:
out_inf: tensor(2.2070, device='cuda:0', dtype=torch.float16) tensor(0.0954, device='cuda:0', dtype=torch.float16)
tensor(0.6309, device='cuda:0', dtype=torch.float16) tensor(0.0472, device='cuda:0', dtype=torch.float16)
tensor(0.6812, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.6328, device='cuda:0', dtype=torch.float16) tensor(0.0533, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0473, device='cuda:0', dtype=torch.float16)
2 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2656, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
tensor(0.8047, device='cuda:0', dtype=torch.float16) tensor(0.0474, device='cuda:0', dtype=torch.float16)
tensor(0.6934, device='cuda:0', dtype=torch.float16) tensor(0.0473, device='cuda:0', dtype=torch.float16)
tensor(0.8540, device='cuda:0', dtype=torch.float16) tensor(0.0526, device='cuda:0', dtype=torch.float16)
tensor(0.8779, device='cuda:0', dtype=torch.float16) tensor(0.0473, device='cuda:0', dtype=torch.float16)
tensor(0.0382, device='cuda:0')
old_score: tensor(0.0486, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0448, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.4864616394043
Validation after dual ascent:
out_inf: tensor(2.2656, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
tensor(0.6685, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
tensor(0.6104, device='cuda:0', dtype=torch.float16) tensor(0.0433, device='cuda:0', dtype=torch.float16)
tensor(0.7402, device='cuda:0', dtype=torch.float16) tensor(0.0489, device='cuda:0', dtype=torch.float16)
tensor(0.7490, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
2 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.1797, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
tensor(0.0807, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.1300, device='cuda:0', dtype=torch.float16) tensor(0.0069, device='cuda:0', dtype=torch.float16)
tensor(0.0976, device='cuda:0', dtype=torch.float16) tensor(0.0085, device='cuda:0', dtype=torch.float16)
tensor(0.0986, device='cuda:0', dtype=torch.float16) tensor(0.0070, device='cuda:0', dtype=torch.float16)
tensor(0.1603, device='cuda:0')
old_score: tensor(0.0073, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0070, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.28286981582642
Validation after dual ascent:
out_inf: tensor(4.1797, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
tensor(0.0770, device='cuda:0', dtype=torch.float16) tensor(0.0066, device='cuda:0', dtype=torch.float16)
tensor(0.1235, device='cuda:0', dtype=torch.float16) tensor(0.0065, device='cuda:0', dtype=torch.float16)
tensor(0.0971, device='cuda:0', dtype=torch.float16) tensor(0.0081, device='cuda:0', dtype=torch.float16)
tensor(0.0999, device='cuda:0', dtype=torch.float16) tensor(0.0066, device='cuda:0', dtype=torch.float16)
layer 2 done
3 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.7188, device='cuda:0', dtype=torch.float16) tensor(0.8892, device='cuda:0', dtype=torch.float16)
tensor(1.9355, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
tensor(1.4238, device='cuda:0', dtype=torch.float16) tensor(0.1525, device='cuda:0', dtype=torch.float16)
tensor(1.9521, device='cuda:0', dtype=torch.float16) tensor(0.1658, device='cuda:0', dtype=torch.float16)
tensor(1.5098, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(0.0803, device='cuda:0')
old_score: tensor(0.1550, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1357, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.198301076889038
Validation after dual ascent:
out_inf: tensor(18.7188, device='cuda:0', dtype=torch.float16) tensor(0.8892, device='cuda:0', dtype=torch.float16)
tensor(1.8789, device='cuda:0', dtype=torch.float16) tensor(0.1309, device='cuda:0', dtype=torch.float16)
tensor(1.5742, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
tensor(1.8242, device='cuda:0', dtype=torch.float16) tensor(0.1473, device='cuda:0', dtype=torch.float16)
tensor(1.5713, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
3 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.4219, device='cuda:0', dtype=torch.float16) tensor(1.0703, device='cuda:0', dtype=torch.float16)
tensor(2.0430, device='cuda:0', dtype=torch.float16) tensor(0.1541, device='cuda:0', dtype=torch.float16)
tensor(1.6621, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(1.6914, device='cuda:0', dtype=torch.float16) tensor(0.1693, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(0.0840, device='cuda:0')
old_score: tensor(0.1589, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.215927124023438
Validation after dual ascent:
out_inf: tensor(17.4219, device='cuda:0', dtype=torch.float16) tensor(1.0703, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
tensor(1.5088, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.4863, device='cuda:0', dtype=torch.float16) tensor(0.1505, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.1349, device='cuda:0', dtype=torch.float16)
3 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.0879, device='cuda:0', dtype=torch.float16) tensor(0.1774, device='cuda:0', dtype=torch.float16)
tensor(0.7695, device='cuda:0', dtype=torch.float16) tensor(0.0787, device='cuda:0', dtype=torch.float16)
tensor(0.7329, device='cuda:0', dtype=torch.float16) tensor(0.0799, device='cuda:0', dtype=torch.float16)
tensor(0.8042, device='cuda:0', dtype=torch.float16) tensor(0.0862, device='cuda:0', dtype=torch.float16)
tensor(0.7568, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0127, device='cuda:0')
tensor(0.1235, device='cuda:0')
old_score: tensor(0.0810, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0732, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.232475519180298
Validation after dual ascent:
out_inf: tensor(3.0879, device='cuda:0', dtype=torch.float16) tensor(0.1774, device='cuda:0', dtype=torch.float16)
tensor(0.7764, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.7231, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.7432, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
tensor(0.6655, device='cuda:0', dtype=torch.float16) tensor(0.0712, device='cuda:0', dtype=torch.float16)
3 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0092, device='cuda:0', dtype=torch.float16)
tensor(0.0864, device='cuda:0', dtype=torch.float16) tensor(0.0033, device='cuda:0', dtype=torch.float16)
tensor(0.0981, device='cuda:0', dtype=torch.float16) tensor(0.0039, device='cuda:0', dtype=torch.float16)
tensor(0.0676, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
tensor(0.0880, device='cuda:0', dtype=torch.float16) tensor(0.0035, device='cuda:0', dtype=torch.float16)
tensor(0.0736, device='cuda:0')
old_score: tensor(0.0035, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0032, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.126351118087769
Validation after dual ascent:
out_inf: tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0092, device='cuda:0', dtype=torch.float16)
tensor(0.0615, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0830, device='cuda:0', dtype=torch.float16) tensor(0.0036, device='cuda:0', dtype=torch.float16)
tensor(0.0676, device='cuda:0', dtype=torch.float16) tensor(0.0030, device='cuda:0', dtype=torch.float16)
tensor(0.0820, device='cuda:0', dtype=torch.float16) tensor(0.0032, device='cuda:0', dtype=torch.float16)
3 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.7773, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
tensor(0.9600, device='cuda:0', dtype=torch.float16) tensor(0.0616, device='cuda:0', dtype=torch.float16)
tensor(0.9346, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(0.7314, device='cuda:0', dtype=torch.float16) tensor(0.0684, device='cuda:0', dtype=torch.float16)
tensor(1.0283, device='cuda:0', dtype=torch.float16) tensor(0.0619, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0142, device='cuda:0')
tensor(0.0258, device='cuda:0')
old_score: tensor(0.0635, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0582, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 25.776482820510864
Validation after dual ascent:
out_inf: tensor(3.7773, device='cuda:0', dtype=torch.float16) tensor(0.1175, device='cuda:0', dtype=torch.float16)
tensor(0.9131, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
tensor(0.7461, device='cuda:0', dtype=torch.float16) tensor(0.0565, device='cuda:0', dtype=torch.float16)
tensor(0.6313, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(0.9658, device='cuda:0', dtype=torch.float16) tensor(0.0565, device='cuda:0', dtype=torch.float16)
3 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.3594, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
tensor(1.0830, device='cuda:0', dtype=torch.float16) tensor(0.0567, device='cuda:0', dtype=torch.float16)
tensor(0.7656, device='cuda:0', dtype=torch.float16) tensor(0.0571, device='cuda:0', dtype=torch.float16)
tensor(0.7832, device='cuda:0', dtype=torch.float16) tensor(0.0627, device='cuda:0', dtype=torch.float16)
tensor(0.8066, device='cuda:0', dtype=torch.float16) tensor(0.0569, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0186, device='cuda:0')
tensor(0.0293, device='cuda:0')
old_score: tensor(0.0583, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0536, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.996643543243408
Validation after dual ascent:
out_inf: tensor(2.3594, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
tensor(0.9927, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0521, device='cuda:0', dtype=torch.float16)
tensor(0.7236, device='cuda:0', dtype=torch.float16) tensor(0.0584, device='cuda:0', dtype=torch.float16)
tensor(0.8184, device='cuda:0', dtype=torch.float16) tensor(0.0520, device='cuda:0', dtype=torch.float16)
3 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.8579, device='cuda:0', dtype=torch.float16) tensor(0.0205, device='cuda:0', dtype=torch.float16)
tensor(0.0965, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.0966, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.1097, device='cuda:0', dtype=torch.float16) tensor(0.0113, device='cuda:0', dtype=torch.float16)
tensor(0.1000, device='cuda:0', dtype=torch.float16) tensor(0.0101, device='cuda:0', dtype=torch.float16)
tensor(0.1638, device='cuda:0')
old_score: tensor(0.0104, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0098, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.40412616729736
Validation after dual ascent:
out_inf: tensor(0.8579, device='cuda:0', dtype=torch.float16) tensor(0.0205, device='cuda:0', dtype=torch.float16)
tensor(0.0984, device='cuda:0', dtype=torch.float16) tensor(0.0094, device='cuda:0', dtype=torch.float16)
tensor(0.0970, device='cuda:0', dtype=torch.float16) tensor(0.0095, device='cuda:0', dtype=torch.float16)
tensor(0.1121, device='cuda:0', dtype=torch.float16) tensor(0.0108, device='cuda:0', dtype=torch.float16)
tensor(0.1011, device='cuda:0', dtype=torch.float16) tensor(0.0095, device='cuda:0', dtype=torch.float16)
layer 3 done
4 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.3750, device='cuda:0', dtype=torch.float16) tensor(0.8701, device='cuda:0', dtype=torch.float16)
tensor(1.4111, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.1595, device='cuda:0', dtype=torch.float16)
tensor(1.5508, device='cuda:0', dtype=torch.float16) tensor(0.1688, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.1586, device='cuda:0', dtype=torch.float16)
tensor(0.0548, device='cuda:0')
old_score: tensor(0.1608, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1364, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.192076683044434
Validation after dual ascent:
out_inf: tensor(15.3750, device='cuda:0', dtype=torch.float16) tensor(0.8701, device='cuda:0', dtype=torch.float16)
tensor(1.5000, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
tensor(1.2510, device='cuda:0', dtype=torch.float16) tensor(0.1346, device='cuda:0', dtype=torch.float16)
tensor(1.4014, device='cuda:0', dtype=torch.float16) tensor(0.1458, device='cuda:0', dtype=torch.float16)
tensor(1.2998, device='cuda:0', dtype=torch.float16) tensor(0.1335, device='cuda:0', dtype=torch.float16)
4 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.9219, device='cuda:0', dtype=torch.float16) tensor(1.1211, device='cuda:0', dtype=torch.float16)
tensor(1.8750, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
tensor(2.3086, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1697, device='cuda:0', dtype=torch.float16)
tensor(2.1855, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
tensor(0.0598, device='cuda:0')
old_score: tensor(0.1622, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1370, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.179771661758423
Validation after dual ascent:
out_inf: tensor(20.9219, device='cuda:0', dtype=torch.float16) tensor(1.1211, device='cuda:0', dtype=torch.float16)
tensor(1.8574, device='cuda:0', dtype=torch.float16) tensor(0.1322, device='cuda:0', dtype=torch.float16)
tensor(1.8330, device='cuda:0', dtype=torch.float16) tensor(0.1356, device='cuda:0', dtype=torch.float16)
tensor(1.2295, device='cuda:0', dtype=torch.float16) tensor(0.1461, device='cuda:0', dtype=torch.float16)
tensor(1.8262, device='cuda:0', dtype=torch.float16) tensor(0.1339, device='cuda:0', dtype=torch.float16)
4 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.5059, device='cuda:0', dtype=torch.float16) tensor(0.1965, device='cuda:0', dtype=torch.float16)
tensor(0.6997, device='cuda:0', dtype=torch.float16) tensor(0.0813, device='cuda:0', dtype=torch.float16)
tensor(0.8481, device='cuda:0', dtype=torch.float16) tensor(0.0831, device='cuda:0', dtype=torch.float16)
tensor(0.6909, device='cuda:0', dtype=torch.float16) tensor(0.0873, device='cuda:0', dtype=torch.float16)
tensor(0.7935, device='cuda:0', dtype=torch.float16) tensor(0.0819, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0112, device='cuda:0')
tensor(0.1028, device='cuda:0')
old_score: tensor(0.0834, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0731, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2235107421875
Validation after dual ascent:
out_inf: tensor(3.5059, device='cuda:0', dtype=torch.float16) tensor(0.1965, device='cuda:0', dtype=torch.float16)
tensor(0.6709, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.8354, device='cuda:0', dtype=torch.float16) tensor(0.0721, device='cuda:0', dtype=torch.float16)
tensor(0.6353, device='cuda:0', dtype=torch.float16) tensor(0.0782, device='cuda:0', dtype=torch.float16)
tensor(0.7891, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
4 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5273, device='cuda:0', dtype=torch.float16) tensor(0.0232, device='cuda:0', dtype=torch.float16)
tensor(0.1497, device='cuda:0', dtype=torch.float16) tensor(0.0095, device='cuda:0', dtype=torch.float16)
tensor(0.1340, device='cuda:0', dtype=torch.float16) tensor(0.0108, device='cuda:0', dtype=torch.float16)
tensor(0.1146, device='cuda:0', dtype=torch.float16) tensor(0.0090, device='cuda:0', dtype=torch.float16)
tensor(0.1493, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.0742, device='cuda:0')
old_score: tensor(0.0097, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0088, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.145848751068115
Validation after dual ascent:
out_inf: tensor(4.5273, device='cuda:0', dtype=torch.float16) tensor(0.0232, device='cuda:0', dtype=torch.float16)
tensor(0.1431, device='cuda:0', dtype=torch.float16) tensor(0.0086, device='cuda:0', dtype=torch.float16)
tensor(0.1198, device='cuda:0', dtype=torch.float16) tensor(0.0097, device='cuda:0', dtype=torch.float16)
tensor(0.1096, device='cuda:0', dtype=torch.float16) tensor(0.0080, device='cuda:0', dtype=torch.float16)
tensor(0.1426, device='cuda:0', dtype=torch.float16) tensor(0.0087, device='cuda:0', dtype=torch.float16)
4 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7344, device='cuda:0', dtype=torch.float16) tensor(0.1769, device='cuda:0', dtype=torch.float16)
tensor(1.1611, device='cuda:0', dtype=torch.float16) tensor(0.0768, device='cuda:0', dtype=torch.float16)
tensor(1.1973, device='cuda:0', dtype=torch.float16) tensor(0.0768, device='cuda:0', dtype=torch.float16)
tensor(1.0020, device='cuda:0', dtype=torch.float16) tensor(0.0801, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0191, device='cuda:0')
tensor(0.0201, device='cuda:0')
old_score: tensor(0.0777, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0692, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.168626546859741
Validation after dual ascent:
out_inf: tensor(4.7344, device='cuda:0', dtype=torch.float16) tensor(0.1769, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0682, device='cuda:0', dtype=torch.float16)
tensor(0.9229, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.8428, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(0.8721, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
4 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.2402, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.0680, device='cuda:0', dtype=torch.float16)
tensor(1.1133, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.9688, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0683, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0193, device='cuda:0')
tensor(0.0494, device='cuda:0')
old_score: tensor(0.0687, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0616, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.211332559585571
Validation after dual ascent:
out_inf: tensor(3.2402, device='cuda:0', dtype=torch.float16) tensor(0.1404, device='cuda:0', dtype=torch.float16)
tensor(0.9453, device='cuda:0', dtype=torch.float16) tensor(0.0607, device='cuda:0', dtype=torch.float16)
tensor(0.9619, device='cuda:0', dtype=torch.float16) tensor(0.0601, device='cuda:0', dtype=torch.float16)
tensor(0.8311, device='cuda:0', dtype=torch.float16) tensor(0.0645, device='cuda:0', dtype=torch.float16)
tensor(0.8789, device='cuda:0', dtype=torch.float16) tensor(0.0610, device='cuda:0', dtype=torch.float16)
4 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.2422, device='cuda:0', dtype=torch.float16) tensor(0.0419, device='cuda:0', dtype=torch.float16)
tensor(0.2196, device='cuda:0', dtype=torch.float16) tensor(0.0175, device='cuda:0', dtype=torch.float16)
tensor(0.2013, device='cuda:0', dtype=torch.float16) tensor(0.0176, device='cuda:0', dtype=torch.float16)
tensor(0.1646, device='cuda:0', dtype=torch.float16) tensor(0.0175, device='cuda:0', dtype=torch.float16)
tensor(0.1672, device='cuda:0', dtype=torch.float16) tensor(0.0176, device='cuda:0', dtype=torch.float16)
tensor(0.1311, device='cuda:0')
old_score: tensor(0.0175, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0164, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.30080080032349
Validation after dual ascent:
out_inf: tensor(9.2422, device='cuda:0', dtype=torch.float16) tensor(0.0419, device='cuda:0', dtype=torch.float16)
tensor(0.1969, device='cuda:0', dtype=torch.float16) tensor(0.0163, device='cuda:0', dtype=torch.float16)
tensor(0.1799, device='cuda:0', dtype=torch.float16) tensor(0.0164, device='cuda:0', dtype=torch.float16)
tensor(0.1582, device='cuda:0', dtype=torch.float16) tensor(0.0165, device='cuda:0', dtype=torch.float16)
tensor(0.1625, device='cuda:0', dtype=torch.float16) tensor(0.0165, device='cuda:0', dtype=torch.float16)
layer 4 done
5 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.4297, device='cuda:0', dtype=torch.float16) tensor(0.8521, device='cuda:0', dtype=torch.float16)
tensor(1.4131, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(1.4561, device='cuda:0', dtype=torch.float16) tensor(0.1566, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
tensor(0.2296, device='cuda:0')
old_score: tensor(0.1543, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1240, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.164809226989746
Validation after dual ascent:
out_inf: tensor(15.4297, device='cuda:0', dtype=torch.float16) tensor(0.8521, device='cuda:0', dtype=torch.float16)
tensor(1.1787, device='cuda:0', dtype=torch.float16) tensor(0.1211, device='cuda:0', dtype=torch.float16)
tensor(1.5098, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
tensor(1.3145, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.1223, device='cuda:0', dtype=torch.float16)
5 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.2344, device='cuda:0', dtype=torch.float16) tensor(1.0996, device='cuda:0', dtype=torch.float16)
tensor(1.3320, device='cuda:0', dtype=torch.float16) tensor(0.1582, device='cuda:0', dtype=torch.float16)
tensor(1.7334, device='cuda:0', dtype=torch.float16) tensor(0.1622, device='cuda:0', dtype=torch.float16)
tensor(1.4102, device='cuda:0', dtype=torch.float16) tensor(0.1633, device='cuda:0', dtype=torch.float16)
tensor(1.3818, device='cuda:0', dtype=torch.float16) tensor(0.1593, device='cuda:0', dtype=torch.float16)
tensor(0.2284, device='cuda:0')
old_score: tensor(0.1608, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1279, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.185463905334473
Validation after dual ascent:
out_inf: tensor(18.2344, device='cuda:0', dtype=torch.float16) tensor(1.0996, device='cuda:0', dtype=torch.float16)
tensor(1.2354, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
tensor(1.5586, device='cuda:0', dtype=torch.float16) tensor(0.1285, device='cuda:0', dtype=torch.float16)
tensor(1.2324, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
5 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2539, device='cuda:0', dtype=torch.float16) tensor(0.2113, device='cuda:0', dtype=torch.float16)
tensor(0.6987, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
tensor(0.6719, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
tensor(0.6704, device='cuda:0', dtype=torch.float16) tensor(0.0812, device='cuda:0', dtype=torch.float16)
tensor(0.6855, device='cuda:0', dtype=torch.float16) tensor(0.0798, device='cuda:0', dtype=torch.float16)
tensor(0.1048, device='cuda:0')
old_score: tensor(0.0803, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0669, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.154357194900513
Validation after dual ascent:
out_inf: tensor(2.2539, device='cuda:0', dtype=torch.float16) tensor(0.2113, device='cuda:0', dtype=torch.float16)
tensor(0.6445, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
tensor(0.6050, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.5928, device='cuda:0', dtype=torch.float16) tensor(0.0692, device='cuda:0', dtype=torch.float16)
tensor(0.5825, device='cuda:0', dtype=torch.float16) tensor(0.0660, device='cuda:0', dtype=torch.float16)
5 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
tensor(0.1799, device='cuda:0', dtype=torch.float16) tensor(0.0132, device='cuda:0', dtype=torch.float16)
tensor(0.2040, device='cuda:0', dtype=torch.float16) tensor(0.0137, device='cuda:0', dtype=torch.float16)
tensor(0.2015, device='cuda:0', dtype=torch.float16) tensor(0.0137, device='cuda:0', dtype=torch.float16)
tensor(0.1772, device='cuda:0', dtype=torch.float16) tensor(0.0128, device='cuda:0', dtype=torch.float16)
tensor(0.0884, device='cuda:0')
old_score: tensor(0.0134, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0117, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.141572952270508
Validation after dual ascent:
out_inf: tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
tensor(0.1575, device='cuda:0', dtype=torch.float16) tensor(0.0114, device='cuda:0', dtype=torch.float16)
tensor(0.1580, device='cuda:0', dtype=torch.float16) tensor(0.0121, device='cuda:0', dtype=torch.float16)
tensor(0.1543, device='cuda:0', dtype=torch.float16) tensor(0.0119, device='cuda:0', dtype=torch.float16)
tensor(0.1602, device='cuda:0', dtype=torch.float16) tensor(0.0112, device='cuda:0', dtype=torch.float16)
5 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.5918, device='cuda:0', dtype=torch.float16) tensor(0.2179, device='cuda:0', dtype=torch.float16)
tensor(0.8584, device='cuda:0', dtype=torch.float16) tensor(0.0707, device='cuda:0', dtype=torch.float16)
tensor(0.8984, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.7549, device='cuda:0', dtype=torch.float16) tensor(0.0709, device='cuda:0', dtype=torch.float16)
tensor(0.8130, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
Converged at iteration 800
tensor(0.0184, device='cuda:0')
tensor(0.0268, device='cuda:0')
old_score: tensor(0.0718, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0588, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.754883766174316
Validation after dual ascent:
out_inf: tensor(3.5918, device='cuda:0', dtype=torch.float16) tensor(0.2179, device='cuda:0', dtype=torch.float16)
tensor(0.7041, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.0608, device='cuda:0', dtype=torch.float16)
tensor(0.6201, device='cuda:0', dtype=torch.float16) tensor(0.0588, device='cuda:0', dtype=torch.float16)
tensor(0.7700, device='cuda:0', dtype=torch.float16) tensor(0.0580, device='cuda:0', dtype=torch.float16)
5 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.9043, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(1.0693, device='cuda:0', dtype=torch.float16) tensor(0.0614, device='cuda:0', dtype=torch.float16)
tensor(0.7568, device='cuda:0', dtype=torch.float16) tensor(0.0646, device='cuda:0', dtype=torch.float16)
tensor(0.6982, device='cuda:0', dtype=torch.float16) tensor(0.0617, device='cuda:0', dtype=torch.float16)
tensor(0.7656, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0189, device='cuda:0')
tensor(0.0364, device='cuda:0')
old_score: tensor(0.0624, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0519, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 16.050442934036255
Validation after dual ascent:
out_inf: tensor(3.9043, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.0507, device='cuda:0', dtype=torch.float16)
tensor(0.7217, device='cuda:0', dtype=torch.float16) tensor(0.0537, device='cuda:0', dtype=torch.float16)
tensor(0.6787, device='cuda:0', dtype=torch.float16) tensor(0.0520, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0513, device='cuda:0', dtype=torch.float16)
5 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.0547, device='cuda:0', dtype=torch.float16) tensor(0.0491, device='cuda:0', dtype=torch.float16)
tensor(0.1715, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.1545, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
tensor(0.1697, device='cuda:0', dtype=torch.float16) tensor(0.0150, device='cuda:0', dtype=torch.float16)
tensor(0.1790, device='cuda:0', dtype=torch.float16) tensor(0.0158, device='cuda:0', dtype=torch.float16)
tensor(0.1633, device='cuda:0')
old_score: tensor(0.0158, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0143, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.4182641506195
Validation after dual ascent:
out_inf: tensor(2.0547, device='cuda:0', dtype=torch.float16) tensor(0.0491, device='cuda:0', dtype=torch.float16)
tensor(0.1820, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.1519, device='cuda:0', dtype=torch.float16) tensor(0.0152, device='cuda:0', dtype=torch.float16)
tensor(0.1542, device='cuda:0', dtype=torch.float16) tensor(0.0137, device='cuda:0', dtype=torch.float16)
tensor(0.1671, device='cuda:0', dtype=torch.float16) tensor(0.0142, device='cuda:0', dtype=torch.float16)
layer 5 done
6 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.6250, device='cuda:0', dtype=torch.float16) tensor(0.8647, device='cuda:0', dtype=torch.float16)
tensor(1.3018, device='cuda:0', dtype=torch.float16) tensor(0.1672, device='cuda:0', dtype=torch.float16)
tensor(1.5068, device='cuda:0', dtype=torch.float16) tensor(0.1759, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1704, device='cuda:0', dtype=torch.float16)
tensor(1.4287, device='cuda:0', dtype=torch.float16) tensor(0.1685, device='cuda:0', dtype=torch.float16)
tensor(0.1737, device='cuda:0')
old_score: tensor(0.1705, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1317, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.181572198867798
Validation after dual ascent:
out_inf: tensor(14.6250, device='cuda:0', dtype=torch.float16) tensor(0.8647, device='cuda:0', dtype=torch.float16)
tensor(1.1650, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
tensor(1.3115, device='cuda:0', dtype=torch.float16) tensor(0.1368, device='cuda:0', dtype=torch.float16)
tensor(1.3467, device='cuda:0', dtype=torch.float16) tensor(0.1331, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
6 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.8438, device='cuda:0', dtype=torch.float16) tensor(1.0566, device='cuda:0', dtype=torch.float16)
tensor(1.5605, device='cuda:0', dtype=torch.float16) tensor(0.1702, device='cuda:0', dtype=torch.float16)
tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.1785, device='cuda:0', dtype=torch.float16)
tensor(1.4453, device='cuda:0', dtype=torch.float16) tensor(0.1711, device='cuda:0', dtype=torch.float16)
tensor(1.7051, device='cuda:0', dtype=torch.float16) tensor(0.1708, device='cuda:0', dtype=torch.float16)
tensor(0.1879, device='cuda:0')
old_score: tensor(0.1726, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1326, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.199249744415283
Validation after dual ascent:
out_inf: tensor(17.8438, device='cuda:0', dtype=torch.float16) tensor(1.0566, device='cuda:0', dtype=torch.float16)
tensor(1.3926, device='cuda:0', dtype=torch.float16) tensor(0.1287, device='cuda:0', dtype=torch.float16)
tensor(1.2695, device='cuda:0', dtype=torch.float16) tensor(0.1381, device='cuda:0', dtype=torch.float16)
tensor(1.1260, device='cuda:0', dtype=torch.float16) tensor(0.1335, device='cuda:0', dtype=torch.float16)
tensor(1.3955, device='cuda:0', dtype=torch.float16) tensor(0.1300, device='cuda:0', dtype=torch.float16)
6 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.2070, device='cuda:0', dtype=torch.float16) tensor(0.2424, device='cuda:0', dtype=torch.float16)
tensor(0.6665, device='cuda:0', dtype=torch.float16) tensor(0.0851, device='cuda:0', dtype=torch.float16)
tensor(0.6650, device='cuda:0', dtype=torch.float16) tensor(0.0897, device='cuda:0', dtype=torch.float16)
tensor(0.7305, device='cuda:0', dtype=torch.float16) tensor(0.0863, device='cuda:0', dtype=torch.float16)
tensor(0.6929, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0146, device='cuda:0')
tensor(0.0546, device='cuda:0')
old_score: tensor(0.0867, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0693, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.964621067047119
Validation after dual ascent:
out_inf: tensor(3.2070, device='cuda:0', dtype=torch.float16) tensor(0.2424, device='cuda:0', dtype=torch.float16)
tensor(0.7266, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.6245, device='cuda:0', dtype=torch.float16) tensor(0.0720, device='cuda:0', dtype=torch.float16)
tensor(0.6250, device='cuda:0', dtype=torch.float16) tensor(0.0700, device='cuda:0', dtype=torch.float16)
tensor(0.5762, device='cuda:0', dtype=torch.float16) tensor(0.0678, device='cuda:0', dtype=torch.float16)
6 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.3145, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.2073, device='cuda:0', dtype=torch.float16) tensor(0.0138, device='cuda:0', dtype=torch.float16)
tensor(0.1962, device='cuda:0', dtype=torch.float16) tensor(0.0165, device='cuda:0', dtype=torch.float16)
tensor(0.2358, device='cuda:0', dtype=torch.float16) tensor(0.0148, device='cuda:0', dtype=torch.float16)
tensor(0.1982, device='cuda:0', dtype=torch.float16) tensor(0.0141, device='cuda:0', dtype=torch.float16)
tensor(0.0839, device='cuda:0')
old_score: tensor(0.0148, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0125, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.148910999298096
Validation after dual ascent:
out_inf: tensor(3.3145, device='cuda:0', dtype=torch.float16) tensor(0.0398, device='cuda:0', dtype=torch.float16)
tensor(0.1598, device='cuda:0', dtype=torch.float16) tensor(0.0115, device='cuda:0', dtype=torch.float16)
tensor(0.1962, device='cuda:0', dtype=torch.float16) tensor(0.0142, device='cuda:0', dtype=torch.float16)
tensor(0.1818, device='cuda:0', dtype=torch.float16) tensor(0.0125, device='cuda:0', dtype=torch.float16)
tensor(0.1638, device='cuda:0', dtype=torch.float16) tensor(0.0118, device='cuda:0', dtype=torch.float16)
6 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.6445, device='cuda:0', dtype=torch.float16) tensor(0.2430, device='cuda:0', dtype=torch.float16)
tensor(1.1738, device='cuda:0', dtype=torch.float16) tensor(0.0743, device='cuda:0', dtype=torch.float16)
tensor(0.9043, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(0.7227, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(0.9487, device='cuda:0', dtype=torch.float16) tensor(0.0746, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0189, device='cuda:0')
tensor(0.0209, device='cuda:0')
old_score: tensor(0.0759, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0616, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.079945802688599
Validation after dual ascent:
out_inf: tensor(3.6445, device='cuda:0', dtype=torch.float16) tensor(0.2430, device='cuda:0', dtype=torch.float16)
tensor(0.8350, device='cuda:0', dtype=torch.float16) tensor(0.0598, device='cuda:0', dtype=torch.float16)
tensor(0.7002, device='cuda:0', dtype=torch.float16) tensor(0.0636, device='cuda:0', dtype=torch.float16)
tensor(0.7095, device='cuda:0', dtype=torch.float16) tensor(0.0632, device='cuda:0', dtype=torch.float16)
tensor(0.8145, device='cuda:0', dtype=torch.float16) tensor(0.0599, device='cuda:0', dtype=torch.float16)
6 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.6621, device='cuda:0', dtype=torch.float16) tensor(0.1609, device='cuda:0', dtype=torch.float16)
tensor(0.7866, device='cuda:0', dtype=torch.float16) tensor(0.0635, device='cuda:0', dtype=torch.float16)
tensor(0.7598, device='cuda:0', dtype=torch.float16) tensor(0.0666, device='cuda:0', dtype=torch.float16)
tensor(0.7510, device='cuda:0', dtype=torch.float16) tensor(0.0659, device='cuda:0', dtype=torch.float16)
tensor(0.8193, device='cuda:0', dtype=torch.float16) tensor(0.0637, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0153, device='cuda:0')
tensor(0.0191, device='cuda:0')
old_score: tensor(0.0649, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0535, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.10819387435913
Validation after dual ascent:
out_inf: tensor(3.6621, device='cuda:0', dtype=torch.float16) tensor(0.1609, device='cuda:0', dtype=torch.float16)
tensor(0.7065, device='cuda:0', dtype=torch.float16) tensor(0.0518, device='cuda:0', dtype=torch.float16)
tensor(0.6631, device='cuda:0', dtype=torch.float16) tensor(0.0551, device='cuda:0', dtype=torch.float16)
tensor(0.6064, device='cuda:0', dtype=torch.float16) tensor(0.0549, device='cuda:0', dtype=torch.float16)
tensor(0.7422, device='cuda:0', dtype=torch.float16) tensor(0.0520, device='cuda:0', dtype=torch.float16)
6 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.8623, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.1637, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
tensor(0.1964, device='cuda:0', dtype=torch.float16) tensor(0.0179, device='cuda:0', dtype=torch.float16)
tensor(0.1698, device='cuda:0', dtype=torch.float16) tensor(0.0169, device='cuda:0', dtype=torch.float16)
tensor(0.1614, device='cuda:0', dtype=torch.float16) tensor(0.0168, device='cuda:0', dtype=torch.float16)
tensor(0.1593, device='cuda:0')
old_score: tensor(0.0171, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0153, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.25429463386536
Validation after dual ascent:
out_inf: tensor(1.8623, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.1591, device='cuda:0', dtype=torch.float16) tensor(0.0149, device='cuda:0', dtype=torch.float16)
tensor(0.1986, device='cuda:0', dtype=torch.float16) tensor(0.0161, device='cuda:0', dtype=torch.float16)
tensor(0.1660, device='cuda:0', dtype=torch.float16) tensor(0.0153, device='cuda:0', dtype=torch.float16)
tensor(0.1697, device='cuda:0', dtype=torch.float16) tensor(0.0149, device='cuda:0', dtype=torch.float16)
layer 6 done
7 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.6094, device='cuda:0', dtype=torch.float16) tensor(0.8730, device='cuda:0', dtype=torch.float16)
tensor(2.9883, device='cuda:0', dtype=torch.float16) tensor(0.1804, device='cuda:0', dtype=torch.float16)
tensor(2.5977, device='cuda:0', dtype=torch.float16) tensor(0.1898, device='cuda:0', dtype=torch.float16)
tensor(2.4980, device='cuda:0', dtype=torch.float16) tensor(0.1868, device='cuda:0', dtype=torch.float16)
tensor(1.5273, device='cuda:0', dtype=torch.float16) tensor(0.1835, device='cuda:0', dtype=torch.float16)
tensor(0.1262, device='cuda:0')
old_score: tensor(0.1851, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1467, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.219861030578613
Validation after dual ascent:
out_inf: tensor(20.6094, device='cuda:0', dtype=torch.float16) tensor(0.8730, device='cuda:0', dtype=torch.float16)
tensor(2.7539, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(2.4297, device='cuda:0', dtype=torch.float16) tensor(0.1511, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
tensor(1.2480, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
7 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(1.6973, device='cuda:0', dtype=torch.float16) tensor(0.1813, device='cuda:0', dtype=torch.float16)
tensor(2.1035, device='cuda:0', dtype=torch.float16) tensor(0.1902, device='cuda:0', dtype=torch.float16)
tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.1873, device='cuda:0', dtype=torch.float16)
tensor(1.9160, device='cuda:0', dtype=torch.float16) tensor(0.1841, device='cuda:0', dtype=torch.float16)
tensor(0.1350, device='cuda:0')
old_score: tensor(0.1857, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1458, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.171313285827637
Validation after dual ascent:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(1.0264, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.1414, device='cuda:0', dtype=torch.float16)
tensor(1.4268, device='cuda:0', dtype=torch.float16) tensor(0.1500, device='cuda:0', dtype=torch.float16)
tensor(2.0645, device='cuda:0', dtype=torch.float16) tensor(0.1484, device='cuda:0', dtype=torch.float16)
tensor(1.5742, device='cuda:0', dtype=torch.float16) tensor(0.1432, device='cuda:0', dtype=torch.float16)
7 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.2422, device='cuda:0', dtype=torch.float16)
tensor(0.7251, device='cuda:0', dtype=torch.float16) tensor(0.0934, device='cuda:0', dtype=torch.float16)
tensor(0.7852, device='cuda:0', dtype=torch.float16) tensor(0.0978, device='cuda:0', dtype=torch.float16)
tensor(0.7783, device='cuda:0', dtype=torch.float16) tensor(0.0964, device='cuda:0', dtype=torch.float16)
tensor(0.6929, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0140, device='cuda:0')
tensor(0.1301, device='cuda:0')
old_score: tensor(0.0955, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0780, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2267465591430664
Validation after dual ascent:
out_inf: tensor(4.5195, device='cuda:0', dtype=torch.float16) tensor(0.2422, device='cuda:0', dtype=torch.float16)
tensor(0.6582, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(0.6787, device='cuda:0', dtype=torch.float16) tensor(0.0802, device='cuda:0', dtype=torch.float16)
tensor(0.6426, device='cuda:0', dtype=torch.float16) tensor(0.0794, device='cuda:0', dtype=torch.float16)
tensor(0.6660, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
7 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.1250, device='cuda:0', dtype=torch.float16) tensor(0.0477, device='cuda:0', dtype=torch.float16)
tensor(0.1978, device='cuda:0', dtype=torch.float16) tensor(0.0190, device='cuda:0', dtype=torch.float16)
tensor(0.2220, device='cuda:0', dtype=torch.float16) tensor(0.0209, device='cuda:0', dtype=torch.float16)
tensor(0.2388, device='cuda:0', dtype=torch.float16) tensor(0.0221, device='cuda:0', dtype=torch.float16)
tensor(0.1980, device='cuda:0', dtype=torch.float16) tensor(0.0182, device='cuda:0', dtype=torch.float16)
tensor(0.0725, device='cuda:0')
old_score: tensor(0.0201, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0175, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.082467079162598
Validation after dual ascent:
out_inf: tensor(3.1250, device='cuda:0', dtype=torch.float16) tensor(0.0477, device='cuda:0', dtype=torch.float16)
tensor(0.1882, device='cuda:0', dtype=torch.float16) tensor(0.0165, device='cuda:0', dtype=torch.float16)
tensor(0.2008, device='cuda:0', dtype=torch.float16) tensor(0.0183, device='cuda:0', dtype=torch.float16)
tensor(0.2271, device='cuda:0', dtype=torch.float16) tensor(0.0194, device='cuda:0', dtype=torch.float16)
tensor(0.1733, device='cuda:0', dtype=torch.float16) tensor(0.0159, device='cuda:0', dtype=torch.float16)
7 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.8203, device='cuda:0', dtype=torch.float16) tensor(0.2494, device='cuda:0', dtype=torch.float16)
tensor(1.0879, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(1.3818, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
tensor(1.2344, device='cuda:0', dtype=torch.float16) tensor(0.0881, device='cuda:0', dtype=torch.float16)
tensor(1.1270, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0130, device='cuda:0')
tensor(0.0210, device='cuda:0')
old_score: tensor(0.0870, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0717, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.141924381256104
Validation after dual ascent:
out_inf: tensor(5.8203, device='cuda:0', dtype=torch.float16) tensor(0.2494, device='cuda:0', dtype=torch.float16)
tensor(0.9580, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
tensor(0.8359, device='cuda:0', dtype=torch.float16) tensor(0.0733, device='cuda:0', dtype=torch.float16)
tensor(0.9556, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
7 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.9121, device='cuda:0', dtype=torch.float16) tensor(0.1761, device='cuda:0', dtype=torch.float16)
tensor(0.9531, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(1.1240, device='cuda:0', dtype=torch.float16) tensor(0.0765, device='cuda:0', dtype=torch.float16)
tensor(1.0234, device='cuda:0', dtype=torch.float16) tensor(0.0762, device='cuda:0', dtype=torch.float16)
tensor(0.9258, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0146, device='cuda:0')
tensor(0.0730, device='cuda:0')
old_score: tensor(0.0751, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0625, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.180291175842285
Validation after dual ascent:
out_inf: tensor(3.9121, device='cuda:0', dtype=torch.float16) tensor(0.1761, device='cuda:0', dtype=torch.float16)
tensor(0.6592, device='cuda:0', dtype=torch.float16) tensor(0.0611, device='cuda:0', dtype=torch.float16)
tensor(0.8711, device='cuda:0', dtype=torch.float16) tensor(0.0638, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0640, device='cuda:0', dtype=torch.float16)
tensor(0.6562, device='cuda:0', dtype=torch.float16) tensor(0.0612, device='cuda:0', dtype=torch.float16)
7 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.5127, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.2164, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
tensor(0.2244, device='cuda:0', dtype=torch.float16) tensor(0.0225, device='cuda:0', dtype=torch.float16)
tensor(0.2144, device='cuda:0', dtype=torch.float16) tensor(0.0217, device='cuda:0', dtype=torch.float16)
tensor(0.2046, device='cuda:0', dtype=torch.float16) tensor(0.0214, device='cuda:0', dtype=torch.float16)
tensor(0.0987, device='cuda:0')
old_score: tensor(0.0218, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0199, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 99.92915868759155
Validation after dual ascent:
out_inf: tensor(1.5127, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.2065, device='cuda:0', dtype=torch.float16) tensor(0.0197, device='cuda:0', dtype=torch.float16)
tensor(0.2030, device='cuda:0', dtype=torch.float16) tensor(0.0206, device='cuda:0', dtype=torch.float16)
tensor(0.1942, device='cuda:0', dtype=torch.float16) tensor(0.0200, device='cuda:0', dtype=torch.float16)
tensor(0.1803, device='cuda:0', dtype=torch.float16) tensor(0.0195, device='cuda:0', dtype=torch.float16)
layer 7 done
8 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.0938, device='cuda:0', dtype=torch.float16) tensor(0.8330, device='cuda:0', dtype=torch.float16)
tensor(1.7656, device='cuda:0', dtype=torch.float16) tensor(0.1881, device='cuda:0', dtype=torch.float16)
tensor(1.7969, device='cuda:0', dtype=torch.float16) tensor(0.1989, device='cuda:0', dtype=torch.float16)
tensor(2.3125, device='cuda:0', dtype=torch.float16) tensor(0.1927, device='cuda:0', dtype=torch.float16)
tensor(1.9619, device='cuda:0', dtype=torch.float16) tensor(0.1898, device='cuda:0', dtype=torch.float16)
tensor(0.0893, device='cuda:0')
old_score: tensor(0.1924, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1541, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.198382377624512
Validation after dual ascent:
out_inf: tensor(20.0938, device='cuda:0', dtype=torch.float16) tensor(0.8330, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.1500, device='cuda:0', dtype=torch.float16)
tensor(1.5088, device='cuda:0', dtype=torch.float16) tensor(0.1597, device='cuda:0', dtype=torch.float16)
tensor(1.7842, device='cuda:0', dtype=torch.float16) tensor(0.1552, device='cuda:0', dtype=torch.float16)
tensor(1.6152, device='cuda:0', dtype=torch.float16) tensor(0.1512, device='cuda:0', dtype=torch.float16)
8 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.7344, device='cuda:0', dtype=torch.float16) tensor(1.0381, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.1887, device='cuda:0', dtype=torch.float16)
tensor(1.5840, device='cuda:0', dtype=torch.float16) tensor(0.1993, device='cuda:0', dtype=torch.float16)
tensor(2.1094, device='cuda:0', dtype=torch.float16) tensor(0.1925, device='cuda:0', dtype=torch.float16)
tensor(1.4922, device='cuda:0', dtype=torch.float16) tensor(0.1901, device='cuda:0', dtype=torch.float16)
tensor(0.0918, device='cuda:0')
old_score: tensor(0.1926, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1531, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.149295091629028
Validation after dual ascent:
out_inf: tensor(16.7344, device='cuda:0', dtype=torch.float16) tensor(1.0381, device='cuda:0', dtype=torch.float16)
tensor(1.4502, device='cuda:0', dtype=torch.float16) tensor(0.1494, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1584, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(1.1904, device='cuda:0', dtype=torch.float16) tensor(0.1500, device='cuda:0', dtype=torch.float16)
8 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8359, device='cuda:0', dtype=torch.float16) tensor(0.2747, device='cuda:0', dtype=torch.float16)
tensor(0.8188, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.8154, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
tensor(0.7686, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
tensor(0.8208, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0188, device='cuda:0')
tensor(0.2294, device='cuda:0')
old_score: tensor(0.1043, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0854, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.477776050567627
Validation after dual ascent:
out_inf: tensor(4.8359, device='cuda:0', dtype=torch.float16) tensor(0.2747, device='cuda:0', dtype=torch.float16)
tensor(0.7520, device='cuda:0', dtype=torch.float16) tensor(0.0835, device='cuda:0', dtype=torch.float16)
tensor(0.7007, device='cuda:0', dtype=torch.float16) tensor(0.0883, device='cuda:0', dtype=torch.float16)
tensor(0.6826, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(0.8042, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
8 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.1680, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(0.3120, device='cuda:0', dtype=torch.float16) tensor(0.0269, device='cuda:0', dtype=torch.float16)
tensor(0.3127, device='cuda:0', dtype=torch.float16) tensor(0.0310, device='cuda:0', dtype=torch.float16)
tensor(0.2820, device='cuda:0', dtype=torch.float16) tensor(0.0311, device='cuda:0', dtype=torch.float16)
tensor(0.2896, device='cuda:0', dtype=torch.float16) tensor(0.0268, device='cuda:0', dtype=torch.float16)
tensor(0.0546, device='cuda:0')
old_score: tensor(0.0290, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0244, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.054166316986084
Validation after dual ascent:
out_inf: tensor(5.1680, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(0.2220, device='cuda:0', dtype=torch.float16) tensor(0.0226, device='cuda:0', dtype=torch.float16)
tensor(0.2864, device='cuda:0', dtype=torch.float16) tensor(0.0265, device='cuda:0', dtype=torch.float16)
tensor(0.2405, device='cuda:0', dtype=torch.float16) tensor(0.0261, device='cuda:0', dtype=torch.float16)
tensor(0.2568, device='cuda:0', dtype=torch.float16) tensor(0.0225, device='cuda:0', dtype=torch.float16)
8 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(5., device='cuda:0', dtype=torch.float16) tensor(0.2920, device='cuda:0', dtype=torch.float16)
tensor(1.0889, device='cuda:0', dtype=torch.float16) tensor(0.0834, device='cuda:0', dtype=torch.float16)
tensor(0.9023, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(1.0703, device='cuda:0', dtype=torch.float16) tensor(0.0849, device='cuda:0', dtype=torch.float16)
tensor(0.9902, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0190, device='cuda:0')
tensor(0.0229, device='cuda:0')
old_score: tensor(0.0848, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0689, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.138256788253784
Validation after dual ascent:
out_inf: tensor(5., device='cuda:0', dtype=torch.float16) tensor(0.2920, device='cuda:0', dtype=torch.float16)
tensor(0.9482, device='cuda:0', dtype=torch.float16) tensor(0.0676, device='cuda:0', dtype=torch.float16)
tensor(0.8403, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.7764, device='cuda:0', dtype=torch.float16) tensor(0.0687, device='cuda:0', dtype=torch.float16)
tensor(0.7686, device='cuda:0', dtype=torch.float16) tensor(0.0678, device='cuda:0', dtype=torch.float16)
8 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.0703, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.8652, device='cuda:0', dtype=torch.float16) tensor(0.0737, device='cuda:0', dtype=torch.float16)
tensor(0.8135, device='cuda:0', dtype=torch.float16) tensor(0.0771, device='cuda:0', dtype=torch.float16)
tensor(1.0781, device='cuda:0', dtype=torch.float16) tensor(0.0752, device='cuda:0', dtype=torch.float16)
tensor(0.9492, device='cuda:0', dtype=torch.float16) tensor(0.0742, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0151, device='cuda:0')
tensor(0.0674, device='cuda:0')
old_score: tensor(0.0751, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0619, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.173097133636475
Validation after dual ascent:
out_inf: tensor(6.0703, device='cuda:0', dtype=torch.float16) tensor(0.1941, device='cuda:0', dtype=torch.float16)
tensor(0.7500, device='cuda:0', dtype=torch.float16) tensor(0.0606, device='cuda:0', dtype=torch.float16)
tensor(0.7622, device='cuda:0', dtype=torch.float16) tensor(0.0641, device='cuda:0', dtype=torch.float16)
tensor(0.7266, device='cuda:0', dtype=torch.float16) tensor(0.0617, device='cuda:0', dtype=torch.float16)
tensor(0.9312, device='cuda:0', dtype=torch.float16) tensor(0.0609, device='cuda:0', dtype=torch.float16)
8 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.9785, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.2983, device='cuda:0', dtype=torch.float16) tensor(0.0228, device='cuda:0', dtype=torch.float16)
tensor(0.2388, device='cuda:0', dtype=torch.float16) tensor(0.0239, device='cuda:0', dtype=torch.float16)
tensor(0.2125, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(0.2488, device='cuda:0', dtype=torch.float16) tensor(0.0226, device='cuda:0', dtype=torch.float16)
tensor(0.1197, device='cuda:0')
old_score: tensor(0.0231, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0205, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 99.75702953338623
Validation after dual ascent:
out_inf: tensor(3.9785, device='cuda:0', dtype=torch.float16) tensor(0.0671, device='cuda:0', dtype=torch.float16)
tensor(0.2734, device='cuda:0', dtype=torch.float16) tensor(0.0202, device='cuda:0', dtype=torch.float16)
tensor(0.2323, device='cuda:0', dtype=torch.float16) tensor(0.0215, device='cuda:0', dtype=torch.float16)
tensor(0.2217, device='cuda:0', dtype=torch.float16) tensor(0.0204, device='cuda:0', dtype=torch.float16)
tensor(0.2343, device='cuda:0', dtype=torch.float16) tensor(0.0201, device='cuda:0', dtype=torch.float16)
layer 8 done
9 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.7344, device='cuda:0', dtype=torch.float16) tensor(0.8184, device='cuda:0', dtype=torch.float16)
tensor(1.6846, device='cuda:0', dtype=torch.float16) tensor(0.1945, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.2054, device='cuda:0', dtype=torch.float16)
tensor(1.5869, device='cuda:0', dtype=torch.float16) tensor(0.2002, device='cuda:0', dtype=torch.float16)
tensor(1.7383, device='cuda:0', dtype=torch.float16) tensor(0.1962, device='cuda:0', dtype=torch.float16)
tensor(0.0638, device='cuda:0')
old_score: tensor(0.1991, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1587, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.192957878112793
Validation after dual ascent:
out_inf: tensor(13.7344, device='cuda:0', dtype=torch.float16) tensor(0.8184, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(1.4365, device='cuda:0', dtype=torch.float16) tensor(0.1655, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1592, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.1559, device='cuda:0', dtype=torch.float16)
9 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.8281, device='cuda:0', dtype=torch.float16) tensor(1.0312, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.1948, device='cuda:0', dtype=torch.float16)
tensor(1.7793, device='cuda:0', dtype=torch.float16) tensor(0.2063, device='cuda:0', dtype=torch.float16)
tensor(1.9121, device='cuda:0', dtype=torch.float16) tensor(0.1993, device='cuda:0', dtype=torch.float16)
tensor(1.6191, device='cuda:0', dtype=torch.float16) tensor(0.1964, device='cuda:0', dtype=torch.float16)
tensor(0.0712, device='cuda:0')
old_score: tensor(0.1992, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1587, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.177245616912842
Validation after dual ascent:
out_inf: tensor(17.8281, device='cuda:0', dtype=torch.float16) tensor(1.0312, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(1.5332, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(1.4980, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(1.3623, device='cuda:0', dtype=torch.float16) tensor(0.1558, device='cuda:0', dtype=torch.float16)
9 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.5430, device='cuda:0', dtype=torch.float16) tensor(0.2690, device='cuda:0', dtype=torch.float16)
tensor(0.8574, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
tensor(0.8247, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
tensor(0.8047, device='cuda:0', dtype=torch.float16) tensor(0.1069, device='cuda:0', dtype=torch.float16)
tensor(0.8164, device='cuda:0', dtype=torch.float16) tensor(0.1051, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0096, device='cuda:0')
tensor(0.1166, device='cuda:0')
old_score: tensor(0.1067, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0872, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2176291942596436
Validation after dual ascent:
out_inf: tensor(6.5430, device='cuda:0', dtype=torch.float16) tensor(0.2690, device='cuda:0', dtype=torch.float16)
tensor(0.7900, device='cuda:0', dtype=torch.float16) tensor(0.0850, device='cuda:0', dtype=torch.float16)
tensor(0.7354, device='cuda:0', dtype=torch.float16) tensor(0.0909, device='cuda:0', dtype=torch.float16)
tensor(0.7051, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(0.8022, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
9 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.4648, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.2534, device='cuda:0', dtype=torch.float16) tensor(0.0271, device='cuda:0', dtype=torch.float16)
tensor(0.2637, device='cuda:0', dtype=torch.float16) tensor(0.0297, device='cuda:0', dtype=torch.float16)
tensor(0.2534, device='cuda:0', dtype=torch.float16) tensor(0.0295, device='cuda:0', dtype=torch.float16)
tensor(0.2739, device='cuda:0', dtype=torch.float16) tensor(0.0266, device='cuda:0', dtype=torch.float16)
tensor(0.0397, device='cuda:0')
old_score: tensor(0.0282, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0240, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.04255747795105
Validation after dual ascent:
out_inf: tensor(7.4648, device='cuda:0', dtype=torch.float16) tensor(0.0745, device='cuda:0', dtype=torch.float16)
tensor(0.2300, device='cuda:0', dtype=torch.float16) tensor(0.0229, device='cuda:0', dtype=torch.float16)
tensor(0.2812, device='cuda:0', dtype=torch.float16) tensor(0.0255, device='cuda:0', dtype=torch.float16)
tensor(0.2386, device='cuda:0', dtype=torch.float16) tensor(0.0249, device='cuda:0', dtype=torch.float16)
tensor(0.2356, device='cuda:0', dtype=torch.float16) tensor(0.0225, device='cuda:0', dtype=torch.float16)
9 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1562, device='cuda:0', dtype=torch.float16) tensor(0.2830, device='cuda:0', dtype=torch.float16)
tensor(1.0020, device='cuda:0', dtype=torch.float16) tensor(0.0828, device='cuda:0', dtype=torch.float16)
tensor(0.9082, device='cuda:0', dtype=torch.float16) tensor(0.0867, device='cuda:0', dtype=torch.float16)
tensor(1.2354, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.0833, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0181, device='cuda:0')
tensor(0.0231, device='cuda:0')
old_score: tensor(0.0845, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0695, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.150118112564087
Validation after dual ascent:
out_inf: tensor(6.1562, device='cuda:0', dtype=torch.float16) tensor(0.2830, device='cuda:0', dtype=torch.float16)
tensor(0.8398, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.9604, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.9727, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(1.0410, device='cuda:0', dtype=torch.float16) tensor(0.0682, device='cuda:0', dtype=torch.float16)
9 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.2500, device='cuda:0', dtype=torch.float16) tensor(0.1956, device='cuda:0', dtype=torch.float16)
tensor(0.8164, device='cuda:0', dtype=torch.float16) tensor(0.0751, device='cuda:0', dtype=torch.float16)
tensor(0.7871, device='cuda:0', dtype=torch.float16) tensor(0.0787, device='cuda:0', dtype=torch.float16)
tensor(0.7734, device='cuda:0', dtype=torch.float16) tensor(0.0775, device='cuda:0', dtype=torch.float16)
tensor(0.8203, device='cuda:0', dtype=torch.float16) tensor(0.0758, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0151, device='cuda:0')
tensor(0.0731, device='cuda:0')
old_score: tensor(0.0768, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0637, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.1813859939575195
Validation after dual ascent:
out_inf: tensor(8.2500, device='cuda:0', dtype=torch.float16) tensor(0.1956, device='cuda:0', dtype=torch.float16)
tensor(0.7637, device='cuda:0', dtype=torch.float16) tensor(0.0621, device='cuda:0', dtype=torch.float16)
tensor(0.6426, device='cuda:0', dtype=torch.float16) tensor(0.0659, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0641, device='cuda:0', dtype=torch.float16)
tensor(0.7441, device='cuda:0', dtype=torch.float16) tensor(0.0626, device='cuda:0', dtype=torch.float16)
9 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.5781, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
tensor(0.2654, device='cuda:0', dtype=torch.float16) tensor(0.0236, device='cuda:0', dtype=torch.float16)
tensor(0.2371, device='cuda:0', dtype=torch.float16) tensor(0.0247, device='cuda:0', dtype=torch.float16)
tensor(0.2463, device='cuda:0', dtype=torch.float16) tensor(0.0243, device='cuda:0', dtype=torch.float16)
tensor(0.2537, device='cuda:0', dtype=torch.float16) tensor(0.0237, device='cuda:0', dtype=torch.float16)
tensor(0.1108, device='cuda:0')
old_score: tensor(0.0241, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0216, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 99.77873420715332
Validation after dual ascent:
out_inf: tensor(2.5781, device='cuda:0', dtype=torch.float16) tensor(0.0685, device='cuda:0', dtype=torch.float16)
tensor(0.2837, device='cuda:0', dtype=torch.float16) tensor(0.0211, device='cuda:0', dtype=torch.float16)
tensor(0.2142, device='cuda:0', dtype=torch.float16) tensor(0.0224, device='cuda:0', dtype=torch.float16)
tensor(0.2242, device='cuda:0', dtype=torch.float16) tensor(0.0218, device='cuda:0', dtype=torch.float16)
tensor(0.2219, device='cuda:0', dtype=torch.float16) tensor(0.0212, device='cuda:0', dtype=torch.float16)
layer 9 done
10 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.6016, device='cuda:0', dtype=torch.float16) tensor(0.8027, device='cuda:0', dtype=torch.float16)
tensor(1.6904, device='cuda:0', dtype=torch.float16) tensor(0.1919, device='cuda:0', dtype=torch.float16)
tensor(1.6689, device='cuda:0', dtype=torch.float16) tensor(0.2018, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1997, device='cuda:0', dtype=torch.float16)
tensor(1.6055, device='cuda:0', dtype=torch.float16) tensor(0.1938, device='cuda:0', dtype=torch.float16)
tensor(0.0906, device='cuda:0')
old_score: tensor(0.1968, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1580, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.160144329071045
Validation after dual ascent:
out_inf: tensor(14.6016, device='cuda:0', dtype=torch.float16) tensor(0.8027, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
tensor(1.4619, device='cuda:0', dtype=torch.float16) tensor(0.1632, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.1602, device='cuda:0', dtype=torch.float16)
tensor(1.5605, device='cuda:0', dtype=torch.float16) tensor(0.1549, device='cuda:0', dtype=torch.float16)
10 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.3438, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(1.7666, device='cuda:0', dtype=torch.float16) tensor(0.1924, device='cuda:0', dtype=torch.float16)
tensor(1.7480, device='cuda:0', dtype=torch.float16) tensor(0.2017, device='cuda:0', dtype=torch.float16)
tensor(1.5967, device='cuda:0', dtype=torch.float16) tensor(0.1996, device='cuda:0', dtype=torch.float16)
tensor(1.5410, device='cuda:0', dtype=torch.float16) tensor(0.1946, device='cuda:0', dtype=torch.float16)
tensor(0.0894, device='cuda:0')
old_score: tensor(0.1970, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1575, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.133454322814941
Validation after dual ascent:
out_inf: tensor(17.3438, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(1.3604, device='cuda:0', dtype=torch.float16) tensor(0.1536, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1625, device='cuda:0', dtype=torch.float16)
tensor(1.2881, device='cuda:0', dtype=torch.float16) tensor(0.1598, device='cuda:0', dtype=torch.float16)
tensor(1.2549, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
10 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.6797, device='cuda:0', dtype=torch.float16) tensor(0.2659, device='cuda:0', dtype=torch.float16)
tensor(0.8799, device='cuda:0', dtype=torch.float16) tensor(0.1032, device='cuda:0', dtype=torch.float16)
tensor(0.8916, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(0.8179, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
tensor(0.8867, device='cuda:0', dtype=torch.float16) tensor(0.1036, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0187, device='cuda:0')
tensor(0.2207, device='cuda:0')
old_score: tensor(0.1052, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0862, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 2.4781510829925537
Validation after dual ascent:
out_inf: tensor(6.6797, device='cuda:0', dtype=torch.float16) tensor(0.2659, device='cuda:0', dtype=torch.float16)
tensor(0.7583, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
tensor(0.7612, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
tensor(0.7456, device='cuda:0', dtype=torch.float16) tensor(0.0871, device='cuda:0', dtype=torch.float16)
tensor(0.7666, device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
10 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.8320, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(0.3220, device='cuda:0', dtype=torch.float16) tensor(0.0339, device='cuda:0', dtype=torch.float16)
tensor(0.3584, device='cuda:0', dtype=torch.float16) tensor(0.0366, device='cuda:0', dtype=torch.float16)
tensor(0.3337, device='cuda:0', dtype=torch.float16) tensor(0.0391, device='cuda:0', dtype=torch.float16)
tensor(0.3240, device='cuda:0', dtype=torch.float16) tensor(0.0328, device='cuda:0', dtype=torch.float16)
tensor(0.0609, device='cuda:0')
old_score: tensor(0.0356, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0302, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.073407888412476
Validation after dual ascent:
out_inf: tensor(5.8320, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(0.2842, device='cuda:0', dtype=torch.float16) tensor(0.0287, device='cuda:0', dtype=torch.float16)
tensor(0.2886, device='cuda:0', dtype=torch.float16) tensor(0.0311, device='cuda:0', dtype=torch.float16)
tensor(0.2900, device='cuda:0', dtype=torch.float16) tensor(0.0329, device='cuda:0', dtype=torch.float16)
tensor(0.2659, device='cuda:0', dtype=torch.float16) tensor(0.0278, device='cuda:0', dtype=torch.float16)
10 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9688, device='cuda:0', dtype=torch.float16) tensor(0.2756, device='cuda:0', dtype=torch.float16)
tensor(1.1934, device='cuda:0', dtype=torch.float16) tensor(0.0865, device='cuda:0', dtype=torch.float16)
tensor(0.9497, device='cuda:0', dtype=torch.float16) tensor(0.0892, device='cuda:0', dtype=torch.float16)
tensor(0.9619, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
tensor(1.0889, device='cuda:0', dtype=torch.float16) tensor(0.0858, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0157, device='cuda:0')
tensor(0.0266, device='cuda:0')
old_score: tensor(0.0876, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0719, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.146121263504028
Validation after dual ascent:
out_inf: tensor(5.9688, device='cuda:0', dtype=torch.float16) tensor(0.2756, device='cuda:0', dtype=torch.float16)
tensor(0.9346, device='cuda:0', dtype=torch.float16) tensor(0.0707, device='cuda:0', dtype=torch.float16)
tensor(0.7744, device='cuda:0', dtype=torch.float16) tensor(0.0741, device='cuda:0', dtype=torch.float16)
tensor(0.8726, device='cuda:0', dtype=torch.float16) tensor(0.0729, device='cuda:0', dtype=torch.float16)
tensor(0.8467, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
10 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4219, device='cuda:0', dtype=torch.float16) tensor(0.2058, device='cuda:0', dtype=torch.float16)
tensor(0.8447, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
tensor(0.8311, device='cuda:0', dtype=torch.float16) tensor(0.0831, device='cuda:0', dtype=torch.float16)
tensor(1.0303, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.9092, device='cuda:0', dtype=torch.float16) tensor(0.0800, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0167, device='cuda:0')
tensor(0.0952, device='cuda:0')
old_score: tensor(0.0815, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0673, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.184061527252197
Validation after dual ascent:
out_inf: tensor(4.4219, device='cuda:0', dtype=torch.float16) tensor(0.2058, device='cuda:0', dtype=torch.float16)
tensor(0.7559, device='cuda:0', dtype=torch.float16) tensor(0.0661, device='cuda:0', dtype=torch.float16)
tensor(0.8340, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
tensor(0.8154, device='cuda:0', dtype=torch.float16) tensor(0.0681, device='cuda:0', dtype=torch.float16)
tensor(0.7720, device='cuda:0', dtype=torch.float16) tensor(0.0656, device='cuda:0', dtype=torch.float16)
10 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.9814, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(0.3022, device='cuda:0', dtype=torch.float16) tensor(0.0263, device='cuda:0', dtype=torch.float16)
tensor(0.2871, device='cuda:0', dtype=torch.float16) tensor(0.0269, device='cuda:0', dtype=torch.float16)
tensor(0.2566, device='cuda:0', dtype=torch.float16) tensor(0.0268, device='cuda:0', dtype=torch.float16)
tensor(0.3003, device='cuda:0', dtype=torch.float16) tensor(0.0258, device='cuda:0', dtype=torch.float16)
tensor(0.0783, device='cuda:0')
old_score: tensor(0.0265, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0240, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 99.8774151802063
Validation after dual ascent:
out_inf: tensor(0.9814, device='cuda:0', dtype=torch.float16) tensor(0.0724, device='cuda:0', dtype=torch.float16)
tensor(0.2881, device='cuda:0', dtype=torch.float16) tensor(0.0238, device='cuda:0', dtype=torch.float16)
tensor(0.2489, device='cuda:0', dtype=torch.float16) tensor(0.0246, device='cuda:0', dtype=torch.float16)
tensor(0.2283, device='cuda:0', dtype=torch.float16) tensor(0.0244, device='cuda:0', dtype=torch.float16)
tensor(0.2732, device='cuda:0', dtype=torch.float16) tensor(0.0233, device='cuda:0', dtype=torch.float16)
layer 10 done
11 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.7344, device='cuda:0', dtype=torch.float16) tensor(0.8076, device='cuda:0', dtype=torch.float16)
tensor(2.4844, device='cuda:0', dtype=torch.float16) tensor(0.2007, device='cuda:0', dtype=torch.float16)
tensor(1.9150, device='cuda:0', dtype=torch.float16) tensor(0.2068, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.2064, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.2009, device='cuda:0', dtype=torch.float16)
tensor(0.1554, device='cuda:0')
old_score: tensor(0.2036, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1665, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.151504516601562
Validation after dual ascent:
out_inf: tensor(20.7344, device='cuda:0', dtype=torch.float16) tensor(0.8076, device='cuda:0', dtype=torch.float16)
tensor(1.6973, device='cuda:0', dtype=torch.float16) tensor(0.1631, device='cuda:0', dtype=torch.float16)
tensor(1.8057, device='cuda:0', dtype=torch.float16) tensor(0.1707, device='cuda:0', dtype=torch.float16)
tensor(1.4551, device='cuda:0', dtype=torch.float16) tensor(0.1689, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1631, device='cuda:0', dtype=torch.float16)
11 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.9844, device='cuda:0', dtype=torch.float16) tensor(1.0498, device='cuda:0', dtype=torch.float16)
tensor(1.5371, device='cuda:0', dtype=torch.float16) tensor(0.1992, device='cuda:0', dtype=torch.float16)
tensor(1.8135, device='cuda:0', dtype=torch.float16) tensor(0.2051, device='cuda:0', dtype=torch.float16)
tensor(1.5039, device='cuda:0', dtype=torch.float16) tensor(0.2031, device='cuda:0', dtype=torch.float16)
tensor(1.5986, device='cuda:0', dtype=torch.float16) tensor(0.1991, device='cuda:0', dtype=torch.float16)
tensor(0.1558, device='cuda:0')
old_score: tensor(0.2017, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1632, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.140421867370605
Validation after dual ascent:
out_inf: tensor(18.9844, device='cuda:0', dtype=torch.float16) tensor(1.0498, device='cuda:0', dtype=torch.float16)
tensor(1.3926, device='cuda:0', dtype=torch.float16) tensor(0.1602, device='cuda:0', dtype=torch.float16)
tensor(1.7559, device='cuda:0', dtype=torch.float16) tensor(0.1675, device='cuda:0', dtype=torch.float16)
tensor(1.3838, device='cuda:0', dtype=torch.float16) tensor(0.1653, device='cuda:0', dtype=torch.float16)
tensor(1.3271, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
11 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.4414, device='cuda:0', dtype=torch.float16) tensor(0.3015, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.1225, device='cuda:0', dtype=torch.float16)
tensor(0.9502, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
tensor(0.9370, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
tensor(0.9600, device='cuda:0', dtype=torch.float16) tensor(0.1223, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0190, device='cuda:0')
tensor(0.1935, device='cuda:0')
old_score: tensor(0.1237, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1019, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.221832275390625
Validation after dual ascent:
out_inf: tensor(7.4414, device='cuda:0', dtype=torch.float16) tensor(0.3015, device='cuda:0', dtype=torch.float16)
tensor(0.9585, device='cuda:0', dtype=torch.float16) tensor(0.1003, device='cuda:0', dtype=torch.float16)
tensor(0.8740, device='cuda:0', dtype=torch.float16) tensor(0.1046, device='cuda:0', dtype=torch.float16)
tensor(0.9092, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
tensor(0.8374, device='cuda:0', dtype=torch.float16) tensor(0.1000, device='cuda:0', dtype=torch.float16)
11 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2852, device='cuda:0', dtype=torch.float16) tensor(0.0796, device='cuda:0', dtype=torch.float16)
tensor(0.4207, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.4546, device='cuda:0', dtype=torch.float16) tensor(0.0380, device='cuda:0', dtype=torch.float16)
tensor(0.4226, device='cuda:0', dtype=torch.float16) tensor(0.0436, device='cuda:0', dtype=torch.float16)
tensor(0.4185, device='cuda:0', dtype=torch.float16) tensor(0.0333, device='cuda:0', dtype=torch.float16)
tensor(0.0477, device='cuda:0')
old_score: tensor(0.0377, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0331, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.071325540542603
Validation after dual ascent:
out_inf: tensor(4.2852, device='cuda:0', dtype=torch.float16) tensor(0.0796, device='cuda:0', dtype=torch.float16)
tensor(0.4014, device='cuda:0', dtype=torch.float16) tensor(0.0315, device='cuda:0', dtype=torch.float16)
tensor(0.4280, device='cuda:0', dtype=torch.float16) tensor(0.0336, device='cuda:0', dtype=torch.float16)
tensor(0.4316, device='cuda:0', dtype=torch.float16) tensor(0.0384, device='cuda:0', dtype=torch.float16)
tensor(0.3604, device='cuda:0', dtype=torch.float16) tensor(0.0290, device='cuda:0', dtype=torch.float16)
11 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.7148, device='cuda:0', dtype=torch.float16) tensor(0.2856, device='cuda:0', dtype=torch.float16)
tensor(1.3848, device='cuda:0', dtype=torch.float16) tensor(0.0974, device='cuda:0', dtype=torch.float16)
tensor(1.1074, device='cuda:0', dtype=torch.float16) tensor(0.1010, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(1.2764, device='cuda:0', dtype=torch.float16) tensor(0.0963, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0136, device='cuda:0')
tensor(0.0353, device='cuda:0')
old_score: tensor(0.0988, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0829, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.146910190582275
Validation after dual ascent:
out_inf: tensor(7.7148, device='cuda:0', dtype=torch.float16) tensor(0.2856, device='cuda:0', dtype=torch.float16)
tensor(1.1465, device='cuda:0', dtype=torch.float16) tensor(0.0815, device='cuda:0', dtype=torch.float16)
tensor(0.9609, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(0.9707, device='cuda:0', dtype=torch.float16) tensor(0.0842, device='cuda:0', dtype=torch.float16)
tensor(0.9443, device='cuda:0', dtype=torch.float16) tensor(0.0804, device='cuda:0', dtype=torch.float16)
11 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6484, device='cuda:0', dtype=torch.float16) tensor(0.2153, device='cuda:0', dtype=torch.float16)
tensor(0.9424, device='cuda:0', dtype=torch.float16) tensor(0.0913, device='cuda:0', dtype=torch.float16)
tensor(1.0889, device='cuda:0', dtype=torch.float16) tensor(0.0950, device='cuda:0', dtype=torch.float16)
tensor(1.2656, device='cuda:0', dtype=torch.float16) tensor(0.0941, device='cuda:0', dtype=torch.float16)
tensor(1.0635, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0192, device='cuda:0')
tensor(0.1488, device='cuda:0')
old_score: tensor(0.0927, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0785, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.189491271972656
Validation after dual ascent:
out_inf: tensor(4.6484, device='cuda:0', dtype=torch.float16) tensor(0.2153, device='cuda:0', dtype=torch.float16)
tensor(0.8521, device='cuda:0', dtype=torch.float16) tensor(0.0770, device='cuda:0', dtype=torch.float16)
tensor(0.9541, device='cuda:0', dtype=torch.float16) tensor(0.0811, device='cuda:0', dtype=torch.float16)
tensor(1.1064, device='cuda:0', dtype=torch.float16) tensor(0.0797, device='cuda:0', dtype=torch.float16)
tensor(0.9028, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
11 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(0.9556, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.2932, device='cuda:0', dtype=torch.float16) tensor(0.0308, device='cuda:0', dtype=torch.float16)
tensor(0.2854, device='cuda:0', dtype=torch.float16) tensor(0.0319, device='cuda:0', dtype=torch.float16)
tensor(0.2915, device='cuda:0', dtype=torch.float16) tensor(0.0313, device='cuda:0', dtype=torch.float16)
tensor(0.2964, device='cuda:0', dtype=torch.float16) tensor(0.0302, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0114, device='cuda:0')
tensor(0.0252, device='cuda:0')
old_score: tensor(0.0311, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0286, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 85.39973163604736
Validation after dual ascent:
out_inf: tensor(0.9556, device='cuda:0', dtype=torch.float16) tensor(0.0714, device='cuda:0', dtype=torch.float16)
tensor(0.3003, device='cuda:0', dtype=torch.float16) tensor(0.0282, device='cuda:0', dtype=torch.float16)
tensor(0.2844, device='cuda:0', dtype=torch.float16) tensor(0.0296, device='cuda:0', dtype=torch.float16)
tensor(0.2532, device='cuda:0', dtype=torch.float16) tensor(0.0289, device='cuda:0', dtype=torch.float16)
tensor(0.2976, device='cuda:0', dtype=torch.float16) tensor(0.0276, device='cuda:0', dtype=torch.float16)
layer 11 done
12 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.1406, device='cuda:0', dtype=torch.float16) tensor(0.8081, device='cuda:0', dtype=torch.float16)
tensor(2.3516, device='cuda:0', dtype=torch.float16) tensor(0.2206, device='cuda:0', dtype=torch.float16)
tensor(2.2969, device='cuda:0', dtype=torch.float16) tensor(0.2294, device='cuda:0', dtype=torch.float16)
tensor(1.9961, device='cuda:0', dtype=torch.float16) tensor(0.2274, device='cuda:0', dtype=torch.float16)
tensor(1.6816, device='cuda:0', dtype=torch.float16) tensor(0.2194, device='cuda:0', dtype=torch.float16)
tensor(0.1728, device='cuda:0')
old_score: tensor(0.2241, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1870, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.175578355789185
Validation after dual ascent:
out_inf: tensor(18.1406, device='cuda:0', dtype=torch.float16) tensor(0.8081, device='cuda:0', dtype=torch.float16)
tensor(1.8203, device='cuda:0', dtype=torch.float16) tensor(0.1832, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1930, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1899, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1816, device='cuda:0', dtype=torch.float16)
12 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.5078, device='cuda:0', dtype=torch.float16) tensor(1.0469, device='cuda:0', dtype=torch.float16)
tensor(2.0020, device='cuda:0', dtype=torch.float16) tensor(0.2258, device='cuda:0', dtype=torch.float16)
tensor(1.7695, device='cuda:0', dtype=torch.float16) tensor(0.2351, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.2323, device='cuda:0', dtype=torch.float16)
tensor(1.9023, device='cuda:0', dtype=torch.float16) tensor(0.2242, device='cuda:0', dtype=torch.float16)
tensor(0.1839, device='cuda:0')
old_score: tensor(0.2294, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1895, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.164103269577026
Validation after dual ascent:
out_inf: tensor(15.5078, device='cuda:0', dtype=torch.float16) tensor(1.0469, device='cuda:0', dtype=torch.float16)
tensor(1.6543, device='cuda:0', dtype=torch.float16) tensor(0.1860, device='cuda:0', dtype=torch.float16)
tensor(1.5059, device='cuda:0', dtype=torch.float16) tensor(0.1952, device='cuda:0', dtype=torch.float16)
tensor(1.5244, device='cuda:0', dtype=torch.float16) tensor(0.1924, device='cuda:0', dtype=torch.float16)
tensor(1.9668, device='cuda:0', dtype=torch.float16) tensor(0.1840, device='cuda:0', dtype=torch.float16)
12 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.0078, device='cuda:0', dtype=torch.float16) tensor(0.3044, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
tensor(1.1504, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
tensor(1.0605, device='cuda:0', dtype=torch.float16) tensor(0.1323, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.1278, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0195, device='cuda:0')
tensor(0.0866, device='cuda:0')
old_score: tensor(0.1305, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1100, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.91276478767395
Validation after dual ascent:
out_inf: tensor(6.0078, device='cuda:0', dtype=torch.float16) tensor(0.3044, device='cuda:0', dtype=torch.float16)
tensor(1.0596, device='cuda:0', dtype=torch.float16) tensor(0.1081, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
tensor(0.8525, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(1.0605, device='cuda:0', dtype=torch.float16) tensor(0.1068, device='cuda:0', dtype=torch.float16)
12 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.8984, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
tensor(0.3655, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.3435, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.3821, device='cuda:0', dtype=torch.float16) tensor(0.0446, device='cuda:0', dtype=torch.float16)
tensor(0.4067, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
Converged at iteration 900
tensor(0.0199, device='cuda:0')
tensor(0.0323, device='cuda:0')
old_score: tensor(0.0414, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0362, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 13.62182903289795
Validation after dual ascent:
out_inf: tensor(6.8984, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
tensor(0.3374, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
tensor(0.3511, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.3960, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.3589, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
12 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6562, device='cuda:0', dtype=torch.float16) tensor(0.2930, device='cuda:0', dtype=torch.float16)
tensor(1.1191, device='cuda:0', dtype=torch.float16) tensor(0.0978, device='cuda:0', dtype=torch.float16)
tensor(1.4082, device='cuda:0', dtype=torch.float16) tensor(0.1012, device='cuda:0', dtype=torch.float16)
tensor(1.1797, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
tensor(1.1582, device='cuda:0', dtype=torch.float16) tensor(0.0960, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0146, device='cuda:0')
tensor(0.0333, device='cuda:0')
old_score: tensor(0.0990, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0835, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.157922744750977
Validation after dual ascent:
out_inf: tensor(5.6562, device='cuda:0', dtype=torch.float16) tensor(0.2930, device='cuda:0', dtype=torch.float16)
tensor(0.9766, device='cuda:0', dtype=torch.float16) tensor(0.0820, device='cuda:0', dtype=torch.float16)
tensor(1.3086, device='cuda:0', dtype=torch.float16) tensor(0.0859, device='cuda:0', dtype=torch.float16)
tensor(0.9570, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(1.0400, device='cuda:0', dtype=torch.float16) tensor(0.0802, device='cuda:0', dtype=torch.float16)
12 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.2229, device='cuda:0', dtype=torch.float16)
tensor(1.2480, device='cuda:0', dtype=torch.float16) tensor(0.0932, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(1.0879, device='cuda:0', dtype=torch.float16) tensor(0.0967, device='cuda:0', dtype=torch.float16)
tensor(1.0684, device='cuda:0', dtype=torch.float16) tensor(0.0917, device='cuda:0', dtype=torch.float16)
Converged at iteration 150
tensor(0.0192, device='cuda:0')
tensor(0.1448, device='cuda:0')
old_score: tensor(0.0946, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0803, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.191512823104858
Validation after dual ascent:
out_inf: tensor(4.3320, device='cuda:0', dtype=torch.float16) tensor(0.2229, device='cuda:0', dtype=torch.float16)
tensor(1.0010, device='cuda:0', dtype=torch.float16) tensor(0.0788, device='cuda:0', dtype=torch.float16)
tensor(0.9219, device='cuda:0', dtype=torch.float16) tensor(0.0826, device='cuda:0', dtype=torch.float16)
tensor(0.8779, device='cuda:0', dtype=torch.float16) tensor(0.0825, device='cuda:0', dtype=torch.float16)
tensor(0.7817, device='cuda:0', dtype=torch.float16) tensor(0.0772, device='cuda:0', dtype=torch.float16)
12 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.3105, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(0.3521, device='cuda:0', dtype=torch.float16) tensor(0.0319, device='cuda:0', dtype=torch.float16)
tensor(0.3040, device='cuda:0', dtype=torch.float16) tensor(0.0329, device='cuda:0', dtype=torch.float16)
tensor(0.3042, device='cuda:0', dtype=torch.float16) tensor(0.0327, device='cuda:0', dtype=torch.float16)
tensor(0.3125, device='cuda:0', dtype=torch.float16) tensor(0.0311, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0107, device='cuda:0')
tensor(0.0233, device='cuda:0')
old_score: tensor(0.0321, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0296, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 85.3945574760437
Validation after dual ascent:
out_inf: tensor(2.3105, device='cuda:0', dtype=torch.float16) tensor(0.0779, device='cuda:0', dtype=torch.float16)
tensor(0.3469, device='cuda:0', dtype=torch.float16) tensor(0.0293, device='cuda:0', dtype=torch.float16)
tensor(0.2837, device='cuda:0', dtype=torch.float16) tensor(0.0305, device='cuda:0', dtype=torch.float16)
tensor(0.2920, device='cuda:0', dtype=torch.float16) tensor(0.0303, device='cuda:0', dtype=torch.float16)
tensor(0.2971, device='cuda:0', dtype=torch.float16) tensor(0.0284, device='cuda:0', dtype=torch.float16)
layer 12 done
13 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.8438, device='cuda:0', dtype=torch.float16) tensor(0.8188, device='cuda:0', dtype=torch.float16)
tensor(2.1680, device='cuda:0', dtype=torch.float16) tensor(0.2157, device='cuda:0', dtype=torch.float16)
tensor(1.8770, device='cuda:0', dtype=torch.float16) tensor(0.2258, device='cuda:0', dtype=torch.float16)
tensor(1.7773, device='cuda:0', dtype=torch.float16) tensor(0.2250, device='cuda:0', dtype=torch.float16)
tensor(1.8633, device='cuda:0', dtype=torch.float16) tensor(0.2151, device='cuda:0', dtype=torch.float16)
tensor(0.1116, device='cuda:0')
old_score: tensor(0.2205, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1831, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.145612001419067
Validation after dual ascent:
out_inf: tensor(14.8438, device='cuda:0', dtype=torch.float16) tensor(0.8188, device='cuda:0', dtype=torch.float16)
tensor(2.0469, device='cuda:0', dtype=torch.float16) tensor(0.1782, device='cuda:0', dtype=torch.float16)
tensor(1.5752, device='cuda:0', dtype=torch.float16) tensor(0.1892, device='cuda:0', dtype=torch.float16)
tensor(1.5293, device='cuda:0', dtype=torch.float16) tensor(0.1881, device='cuda:0', dtype=torch.float16)
tensor(1.7139, device='cuda:0', dtype=torch.float16) tensor(0.1766, device='cuda:0', dtype=torch.float16)
13 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.0312, device='cuda:0', dtype=torch.float16) tensor(0.9976, device='cuda:0', dtype=torch.float16)
tensor(1.7178, device='cuda:0', dtype=torch.float16) tensor(0.2163, device='cuda:0', dtype=torch.float16)
tensor(1.9941, device='cuda:0', dtype=torch.float16) tensor(0.2273, device='cuda:0', dtype=torch.float16)
tensor(1.8076, device='cuda:0', dtype=torch.float16) tensor(0.2249, device='cuda:0', dtype=torch.float16)
tensor(2.0645, device='cuda:0', dtype=torch.float16) tensor(0.2164, device='cuda:0', dtype=torch.float16)
tensor(0.1179, device='cuda:0')
old_score: tensor(0.2212, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1824, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.145691156387329
Validation after dual ascent:
out_inf: tensor(17.0312, device='cuda:0', dtype=torch.float16) tensor(0.9976, device='cuda:0', dtype=torch.float16)
tensor(1.8213, device='cuda:0', dtype=torch.float16) tensor(0.1777, device='cuda:0', dtype=torch.float16)
tensor(1.5293, device='cuda:0', dtype=torch.float16) tensor(0.1887, device='cuda:0', dtype=torch.float16)
tensor(1.5010, device='cuda:0', dtype=torch.float16) tensor(0.1873, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1759, device='cuda:0', dtype=torch.float16)
13 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.4805, device='cuda:0', dtype=torch.float16) tensor(0.3098, device='cuda:0', dtype=torch.float16)
tensor(1.0225, device='cuda:0', dtype=torch.float16) tensor(0.1305, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1361, device='cuda:0', dtype=torch.float16)
tensor(1.1348, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0097, device='cuda:0')
tensor(0.2016, device='cuda:0')
old_score: tensor(0.1331, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1128, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2327094078063965
Validation after dual ascent:
out_inf: tensor(4.4805, device='cuda:0', dtype=torch.float16) tensor(0.3098, device='cuda:0', dtype=torch.float16)
tensor(0.9126, device='cuda:0', dtype=torch.float16) tensor(0.1101, device='cuda:0', dtype=torch.float16)
tensor(0.8691, device='cuda:0', dtype=torch.float16) tensor(0.1165, device='cuda:0', dtype=torch.float16)
tensor(0.9585, device='cuda:0', dtype=torch.float16) tensor(0.1159, device='cuda:0', dtype=torch.float16)
tensor(0.9561, device='cuda:0', dtype=torch.float16) tensor(0.1087, device='cuda:0', dtype=torch.float16)
13 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9922, device='cuda:0', dtype=torch.float16) tensor(0.0848, device='cuda:0', dtype=torch.float16)
tensor(0.3435, device='cuda:0', dtype=torch.float16) tensor(0.0346, device='cuda:0', dtype=torch.float16)
tensor(0.3333, device='cuda:0', dtype=torch.float16) tensor(0.0382, device='cuda:0', dtype=torch.float16)
tensor(0.4053, device='cuda:0', dtype=torch.float16) tensor(0.0408, device='cuda:0', dtype=torch.float16)
tensor(0.4368, device='cuda:0', dtype=torch.float16) tensor(0.0344, device='cuda:0', dtype=torch.float16)
tensor(0.0640, device='cuda:0')
old_score: tensor(0.0370, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0315, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.079495191574097
Validation after dual ascent:
out_inf: tensor(5.9922, device='cuda:0', dtype=torch.float16) tensor(0.0848, device='cuda:0', dtype=torch.float16)
tensor(0.3083, device='cuda:0', dtype=torch.float16) tensor(0.0290, device='cuda:0', dtype=torch.float16)
tensor(0.3098, device='cuda:0', dtype=torch.float16) tensor(0.0324, device='cuda:0', dtype=torch.float16)
tensor(0.3301, device='cuda:0', dtype=torch.float16) tensor(0.0352, device='cuda:0', dtype=torch.float16)
tensor(0.3862, device='cuda:0', dtype=torch.float16) tensor(0.0292, device='cuda:0', dtype=torch.float16)
13 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.9531, device='cuda:0', dtype=torch.float16) tensor(0.3152, device='cuda:0', dtype=torch.float16)
tensor(1.3828, device='cuda:0', dtype=torch.float16) tensor(0.0992, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(1.2363, device='cuda:0', dtype=torch.float16) tensor(0.1042, device='cuda:0', dtype=torch.float16)
tensor(1.3047, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0158, device='cuda:0')
tensor(0.0368, device='cuda:0')
old_score: tensor(0.1010, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0844, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.154750347137451
Validation after dual ascent:
out_inf: tensor(6.9531, device='cuda:0', dtype=torch.float16) tensor(0.3152, device='cuda:0', dtype=torch.float16)
tensor(1.1846, device='cuda:0', dtype=torch.float16) tensor(0.0827, device='cuda:0', dtype=torch.float16)
tensor(1.0850, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
tensor(0.9785, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(1.1553, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
13 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.2344, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
tensor(0.9932, device='cuda:0', dtype=torch.float16) tensor(0.0985, device='cuda:0', dtype=torch.float16)
tensor(0.8965, device='cuda:0', dtype=torch.float16) tensor(0.1004, device='cuda:0', dtype=torch.float16)
tensor(0.9805, device='cuda:0', dtype=torch.float16) tensor(0.0947, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0100, device='cuda:0')
tensor(0.0250, device='cuda:0')
old_score: tensor(0.0973, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0823, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.167601346969604
Validation after dual ascent:
out_inf: tensor(4.5078, device='cuda:0', dtype=torch.float16) tensor(0.2344, device='cuda:0', dtype=torch.float16)
tensor(0.8740, device='cuda:0', dtype=torch.float16) tensor(0.0806, device='cuda:0', dtype=torch.float16)
tensor(0.9478, device='cuda:0', dtype=torch.float16) tensor(0.0839, device='cuda:0', dtype=torch.float16)
tensor(0.8296, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(0.8018, device='cuda:0', dtype=torch.float16) tensor(0.0793, device='cuda:0', dtype=torch.float16)
13 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.9932, device='cuda:0', dtype=torch.float16) tensor(0.0890, device='cuda:0', dtype=torch.float16)
tensor(0.3945, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
tensor(0.3257, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
tensor(0.3086, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.3315, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
Converged at iteration 850
tensor(0.0096, device='cuda:0')
tensor(0.0181, device='cuda:0')
old_score: tensor(0.0358, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0325, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 85.39966750144958
Validation after dual ascent:
out_inf: tensor(1.9932, device='cuda:0', dtype=torch.float16) tensor(0.0890, device='cuda:0', dtype=torch.float16)
tensor(0.3506, device='cuda:0', dtype=torch.float16) tensor(0.0320, device='cuda:0', dtype=torch.float16)
tensor(0.3315, device='cuda:0', dtype=torch.float16) tensor(0.0330, device='cuda:0', dtype=torch.float16)
tensor(0.2974, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.3040, device='cuda:0', dtype=torch.float16) tensor(0.0313, device='cuda:0', dtype=torch.float16)
layer 13 done
14 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.1953, device='cuda:0', dtype=torch.float16) tensor(0.8057, device='cuda:0', dtype=torch.float16)
tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.2202, device='cuda:0', dtype=torch.float16)
tensor(2.1738, device='cuda:0', dtype=torch.float16) tensor(0.2273, device='cuda:0', dtype=torch.float16)
tensor(2.2754, device='cuda:0', dtype=torch.float16) tensor(0.2314, device='cuda:0', dtype=torch.float16)
tensor(1.7842, device='cuda:0', dtype=torch.float16) tensor(0.2181, device='cuda:0', dtype=torch.float16)
tensor(0.1867, device='cuda:0')
old_score: tensor(0.2242, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1853, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.218297243118286
Validation after dual ascent:
out_inf: tensor(15.1953, device='cuda:0', dtype=torch.float16) tensor(0.8057, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.1813, device='cuda:0', dtype=torch.float16)
tensor(2.1406, device='cuda:0', dtype=torch.float16) tensor(0.1895, device='cuda:0', dtype=torch.float16)
tensor(1.9043, device='cuda:0', dtype=torch.float16) tensor(0.1927, device='cuda:0', dtype=torch.float16)
tensor(1.5605, device='cuda:0', dtype=torch.float16) tensor(0.1779, device='cuda:0', dtype=torch.float16)
14 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.1094, device='cuda:0', dtype=torch.float16) tensor(1.0859, device='cuda:0', dtype=torch.float16)
tensor(2.4297, device='cuda:0', dtype=torch.float16) tensor(0.2252, device='cuda:0', dtype=torch.float16)
tensor(1.7461, device='cuda:0', dtype=torch.float16) tensor(0.2328, device='cuda:0', dtype=torch.float16)
tensor(1.8750, device='cuda:0', dtype=torch.float16) tensor(0.2355, device='cuda:0', dtype=torch.float16)
tensor(1.8340, device='cuda:0', dtype=torch.float16) tensor(0.2229, device='cuda:0', dtype=torch.float16)
tensor(0.1924, device='cuda:0')
old_score: tensor(0.2290, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1860, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.248862981796265
Validation after dual ascent:
out_inf: tensor(16.1094, device='cuda:0', dtype=torch.float16) tensor(1.0859, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.1823, device='cuda:0', dtype=torch.float16)
tensor(1.5713, device='cuda:0', dtype=torch.float16) tensor(0.1904, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.1930, device='cuda:0', dtype=torch.float16)
tensor(1.5205, device='cuda:0', dtype=torch.float16) tensor(0.1786, device='cuda:0', dtype=torch.float16)
14 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.3047, device='cuda:0', dtype=torch.float16)
tensor(1.1416, device='cuda:0', dtype=torch.float16) tensor(0.1299, device='cuda:0', dtype=torch.float16)
tensor(1.0205, device='cuda:0', dtype=torch.float16) tensor(0.1337, device='cuda:0', dtype=torch.float16)
tensor(1.0469, device='cuda:0', dtype=torch.float16) tensor(0.1357, device='cuda:0', dtype=torch.float16)
tensor(1.0381, device='cuda:0', dtype=torch.float16) tensor(0.1282, device='cuda:0', dtype=torch.float16)
tensor(0.0765, device='cuda:0')
old_score: tensor(0.1318, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1104, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.235562324523926
Validation after dual ascent:
out_inf: tensor(4.3750, device='cuda:0', dtype=torch.float16) tensor(0.3047, device='cuda:0', dtype=torch.float16)
tensor(0.9980, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(0.9775, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
tensor(0.9438, device='cuda:0', dtype=torch.float16) tensor(0.1145, device='cuda:0', dtype=torch.float16)
tensor(0.8838, device='cuda:0', dtype=torch.float16) tensor(0.1059, device='cuda:0', dtype=torch.float16)
14 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.2891, device='cuda:0', dtype=torch.float16) tensor(0.0935, device='cuda:0', dtype=torch.float16)
tensor(0.3816, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.3945, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.5117, device='cuda:0', dtype=torch.float16) tensor(0.0420, device='cuda:0', dtype=torch.float16)
tensor(0.3640, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
Converged at iteration 950
tensor(0.0167, device='cuda:0')
tensor(0.0294, device='cuda:0')
old_score: tensor(0.0388, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0333, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 14.453440189361572
Validation after dual ascent:
out_inf: tensor(8.2891, device='cuda:0', dtype=torch.float16) tensor(0.0935, device='cuda:0', dtype=torch.float16)
tensor(0.4004, device='cuda:0', dtype=torch.float16) tensor(0.0318, device='cuda:0', dtype=torch.float16)
tensor(0.3098, device='cuda:0', dtype=torch.float16) tensor(0.0344, device='cuda:0', dtype=torch.float16)
tensor(0.3931, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
tensor(0.3291, device='cuda:0', dtype=torch.float16) tensor(0.0308, device='cuda:0', dtype=torch.float16)
14 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.4531, device='cuda:0', dtype=torch.float16) tensor(0.3188, device='cuda:0', dtype=torch.float16)
tensor(1.4375, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.1034, device='cuda:0', dtype=torch.float16)
tensor(1.3145, device='cuda:0', dtype=torch.float16) tensor(0.1087, device='cuda:0', dtype=torch.float16)
tensor(1.6230, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0157, device='cuda:0')
tensor(0.0384, device='cuda:0')
old_score: tensor(0.1035, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0869, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.230758905410767
Validation after dual ascent:
out_inf: tensor(7.4531, device='cuda:0', dtype=torch.float16) tensor(0.3188, device='cuda:0', dtype=torch.float16)
tensor(1.1260, device='cuda:0', dtype=torch.float16) tensor(0.0854, device='cuda:0', dtype=torch.float16)
tensor(1.1709, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(1.1543, device='cuda:0', dtype=torch.float16) tensor(0.0923, device='cuda:0', dtype=torch.float16)
tensor(1.1279, device='cuda:0', dtype=torch.float16) tensor(0.0827, device='cuda:0', dtype=torch.float16)
14 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.7305, device='cuda:0', dtype=torch.float16) tensor(0.2401, device='cuda:0', dtype=torch.float16)
tensor(1.1875, device='cuda:0', dtype=torch.float16) tensor(0.0989, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.0999, device='cuda:0', dtype=torch.float16)
tensor(0.9912, device='cuda:0', dtype=torch.float16) tensor(0.1054, device='cuda:0', dtype=torch.float16)
tensor(1.1553, device='cuda:0', dtype=torch.float16) tensor(0.0968, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0101, device='cuda:0')
tensor(0.0283, device='cuda:0')
old_score: tensor(0.1002, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0851, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.219528913497925
Validation after dual ascent:
out_inf: tensor(6.7305, device='cuda:0', dtype=torch.float16) tensor(0.2401, device='cuda:0', dtype=torch.float16)
tensor(1.1787, device='cuda:0', dtype=torch.float16) tensor(0.0836, device='cuda:0', dtype=torch.float16)
tensor(0.7617, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
tensor(0.7964, device='cuda:0', dtype=torch.float16) tensor(0.0905, device='cuda:0', dtype=torch.float16)
tensor(1.0039, device='cuda:0', dtype=torch.float16) tensor(0.0810, device='cuda:0', dtype=torch.float16)
14 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.0283, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(0.3545, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
tensor(0.4819, device='cuda:0', dtype=torch.float16) tensor(0.0372, device='cuda:0', dtype=torch.float16)
tensor(0.3696, device='cuda:0', dtype=torch.float16) tensor(0.0391, device='cuda:0', dtype=torch.float16)
tensor(0.3643, device='cuda:0', dtype=torch.float16) tensor(0.0360, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0144, device='cuda:0')
tensor(0.0320, device='cuda:0')
old_score: tensor(0.0374, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0340, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 66.0889060497284
Validation after dual ascent:
out_inf: tensor(1.0283, device='cuda:0', dtype=torch.float16) tensor(0.0922, device='cuda:0', dtype=torch.float16)
tensor(0.3711, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.4551, device='cuda:0', dtype=torch.float16) tensor(0.0338, device='cuda:0', dtype=torch.float16)
tensor(0.3369, device='cuda:0', dtype=torch.float16) tensor(0.0361, device='cuda:0', dtype=torch.float16)
tensor(0.3323, device='cuda:0', dtype=torch.float16) tensor(0.0324, device='cuda:0', dtype=torch.float16)
layer 14 done
15 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.1406, device='cuda:0', dtype=torch.float16) tensor(0.8042, device='cuda:0', dtype=torch.float16)
tensor(1.7910, device='cuda:0', dtype=torch.float16) tensor(0.2086, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.2130, device='cuda:0', dtype=torch.float16)
tensor(1.7637, device='cuda:0', dtype=torch.float16) tensor(0.2213, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.2050, device='cuda:0', dtype=torch.float16)
tensor(0.0865, device='cuda:0')
old_score: tensor(0.2120, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1757, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.232990503311157
Validation after dual ascent:
out_inf: tensor(16.1406, device='cuda:0', dtype=torch.float16) tensor(0.8042, device='cuda:0', dtype=torch.float16)
tensor(1.6143, device='cuda:0', dtype=torch.float16) tensor(0.1722, device='cuda:0', dtype=torch.float16)
tensor(1.5840, device='cuda:0', dtype=torch.float16) tensor(0.1771, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1855, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1675, device='cuda:0', dtype=torch.float16)
15 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.4375, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.2162, device='cuda:0', dtype=torch.float16)
tensor(1.9531, device='cuda:0', dtype=torch.float16) tensor(0.2202, device='cuda:0', dtype=torch.float16)
tensor(1.7148, device='cuda:0', dtype=torch.float16) tensor(0.2277, device='cuda:0', dtype=torch.float16)
tensor(1.7930, device='cuda:0', dtype=torch.float16) tensor(0.2119, device='cuda:0', dtype=torch.float16)
tensor(0.0989, device='cuda:0')
old_score: tensor(0.2190, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1788, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.26338243484497
Validation after dual ascent:
out_inf: tensor(16.4375, device='cuda:0', dtype=torch.float16) tensor(1.0537, device='cuda:0', dtype=torch.float16)
tensor(1.5977, device='cuda:0', dtype=torch.float16) tensor(0.1757, device='cuda:0', dtype=torch.float16)
tensor(1.9385, device='cuda:0', dtype=torch.float16) tensor(0.1807, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.1882, device='cuda:0', dtype=torch.float16)
tensor(1.4717, device='cuda:0', dtype=torch.float16) tensor(0.1704, device='cuda:0', dtype=torch.float16)
15 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3132, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
tensor(1.0537, device='cuda:0', dtype=torch.float16) tensor(0.1334, device='cuda:0', dtype=torch.float16)
tensor(1.0137, device='cuda:0', dtype=torch.float16) tensor(0.1392, device='cuda:0', dtype=torch.float16)
tensor(1.0137, device='cuda:0', dtype=torch.float16) tensor(0.1283, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0162, device='cuda:0')
tensor(0.1743, device='cuda:0')
old_score: tensor(0.1331, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1122, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2540247440338135
Validation after dual ascent:
out_inf: tensor(4.3984, device='cuda:0', dtype=torch.float16) tensor(0.3132, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.1103, device='cuda:0', dtype=torch.float16)
tensor(1.0078, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.0059, device='cuda:0', dtype=torch.float16) tensor(0.1183, device='cuda:0', dtype=torch.float16)
tensor(0.9092, device='cuda:0', dtype=torch.float16) tensor(0.1069, device='cuda:0', dtype=torch.float16)
15 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8164, device='cuda:0', dtype=torch.float16) tensor(0.1040, device='cuda:0', dtype=torch.float16)
tensor(0.3826, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.4460, device='cuda:0', dtype=torch.float16) tensor(0.0450, device='cuda:0', dtype=torch.float16)
tensor(0.4370, device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
tensor(0.3994, device='cuda:0', dtype=torch.float16) tensor(0.0411, device='cuda:0', dtype=torch.float16)
tensor(0.0443, device='cuda:0')
old_score: tensor(0.0446, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0391, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.19324779510498
Validation after dual ascent:
out_inf: tensor(7.8164, device='cuda:0', dtype=torch.float16) tensor(0.1040, device='cuda:0', dtype=torch.float16)
tensor(0.3643, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.4199, device='cuda:0', dtype=torch.float16) tensor(0.0395, device='cuda:0', dtype=torch.float16)
tensor(0.3928, device='cuda:0', dtype=torch.float16) tensor(0.0437, device='cuda:0', dtype=torch.float16)
tensor(0.3696, device='cuda:0', dtype=torch.float16) tensor(0.0358, device='cuda:0', dtype=torch.float16)
15 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.7461, device='cuda:0', dtype=torch.float16) tensor(0.3345, device='cuda:0', dtype=torch.float16)
tensor(1.3145, device='cuda:0', dtype=torch.float16) tensor(0.1057, device='cuda:0', dtype=torch.float16)
tensor(1.9551, device='cuda:0', dtype=torch.float16) tensor(0.1064, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
tensor(1.1895, device='cuda:0', dtype=torch.float16) tensor(0.1027, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0155, device='cuda:0')
tensor(0.0456, device='cuda:0')
old_score: tensor(0.1068, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0888, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.226798295974731
Validation after dual ascent:
out_inf: tensor(7.7461, device='cuda:0', dtype=torch.float16) tensor(0.3345, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.0884, device='cuda:0', dtype=torch.float16)
tensor(1.1025, device='cuda:0', dtype=torch.float16) tensor(0.0944, device='cuda:0', dtype=torch.float16)
tensor(1.1182, device='cuda:0', dtype=torch.float16) tensor(0.0844, device='cuda:0', dtype=torch.float16)
15 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.1094, device='cuda:0', dtype=torch.float16) tensor(0.2522, device='cuda:0', dtype=torch.float16)
tensor(1.0547, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(1.1973, device='cuda:0', dtype=torch.float16) tensor(0.1090, device='cuda:0', dtype=torch.float16)
tensor(1.1357, device='cuda:0', dtype=torch.float16) tensor(0.0998, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0101, device='cuda:0')
tensor(0.0350, device='cuda:0')
old_score: tensor(0.1036, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0869, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.225651264190674
Validation after dual ascent:
out_inf: tensor(4.1094, device='cuda:0', dtype=torch.float16) tensor(0.2522, device='cuda:0', dtype=torch.float16)
tensor(0.8687, device='cuda:0', dtype=torch.float16) tensor(0.0859, device='cuda:0', dtype=torch.float16)
tensor(1.0459, device='cuda:0', dtype=torch.float16) tensor(0.0866, device='cuda:0', dtype=torch.float16)
tensor(0.9634, device='cuda:0', dtype=torch.float16) tensor(0.0925, device='cuda:0', dtype=torch.float16)
tensor(0.9844, device='cuda:0', dtype=torch.float16) tensor(0.0826, device='cuda:0', dtype=torch.float16)
15 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.0586, device='cuda:0', dtype=torch.float16) tensor(0.1043, device='cuda:0', dtype=torch.float16)
tensor(0.3914, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
tensor(0.3506, device='cuda:0', dtype=torch.float16) tensor(0.0415, device='cuda:0', dtype=torch.float16)
tensor(0.3801, device='cuda:0', dtype=torch.float16) tensor(0.0435, device='cuda:0', dtype=torch.float16)
tensor(0.4485, device='cuda:0', dtype=torch.float16) tensor(0.0399, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0102, device='cuda:0')
tensor(0.0174, device='cuda:0')
old_score: tensor(0.0416, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0376, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 66.14695048332214
Validation after dual ascent:
out_inf: tensor(4.0586, device='cuda:0', dtype=torch.float16) tensor(0.1043, device='cuda:0', dtype=torch.float16)
tensor(0.3760, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.3508, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.3782, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
tensor(0.4111, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
layer 15 done
16 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.4062, device='cuda:0', dtype=torch.float16) tensor(0.7739, device='cuda:0', dtype=torch.float16)
tensor(2.6523, device='cuda:0', dtype=torch.float16) tensor(0.2041, device='cuda:0', dtype=torch.float16)
tensor(1.8691, device='cuda:0', dtype=torch.float16) tensor(0.2052, device='cuda:0', dtype=torch.float16)
tensor(1.7598, device='cuda:0', dtype=torch.float16) tensor(0.2163, device='cuda:0', dtype=torch.float16)
tensor(1.8398, device='cuda:0', dtype=torch.float16) tensor(0.1978, device='cuda:0', dtype=torch.float16)
tensor(0.1028, device='cuda:0')
old_score: tensor(0.2058, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1704, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.241043090820312
Validation after dual ascent:
out_inf: tensor(15.4062, device='cuda:0', dtype=torch.float16) tensor(0.7739, device='cuda:0', dtype=torch.float16)
tensor(2.1719, device='cuda:0', dtype=torch.float16) tensor(0.1686, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.1705, device='cuda:0', dtype=torch.float16)
tensor(1.5410, device='cuda:0', dtype=torch.float16) tensor(0.1809, device='cuda:0', dtype=torch.float16)
tensor(1.6953, device='cuda:0', dtype=torch.float16) tensor(0.1617, device='cuda:0', dtype=torch.float16)
16 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.9844, device='cuda:0', dtype=torch.float16) tensor(1.0723, device='cuda:0', dtype=torch.float16)
tensor(2.1328, device='cuda:0', dtype=torch.float16) tensor(0.2115, device='cuda:0', dtype=torch.float16)
tensor(1.6348, device='cuda:0', dtype=torch.float16) tensor(0.2133, device='cuda:0', dtype=torch.float16)
tensor(1.7666, device='cuda:0', dtype=torch.float16) tensor(0.2225, device='cuda:0', dtype=torch.float16)
tensor(1.7617, device='cuda:0', dtype=torch.float16) tensor(0.2052, device='cuda:0', dtype=torch.float16)
tensor(0.1093, device='cuda:0')
old_score: tensor(0.2131, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1733, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.272860288619995
Validation after dual ascent:
out_inf: tensor(16.9844, device='cuda:0', dtype=torch.float16) tensor(1.0723, device='cuda:0', dtype=torch.float16)
tensor(1.7402, device='cuda:0', dtype=torch.float16) tensor(0.1716, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.1738, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.1833, device='cuda:0', dtype=torch.float16)
tensor(1.6006, device='cuda:0', dtype=torch.float16) tensor(0.1647, device='cuda:0', dtype=torch.float16)
16 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6133, device='cuda:0', dtype=torch.float16) tensor(0.3079, device='cuda:0', dtype=torch.float16)
tensor(1.1104, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
tensor(1.0215, device='cuda:0', dtype=torch.float16) tensor(0.1334, device='cuda:0', dtype=torch.float16)
tensor(1.0146, device='cuda:0', dtype=torch.float16) tensor(0.1399, device='cuda:0', dtype=torch.float16)
tensor(1.0547, device='cuda:0', dtype=torch.float16) tensor(0.1288, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0110, device='cuda:0')
tensor(0.1917, device='cuda:0')
old_score: tensor(0.1338, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1129, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2526862621307373
Validation after dual ascent:
out_inf: tensor(4.6133, device='cuda:0', dtype=torch.float16) tensor(0.3079, device='cuda:0', dtype=torch.float16)
tensor(0.9834, device='cuda:0', dtype=torch.float16) tensor(0.1120, device='cuda:0', dtype=torch.float16)
tensor(0.9341, device='cuda:0', dtype=torch.float16) tensor(0.1129, device='cuda:0', dtype=torch.float16)
tensor(1.0186, device='cuda:0', dtype=torch.float16) tensor(0.1195, device='cuda:0', dtype=torch.float16)
tensor(0.9009, device='cuda:0', dtype=torch.float16) tensor(0.1074, device='cuda:0', dtype=torch.float16)
16 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.3633, device='cuda:0', dtype=torch.float16) tensor(0.1199, device='cuda:0', dtype=torch.float16)
tensor(0.4692, device='cuda:0', dtype=torch.float16) tensor(0.0468, device='cuda:0', dtype=torch.float16)
tensor(0.4534, device='cuda:0', dtype=torch.float16) tensor(0.0476, device='cuda:0', dtype=torch.float16)
tensor(0.5337, device='cuda:0', dtype=torch.float16) tensor(0.0537, device='cuda:0', dtype=torch.float16)
tensor(0.5464, device='cuda:0', dtype=torch.float16) tensor(0.0428, device='cuda:0', dtype=torch.float16)
tensor(0.0677, device='cuda:0')
old_score: tensor(0.0478, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0418, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.215690851211548
Validation after dual ascent:
out_inf: tensor(7.3633, device='cuda:0', dtype=torch.float16) tensor(0.1199, device='cuda:0', dtype=torch.float16)
tensor(0.4673, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.4019, device='cuda:0', dtype=torch.float16) tensor(0.0414, device='cuda:0', dtype=torch.float16)
tensor(0.4688, device='cuda:0', dtype=torch.float16) tensor(0.0477, device='cuda:0', dtype=torch.float16)
tensor(0.5156, device='cuda:0', dtype=torch.float16) tensor(0.0371, device='cuda:0', dtype=torch.float16)
16 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.5781, device='cuda:0', dtype=torch.float16) tensor(0.3462, device='cuda:0', dtype=torch.float16)
tensor(1.5381, device='cuda:0', dtype=torch.float16) tensor(0.1091, device='cuda:0', dtype=torch.float16)
tensor(1.2754, device='cuda:0', dtype=torch.float16) tensor(0.1084, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.1177, device='cuda:0', dtype=torch.float16)
tensor(1.4395, device='cuda:0', dtype=torch.float16) tensor(0.1053, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0184, device='cuda:0')
tensor(0.0486, device='cuda:0')
old_score: tensor(0.1101, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0912, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.238817691802979
Validation after dual ascent:
out_inf: tensor(7.5781, device='cuda:0', dtype=torch.float16) tensor(0.3462, device='cuda:0', dtype=torch.float16)
tensor(1.5479, device='cuda:0', dtype=torch.float16) tensor(0.0903, device='cuda:0', dtype=torch.float16)
tensor(1.1445, device='cuda:0', dtype=torch.float16) tensor(0.0900, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.0982, device='cuda:0', dtype=torch.float16)
tensor(1.1064, device='cuda:0', dtype=torch.float16) tensor(0.0861, device='cuda:0', dtype=torch.float16)
16 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0938, device='cuda:0', dtype=torch.float16) tensor(0.2563, device='cuda:0', dtype=torch.float16)
tensor(1.2627, device='cuda:0', dtype=torch.float16) tensor(0.1050, device='cuda:0', dtype=torch.float16)
tensor(1.3105, device='cuda:0', dtype=torch.float16) tensor(0.1044, device='cuda:0', dtype=torch.float16)
tensor(1.0566, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.1768, device='cuda:0', dtype=torch.float16) tensor(0.1015, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0117, device='cuda:0')
tensor(0.0419, device='cuda:0')
old_score: tensor(0.1061, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0886, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.22698974609375
Validation after dual ascent:
out_inf: tensor(5.0938, device='cuda:0', dtype=torch.float16) tensor(0.2563, device='cuda:0', dtype=torch.float16)
tensor(1.2637, device='cuda:0', dtype=torch.float16) tensor(0.0878, device='cuda:0', dtype=torch.float16)
tensor(1.0117, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(0.8765, device='cuda:0', dtype=torch.float16) tensor(0.0954, device='cuda:0', dtype=torch.float16)
tensor(0.8994, device='cuda:0', dtype=torch.float16) tensor(0.0837, device='cuda:0', dtype=torch.float16)
16 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6133, device='cuda:0', dtype=torch.float16) tensor(0.1181, device='cuda:0', dtype=torch.float16)
tensor(0.4504, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
tensor(0.3540, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.3718, device='cuda:0', dtype=torch.float16) tensor(0.0450, device='cuda:0', dtype=torch.float16)
tensor(0.3862, device='cuda:0', dtype=torch.float16) tensor(0.0397, device='cuda:0', dtype=torch.float16)
Converged at iteration 650
tensor(0.0111, device='cuda:0')
tensor(0.0178, device='cuda:0')
old_score: tensor(0.0418, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0378, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 66.04263734817505
Validation after dual ascent:
out_inf: tensor(5.6133, device='cuda:0', dtype=torch.float16) tensor(0.1181, device='cuda:0', dtype=torch.float16)
tensor(0.4619, device='cuda:0', dtype=torch.float16) tensor(0.0374, device='cuda:0', dtype=torch.float16)
tensor(0.3506, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.3391, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.3787, device='cuda:0', dtype=torch.float16) tensor(0.0354, device='cuda:0', dtype=torch.float16)
layer 16 done
17 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.5547, device='cuda:0', dtype=torch.float16) tensor(0.7783, device='cuda:0', dtype=torch.float16)
tensor(1.8770, device='cuda:0', dtype=torch.float16) tensor(0.1903, device='cuda:0', dtype=torch.float16)
tensor(1.6758, device='cuda:0', dtype=torch.float16) tensor(0.1902, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.2057, device='cuda:0', dtype=torch.float16)
tensor(1.9453, device='cuda:0', dtype=torch.float16) tensor(0.1842, device='cuda:0', dtype=torch.float16)
tensor(0.2423, device='cuda:0')
old_score: tensor(0.1925, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1556, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.262528657913208
Validation after dual ascent:
out_inf: tensor(15.5547, device='cuda:0', dtype=torch.float16) tensor(0.7783, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
tensor(1.5840, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(1.6543, device='cuda:0', dtype=torch.float16) tensor(0.1678, device='cuda:0', dtype=torch.float16)
tensor(1.8438, device='cuda:0', dtype=torch.float16) tensor(0.1470, device='cuda:0', dtype=torch.float16)
17 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.9688, device='cuda:0', dtype=torch.float16) tensor(1.0186, device='cuda:0', dtype=torch.float16)
tensor(1.6934, device='cuda:0', dtype=torch.float16) tensor(0.1963, device='cuda:0', dtype=torch.float16)
tensor(1.8379, device='cuda:0', dtype=torch.float16) tensor(0.1971, device='cuda:0', dtype=torch.float16)
tensor(2.4258, device='cuda:0', dtype=torch.float16) tensor(0.2104, device='cuda:0', dtype=torch.float16)
tensor(1.9629, device='cuda:0', dtype=torch.float16) tensor(0.1901, device='cuda:0', dtype=torch.float16)
tensor(0.2370, device='cuda:0')
old_score: tensor(0.1985, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1578, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.28560733795166
Validation after dual ascent:
out_inf: tensor(16.9688, device='cuda:0', dtype=torch.float16) tensor(1.0186, device='cuda:0', dtype=torch.float16)
tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
tensor(1.4912, device='cuda:0', dtype=torch.float16) tensor(0.1571, device='cuda:0', dtype=torch.float16)
tensor(2.0293, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(1.5986, device='cuda:0', dtype=torch.float16) tensor(0.1490, device='cuda:0', dtype=torch.float16)
17 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2148, device='cuda:0', dtype=torch.float16) tensor(0.3135, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
tensor(1.0283, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
tensor(1.1924, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(0.1347, device='cuda:0')
old_score: tensor(0.1282, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1049, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.213505983352661
Validation after dual ascent:
out_inf: tensor(4.2148, device='cuda:0', dtype=torch.float16) tensor(0.3135, device='cuda:0', dtype=torch.float16)
tensor(0.9541, device='cuda:0', dtype=torch.float16) tensor(0.1034, device='cuda:0', dtype=torch.float16)
tensor(1.0332, device='cuda:0', dtype=torch.float16) tensor(0.1042, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.1127, device='cuda:0', dtype=torch.float16)
tensor(0.9849, device='cuda:0', dtype=torch.float16) tensor(0.0991, device='cuda:0', dtype=torch.float16)
17 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.8789, device='cuda:0', dtype=torch.float16) tensor(0.1183, device='cuda:0', dtype=torch.float16)
tensor(0.5303, device='cuda:0', dtype=torch.float16) tensor(0.0453, device='cuda:0', dtype=torch.float16)
tensor(0.4736, device='cuda:0', dtype=torch.float16) tensor(0.0464, device='cuda:0', dtype=torch.float16)
tensor(0.5396, device='cuda:0', dtype=torch.float16) tensor(0.0544, device='cuda:0', dtype=torch.float16)
tensor(0.6772, device='cuda:0', dtype=torch.float16) tensor(0.0422, device='cuda:0', dtype=torch.float16)
tensor(0.0439, device='cuda:0')
old_score: tensor(0.0471, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0393, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.149763584136963
Validation after dual ascent:
out_inf: tensor(4.8789, device='cuda:0', dtype=torch.float16) tensor(0.1183, device='cuda:0', dtype=torch.float16)
tensor(0.4863, device='cuda:0', dtype=torch.float16) tensor(0.0375, device='cuda:0', dtype=torch.float16)
tensor(0.4961, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
tensor(0.4941, device='cuda:0', dtype=torch.float16) tensor(0.0469, device='cuda:0', dtype=torch.float16)
tensor(0.5244, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
17 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.9297, device='cuda:0', dtype=torch.float16) tensor(0.3701, device='cuda:0', dtype=torch.float16)
tensor(1.6758, device='cuda:0', dtype=torch.float16) tensor(0.1132, device='cuda:0', dtype=torch.float16)
tensor(1.4180, device='cuda:0', dtype=torch.float16) tensor(0.1141, device='cuda:0', dtype=torch.float16)
tensor(1.7549, device='cuda:0', dtype=torch.float16) tensor(0.1226, device='cuda:0', dtype=torch.float16)
tensor(1.4111, device='cuda:0', dtype=torch.float16) tensor(0.1102, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0194, device='cuda:0')
tensor(0.0527, device='cuda:0')
old_score: tensor(0.1150, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0940, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.189173698425293
Validation after dual ascent:
out_inf: tensor(9.9297, device='cuda:0', dtype=torch.float16) tensor(0.3701, device='cuda:0', dtype=torch.float16)
tensor(1.4043, device='cuda:0', dtype=torch.float16) tensor(0.0924, device='cuda:0', dtype=torch.float16)
tensor(1.0723, device='cuda:0', dtype=torch.float16) tensor(0.0936, device='cuda:0', dtype=torch.float16)
tensor(1.3965, device='cuda:0', dtype=torch.float16) tensor(0.1011, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.0889, device='cuda:0', dtype=torch.float16)
17 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4648, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(1.1465, device='cuda:0', dtype=torch.float16) tensor(0.1069, device='cuda:0', dtype=torch.float16)
tensor(1.2998, device='cuda:0', dtype=torch.float16) tensor(0.1079, device='cuda:0', dtype=torch.float16)
tensor(1.5723, device='cuda:0', dtype=torch.float16) tensor(0.1156, device='cuda:0', dtype=torch.float16)
tensor(1.2910, device='cuda:0', dtype=torch.float16) tensor(0.1041, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0110, device='cuda:0')
tensor(0.0413, device='cuda:0')
old_score: tensor(0.1086, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0901, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.187182903289795
Validation after dual ascent:
out_inf: tensor(5.4648, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(1.0820, device='cuda:0', dtype=torch.float16) tensor(0.0886, device='cuda:0', dtype=torch.float16)
tensor(0.9355, device='cuda:0', dtype=torch.float16) tensor(0.0898, device='cuda:0', dtype=torch.float16)
tensor(1.0547, device='cuda:0', dtype=torch.float16) tensor(0.0970, device='cuda:0', dtype=torch.float16)
tensor(0.9243, device='cuda:0', dtype=torch.float16) tensor(0.0853, device='cuda:0', dtype=torch.float16)
17 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.8516, device='cuda:0', dtype=torch.float16) tensor(0.1074, device='cuda:0', dtype=torch.float16)
tensor(0.4243, device='cuda:0', dtype=torch.float16) tensor(0.0408, device='cuda:0', dtype=torch.float16)
tensor(0.4204, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.3672, device='cuda:0', dtype=torch.float16) tensor(0.0440, device='cuda:0', dtype=torch.float16)
tensor(0.3936, device='cuda:0', dtype=torch.float16) tensor(0.0394, device='cuda:0', dtype=torch.float16)
Converged at iteration 600
tensor(0.0151, device='cuda:0')
tensor(0.0227, device='cuda:0')
old_score: tensor(0.0414, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0372, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 61.17924451828003
Validation after dual ascent:
out_inf: tensor(2.8516, device='cuda:0', dtype=torch.float16) tensor(0.1074, device='cuda:0', dtype=torch.float16)
tensor(0.3828, device='cuda:0', dtype=torch.float16) tensor(0.0366, device='cuda:0', dtype=torch.float16)
tensor(0.4233, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
tensor(0.3706, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.3447, device='cuda:0', dtype=torch.float16) tensor(0.0351, device='cuda:0', dtype=torch.float16)
layer 17 done
18 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.2656, device='cuda:0', dtype=torch.float16) tensor(0.8018, device='cuda:0', dtype=torch.float16)
tensor(2.0859, device='cuda:0', dtype=torch.float16) tensor(0.1980, device='cuda:0', dtype=torch.float16)
tensor(1.6279, device='cuda:0', dtype=torch.float16) tensor(0.2003, device='cuda:0', dtype=torch.float16)
tensor(1.7373, device='cuda:0', dtype=torch.float16) tensor(0.2120, device='cuda:0', dtype=torch.float16)
tensor(2.2266, device='cuda:0', dtype=torch.float16) tensor(0.1915, device='cuda:0', dtype=torch.float16)
tensor(0.1016, device='cuda:0')
old_score: tensor(0.2004, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1615, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.246622800827026
Validation after dual ascent:
out_inf: tensor(14.2656, device='cuda:0', dtype=torch.float16) tensor(0.8018, device='cuda:0', dtype=torch.float16)
tensor(1.9971, device='cuda:0', dtype=torch.float16) tensor(0.1587, device='cuda:0', dtype=torch.float16)
tensor(1.5039, device='cuda:0', dtype=torch.float16) tensor(0.1614, device='cuda:0', dtype=torch.float16)
tensor(1.5684, device='cuda:0', dtype=torch.float16) tensor(0.1733, device='cuda:0', dtype=torch.float16)
tensor(1.9424, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
18 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.9375, device='cuda:0', dtype=torch.float16) tensor(0.9995, device='cuda:0', dtype=torch.float16)
tensor(1.8867, device='cuda:0', dtype=torch.float16) tensor(0.2020, device='cuda:0', dtype=torch.float16)
tensor(1.5928, device='cuda:0', dtype=torch.float16) tensor(0.2034, device='cuda:0', dtype=torch.float16)
tensor(1.7158, device='cuda:0', dtype=torch.float16) tensor(0.2153, device='cuda:0', dtype=torch.float16)
tensor(1.7471, device='cuda:0', dtype=torch.float16) tensor(0.1949, device='cuda:0', dtype=torch.float16)
tensor(0.1079, device='cuda:0')
old_score: tensor(0.2039, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1625, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.272116422653198
Validation after dual ascent:
out_inf: tensor(16.9375, device='cuda:0', dtype=torch.float16) tensor(0.9995, device='cuda:0', dtype=torch.float16)
tensor(1.3984, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
tensor(1.4541, device='cuda:0', dtype=torch.float16) tensor(0.1624, device='cuda:0', dtype=torch.float16)
tensor(1.5537, device='cuda:0', dtype=torch.float16) tensor(0.1741, device='cuda:0', dtype=torch.float16)
tensor(1.7334, device='cuda:0', dtype=torch.float16) tensor(0.1537, device='cuda:0', dtype=torch.float16)
18 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.5234, device='cuda:0', dtype=torch.float16) tensor(0.3330, device='cuda:0', dtype=torch.float16)
tensor(1.1719, device='cuda:0', dtype=torch.float16) tensor(0.1398, device='cuda:0', dtype=torch.float16)
tensor(1.1055, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
tensor(1.2412, device='cuda:0', dtype=torch.float16) tensor(0.1506, device='cuda:0', dtype=torch.float16)
tensor(1.1641, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
tensor(0.0412, device='cuda:0')
old_score: tensor(0.1417, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1165, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.263265609741211
Validation after dual ascent:
out_inf: tensor(4.5234, device='cuda:0', dtype=torch.float16) tensor(0.3330, device='cuda:0', dtype=torch.float16)
tensor(0.9487, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(1.0322, device='cuda:0', dtype=torch.float16) tensor(0.1163, device='cuda:0', dtype=torch.float16)
tensor(1.1582, device='cuda:0', dtype=torch.float16) tensor(0.1250, device='cuda:0', dtype=torch.float16)
tensor(1.0908, device='cuda:0', dtype=torch.float16) tensor(0.1102, device='cuda:0', dtype=torch.float16)
18 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.1875, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(0.4268, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.4551, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.4631, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
tensor(0.5210, device='cuda:0', dtype=torch.float16) tensor(0.0385, device='cuda:0', dtype=torch.float16)
tensor(0.1286, device='cuda:0')
old_score: tensor(0.0413, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0362, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.175007104873657
Validation after dual ascent:
out_inf: tensor(5.1875, device='cuda:0', dtype=torch.float16) tensor(0.0945, device='cuda:0', dtype=torch.float16)
tensor(0.4009, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.3943, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
tensor(0.4575, device='cuda:0', dtype=torch.float16) tensor(0.0406, device='cuda:0', dtype=torch.float16)
tensor(0.4209, device='cuda:0', dtype=torch.float16) tensor(0.0335, device='cuda:0', dtype=torch.float16)
18 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(10.3906, device='cuda:0', dtype=torch.float16) tensor(0.3779, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.1178, device='cuda:0', dtype=torch.float16)
tensor(1.4727, device='cuda:0', dtype=torch.float16) tensor(0.1187, device='cuda:0', dtype=torch.float16)
tensor(1.2520, device='cuda:0', dtype=torch.float16) tensor(0.1268, device='cuda:0', dtype=torch.float16)
tensor(1.4512, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0183, device='cuda:0')
tensor(0.0235, device='cuda:0')
old_score: tensor(0.1193, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0969, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.183385610580444
Validation after dual ascent:
out_inf: tensor(10.3906, device='cuda:0', dtype=torch.float16) tensor(0.3779, device='cuda:0', dtype=torch.float16)
tensor(1.2305, device='cuda:0', dtype=torch.float16) tensor(0.0955, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
tensor(1.0020, device='cuda:0', dtype=torch.float16) tensor(0.1039, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0914, device='cuda:0', dtype=torch.float16)
18 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6055, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(1.2090, device='cuda:0', dtype=torch.float16) tensor(0.1096, device='cuda:0', dtype=torch.float16)
tensor(1.1660, device='cuda:0', dtype=torch.float16) tensor(0.1103, device='cuda:0', dtype=torch.float16)
tensor(1.1602, device='cuda:0', dtype=torch.float16) tensor(0.1176, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1057, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0108, device='cuda:0')
tensor(0.0464, device='cuda:0')
old_score: tensor(0.1108, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0918, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.190218448638916
Validation after dual ascent:
out_inf: tensor(5.6055, device='cuda:0', dtype=torch.float16) tensor(0.2527, device='cuda:0', dtype=torch.float16)
tensor(1.1387, device='cuda:0', dtype=torch.float16) tensor(0.0905, device='cuda:0', dtype=torch.float16)
tensor(0.8931, device='cuda:0', dtype=torch.float16) tensor(0.0917, device='cuda:0', dtype=torch.float16)
tensor(0.9434, device='cuda:0', dtype=torch.float16) tensor(0.0984, device='cuda:0', dtype=torch.float16)
tensor(0.9512, device='cuda:0', dtype=torch.float16) tensor(0.0865, device='cuda:0', dtype=torch.float16)
18 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.6113, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
tensor(0.4102, device='cuda:0', dtype=torch.float16) tensor(0.0422, device='cuda:0', dtype=torch.float16)
tensor(0.4375, device='cuda:0', dtype=torch.float16) tensor(0.0421, device='cuda:0', dtype=torch.float16)
tensor(0.4150, device='cuda:0', dtype=torch.float16) tensor(0.0455, device='cuda:0', dtype=torch.float16)
tensor(0.4814, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
Converged at iteration 450
tensor(0.0164, device='cuda:0')
tensor(0.0302, device='cuda:0')
old_score: tensor(0.0425, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0384, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 46.46935510635376
Validation after dual ascent:
out_inf: tensor(2.6113, device='cuda:0', dtype=torch.float16) tensor(0.1077, device='cuda:0', dtype=torch.float16)
tensor(0.3750, device='cuda:0', dtype=torch.float16) tensor(0.0379, device='cuda:0', dtype=torch.float16)
tensor(0.4111, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
tensor(0.4028, device='cuda:0', dtype=torch.float16) tensor(0.0416, device='cuda:0', dtype=torch.float16)
tensor(0.4722, device='cuda:0', dtype=torch.float16) tensor(0.0359, device='cuda:0', dtype=torch.float16)
layer 18 done
19 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.5391, device='cuda:0', dtype=torch.float16) tensor(0.7803, device='cuda:0', dtype=torch.float16)
tensor(2.0723, device='cuda:0', dtype=torch.float16) tensor(0.1938, device='cuda:0', dtype=torch.float16)
tensor(2.0527, device='cuda:0', dtype=torch.float16) tensor(0.1952, device='cuda:0', dtype=torch.float16)
tensor(1.7988, device='cuda:0', dtype=torch.float16) tensor(0.2074, device='cuda:0', dtype=torch.float16)
tensor(2.1641, device='cuda:0', dtype=torch.float16) tensor(0.1868, device='cuda:0', dtype=torch.float16)
tensor(0.1614, device='cuda:0')
old_score: tensor(0.1958, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1584, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.25537109375
Validation after dual ascent:
out_inf: tensor(13.5391, device='cuda:0', dtype=torch.float16) tensor(0.7803, device='cuda:0', dtype=torch.float16)
tensor(1.8359, device='cuda:0', dtype=torch.float16) tensor(0.1561, device='cuda:0', dtype=torch.float16)
tensor(1.8359, device='cuda:0', dtype=torch.float16) tensor(0.1587, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.1696, device='cuda:0', dtype=torch.float16)
tensor(2.0039, device='cuda:0', dtype=torch.float16) tensor(0.1497, device='cuda:0', dtype=torch.float16)
19 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.9531, device='cuda:0', dtype=torch.float16) tensor(1.0684, device='cuda:0', dtype=torch.float16)
tensor(1.9355, device='cuda:0', dtype=torch.float16) tensor(0.2014, device='cuda:0', dtype=torch.float16)
tensor(1.5049, device='cuda:0', dtype=torch.float16) tensor(0.2036, device='cuda:0', dtype=torch.float16)
tensor(1.7451, device='cuda:0', dtype=torch.float16) tensor(0.2135, device='cuda:0', dtype=torch.float16)
tensor(1.9727, device='cuda:0', dtype=torch.float16) tensor(0.1942, device='cuda:0', dtype=torch.float16)
tensor(0.1788, device='cuda:0')
old_score: tensor(0.2032, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1611, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.281248092651367
Validation after dual ascent:
out_inf: tensor(16.9531, device='cuda:0', dtype=torch.float16) tensor(1.0684, device='cuda:0', dtype=torch.float16)
tensor(1.5781, device='cuda:0', dtype=torch.float16) tensor(0.1592, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.1615, device='cuda:0', dtype=torch.float16)
tensor(1.5996, device='cuda:0', dtype=torch.float16) tensor(0.1716, device='cuda:0', dtype=torch.float16)
tensor(1.6641, device='cuda:0', dtype=torch.float16) tensor(0.1523, device='cuda:0', dtype=torch.float16)
19 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.7910, device='cuda:0', dtype=torch.float16) tensor(0.3560, device='cuda:0', dtype=torch.float16)
tensor(1.3291, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
tensor(1.2520, device='cuda:0', dtype=torch.float16) tensor(0.1471, device='cuda:0', dtype=torch.float16)
tensor(1.3311, device='cuda:0', dtype=torch.float16) tensor(0.1544, device='cuda:0', dtype=torch.float16)
tensor(1.2529, device='cuda:0', dtype=torch.float16) tensor(0.1409, device='cuda:0', dtype=torch.float16)
tensor(0.0913, device='cuda:0')
old_score: tensor(0.1470, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1196, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.241724252700806
Validation after dual ascent:
out_inf: tensor(3.7910, device='cuda:0', dtype=torch.float16) tensor(0.3560, device='cuda:0', dtype=torch.float16)
tensor(1.0996, device='cuda:0', dtype=torch.float16) tensor(0.1181, device='cuda:0', dtype=torch.float16)
tensor(1.2441, device='cuda:0', dtype=torch.float16) tensor(0.1199, device='cuda:0', dtype=torch.float16)
tensor(1.2236, device='cuda:0', dtype=torch.float16) tensor(0.1272, device='cuda:0', dtype=torch.float16)
tensor(1.1504, device='cuda:0', dtype=torch.float16) tensor(0.1130, device='cuda:0', dtype=torch.float16)
19 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1562, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(0.4629, device='cuda:0', dtype=torch.float16) tensor(0.0490, device='cuda:0', dtype=torch.float16)
tensor(0.4998, device='cuda:0', dtype=torch.float16) tensor(0.0517, device='cuda:0', dtype=torch.float16)
tensor(0.5239, device='cuda:0', dtype=torch.float16) tensor(0.0514, device='cuda:0', dtype=torch.float16)
tensor(0.4839, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.1151, device='cuda:0')
old_score: tensor(0.0494, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0440, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.161474227905273
Validation after dual ascent:
out_inf: tensor(6.1562, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(0.4189, device='cuda:0', dtype=torch.float16) tensor(0.0432, device='cuda:0', dtype=torch.float16)
tensor(0.4741, device='cuda:0', dtype=torch.float16) tensor(0.0454, device='cuda:0', dtype=torch.float16)
tensor(0.5078, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.4844, device='cuda:0', dtype=torch.float16) tensor(0.0405, device='cuda:0', dtype=torch.float16)
19 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.3438, device='cuda:0', dtype=torch.float16) tensor(0.3582, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(1.4658, device='cuda:0', dtype=torch.float16) tensor(0.1227, device='cuda:0', dtype=torch.float16)
tensor(1.1943, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(1.3672, device='cuda:0', dtype=torch.float16) tensor(0.1170, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0182, device='cuda:0')
tensor(0.0614, device='cuda:0')
old_score: tensor(0.1227, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1011, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.19929814338684
Validation after dual ascent:
out_inf: tensor(9.3438, device='cuda:0', dtype=torch.float16) tensor(0.3582, device='cuda:0', dtype=torch.float16)
tensor(1.3672, device='cuda:0', dtype=torch.float16) tensor(0.1001, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
tensor(1.1855, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
19 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.5469, device='cuda:0', dtype=torch.float16) tensor(0.2593, device='cuda:0', dtype=torch.float16)
tensor(1.2832, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
tensor(1.6055, device='cuda:0', dtype=torch.float16) tensor(0.1146, device='cuda:0', dtype=torch.float16)
tensor(1.2871, device='cuda:0', dtype=torch.float16) tensor(0.1205, device='cuda:0', dtype=torch.float16)
tensor(1.3789, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0110, device='cuda:0')
tensor(0.0513, device='cuda:0')
old_score: tensor(0.1145, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0956, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.19815468788147
Validation after dual ascent:
out_inf: tensor(7.5469, device='cuda:0', dtype=torch.float16) tensor(0.2593, device='cuda:0', dtype=torch.float16)
tensor(1.0654, device='cuda:0', dtype=torch.float16) tensor(0.0946, device='cuda:0', dtype=torch.float16)
tensor(1.3848, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
tensor(0.9878, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(1.3535, device='cuda:0', dtype=torch.float16) tensor(0.0904, device='cuda:0', dtype=torch.float16)
19 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6094, device='cuda:0', dtype=torch.float16) tensor(0.1037, device='cuda:0', dtype=torch.float16)
tensor(0.4280, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
tensor(0.4055, device='cuda:0', dtype=torch.float16) tensor(0.0433, device='cuda:0', dtype=torch.float16)
tensor(0.4321, device='cuda:0', dtype=torch.float16) tensor(0.0457, device='cuda:0', dtype=torch.float16)
tensor(0.4373, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0131, device='cuda:0')
tensor(0.0259, device='cuda:0')
old_score: tensor(0.0432, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0395, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.529945850372314
Validation after dual ascent:
out_inf: tensor(4.6094, device='cuda:0', dtype=torch.float16) tensor(0.1037, device='cuda:0', dtype=torch.float16)
tensor(0.4165, device='cuda:0', dtype=torch.float16) tensor(0.0391, device='cuda:0', dtype=torch.float16)
tensor(0.4087, device='cuda:0', dtype=torch.float16) tensor(0.0396, device='cuda:0', dtype=torch.float16)
tensor(0.4077, device='cuda:0', dtype=torch.float16) tensor(0.0422, device='cuda:0', dtype=torch.float16)
tensor(0.4048, device='cuda:0', dtype=torch.float16) tensor(0.0370, device='cuda:0', dtype=torch.float16)
layer 19 done
20 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.0391, device='cuda:0', dtype=torch.float16) tensor(0.7905, device='cuda:0', dtype=torch.float16)
tensor(1.8379, device='cuda:0', dtype=torch.float16) tensor(0.1949, device='cuda:0', dtype=torch.float16)
tensor(1.7949, device='cuda:0', dtype=torch.float16) tensor(0.1960, device='cuda:0', dtype=torch.float16)
tensor(1.9258, device='cuda:0', dtype=torch.float16) tensor(0.2064, device='cuda:0', dtype=torch.float16)
tensor(1.9004, device='cuda:0', dtype=torch.float16) tensor(0.1873, device='cuda:0', dtype=torch.float16)
tensor(0.1256, device='cuda:0')
old_score: tensor(0.1963, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1586, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.213839769363403
Validation after dual ascent:
out_inf: tensor(15.0391, device='cuda:0', dtype=torch.float16) tensor(0.7905, device='cuda:0', dtype=torch.float16)
tensor(1.6055, device='cuda:0', dtype=torch.float16) tensor(0.1567, device='cuda:0', dtype=torch.float16)
tensor(1.4375, device='cuda:0', dtype=torch.float16) tensor(0.1587, device='cuda:0', dtype=torch.float16)
tensor(1.5830, device='cuda:0', dtype=torch.float16) tensor(0.1691, device='cuda:0', dtype=torch.float16)
tensor(1.7451, device='cuda:0', dtype=torch.float16) tensor(0.1499, device='cuda:0', dtype=torch.float16)
20 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.6406, device='cuda:0', dtype=torch.float16) tensor(1.0645, device='cuda:0', dtype=torch.float16)
tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.2009, device='cuda:0', dtype=torch.float16)
tensor(1.7441, device='cuda:0', dtype=torch.float16) tensor(0.2021, device='cuda:0', dtype=torch.float16)
tensor(2.4570, device='cuda:0', dtype=torch.float16) tensor(0.2108, device='cuda:0', dtype=torch.float16)
tensor(2.2656, device='cuda:0', dtype=torch.float16) tensor(0.1929, device='cuda:0', dtype=torch.float16)
tensor(0.1461, device='cuda:0')
old_score: tensor(0.2017, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1604, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.22423505783081
Validation after dual ascent:
out_inf: tensor(17.6406, device='cuda:0', dtype=torch.float16) tensor(1.0645, device='cuda:0', dtype=torch.float16)
tensor(1.3672, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(1.6357, device='cuda:0', dtype=torch.float16) tensor(0.1608, device='cuda:0', dtype=torch.float16)
tensor(2.1582, device='cuda:0', dtype=torch.float16) tensor(0.1704, device='cuda:0', dtype=torch.float16)
tensor(1.9277, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
20 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.2461, device='cuda:0', dtype=torch.float16) tensor(0.3372, device='cuda:0', dtype=torch.float16)
tensor(1.5635, device='cuda:0', dtype=torch.float16) tensor(0.1425, device='cuda:0', dtype=torch.float16)
tensor(1.3193, device='cuda:0', dtype=torch.float16) tensor(0.1437, device='cuda:0', dtype=torch.float16)
tensor(1.2930, device='cuda:0', dtype=torch.float16) tensor(0.1499, device='cuda:0', dtype=torch.float16)
tensor(1.4707, device='cuda:0', dtype=torch.float16) tensor(0.1372, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0174, device='cuda:0')
tensor(0.2074, device='cuda:0')
old_score: tensor(0.1433, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1185, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 3.2418434619903564
Validation after dual ascent:
out_inf: tensor(5.2461, device='cuda:0', dtype=torch.float16) tensor(0.3372, device='cuda:0', dtype=torch.float16)
tensor(1.1475, device='cuda:0', dtype=torch.float16) tensor(0.1174, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.1189, device='cuda:0', dtype=torch.float16)
tensor(1.0918, device='cuda:0', dtype=torch.float16) tensor(0.1255, device='cuda:0', dtype=torch.float16)
tensor(1.0840, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
20 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.9141, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
tensor(0.7139, device='cuda:0', dtype=torch.float16) tensor(0.0575, device='cuda:0', dtype=torch.float16)
tensor(0.5786, device='cuda:0', dtype=torch.float16) tensor(0.0602, device='cuda:0', dtype=torch.float16)
tensor(0.5898, device='cuda:0', dtype=torch.float16) tensor(0.0517, device='cuda:0', dtype=torch.float16)
tensor(0.5781, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
tensor(0.0945, device='cuda:0')
old_score: tensor(0.0559, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0465, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.160322427749634
Validation after dual ascent:
out_inf: tensor(9.9141, device='cuda:0', dtype=torch.float16) tensor(0.1428, device='cuda:0', dtype=torch.float16)
tensor(0.5254, device='cuda:0', dtype=torch.float16) tensor(0.0477, device='cuda:0', dtype=torch.float16)
tensor(0.5996, device='cuda:0', dtype=torch.float16) tensor(0.0499, device='cuda:0', dtype=torch.float16)
tensor(0.5122, device='cuda:0', dtype=torch.float16) tensor(0.0445, device='cuda:0', dtype=torch.float16)
tensor(0.4971, device='cuda:0', dtype=torch.float16) tensor(0.0440, device='cuda:0', dtype=torch.float16)
20 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.9258, device='cuda:0', dtype=torch.float16) tensor(0.3589, device='cuda:0', dtype=torch.float16)
tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.1212, device='cuda:0', dtype=torch.float16)
tensor(1.5254, device='cuda:0', dtype=torch.float16) tensor(0.1234, device='cuda:0', dtype=torch.float16)
tensor(2.0352, device='cuda:0', dtype=torch.float16) tensor(0.1302, device='cuda:0', dtype=torch.float16)
tensor(2.0527, device='cuda:0', dtype=torch.float16) tensor(0.1171, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0195, device='cuda:0')
tensor(0.0591, device='cuda:0')
old_score: tensor(0.1230, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1013, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.212287664413452
Validation after dual ascent:
out_inf: tensor(7.9258, device='cuda:0', dtype=torch.float16) tensor(0.3589, device='cuda:0', dtype=torch.float16)
tensor(1.7188, device='cuda:0', dtype=torch.float16) tensor(0.0998, device='cuda:0', dtype=torch.float16)
tensor(1.0459, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(1.8730, device='cuda:0', dtype=torch.float16) tensor(0.1083, device='cuda:0', dtype=torch.float16)
tensor(1.7539, device='cuda:0', dtype=torch.float16) tensor(0.0951, device='cuda:0', dtype=torch.float16)
20 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6719, device='cuda:0', dtype=torch.float16) tensor(0.2593, device='cuda:0', dtype=torch.float16)
tensor(2.4531, device='cuda:0', dtype=torch.float16) tensor(0.1124, device='cuda:0', dtype=torch.float16)
tensor(1.2725, device='cuda:0', dtype=torch.float16) tensor(0.1143, device='cuda:0', dtype=torch.float16)
tensor(1.1152, device='cuda:0', dtype=torch.float16) tensor(0.1205, device='cuda:0', dtype=torch.float16)
tensor(1.3574, device='cuda:0', dtype=torch.float16) tensor(0.1086, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0118, device='cuda:0')
tensor(0.0498, device='cuda:0')
old_score: tensor(0.1140, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0951, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.199733972549438
Validation after dual ascent:
out_inf: tensor(4.6719, device='cuda:0', dtype=torch.float16) tensor(0.2593, device='cuda:0', dtype=torch.float16)
tensor(1.7539, device='cuda:0', dtype=torch.float16) tensor(0.0937, device='cuda:0', dtype=torch.float16)
tensor(0.9756, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
tensor(0.9912, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(1.2578, device='cuda:0', dtype=torch.float16) tensor(0.0893, device='cuda:0', dtype=torch.float16)
20 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.0469, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.4507, device='cuda:0', dtype=torch.float16) tensor(0.0418, device='cuda:0', dtype=torch.float16)
tensor(0.4573, device='cuda:0', dtype=torch.float16) tensor(0.0422, device='cuda:0', dtype=torch.float16)
tensor(0.4829, device='cuda:0', dtype=torch.float16) tensor(0.0451, device='cuda:0', dtype=torch.float16)
tensor(0.4170, device='cuda:0', dtype=torch.float16) tensor(0.0401, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0124, device='cuda:0')
tensor(0.0240, device='cuda:0')
old_score: tensor(0.0423, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0387, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.61319899559021
Validation after dual ascent:
out_inf: tensor(4.0469, device='cuda:0', dtype=torch.float16) tensor(0.1025, device='cuda:0', dtype=torch.float16)
tensor(0.4360, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
tensor(0.4348, device='cuda:0', dtype=torch.float16) tensor(0.0387, device='cuda:0', dtype=torch.float16)
tensor(0.5044, device='cuda:0', dtype=torch.float16) tensor(0.0418, device='cuda:0', dtype=torch.float16)
tensor(0.4458, device='cuda:0', dtype=torch.float16) tensor(0.0362, device='cuda:0', dtype=torch.float16)
layer 20 done
21 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.8438, device='cuda:0', dtype=torch.float16) tensor(0.7759, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.1890, device='cuda:0', dtype=torch.float16)
tensor(1.7891, device='cuda:0', dtype=torch.float16) tensor(0.1912, device='cuda:0', dtype=torch.float16)
tensor(1.7041, device='cuda:0', dtype=torch.float16) tensor(0.2046, device='cuda:0', dtype=torch.float16)
tensor(1.6543, device='cuda:0', dtype=torch.float16) tensor(0.1819, device='cuda:0', dtype=torch.float16)
tensor(0.1271, device='cuda:0')
old_score: tensor(0.1917, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1550, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.17659068107605
Validation after dual ascent:
out_inf: tensor(15.8438, device='cuda:0', dtype=torch.float16) tensor(0.7759, device='cuda:0', dtype=torch.float16)
tensor(1.6504, device='cuda:0', dtype=torch.float16) tensor(0.1526, device='cuda:0', dtype=torch.float16)
tensor(1.5020, device='cuda:0', dtype=torch.float16) tensor(0.1547, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1672, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1456, device='cuda:0', dtype=torch.float16)
21 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.3125, device='cuda:0', dtype=torch.float16) tensor(1.0186, device='cuda:0', dtype=torch.float16)
tensor(1.7432, device='cuda:0', dtype=torch.float16) tensor(0.1947, device='cuda:0', dtype=torch.float16)
tensor(1.8535, device='cuda:0', dtype=torch.float16) tensor(0.1973, device='cuda:0', dtype=torch.float16)
tensor(1.7822, device='cuda:0', dtype=torch.float16) tensor(0.2087, device='cuda:0', dtype=torch.float16)
tensor(1.8936, device='cuda:0', dtype=torch.float16) tensor(0.1869, device='cuda:0', dtype=torch.float16)
tensor(0.1506, device='cuda:0')
old_score: tensor(0.1969, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1567, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.200493335723877
Validation after dual ascent:
out_inf: tensor(17.3125, device='cuda:0', dtype=torch.float16) tensor(1.0186, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1542, device='cuda:0', dtype=torch.float16)
tensor(1.6133, device='cuda:0', dtype=torch.float16) tensor(0.1569, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.1686, device='cuda:0', dtype=torch.float16)
tensor(1.5957, device='cuda:0', dtype=torch.float16) tensor(0.1472, device='cuda:0', dtype=torch.float16)
21 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.3633, device='cuda:0', dtype=torch.float16)
tensor(1.2783, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
tensor(1.4346, device='cuda:0', dtype=torch.float16) tensor(0.1522, device='cuda:0', dtype=torch.float16)
tensor(1.3750, device='cuda:0', dtype=torch.float16) tensor(0.1619, device='cuda:0', dtype=torch.float16)
tensor(1.3721, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0156, device='cuda:0')
tensor(0.1791, device='cuda:0')
old_score: tensor(0.1525, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1245, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.231201171875
Validation after dual ascent:
out_inf: tensor(4.6562, device='cuda:0', dtype=torch.float16) tensor(0.3633, device='cuda:0', dtype=torch.float16)
tensor(1.0596, device='cuda:0', dtype=torch.float16) tensor(0.1227, device='cuda:0', dtype=torch.float16)
tensor(1.1416, device='cuda:0', dtype=torch.float16) tensor(0.1245, device='cuda:0', dtype=torch.float16)
tensor(1.2227, device='cuda:0', dtype=torch.float16) tensor(0.1338, device='cuda:0', dtype=torch.float16)
tensor(1.3223, device='cuda:0', dtype=torch.float16) tensor(0.1169, device='cuda:0', dtype=torch.float16)
21 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9453, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(0.7290, device='cuda:0', dtype=torch.float16) tensor(0.0744, device='cuda:0', dtype=torch.float16)
tensor(0.8521, device='cuda:0', dtype=torch.float16) tensor(0.0792, device='cuda:0', dtype=torch.float16)
tensor(0.9058, device='cuda:0', dtype=torch.float16) tensor(0.0809, device='cuda:0', dtype=torch.float16)
tensor(0.6582, device='cuda:0', dtype=torch.float16) tensor(0.0718, device='cuda:0', dtype=torch.float16)
tensor(0.1157, device='cuda:0')
old_score: tensor(0.0766, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0651, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.138754844665527
Validation after dual ascent:
out_inf: tensor(5.9453, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(0.6787, device='cuda:0', dtype=torch.float16) tensor(0.0638, device='cuda:0', dtype=torch.float16)
tensor(0.8726, device='cuda:0', dtype=torch.float16) tensor(0.0662, device='cuda:0', dtype=torch.float16)
tensor(0.7852, device='cuda:0', dtype=torch.float16) tensor(0.0699, device='cuda:0', dtype=torch.float16)
tensor(0.5781, device='cuda:0', dtype=torch.float16) tensor(0.0605, device='cuda:0', dtype=torch.float16)
21 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.0156, device='cuda:0', dtype=torch.float16) tensor(0.3616, device='cuda:0', dtype=torch.float16)
tensor(1.5801, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(1.6074, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1346, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1194, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0190, device='cuda:0')
tensor(0.0233, device='cuda:0')
old_score: tensor(0.1260, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1042, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.17578411102295
Validation after dual ascent:
out_inf: tensor(7.0156, device='cuda:0', dtype=torch.float16) tensor(0.3616, device='cuda:0', dtype=torch.float16)
tensor(1.2646, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(1.1523, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
tensor(1.0420, device='cuda:0', dtype=torch.float16) tensor(0.1122, device='cuda:0', dtype=torch.float16)
tensor(1.1895, device='cuda:0', dtype=torch.float16) tensor(0.0977, device='cuda:0', dtype=torch.float16)
21 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4648, device='cuda:0', dtype=torch.float16) tensor(0.2649, device='cuda:0', dtype=torch.float16)
tensor(1.3594, device='cuda:0', dtype=torch.float16) tensor(0.1138, device='cuda:0', dtype=torch.float16)
tensor(1.1250, device='cuda:0', dtype=torch.float16) tensor(0.1163, device='cuda:0', dtype=torch.float16)
tensor(1.2344, device='cuda:0', dtype=torch.float16) tensor(0.1238, device='cuda:0', dtype=torch.float16)
tensor(1.5664, device='cuda:0', dtype=torch.float16) tensor(0.1100, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0130, device='cuda:0')
tensor(0.0536, device='cuda:0')
old_score: tensor(0.1160, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0972, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.19689393043518
Validation after dual ascent:
out_inf: tensor(5.4648, device='cuda:0', dtype=torch.float16) tensor(0.2649, device='cuda:0', dtype=torch.float16)
tensor(1.0068, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
tensor(1.0430, device='cuda:0', dtype=torch.float16) tensor(0.0976, device='cuda:0', dtype=torch.float16)
tensor(0.9668, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
tensor(1.1406, device='cuda:0', dtype=torch.float16) tensor(0.0910, device='cuda:0', dtype=torch.float16)
21 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.1426, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(0.4436, device='cuda:0', dtype=torch.float16) tensor(0.0418, device='cuda:0', dtype=torch.float16)
tensor(0.4429, device='cuda:0', dtype=torch.float16) tensor(0.0425, device='cuda:0', dtype=torch.float16)
tensor(0.4529, device='cuda:0', dtype=torch.float16) tensor(0.0458, device='cuda:0', dtype=torch.float16)
tensor(0.4260, device='cuda:0', dtype=torch.float16) tensor(0.0400, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0086, device='cuda:0')
tensor(0.0151, device='cuda:0')
old_score: tensor(0.0425, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0390, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.55073380470276
Validation after dual ascent:
out_inf: tensor(2.1426, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(0.4182, device='cuda:0', dtype=torch.float16) tensor(0.0381, device='cuda:0', dtype=torch.float16)
tensor(0.4636, device='cuda:0', dtype=torch.float16) tensor(0.0391, device='cuda:0', dtype=torch.float16)
tensor(0.4502, device='cuda:0', dtype=torch.float16) tensor(0.0427, device='cuda:0', dtype=torch.float16)
tensor(0.3911, device='cuda:0', dtype=torch.float16) tensor(0.0363, device='cuda:0', dtype=torch.float16)
layer 21 done
22 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.1562, device='cuda:0', dtype=torch.float16) tensor(0.8418, device='cuda:0', dtype=torch.float16)
tensor(2.1484, device='cuda:0', dtype=torch.float16) tensor(0.1970, device='cuda:0', dtype=torch.float16)
tensor(2.1738, device='cuda:0', dtype=torch.float16) tensor(0.1992, device='cuda:0', dtype=torch.float16)
tensor(1.7412, device='cuda:0', dtype=torch.float16) tensor(0.2161, device='cuda:0', dtype=torch.float16)
tensor(1.8379, device='cuda:0', dtype=torch.float16) tensor(0.1904, device='cuda:0', dtype=torch.float16)
tensor(0.1481, device='cuda:0')
old_score: tensor(0.2007, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1625, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.165599584579468
Validation after dual ascent:
out_inf: tensor(17.1562, device='cuda:0', dtype=torch.float16) tensor(0.8418, device='cuda:0', dtype=torch.float16)
tensor(1.7568, device='cuda:0', dtype=torch.float16) tensor(0.1592, device='cuda:0', dtype=torch.float16)
tensor(1.7393, device='cuda:0', dtype=torch.float16) tensor(0.1622, device='cuda:0', dtype=torch.float16)
tensor(1.5801, device='cuda:0', dtype=torch.float16) tensor(0.1764, device='cuda:0', dtype=torch.float16)
tensor(1.7832, device='cuda:0', dtype=torch.float16) tensor(0.1522, device='cuda:0', dtype=torch.float16)
22 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.8594, device='cuda:0', dtype=torch.float16) tensor(1.0420, device='cuda:0', dtype=torch.float16)
tensor(1.8242, device='cuda:0', dtype=torch.float16) tensor(0.2002, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.2050, device='cuda:0', dtype=torch.float16)
tensor(2.2090, device='cuda:0', dtype=torch.float16) tensor(0.2178, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1935, device='cuda:0', dtype=torch.float16)
tensor(0.1639, device='cuda:0')
old_score: tensor(0.2041, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1631, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.202851295471191
Validation after dual ascent:
out_inf: tensor(19.8594, device='cuda:0', dtype=torch.float16) tensor(1.0420, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.1599, device='cuda:0', dtype=torch.float16)
tensor(1.5332, device='cuda:0', dtype=torch.float16) tensor(0.1635, device='cuda:0', dtype=torch.float16)
tensor(1.6123, device='cuda:0', dtype=torch.float16) tensor(0.1765, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
22 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.8164, device='cuda:0', dtype=torch.float16) tensor(0.3816, device='cuda:0', dtype=torch.float16)
tensor(1.3984, device='cuda:0', dtype=torch.float16) tensor(0.1519, device='cuda:0', dtype=torch.float16)
tensor(1.3398, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
tensor(1.4004, device='cuda:0', dtype=torch.float16) tensor(0.1650, device='cuda:0', dtype=torch.float16)
tensor(1.2852, device='cuda:0', dtype=torch.float16) tensor(0.1469, device='cuda:0', dtype=torch.float16)
tensor(0.0566, device='cuda:0')
old_score: tensor(0.1545, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1263, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.217357158660889
Validation after dual ascent:
out_inf: tensor(7.8164, device='cuda:0', dtype=torch.float16) tensor(0.3816, device='cuda:0', dtype=torch.float16)
tensor(1.1758, device='cuda:0', dtype=torch.float16) tensor(0.1243, device='cuda:0', dtype=torch.float16)
tensor(1.0557, device='cuda:0', dtype=torch.float16) tensor(0.1265, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.1365, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.1183, device='cuda:0', dtype=torch.float16)
22 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.1094, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(0.6260, device='cuda:0', dtype=torch.float16) tensor(0.0684, device='cuda:0', dtype=torch.float16)
tensor(0.6636, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.7632, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.7095, device='cuda:0', dtype=torch.float16) tensor(0.0654, device='cuda:0', dtype=torch.float16)
tensor(0.1409, device='cuda:0')
old_score: tensor(0.0688, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0597, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.15487027168274
Validation after dual ascent:
out_inf: tensor(12.1094, device='cuda:0', dtype=torch.float16) tensor(0.1560, device='cuda:0', dtype=torch.float16)
tensor(0.6064, device='cuda:0', dtype=torch.float16) tensor(0.0594, device='cuda:0', dtype=torch.float16)
tensor(0.5996, device='cuda:0', dtype=torch.float16) tensor(0.0582, device='cuda:0', dtype=torch.float16)
tensor(0.7539, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(0.6113, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
22 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.5898, device='cuda:0', dtype=torch.float16) tensor(0.3464, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1217, device='cuda:0', dtype=torch.float16)
tensor(1.4082, device='cuda:0', dtype=torch.float16) tensor(0.1239, device='cuda:0', dtype=torch.float16)
tensor(1.3379, device='cuda:0', dtype=torch.float16) tensor(0.1329, device='cuda:0', dtype=torch.float16)
tensor(1.5820, device='cuda:0', dtype=torch.float16) tensor(0.1170, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0181, device='cuda:0')
tensor(0.0211, device='cuda:0')
old_score: tensor(0.1238, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1029, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 10.169748544692993
Validation after dual ascent:
out_inf: tensor(7.5898, device='cuda:0', dtype=torch.float16) tensor(0.3464, device='cuda:0', dtype=torch.float16)
tensor(1.0605, device='cuda:0', dtype=torch.float16) tensor(0.1012, device='cuda:0', dtype=torch.float16)
tensor(1.0186, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(0.9712, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(1.4824, device='cuda:0', dtype=torch.float16) tensor(0.0958, device='cuda:0', dtype=torch.float16)
22 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.7578, device='cuda:0', dtype=torch.float16) tensor(0.2637, device='cuda:0', dtype=torch.float16)
tensor(1.2383, device='cuda:0', dtype=torch.float16) tensor(0.1118, device='cuda:0', dtype=torch.float16)
tensor(1.3242, device='cuda:0', dtype=torch.float16) tensor(0.1136, device='cuda:0', dtype=torch.float16)
tensor(1.1289, device='cuda:0', dtype=torch.float16) tensor(0.1219, device='cuda:0', dtype=torch.float16)
tensor(1.7988, device='cuda:0', dtype=torch.float16) tensor(0.1074, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0133, device='cuda:0')
tensor(0.0482, device='cuda:0')
old_score: tensor(0.1136, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0953, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.195901870727539
Validation after dual ascent:
out_inf: tensor(4.7578, device='cuda:0', dtype=torch.float16) tensor(0.2637, device='cuda:0', dtype=torch.float16)
tensor(1.1924, device='cuda:0', dtype=torch.float16) tensor(0.0937, device='cuda:0', dtype=torch.float16)
tensor(1.1270, device='cuda:0', dtype=torch.float16) tensor(0.0956, device='cuda:0', dtype=torch.float16)
tensor(0.9722, device='cuda:0', dtype=torch.float16) tensor(0.1033, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.0887, device='cuda:0', dtype=torch.float16)
22 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.6748, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(0.4290, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
tensor(0.4238, device='cuda:0', dtype=torch.float16) tensor(0.0409, device='cuda:0', dtype=torch.float16)
tensor(0.4807, device='cuda:0', dtype=torch.float16) tensor(0.0450, device='cuda:0', dtype=torch.float16)
tensor(0.5342, device='cuda:0', dtype=torch.float16) tensor(0.0388, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0077, device='cuda:0')
tensor(0.0137, device='cuda:0')
old_score: tensor(0.0414, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0382, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 41.56369614601135
Validation after dual ascent:
out_inf: tensor(1.6748, device='cuda:0', dtype=torch.float16) tensor(0.1016, device='cuda:0', dtype=torch.float16)
tensor(0.4089, device='cuda:0', dtype=torch.float16) tensor(0.0376, device='cuda:0', dtype=torch.float16)
tensor(0.3889, device='cuda:0', dtype=torch.float16) tensor(0.0378, device='cuda:0', dtype=torch.float16)
tensor(0.4497, device='cuda:0', dtype=torch.float16) tensor(0.0422, device='cuda:0', dtype=torch.float16)
tensor(0.4983, device='cuda:0', dtype=torch.float16) tensor(0.0353, device='cuda:0', dtype=torch.float16)
layer 22 done
23 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.9453, device='cuda:0', dtype=torch.float16) tensor(0.8535, device='cuda:0', dtype=torch.float16)
tensor(1.9014, device='cuda:0', dtype=torch.float16) tensor(0.2040, device='cuda:0', dtype=torch.float16)
tensor(2.0312, device='cuda:0', dtype=torch.float16) tensor(0.2089, device='cuda:0', dtype=torch.float16)
tensor(1.9229, device='cuda:0', dtype=torch.float16) tensor(0.2244, device='cuda:0', dtype=torch.float16)
tensor(2.0195, device='cuda:0', dtype=torch.float16) tensor(0.1970, device='cuda:0', dtype=torch.float16)
tensor(0.3063, device='cuda:0')
old_score: tensor(0.2085, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1689, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.190381288528442
Validation after dual ascent:
out_inf: tensor(14.9453, device='cuda:0', dtype=torch.float16) tensor(0.8535, device='cuda:0', dtype=torch.float16)
tensor(1.8438, device='cuda:0', dtype=torch.float16) tensor(0.1650, device='cuda:0', dtype=torch.float16)
tensor(1.7158, device='cuda:0', dtype=torch.float16) tensor(0.1691, device='cuda:0', dtype=torch.float16)
tensor(1.8691, device='cuda:0', dtype=torch.float16) tensor(0.1843, device='cuda:0', dtype=torch.float16)
tensor(1.7383, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
23 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.2188, device='cuda:0', dtype=torch.float16) tensor(1.0205, device='cuda:0', dtype=torch.float16)
tensor(1.8672, device='cuda:0', dtype=torch.float16) tensor(0.2079, device='cuda:0', dtype=torch.float16)
tensor(1.8477, device='cuda:0', dtype=torch.float16) tensor(0.2139, device='cuda:0', dtype=torch.float16)
tensor(1.7783, device='cuda:0', dtype=torch.float16) tensor(0.2261, device='cuda:0', dtype=torch.float16)
tensor(2.0234, device='cuda:0', dtype=torch.float16) tensor(0.2009, device='cuda:0', dtype=torch.float16)
tensor(0.3199, device='cuda:0')
old_score: tensor(0.2122, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1697, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.212532758712769
Validation after dual ascent:
out_inf: tensor(18.2188, device='cuda:0', dtype=torch.float16) tensor(1.0205, device='cuda:0', dtype=torch.float16)
tensor(1.6270, device='cuda:0', dtype=torch.float16) tensor(0.1658, device='cuda:0', dtype=torch.float16)
tensor(1.5146, device='cuda:0', dtype=torch.float16) tensor(0.1704, device='cuda:0', dtype=torch.float16)
tensor(1.6758, device='cuda:0', dtype=torch.float16) tensor(0.1844, device='cuda:0', dtype=torch.float16)
tensor(1.6367, device='cuda:0', dtype=torch.float16) tensor(0.1580, device='cuda:0', dtype=torch.float16)
23 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.9297, device='cuda:0', dtype=torch.float16) tensor(0.4207, device='cuda:0', dtype=torch.float16)
tensor(1.3691, device='cuda:0', dtype=torch.float16) tensor(0.1697, device='cuda:0', dtype=torch.float16)
tensor(1.4482, device='cuda:0', dtype=torch.float16) tensor(0.1732, device='cuda:0', dtype=torch.float16)
tensor(1.5312, device='cuda:0', dtype=torch.float16) tensor(0.1837, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1638, device='cuda:0', dtype=torch.float16)
tensor(0.2384, device='cuda:0')
old_score: tensor(0.1726, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1410, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.234590768814087
Validation after dual ascent:
out_inf: tensor(4.9297, device='cuda:0', dtype=torch.float16) tensor(0.4207, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.1382, device='cuda:0', dtype=torch.float16)
tensor(1.2266, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.2715, device='cuda:0', dtype=torch.float16) tensor(0.1531, device='cuda:0', dtype=torch.float16)
tensor(1.3262, device='cuda:0', dtype=torch.float16) tensor(0.1311, device='cuda:0', dtype=torch.float16)
23 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.0547, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(0.8975, device='cuda:0', dtype=torch.float16) tensor(0.0760, device='cuda:0', dtype=torch.float16)
tensor(0.7603, device='cuda:0', dtype=torch.float16) tensor(0.0795, device='cuda:0', dtype=torch.float16)
tensor(0.8335, device='cuda:0', dtype=torch.float16) tensor(0.0740, device='cuda:0', dtype=torch.float16)
tensor(0.7593, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(0.1547, device='cuda:0')
old_score: tensor(0.0743, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0658, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.171695947647095
Validation after dual ascent:
out_inf: tensor(15.0547, device='cuda:0', dtype=torch.float16) tensor(0.1654, device='cuda:0', dtype=torch.float16)
tensor(0.7036, device='cuda:0', dtype=torch.float16) tensor(0.0673, device='cuda:0', dtype=torch.float16)
tensor(0.7700, device='cuda:0', dtype=torch.float16) tensor(0.0701, device='cuda:0', dtype=torch.float16)
tensor(0.7256, device='cuda:0', dtype=torch.float16) tensor(0.0664, device='cuda:0', dtype=torch.float16)
tensor(0.5898, device='cuda:0', dtype=torch.float16) tensor(0.0593, device='cuda:0', dtype=torch.float16)
23 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.5156, device='cuda:0', dtype=torch.float16) tensor(0.3789, device='cuda:0', dtype=torch.float16)
tensor(2.2305, device='cuda:0', dtype=torch.float16) tensor(0.1327, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.1346, device='cuda:0', dtype=torch.float16)
tensor(1.3652, device='cuda:0', dtype=torch.float16) tensor(0.1451, device='cuda:0', dtype=torch.float16)
tensor(2.4531, device='cuda:0', dtype=torch.float16) tensor(0.1270, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0161, device='cuda:0')
tensor(0.0168, device='cuda:0')
old_score: tensor(0.1349, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1109, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.177292585372925
Validation after dual ascent:
out_inf: tensor(8.5156, device='cuda:0', dtype=torch.float16) tensor(0.3789, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.1089, device='cuda:0', dtype=torch.float16)
tensor(1.0967, device='cuda:0', dtype=torch.float16) tensor(0.1108, device='cuda:0', dtype=torch.float16)
tensor(1.1113, device='cuda:0', dtype=torch.float16) tensor(0.1213, device='cuda:0', dtype=torch.float16)
tensor(1.9531, device='cuda:0', dtype=torch.float16) tensor(0.1026, device='cuda:0', dtype=torch.float16)
23 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.7812, device='cuda:0', dtype=torch.float16) tensor(0.2903, device='cuda:0', dtype=torch.float16)
tensor(1.2695, device='cuda:0', dtype=torch.float16) tensor(0.1221, device='cuda:0', dtype=torch.float16)
tensor(1.1484, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(1.6953, device='cuda:0', dtype=torch.float16) tensor(0.1335, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1168, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0150, device='cuda:0')
tensor(0.0635, device='cuda:0')
old_score: tensor(0.1240, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1031, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.220344066619873
Validation after dual ascent:
out_inf: tensor(5.7812, device='cuda:0', dtype=torch.float16) tensor(0.2903, device='cuda:0', dtype=torch.float16)
tensor(1.2363, device='cuda:0', dtype=torch.float16) tensor(0.1013, device='cuda:0', dtype=torch.float16)
tensor(0.9009, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
tensor(1.5508, device='cuda:0', dtype=torch.float16) tensor(0.1127, device='cuda:0', dtype=torch.float16)
tensor(1.2734, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
23 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.7812, device='cuda:0', dtype=torch.float16) tensor(0.1152, device='cuda:0', dtype=torch.float16)
tensor(0.5225, device='cuda:0', dtype=torch.float16) tensor(0.0484, device='cuda:0', dtype=torch.float16)
tensor(0.4668, device='cuda:0', dtype=torch.float16) tensor(0.0479, device='cuda:0', dtype=torch.float16)
tensor(0.5693, device='cuda:0', dtype=torch.float16) tensor(0.0534, device='cuda:0', dtype=torch.float16)
tensor(0.4856, device='cuda:0', dtype=torch.float16) tensor(0.0453, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0130, device='cuda:0')
tensor(0.0116, device='cuda:0')
old_score: tensor(0.0487, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0448, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.83297109603882
Validation after dual ascent:
out_inf: tensor(2.7812, device='cuda:0', dtype=torch.float16) tensor(0.1152, device='cuda:0', dtype=torch.float16)
tensor(0.5312, device='cuda:0', dtype=torch.float16) tensor(0.0443, device='cuda:0', dtype=torch.float16)
tensor(0.4590, device='cuda:0', dtype=torch.float16) tensor(0.0441, device='cuda:0', dtype=torch.float16)
tensor(0.5278, device='cuda:0', dtype=torch.float16) tensor(0.0499, device='cuda:0', dtype=torch.float16)
tensor(0.5020, device='cuda:0', dtype=torch.float16) tensor(0.0410, device='cuda:0', dtype=torch.float16)
layer 23 done
24 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.9219, device='cuda:0', dtype=torch.float16) tensor(0.8052, device='cuda:0', dtype=torch.float16)
tensor(1.9199, device='cuda:0', dtype=torch.float16) tensor(0.1952, device='cuda:0', dtype=torch.float16)
tensor(1.8662, device='cuda:0', dtype=torch.float16) tensor(0.1991, device='cuda:0', dtype=torch.float16)
tensor(1.8857, device='cuda:0', dtype=torch.float16) tensor(0.2167, device='cuda:0', dtype=torch.float16)
tensor(2.3945, device='cuda:0', dtype=torch.float16) tensor(0.1874, device='cuda:0', dtype=torch.float16)
tensor(0.2907, device='cuda:0')
old_score: tensor(0.1996, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1619, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.185336112976074
Validation after dual ascent:
out_inf: tensor(14.9219, device='cuda:0', dtype=torch.float16) tensor(0.8052, device='cuda:0', dtype=torch.float16)
tensor(1.5469, device='cuda:0', dtype=torch.float16) tensor(0.1575, device='cuda:0', dtype=torch.float16)
tensor(1.4512, device='cuda:0', dtype=torch.float16) tensor(0.1617, device='cuda:0', dtype=torch.float16)
tensor(1.7227, device='cuda:0', dtype=torch.float16) tensor(0.1788, device='cuda:0', dtype=torch.float16)
tensor(1.9102, device='cuda:0', dtype=torch.float16) tensor(0.1495, device='cuda:0', dtype=torch.float16)
24 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.2969, device='cuda:0', dtype=torch.float16) tensor(1.0518, device='cuda:0', dtype=torch.float16)
tensor(1.6279, device='cuda:0', dtype=torch.float16) tensor(0.1981, device='cuda:0', dtype=torch.float16)
tensor(1.7051, device='cuda:0', dtype=torch.float16) tensor(0.2037, device='cuda:0', dtype=torch.float16)
tensor(1.8457, device='cuda:0', dtype=torch.float16) tensor(0.2188, device='cuda:0', dtype=torch.float16)
tensor(1.7734, device='cuda:0', dtype=torch.float16) tensor(0.1917, device='cuda:0', dtype=torch.float16)
tensor(0.3045, device='cuda:0')
old_score: tensor(0.2031, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1625, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.206182479858398
Validation after dual ascent:
out_inf: tensor(17.2969, device='cuda:0', dtype=torch.float16) tensor(1.0518, device='cuda:0', dtype=torch.float16)
tensor(1.4414, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.1628, device='cuda:0', dtype=torch.float16)
tensor(1.6289, device='cuda:0', dtype=torch.float16) tensor(0.1786, device='cuda:0', dtype=torch.float16)
tensor(1.6377, device='cuda:0', dtype=torch.float16) tensor(0.1505, device='cuda:0', dtype=torch.float16)
24 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9648, device='cuda:0', dtype=torch.float16) tensor(0.4236, device='cuda:0', dtype=torch.float16)
tensor(1.4551, device='cuda:0', dtype=torch.float16) tensor(0.1649, device='cuda:0', dtype=torch.float16)
tensor(1.7695, device='cuda:0', dtype=torch.float16) tensor(0.1686, device='cuda:0', dtype=torch.float16)
tensor(1.5703, device='cuda:0', dtype=torch.float16) tensor(0.1820, device='cuda:0', dtype=torch.float16)
tensor(1.5361, device='cuda:0', dtype=torch.float16) tensor(0.1589, device='cuda:0', dtype=torch.float16)
tensor(0.2051, device='cuda:0')
old_score: tensor(0.1687, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1372, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.22254991531372
Validation after dual ascent:
out_inf: tensor(5.9648, device='cuda:0', dtype=torch.float16) tensor(0.4236, device='cuda:0', dtype=torch.float16)
tensor(1.2793, device='cuda:0', dtype=torch.float16) tensor(0.1339, device='cuda:0', dtype=torch.float16)
tensor(1.2158, device='cuda:0', dtype=torch.float16) tensor(0.1375, device='cuda:0', dtype=torch.float16)
tensor(1.3809, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
tensor(1.4336, device='cuda:0', dtype=torch.float16) tensor(0.1267, device='cuda:0', dtype=torch.float16)
24 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.6953, device='cuda:0', dtype=torch.float16) tensor(0.2061, device='cuda:0', dtype=torch.float16)
tensor(0.8760, device='cuda:0', dtype=torch.float16) tensor(0.0845, device='cuda:0', dtype=torch.float16)
tensor(0.9805, device='cuda:0', dtype=torch.float16) tensor(0.0997, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.1056, device='cuda:0', dtype=torch.float16)
tensor(0.9351, device='cuda:0', dtype=torch.float16) tensor(0.0849, device='cuda:0', dtype=torch.float16)
tensor(0.5045, device='cuda:0')
old_score: tensor(0.0937, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0828, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.170678853988647
Validation after dual ascent:
out_inf: tensor(13.6953, device='cuda:0', dtype=torch.float16) tensor(0.2061, device='cuda:0', dtype=torch.float16)
tensor(0.7354, device='cuda:0', dtype=torch.float16) tensor(0.0753, device='cuda:0', dtype=torch.float16)
tensor(0.8350, device='cuda:0', dtype=torch.float16) tensor(0.0867, device='cuda:0', dtype=torch.float16)
tensor(1.0322, device='cuda:0', dtype=torch.float16) tensor(0.0953, device='cuda:0', dtype=torch.float16)
tensor(1.0215, device='cuda:0', dtype=torch.float16) tensor(0.0742, device='cuda:0', dtype=torch.float16)
24 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.0547, device='cuda:0', dtype=torch.float16) tensor(0.3979, device='cuda:0', dtype=torch.float16)
tensor(2.2383, device='cuda:0', dtype=torch.float16) tensor(0.1328, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1377, device='cuda:0', dtype=torch.float16)
tensor(1.5547, device='cuda:0', dtype=torch.float16) tensor(0.1472, device='cuda:0', dtype=torch.float16)
tensor(2.4199, device='cuda:0', dtype=torch.float16) tensor(0.1277, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0186, device='cuda:0')
tensor(0.0190, device='cuda:0')
old_score: tensor(0.1364, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1123, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.16968297958374
Validation after dual ascent:
out_inf: tensor(8.0547, device='cuda:0', dtype=torch.float16) tensor(0.3979, device='cuda:0', dtype=torch.float16)
tensor(1.8789, device='cuda:0', dtype=torch.float16) tensor(0.1094, device='cuda:0', dtype=torch.float16)
tensor(1.2324, device='cuda:0', dtype=torch.float16) tensor(0.1134, device='cuda:0', dtype=torch.float16)
tensor(1.4033, device='cuda:0', dtype=torch.float16) tensor(0.1235, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.1031, device='cuda:0', dtype=torch.float16)
24 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.2969, device='cuda:0', dtype=torch.float16) tensor(0.3003, device='cuda:0', dtype=torch.float16)
tensor(1.4668, device='cuda:0', dtype=torch.float16) tensor(0.1220, device='cuda:0', dtype=torch.float16)
tensor(1.3027, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1348, device='cuda:0', dtype=torch.float16)
tensor(1.2402, device='cuda:0', dtype=torch.float16) tensor(0.1170, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0173, device='cuda:0')
tensor(0.0630, device='cuda:0')
old_score: tensor(0.1249, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1045, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.21669054031372
Validation after dual ascent:
out_inf: tensor(4.2969, device='cuda:0', dtype=torch.float16) tensor(0.3003, device='cuda:0', dtype=torch.float16)
tensor(1.0625, device='cuda:0', dtype=torch.float16) tensor(0.1018, device='cuda:0', dtype=torch.float16)
tensor(0.9990, device='cuda:0', dtype=torch.float16) tensor(0.1055, device='cuda:0', dtype=torch.float16)
tensor(1.1309, device='cuda:0', dtype=torch.float16) tensor(0.1147, device='cuda:0', dtype=torch.float16)
tensor(1.1094, device='cuda:0', dtype=torch.float16) tensor(0.0959, device='cuda:0', dtype=torch.float16)
24 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(3.5176, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(0.5205, device='cuda:0', dtype=torch.float16) tensor(0.0490, device='cuda:0', dtype=torch.float16)
tensor(0.5171, device='cuda:0', dtype=torch.float16) tensor(0.0495, device='cuda:0', dtype=torch.float16)
tensor(0.5444, device='cuda:0', dtype=torch.float16) tensor(0.0545, device='cuda:0', dtype=torch.float16)
tensor(0.5532, device='cuda:0', dtype=torch.float16) tensor(0.0456, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0163, device='cuda:0')
tensor(0.0130, device='cuda:0')
old_score: tensor(0.0497, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0457, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.703875303268433
Validation after dual ascent:
out_inf: tensor(3.5176, device='cuda:0', dtype=torch.float16) tensor(0.1215, device='cuda:0', dtype=torch.float16)
tensor(0.4468, device='cuda:0', dtype=torch.float16) tensor(0.0446, device='cuda:0', dtype=torch.float16)
tensor(0.4941, device='cuda:0', dtype=torch.float16) tensor(0.0456, device='cuda:0', dtype=torch.float16)
tensor(0.5068, device='cuda:0', dtype=torch.float16) tensor(0.0511, device='cuda:0', dtype=torch.float16)
tensor(0.6152, device='cuda:0', dtype=torch.float16) tensor(0.0413, device='cuda:0', dtype=torch.float16)
layer 24 done
25 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(12.6875, device='cuda:0', dtype=torch.float16) tensor(0.8057, device='cuda:0', dtype=torch.float16)
tensor(2.1367, device='cuda:0', dtype=torch.float16) tensor(0.2009, device='cuda:0', dtype=torch.float16)
tensor(2.3184, device='cuda:0', dtype=torch.float16) tensor(0.2079, device='cuda:0', dtype=torch.float16)
tensor(2.2500, device='cuda:0', dtype=torch.float16) tensor(0.2242, device='cuda:0', dtype=torch.float16)
tensor(2.6523, device='cuda:0', dtype=torch.float16) tensor(0.1926, device='cuda:0', dtype=torch.float16)
tensor(0.1723, device='cuda:0')
old_score: tensor(0.2063, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1685, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.176175832748413
Validation after dual ascent:
out_inf: tensor(12.6875, device='cuda:0', dtype=torch.float16) tensor(0.8057, device='cuda:0', dtype=torch.float16)
tensor(1.6777, device='cuda:0', dtype=torch.float16) tensor(0.1631, device='cuda:0', dtype=torch.float16)
tensor(2.1641, device='cuda:0', dtype=torch.float16) tensor(0.1697, device='cuda:0', dtype=torch.float16)
tensor(2.1172, device='cuda:0', dtype=torch.float16) tensor(0.1866, device='cuda:0', dtype=torch.float16)
tensor(2.3926, device='cuda:0', dtype=torch.float16) tensor(0.1543, device='cuda:0', dtype=torch.float16)
25 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(0.9854, device='cuda:0', dtype=torch.float16)
tensor(1.6592, device='cuda:0', dtype=torch.float16) tensor(0.2039, device='cuda:0', dtype=torch.float16)
tensor(2.1777, device='cuda:0', dtype=torch.float16) tensor(0.2125, device='cuda:0', dtype=torch.float16)
tensor(2.2695, device='cuda:0', dtype=torch.float16) tensor(0.2271, device='cuda:0', dtype=torch.float16)
tensor(1.7900, device='cuda:0', dtype=torch.float16) tensor(0.1969, device='cuda:0', dtype=torch.float16)
tensor(0.1830, device='cuda:0')
old_score: tensor(0.2101, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1694, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.198413610458374
Validation after dual ascent:
out_inf: tensor(17.7969, device='cuda:0', dtype=torch.float16) tensor(0.9854, device='cuda:0', dtype=torch.float16)
tensor(1.4258, device='cuda:0', dtype=torch.float16) tensor(0.1641, device='cuda:0', dtype=torch.float16)
tensor(1.5430, device='cuda:0', dtype=torch.float16) tensor(0.1710, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1875, device='cuda:0', dtype=torch.float16)
tensor(1.8145, device='cuda:0', dtype=torch.float16) tensor(0.1555, device='cuda:0', dtype=torch.float16)
25 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.5781, device='cuda:0', dtype=torch.float16) tensor(0.4548, device='cuda:0', dtype=torch.float16)
tensor(1.7803, device='cuda:0', dtype=torch.float16) tensor(0.1769, device='cuda:0', dtype=torch.float16)
tensor(1.6250, device='cuda:0', dtype=torch.float16) tensor(0.1837, device='cuda:0', dtype=torch.float16)
tensor(1.8496, device='cuda:0', dtype=torch.float16) tensor(0.1970, device='cuda:0', dtype=torch.float16)
tensor(1.6035, device='cuda:0', dtype=torch.float16) tensor(0.1704, device='cuda:0', dtype=torch.float16)
tensor(0.1106, device='cuda:0')
old_score: tensor(0.1820, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1489, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.226551532745361
Validation after dual ascent:
out_inf: tensor(5.5781, device='cuda:0', dtype=torch.float16) tensor(0.4548, device='cuda:0', dtype=torch.float16)
tensor(1.5273, device='cuda:0', dtype=torch.float16) tensor(0.1443, device='cuda:0', dtype=torch.float16)
tensor(1.2695, device='cuda:0', dtype=torch.float16) tensor(0.1501, device='cuda:0', dtype=torch.float16)
tensor(1.6348, device='cuda:0', dtype=torch.float16) tensor(0.1648, device='cuda:0', dtype=torch.float16)
tensor(1.4434, device='cuda:0', dtype=torch.float16) tensor(0.1362, device='cuda:0', dtype=torch.float16)
25 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.0742, device='cuda:0', dtype=torch.float16) tensor(0.1722, device='cuda:0', dtype=torch.float16)
tensor(0.7314, device='cuda:0', dtype=torch.float16) tensor(0.0679, device='cuda:0', dtype=torch.float16)
tensor(0.7808, device='cuda:0', dtype=torch.float16) tensor(0.0790, device='cuda:0', dtype=torch.float16)
tensor(0.9263, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
tensor(0.7378, device='cuda:0', dtype=torch.float16) tensor(0.0652, device='cuda:0', dtype=torch.float16)
tensor(0.2610, device='cuda:0')
old_score: tensor(0.0719, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0616, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.108834028244019
Validation after dual ascent:
out_inf: tensor(5.0742, device='cuda:0', dtype=torch.float16) tensor(0.1722, device='cuda:0', dtype=torch.float16)
tensor(0.6997, device='cuda:0', dtype=torch.float16) tensor(0.0584, device='cuda:0', dtype=torch.float16)
tensor(0.7563, device='cuda:0', dtype=torch.float16) tensor(0.0653, device='cuda:0', dtype=torch.float16)
tensor(0.7793, device='cuda:0', dtype=torch.float16) tensor(0.0665, device='cuda:0', dtype=torch.float16)
tensor(0.7041, device='cuda:0', dtype=torch.float16) tensor(0.0562, device='cuda:0', dtype=torch.float16)
25 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.0938, device='cuda:0', dtype=torch.float16) tensor(0.4209, device='cuda:0', dtype=torch.float16)
tensor(1.3945, device='cuda:0', dtype=torch.float16) tensor(0.1343, device='cuda:0', dtype=torch.float16)
tensor(1.5605, device='cuda:0', dtype=torch.float16) tensor(0.1415, device='cuda:0', dtype=torch.float16)
tensor(1.6172, device='cuda:0', dtype=torch.float16) tensor(0.1498, device='cuda:0', dtype=torch.float16)
tensor(2.0234, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
tensor(0.0219, device='cuda:0')
old_score: tensor(0.1388, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1137, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.5449116230011
Validation after dual ascent:
out_inf: tensor(8.0938, device='cuda:0', dtype=torch.float16) tensor(0.4209, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.1101, device='cuda:0', dtype=torch.float16)
tensor(1.3438, device='cuda:0', dtype=torch.float16) tensor(0.1149, device='cuda:0', dtype=torch.float16)
tensor(1.1553, device='cuda:0', dtype=torch.float16) tensor(0.1259, device='cuda:0', dtype=torch.float16)
tensor(1.8047, device='cuda:0', dtype=torch.float16) tensor(0.1038, device='cuda:0', dtype=torch.float16)
25 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.4844, device='cuda:0', dtype=torch.float16) tensor(0.3164, device='cuda:0', dtype=torch.float16)
tensor(1.2812, device='cuda:0', dtype=torch.float16) tensor(0.1241, device='cuda:0', dtype=torch.float16)
tensor(1.6045, device='cuda:0', dtype=torch.float16) tensor(0.1296, device='cuda:0', dtype=torch.float16)
tensor(1.6143, device='cuda:0', dtype=torch.float16) tensor(0.1384, device='cuda:0', dtype=torch.float16)
tensor(1.6309, device='cuda:0', dtype=torch.float16) tensor(0.1194, device='cuda:0', dtype=torch.float16)
Converged at iteration 200
tensor(0.0195, device='cuda:0')
tensor(0.0670, device='cuda:0')
old_score: tensor(0.1279, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1060, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 8.162793397903442
Validation after dual ascent:
out_inf: tensor(6.4844, device='cuda:0', dtype=torch.float16) tensor(0.3164, device='cuda:0', dtype=torch.float16)
tensor(0.9546, device='cuda:0', dtype=torch.float16) tensor(0.1028, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.1072, device='cuda:0', dtype=torch.float16)
tensor(1.4463, device='cuda:0', dtype=torch.float16) tensor(0.1172, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.0969, device='cuda:0', dtype=torch.float16)
25 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.1462, device='cuda:0', dtype=torch.float16)
tensor(0.5376, device='cuda:0', dtype=torch.float16) tensor(0.0517, device='cuda:0', dtype=torch.float16)
tensor(0.5225, device='cuda:0', dtype=torch.float16) tensor(0.0531, device='cuda:0', dtype=torch.float16)
tensor(0.5625, device='cuda:0', dtype=torch.float16) tensor(0.0586, device='cuda:0', dtype=torch.float16)
tensor(0.5830, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0177, device='cuda:0')
tensor(0.0159, device='cuda:0')
old_score: tensor(0.0530, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0485, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 31.55953311920166
Validation after dual ascent:
out_inf: tensor(2.2227, device='cuda:0', dtype=torch.float16) tensor(0.1462, device='cuda:0', dtype=torch.float16)
tensor(0.4990, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(0.5146, device='cuda:0', dtype=torch.float16) tensor(0.0486, device='cuda:0', dtype=torch.float16)
tensor(0.5366, device='cuda:0', dtype=torch.float16) tensor(0.0548, device='cuda:0', dtype=torch.float16)
tensor(0.6025, device='cuda:0', dtype=torch.float16) tensor(0.0438, device='cuda:0', dtype=torch.float16)
layer 25 done
26 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.3203, device='cuda:0', dtype=torch.float16) tensor(0.8633, device='cuda:0', dtype=torch.float16)
tensor(1.8164, device='cuda:0', dtype=torch.float16) tensor(0.2045, device='cuda:0', dtype=torch.float16)
tensor(1.7422, device='cuda:0', dtype=torch.float16) tensor(0.2158, device='cuda:0', dtype=torch.float16)
tensor(1.8467, device='cuda:0', dtype=torch.float16) tensor(0.2311, device='cuda:0', dtype=torch.float16)
tensor(1.9180, device='cuda:0', dtype=torch.float16) tensor(0.1979, device='cuda:0', dtype=torch.float16)
tensor(0.1538, device='cuda:0')
old_score: tensor(0.2123, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1715, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.165749549865723
Validation after dual ascent:
out_inf: tensor(13.3203, device='cuda:0', dtype=torch.float16) tensor(0.8633, device='cuda:0', dtype=torch.float16)
tensor(1.6914, device='cuda:0', dtype=torch.float16) tensor(0.1648, device='cuda:0', dtype=torch.float16)
tensor(1.4570, device='cuda:0', dtype=torch.float16) tensor(0.1735, device='cuda:0', dtype=torch.float16)
tensor(1.7100, device='cuda:0', dtype=torch.float16) tensor(0.1909, device='cuda:0', dtype=torch.float16)
tensor(1.8887, device='cuda:0', dtype=torch.float16) tensor(0.1566, device='cuda:0', dtype=torch.float16)
26 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.9375, device='cuda:0', dtype=torch.float16) tensor(1.0830, device='cuda:0', dtype=torch.float16)
tensor(1.8477, device='cuda:0', dtype=torch.float16) tensor(0.2074, device='cuda:0', dtype=torch.float16)
tensor(1.9102, device='cuda:0', dtype=torch.float16) tensor(0.2207, device='cuda:0', dtype=torch.float16)
tensor(2.1758, device='cuda:0', dtype=torch.float16) tensor(0.2323, device='cuda:0', dtype=torch.float16)
tensor(1.7988, device='cuda:0', dtype=torch.float16) tensor(0.2012, device='cuda:0', dtype=torch.float16)
tensor(0.1696, device='cuda:0')
old_score: tensor(0.2155, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1722, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.201091289520264
Validation after dual ascent:
out_inf: tensor(17.9375, device='cuda:0', dtype=torch.float16) tensor(1.0830, device='cuda:0', dtype=torch.float16)
tensor(1.4131, device='cuda:0', dtype=torch.float16) tensor(0.1655, device='cuda:0', dtype=torch.float16)
tensor(1.4297, device='cuda:0', dtype=torch.float16) tensor(0.1753, device='cuda:0', dtype=torch.float16)
tensor(1.8174, device='cuda:0', dtype=torch.float16) tensor(0.1908, device='cuda:0', dtype=torch.float16)
tensor(1.6465, device='cuda:0', dtype=torch.float16) tensor(0.1572, device='cuda:0', dtype=torch.float16)
26 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4609, device='cuda:0', dtype=torch.float16) tensor(0.4824, device='cuda:0', dtype=torch.float16)
tensor(1.5117, device='cuda:0', dtype=torch.float16) tensor(0.1818, device='cuda:0', dtype=torch.float16)
tensor(1.6455, device='cuda:0', dtype=torch.float16) tensor(0.1914, device='cuda:0', dtype=torch.float16)
tensor(1.7285, device='cuda:0', dtype=torch.float16) tensor(0.2031, device='cuda:0', dtype=torch.float16)
tensor(1.5791, device='cuda:0', dtype=torch.float16) tensor(0.1759, device='cuda:0', dtype=torch.float16)
Converged at iteration 400
tensor(0.0194, device='cuda:0')
tensor(0.1066, device='cuda:0')
old_score: tensor(0.1880, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1538, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 6.23399019241333
Validation after dual ascent:
out_inf: tensor(5.4609, device='cuda:0', dtype=torch.float16) tensor(0.4824, device='cuda:0', dtype=torch.float16)
tensor(1.2207, device='cuda:0', dtype=torch.float16) tensor(0.1483, device='cuda:0', dtype=torch.float16)
tensor(1.4658, device='cuda:0', dtype=torch.float16) tensor(0.1562, device='cuda:0', dtype=torch.float16)
tensor(1.4375, device='cuda:0', dtype=torch.float16) tensor(0.1702, device='cuda:0', dtype=torch.float16)
tensor(1.4941, device='cuda:0', dtype=torch.float16) tensor(0.1403, device='cuda:0', dtype=torch.float16)
26 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(21.2969, device='cuda:0', dtype=torch.float16) tensor(0.2490, device='cuda:0', dtype=torch.float16)
tensor(0.8462, device='cuda:0', dtype=torch.float16) tensor(0.0869, device='cuda:0', dtype=torch.float16)
tensor(0.8926, device='cuda:0', dtype=torch.float16) tensor(0.0963, device='cuda:0', dtype=torch.float16)
tensor(0.9966, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(0.8364, device='cuda:0', dtype=torch.float16) tensor(0.0815, device='cuda:0', dtype=torch.float16)
tensor(0.2867, device='cuda:0')
old_score: tensor(0.0950, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0806, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.154734373092651
Validation after dual ascent:
out_inf: tensor(21.2969, device='cuda:0', dtype=torch.float16) tensor(0.2490, device='cuda:0', dtype=torch.float16)
tensor(0.7656, device='cuda:0', dtype=torch.float16) tensor(0.0728, device='cuda:0', dtype=torch.float16)
tensor(0.8037, device='cuda:0', dtype=torch.float16) tensor(0.0823, device='cuda:0', dtype=torch.float16)
tensor(0.8818, device='cuda:0', dtype=torch.float16) tensor(0.0982, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.0693, device='cuda:0', dtype=torch.float16)
26 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.1172, device='cuda:0', dtype=torch.float16) tensor(0.4751, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1348, device='cuda:0', dtype=torch.float16)
tensor(1.9492, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
tensor(1.6201, device='cuda:0', dtype=torch.float16) tensor(0.1530, device='cuda:0', dtype=torch.float16)
tensor(1.4883, device='cuda:0', dtype=torch.float16) tensor(0.1313, device='cuda:0', dtype=torch.float16)
tensor(0.0295, device='cuda:0')
old_score: tensor(0.1401, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1145, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.563286781311035
Validation after dual ascent:
out_inf: tensor(8.1172, device='cuda:0', dtype=torch.float16) tensor(0.4751, device='cuda:0', dtype=torch.float16)
tensor(1.1475, device='cuda:0', dtype=torch.float16) tensor(0.1093, device='cuda:0', dtype=torch.float16)
tensor(1.8730, device='cuda:0', dtype=torch.float16) tensor(0.1155, device='cuda:0', dtype=torch.float16)
tensor(1.4023, device='cuda:0', dtype=torch.float16) tensor(0.1284, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1047, device='cuda:0', dtype=torch.float16)
26 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4648, device='cuda:0', dtype=torch.float16) tensor(0.3474, device='cuda:0', dtype=torch.float16)
tensor(1.6348, device='cuda:0', dtype=torch.float16) tensor(0.1249, device='cuda:0', dtype=torch.float16)
tensor(1.9111, device='cuda:0', dtype=torch.float16) tensor(0.1310, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(2.1348, device='cuda:0', dtype=torch.float16) tensor(0.1219, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0187, device='cuda:0')
tensor(0.0192, device='cuda:0')
old_score: tensor(0.1300, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1072, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 12.08576774597168
Validation after dual ascent:
out_inf: tensor(5.4648, device='cuda:0', dtype=torch.float16) tensor(0.3474, device='cuda:0', dtype=torch.float16)
tensor(1.2539, device='cuda:0', dtype=torch.float16) tensor(0.1022, device='cuda:0', dtype=torch.float16)
tensor(1.8340, device='cuda:0', dtype=torch.float16) tensor(0.1082, device='cuda:0', dtype=torch.float16)
tensor(1.0986, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
tensor(1.8730, device='cuda:0', dtype=torch.float16) tensor(0.0980, device='cuda:0', dtype=torch.float16)
26 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(2.0957, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(0.6558, device='cuda:0', dtype=torch.float16) tensor(0.0540, device='cuda:0', dtype=torch.float16)
tensor(0.6577, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(0.5728, device='cuda:0', dtype=torch.float16) tensor(0.0630, device='cuda:0', dtype=torch.float16)
tensor(0.6348, device='cuda:0', dtype=torch.float16) tensor(0.0519, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0167, device='cuda:0')
tensor(0.0186, device='cuda:0')
old_score: tensor(0.0562, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0507, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 36.459113359451294
Validation after dual ascent:
out_inf: tensor(2.0957, device='cuda:0', dtype=torch.float16) tensor(0.1545, device='cuda:0', dtype=torch.float16)
tensor(0.5513, device='cuda:0', dtype=torch.float16) tensor(0.0482, device='cuda:0', dtype=torch.float16)
tensor(0.5669, device='cuda:0', dtype=torch.float16) tensor(0.0505, device='cuda:0', dtype=torch.float16)
tensor(0.5537, device='cuda:0', dtype=torch.float16) tensor(0.0581, device='cuda:0', dtype=torch.float16)
tensor(0.6094, device='cuda:0', dtype=torch.float16) tensor(0.0459, device='cuda:0', dtype=torch.float16)
layer 26 done
27 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.4062, device='cuda:0', dtype=torch.float16) tensor(0.8330, device='cuda:0', dtype=torch.float16)
tensor(1.6367, device='cuda:0', dtype=torch.float16) tensor(0.2001, device='cuda:0', dtype=torch.float16)
tensor(1.7568, device='cuda:0', dtype=torch.float16) tensor(0.2106, device='cuda:0', dtype=torch.float16)
tensor(2.0117, device='cuda:0', dtype=torch.float16) tensor(0.2288, device='cuda:0', dtype=torch.float16)
tensor(1.9277, device='cuda:0', dtype=torch.float16) tensor(0.1946, device='cuda:0', dtype=torch.float16)
tensor(0.1984, device='cuda:0')
old_score: tensor(0.2085, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1669, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.16950798034668
Validation after dual ascent:
out_inf: tensor(14.4062, device='cuda:0', dtype=torch.float16) tensor(0.8330, device='cuda:0', dtype=torch.float16)
tensor(1.5176, device='cuda:0', dtype=torch.float16) tensor(0.1595, device='cuda:0', dtype=torch.float16)
tensor(1.4688, device='cuda:0', dtype=torch.float16) tensor(0.1683, device='cuda:0', dtype=torch.float16)
tensor(1.7988, device='cuda:0', dtype=torch.float16) tensor(0.1875, device='cuda:0', dtype=torch.float16)
tensor(1.8594, device='cuda:0', dtype=torch.float16) tensor(0.1520, device='cuda:0', dtype=torch.float16)
27 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17.4219, device='cuda:0', dtype=torch.float16) tensor(0.9844, device='cuda:0', dtype=torch.float16)
tensor(1.7949, device='cuda:0', dtype=torch.float16) tensor(0.2019, device='cuda:0', dtype=torch.float16)
tensor(1.9062, device='cuda:0', dtype=torch.float16) tensor(0.2126, device='cuda:0', dtype=torch.float16)
tensor(1.8320, device='cuda:0', dtype=torch.float16) tensor(0.2303, device='cuda:0', dtype=torch.float16)
tensor(1.9434, device='cuda:0', dtype=torch.float16) tensor(0.1963, device='cuda:0', dtype=torch.float16)
tensor(0.1987, device='cuda:0')
old_score: tensor(0.2103, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1676, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.20383071899414
Validation after dual ascent:
out_inf: tensor(17.4219, device='cuda:0', dtype=torch.float16) tensor(0.9844, device='cuda:0', dtype=torch.float16)
tensor(1.4160, device='cuda:0', dtype=torch.float16) tensor(0.1602, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1692, device='cuda:0', dtype=torch.float16)
tensor(1.8066, device='cuda:0', dtype=torch.float16) tensor(0.1882, device='cuda:0', dtype=torch.float16)
tensor(1.8213, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
27 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.0820, device='cuda:0', dtype=torch.float16) tensor(0.4705, device='cuda:0', dtype=torch.float16)
tensor(1.5488, device='cuda:0', dtype=torch.float16) tensor(0.1698, device='cuda:0', dtype=torch.float16)
tensor(1.3809, device='cuda:0', dtype=torch.float16) tensor(0.1786, device='cuda:0', dtype=torch.float16)
tensor(1.5762, device='cuda:0', dtype=torch.float16) tensor(0.1934, device='cuda:0', dtype=torch.float16)
tensor(1.5938, device='cuda:0', dtype=torch.float16) tensor(0.1653, device='cuda:0', dtype=torch.float16)
tensor(0.1471, device='cuda:0')
old_score: tensor(0.1768, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1438, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.185641765594482
Validation after dual ascent:
out_inf: tensor(6.0820, device='cuda:0', dtype=torch.float16) tensor(0.4705, device='cuda:0', dtype=torch.float16)
tensor(1.3760, device='cuda:0', dtype=torch.float16) tensor(0.1376, device='cuda:0', dtype=torch.float16)
tensor(1.2100, device='cuda:0', dtype=torch.float16) tensor(0.1455, device='cuda:0', dtype=torch.float16)
tensor(1.4141, device='cuda:0', dtype=torch.float16) tensor(0.1613, device='cuda:0', dtype=torch.float16)
tensor(1.4814, device='cuda:0', dtype=torch.float16) tensor(0.1310, device='cuda:0', dtype=torch.float16)
27 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.3867, device='cuda:0', dtype=torch.float16) tensor(0.1405, device='cuda:0', dtype=torch.float16)
tensor(0.6533, device='cuda:0', dtype=torch.float16) tensor(0.0412, device='cuda:0', dtype=torch.float16)
tensor(0.7900, device='cuda:0', dtype=torch.float16) tensor(0.0472, device='cuda:0', dtype=torch.float16)
tensor(0.7979, device='cuda:0', dtype=torch.float16) tensor(0.0467, device='cuda:0', dtype=torch.float16)
tensor(0.8672, device='cuda:0', dtype=torch.float16) tensor(0.0424, device='cuda:0', dtype=torch.float16)
tensor(0.2353, device='cuda:0')
old_score: tensor(0.0444, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0377, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.063010215759277
Validation after dual ascent:
out_inf: tensor(5.3867, device='cuda:0', dtype=torch.float16) tensor(0.1405, device='cuda:0', dtype=torch.float16)
tensor(0.6377, device='cuda:0', dtype=torch.float16) tensor(0.0347, device='cuda:0', dtype=torch.float16)
tensor(0.6738, device='cuda:0', dtype=torch.float16) tensor(0.0397, device='cuda:0', dtype=torch.float16)
tensor(0.7261, device='cuda:0', dtype=torch.float16) tensor(0.0407, device='cuda:0', dtype=torch.float16)
tensor(0.7344, device='cuda:0', dtype=torch.float16) tensor(0.0356, device='cuda:0', dtype=torch.float16)
27 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.3359, device='cuda:0', dtype=torch.float16) tensor(0.5054, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1370, device='cuda:0', dtype=torch.float16)
tensor(1.5381, device='cuda:0', dtype=torch.float16) tensor(0.1444, device='cuda:0', dtype=torch.float16)
tensor(1.5820, device='cuda:0', dtype=torch.float16) tensor(0.1566, device='cuda:0', dtype=torch.float16)
tensor(1.7363, device='cuda:0', dtype=torch.float16) tensor(0.1333, device='cuda:0', dtype=torch.float16)
tensor(0.0330, device='cuda:0')
old_score: tensor(0.1428, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1147, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.54751372337341
Validation after dual ascent:
out_inf: tensor(9.3359, device='cuda:0', dtype=torch.float16) tensor(0.5054, device='cuda:0', dtype=torch.float16)
tensor(1.0742, device='cuda:0', dtype=torch.float16) tensor(0.1099, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.1150, device='cuda:0', dtype=torch.float16)
tensor(1.3496, device='cuda:0', dtype=torch.float16) tensor(0.1295, device='cuda:0', dtype=torch.float16)
tensor(1.4082, device='cuda:0', dtype=torch.float16) tensor(0.1045, device='cuda:0', dtype=torch.float16)
27 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.4648, device='cuda:0', dtype=torch.float16) tensor(0.3804, device='cuda:0', dtype=torch.float16)
tensor(1.4492, device='cuda:0', dtype=torch.float16) tensor(0.1281, device='cuda:0', dtype=torch.float16)
tensor(2.0117, device='cuda:0', dtype=torch.float16) tensor(0.1342, device='cuda:0', dtype=torch.float16)
tensor(1.6211, device='cuda:0', dtype=torch.float16) tensor(0.1460, device='cuda:0', dtype=torch.float16)
tensor(1.8359, device='cuda:0', dtype=torch.float16) tensor(0.1241, device='cuda:0', dtype=torch.float16)
tensor(0.0230, device='cuda:0')
old_score: tensor(0.1331, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1080, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.59474158287048
Validation after dual ascent:
out_inf: tensor(5.4648, device='cuda:0', dtype=torch.float16) tensor(0.3804, device='cuda:0', dtype=torch.float16)
tensor(1.3379, device='cuda:0', dtype=torch.float16) tensor(0.1035, device='cuda:0', dtype=torch.float16)
tensor(1.5459, device='cuda:0', dtype=torch.float16) tensor(0.1084, device='cuda:0', dtype=torch.float16)
tensor(1.2070, device='cuda:0', dtype=torch.float16) tensor(0.1218, device='cuda:0', dtype=torch.float16)
tensor(1.6445, device='cuda:0', dtype=torch.float16) tensor(0.0983, device='cuda:0', dtype=torch.float16)
27 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1.9883, device='cuda:0', dtype=torch.float16) tensor(0.1827, device='cuda:0', dtype=torch.float16)
tensor(0.6533, device='cuda:0', dtype=torch.float16) tensor(0.0602, device='cuda:0', dtype=torch.float16)
tensor(0.7266, device='cuda:0', dtype=torch.float16) tensor(0.0623, device='cuda:0', dtype=torch.float16)
tensor(0.6606, device='cuda:0', dtype=torch.float16) tensor(0.0698, device='cuda:0', dtype=torch.float16)
tensor(0.6240, device='cuda:0', dtype=torch.float16) tensor(0.0571, device='cuda:0', dtype=torch.float16)
Converged at iteration 350
tensor(0.0200, device='cuda:0')
tensor(0.0205, device='cuda:0')
old_score: tensor(0.0624, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0555, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 36.47922873497009
Validation after dual ascent:
out_inf: tensor(1.9883, device='cuda:0', dtype=torch.float16) tensor(0.1827, device='cuda:0', dtype=torch.float16)
tensor(0.6577, device='cuda:0', dtype=torch.float16) tensor(0.0529, device='cuda:0', dtype=torch.float16)
tensor(0.6343, device='cuda:0', dtype=torch.float16) tensor(0.0553, device='cuda:0', dtype=torch.float16)
tensor(0.6211, device='cuda:0', dtype=torch.float16) tensor(0.0636, device='cuda:0', dtype=torch.float16)
tensor(0.6104, device='cuda:0', dtype=torch.float16) tensor(0.0499, device='cuda:0', dtype=torch.float16)
layer 27 done
28 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.7812, device='cuda:0', dtype=torch.float16) tensor(0.8442, device='cuda:0', dtype=torch.float16)
tensor(2.1484, device='cuda:0', dtype=torch.float16) tensor(0.2030, device='cuda:0', dtype=torch.float16)
tensor(1.8926, device='cuda:0', dtype=torch.float16) tensor(0.2128, device='cuda:0', dtype=torch.float16)
tensor(2.0273, device='cuda:0', dtype=torch.float16) tensor(0.2317, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.1963, device='cuda:0', dtype=torch.float16)
tensor(0.1019, device='cuda:0')
old_score: tensor(0.2109, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1661, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.184884786605835
Validation after dual ascent:
out_inf: tensor(13.7812, device='cuda:0', dtype=torch.float16) tensor(0.8442, device='cuda:0', dtype=torch.float16)
tensor(1.8496, device='cuda:0', dtype=torch.float16) tensor(0.1583, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1678, device='cuda:0', dtype=torch.float16)
tensor(1.8545, device='cuda:0', dtype=torch.float16) tensor(0.1877, device='cuda:0', dtype=torch.float16)
tensor(1.8672, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
28 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.6562, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(1.6875, device='cuda:0', dtype=torch.float16) tensor(0.2050, device='cuda:0', dtype=torch.float16)
tensor(1.9229, device='cuda:0', dtype=torch.float16) tensor(0.2155, device='cuda:0', dtype=torch.float16)
tensor(1.8164, device='cuda:0', dtype=torch.float16) tensor(0.2339, device='cuda:0', dtype=torch.float16)
tensor(2.0918, device='cuda:0', dtype=torch.float16) tensor(0.1986, device='cuda:0', dtype=torch.float16)
tensor(0.1084, device='cuda:0')
old_score: tensor(0.2133, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1664, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.21192479133606
Validation after dual ascent:
out_inf: tensor(18.6562, device='cuda:0', dtype=torch.float16) tensor(1.0283, device='cuda:0', dtype=torch.float16)
tensor(1.3867, device='cuda:0', dtype=torch.float16) tensor(0.1587, device='cuda:0', dtype=torch.float16)
tensor(1.6211, device='cuda:0', dtype=torch.float16) tensor(0.1680, device='cuda:0', dtype=torch.float16)
tensor(1.6846, device='cuda:0', dtype=torch.float16) tensor(0.1882, device='cuda:0', dtype=torch.float16)
tensor(1.7520, device='cuda:0', dtype=torch.float16) tensor(0.1509, device='cuda:0', dtype=torch.float16)
28 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.6133, device='cuda:0', dtype=torch.float16) tensor(0.5249, device='cuda:0', dtype=torch.float16)
tensor(1.7061, device='cuda:0', dtype=torch.float16) tensor(0.1812, device='cuda:0', dtype=torch.float16)
tensor(2.3164, device='cuda:0', dtype=torch.float16) tensor(0.1910, device='cuda:0', dtype=torch.float16)
tensor(1.6582, device='cuda:0', dtype=torch.float16) tensor(0.2069, device='cuda:0', dtype=torch.float16)
tensor(2.6113, device='cuda:0', dtype=torch.float16) tensor(0.1763, device='cuda:0', dtype=torch.float16)
Converged at iteration 300
tensor(0.0188, device='cuda:0')
tensor(0.1059, device='cuda:0')
old_score: tensor(0.1888, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1512, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 4.74066686630249
Validation after dual ascent:
out_inf: tensor(5.6133, device='cuda:0', dtype=torch.float16) tensor(0.5249, device='cuda:0', dtype=torch.float16)
tensor(1.4062, device='cuda:0', dtype=torch.float16) tensor(0.1443, device='cuda:0', dtype=torch.float16)
tensor(1.9180, device='cuda:0', dtype=torch.float16) tensor(0.1528, device='cuda:0', dtype=torch.float16)
tensor(1.4453, device='cuda:0', dtype=torch.float16) tensor(0.1709, device='cuda:0', dtype=torch.float16)
tensor(2.2598, device='cuda:0', dtype=torch.float16) tensor(0.1371, device='cuda:0', dtype=torch.float16)
28 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.9688, device='cuda:0', dtype=torch.float16) tensor(0.1732, device='cuda:0', dtype=torch.float16)
tensor(1.0352, device='cuda:0', dtype=torch.float16) tensor(0.0561, device='cuda:0', dtype=torch.float16)
tensor(1.2119, device='cuda:0', dtype=torch.float16) tensor(0.0754, device='cuda:0', dtype=torch.float16)
tensor(1.2422, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
tensor(1.2246, device='cuda:0', dtype=torch.float16) tensor(0.0587, device='cuda:0', dtype=torch.float16)
tensor(0.2906, device='cuda:0')
old_score: tensor(0.0694, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0589, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.152810096740723
Validation after dual ascent:
out_inf: tensor(8.9688, device='cuda:0', dtype=torch.float16) tensor(0.1732, device='cuda:0', dtype=torch.float16)
tensor(0.9590, device='cuda:0', dtype=torch.float16) tensor(0.0470, device='cuda:0', dtype=torch.float16)
tensor(1.3076, device='cuda:0', dtype=torch.float16) tensor(0.0626, device='cuda:0', dtype=torch.float16)
tensor(1.3516, device='cuda:0', dtype=torch.float16) tensor(0.0768, device='cuda:0', dtype=torch.float16)
tensor(1., device='cuda:0', dtype=torch.float16) tensor(0.0493, device='cuda:0', dtype=torch.float16)
28 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(8.0234, device='cuda:0', dtype=torch.float16) tensor(0.5146, device='cuda:0', dtype=torch.float16)
tensor(2.1914, device='cuda:0', dtype=torch.float16) tensor(0.1422, device='cuda:0', dtype=torch.float16)
tensor(2.8906, device='cuda:0', dtype=torch.float16) tensor(0.1508, device='cuda:0', dtype=torch.float16)
tensor(2.3125, device='cuda:0', dtype=torch.float16) tensor(0.1627, device='cuda:0', dtype=torch.float16)
tensor(2.4961, device='cuda:0', dtype=torch.float16) tensor(0.1381, device='cuda:0', dtype=torch.float16)
tensor(0.0358, device='cuda:0')
old_score: tensor(0.1484, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1166, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.79322123527527
Validation after dual ascent:
out_inf: tensor(8.0234, device='cuda:0', dtype=torch.float16) tensor(0.5146, device='cuda:0', dtype=torch.float16)
tensor(1.8652, device='cuda:0', dtype=torch.float16) tensor(0.1116, device='cuda:0', dtype=torch.float16)
tensor(2.1602, device='cuda:0', dtype=torch.float16) tensor(0.1172, device='cuda:0', dtype=torch.float16)
tensor(1.6719, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(2.1055, device='cuda:0', dtype=torch.float16) tensor(0.1057, device='cuda:0', dtype=torch.float16)
28 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(6.1289, device='cuda:0', dtype=torch.float16) tensor(0.4250, device='cuda:0', dtype=torch.float16)
tensor(1.6836, device='cuda:0', dtype=torch.float16) tensor(0.1355, device='cuda:0', dtype=torch.float16)
tensor(2.6406, device='cuda:0', dtype=torch.float16) tensor(0.1429, device='cuda:0', dtype=torch.float16)
tensor(2.6719, device='cuda:0', dtype=torch.float16) tensor(0.1549, device='cuda:0', dtype=torch.float16)
tensor(2.0742, device='cuda:0', dtype=torch.float16) tensor(0.1312, device='cuda:0', dtype=torch.float16)
tensor(0.0294, device='cuda:0')
old_score: tensor(0.1411, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1116, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.73820996284485
Validation after dual ascent:
out_inf: tensor(6.1289, device='cuda:0', dtype=torch.float16) tensor(0.4250, device='cuda:0', dtype=torch.float16)
tensor(1.3535, device='cuda:0', dtype=torch.float16) tensor(0.1070, device='cuda:0', dtype=torch.float16)
tensor(2.3008, device='cuda:0', dtype=torch.float16) tensor(0.1121, device='cuda:0', dtype=torch.float16)
tensor(1.7344, device='cuda:0', dtype=torch.float16) tensor(0.1261, device='cuda:0', dtype=torch.float16)
tensor(1.7754, device='cuda:0', dtype=torch.float16) tensor(0.1012, device='cuda:0', dtype=torch.float16)
28 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(4.1523, device='cuda:0', dtype=torch.float16) tensor(0.2131, device='cuda:0', dtype=torch.float16)
tensor(0.8252, device='cuda:0', dtype=torch.float16) tensor(0.0686, device='cuda:0', dtype=torch.float16)
tensor(0.8706, device='cuda:0', dtype=torch.float16) tensor(0.0715, device='cuda:0', dtype=torch.float16)
tensor(0.8779, device='cuda:0', dtype=torch.float16) tensor(0.0815, device='cuda:0', dtype=torch.float16)
tensor(0.8115, device='cuda:0', dtype=torch.float16) tensor(0.0653, device='cuda:0', dtype=torch.float16)
Converged at iteration 250
tensor(0.0186, device='cuda:0')
tensor(0.0159, device='cuda:0')
old_score: tensor(0.0718, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0637, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 26.79385232925415
Validation after dual ascent:
out_inf: tensor(4.1523, device='cuda:0', dtype=torch.float16) tensor(0.2131, device='cuda:0', dtype=torch.float16)
tensor(0.7124, device='cuda:0', dtype=torch.float16) tensor(0.0603, device='cuda:0', dtype=torch.float16)
tensor(0.7856, device='cuda:0', dtype=torch.float16) tensor(0.0634, device='cuda:0', dtype=torch.float16)
tensor(0.8057, device='cuda:0', dtype=torch.float16) tensor(0.0742, device='cuda:0', dtype=torch.float16)
tensor(0.7275, device='cuda:0', dtype=torch.float16) tensor(0.0569, device='cuda:0', dtype=torch.float16)
layer 28 done
29 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(14.0547, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(2.2344, device='cuda:0', dtype=torch.float16) tensor(0.1920, device='cuda:0', dtype=torch.float16)
tensor(2.7422, device='cuda:0', dtype=torch.float16) tensor(0.2037, device='cuda:0', dtype=torch.float16)
tensor(2.1016, device='cuda:0', dtype=torch.float16) tensor(0.2228, device='cuda:0', dtype=torch.float16)
tensor(2.7754, device='cuda:0', dtype=torch.float16) tensor(0.1871, device='cuda:0', dtype=torch.float16)
tensor(0.1339, device='cuda:0')
old_score: tensor(0.2014, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1560, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.204256057739258
Validation after dual ascent:
out_inf: tensor(14.0547, device='cuda:0', dtype=torch.float16) tensor(0.8564, device='cuda:0', dtype=torch.float16)
tensor(1.9824, device='cuda:0', dtype=torch.float16) tensor(0.1481, device='cuda:0', dtype=torch.float16)
tensor(2.6953, device='cuda:0', dtype=torch.float16) tensor(0.1570, device='cuda:0', dtype=torch.float16)
tensor(1.8809, device='cuda:0', dtype=torch.float16) tensor(0.1776, device='cuda:0', dtype=torch.float16)
tensor(2.6816, device='cuda:0', dtype=torch.float16) tensor(0.1410, device='cuda:0', dtype=torch.float16)
29 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(19.8594, device='cuda:0', dtype=torch.float16) tensor(1.0957, device='cuda:0', dtype=torch.float16)
tensor(1.6963, device='cuda:0', dtype=torch.float16) tensor(0.1989, device='cuda:0', dtype=torch.float16)
tensor(1.9473, device='cuda:0', dtype=torch.float16) tensor(0.2111, device='cuda:0', dtype=torch.float16)
tensor(1.8125, device='cuda:0', dtype=torch.float16) tensor(0.2284, device='cuda:0', dtype=torch.float16)
tensor(2.1387, device='cuda:0', dtype=torch.float16) tensor(0.1934, device='cuda:0', dtype=torch.float16)
tensor(0.1432, device='cuda:0')
old_score: tensor(0.2079, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1580, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.219882249832153
Validation after dual ascent:
out_inf: tensor(19.8594, device='cuda:0', dtype=torch.float16) tensor(1.0957, device='cuda:0', dtype=torch.float16)
tensor(1.5654, device='cuda:0', dtype=torch.float16) tensor(0.1503, device='cuda:0', dtype=torch.float16)
tensor(1.5117, device='cuda:0', dtype=torch.float16) tensor(0.1594, device='cuda:0', dtype=torch.float16)
tensor(1.5898, device='cuda:0', dtype=torch.float16) tensor(0.1794, device='cuda:0', dtype=torch.float16)
tensor(1.6523, device='cuda:0', dtype=torch.float16) tensor(0.1429, device='cuda:0', dtype=torch.float16)
29 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(5.9062, device='cuda:0', dtype=torch.float16) tensor(0.5122, device='cuda:0', dtype=torch.float16)
tensor(1.7686, device='cuda:0', dtype=torch.float16) tensor(0.1801, device='cuda:0', dtype=torch.float16)
tensor(2.0078, device='cuda:0', dtype=torch.float16) tensor(0.1904, device='cuda:0', dtype=torch.float16)
tensor(2.0273, device='cuda:0', dtype=torch.float16) tensor(0.2089, device='cuda:0', dtype=torch.float16)
tensor(1.9883, device='cuda:0', dtype=torch.float16) tensor(0.1757, device='cuda:0', dtype=torch.float16)
tensor(0.0506, device='cuda:0')
old_score: tensor(0.1888, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1486, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.252694606781006
Validation after dual ascent:
out_inf: tensor(5.9062, device='cuda:0', dtype=torch.float16) tensor(0.5122, device='cuda:0', dtype=torch.float16)
tensor(1.3105, device='cuda:0', dtype=torch.float16) tensor(0.1414, device='cuda:0', dtype=torch.float16)
tensor(1.3770, device='cuda:0', dtype=torch.float16) tensor(0.1495, device='cuda:0', dtype=torch.float16)
tensor(1.5625, device='cuda:0', dtype=torch.float16) tensor(0.1691, device='cuda:0', dtype=torch.float16)
tensor(1.8438, device='cuda:0', dtype=torch.float16) tensor(0.1343, device='cuda:0', dtype=torch.float16)
29 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.3281, device='cuda:0', dtype=torch.float16) tensor(0.2339, device='cuda:0', dtype=torch.float16)
tensor(0.9473, device='cuda:0', dtype=torch.float16) tensor(0.0744, device='cuda:0', dtype=torch.float16)
tensor(1.0176, device='cuda:0', dtype=torch.float16) tensor(0.0943, device='cuda:0', dtype=torch.float16)
tensor(0.9985, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(0.9233, device='cuda:0', dtype=torch.float16) tensor(0.0743, device='cuda:0', dtype=torch.float16)
tensor(0.3197, device='cuda:0')
old_score: tensor(0.0849, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0740, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.192854166030884
Validation after dual ascent:
out_inf: tensor(16.3281, device='cuda:0', dtype=torch.float16) tensor(0.2339, device='cuda:0', dtype=torch.float16)
tensor(0.8467, device='cuda:0', dtype=torch.float16) tensor(0.0651, device='cuda:0', dtype=torch.float16)
tensor(0.8779, device='cuda:0', dtype=torch.float16) tensor(0.0807, device='cuda:0', dtype=torch.float16)
tensor(0.8843, device='cuda:0', dtype=torch.float16) tensor(0.0846, device='cuda:0', dtype=torch.float16)
tensor(0.8291, device='cuda:0', dtype=torch.float16) tensor(0.0655, device='cuda:0', dtype=torch.float16)
29 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.5400, device='cuda:0', dtype=torch.float16)
tensor(2.1543, device='cuda:0', dtype=torch.float16) tensor(0.1448, device='cuda:0', dtype=torch.float16)
tensor(2.2852, device='cuda:0', dtype=torch.float16) tensor(0.1542, device='cuda:0', dtype=torch.float16)
tensor(2.3867, device='cuda:0', dtype=torch.float16) tensor(0.1652, device='cuda:0', dtype=torch.float16)
tensor(2.0566, device='cuda:0', dtype=torch.float16) tensor(0.1411, device='cuda:0', dtype=torch.float16)
tensor(0.0400, device='cuda:0')
old_score: tensor(0.1512, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1187, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.88621664047241
Validation after dual ascent:
out_inf: tensor(7.9219, device='cuda:0', dtype=torch.float16) tensor(0.5400, device='cuda:0', dtype=torch.float16)
tensor(1.7051, device='cuda:0', dtype=torch.float16) tensor(0.1134, device='cuda:0', dtype=torch.float16)
tensor(1.9141, device='cuda:0', dtype=torch.float16) tensor(0.1196, device='cuda:0', dtype=torch.float16)
tensor(1.6680, device='cuda:0', dtype=torch.float16) tensor(0.1340, device='cuda:0', dtype=torch.float16)
tensor(1.7715, device='cuda:0', dtype=torch.float16) tensor(0.1075, device='cuda:0', dtype=torch.float16)
29 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(9.1094, device='cuda:0', dtype=torch.float16) tensor(0.4888, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.1401, device='cuda:0', dtype=torch.float16)
tensor(2.3047, device='cuda:0', dtype=torch.float16) tensor(0.1484, device='cuda:0', dtype=torch.float16)
tensor(1.9531, device='cuda:0', dtype=torch.float16) tensor(0.1592, device='cuda:0', dtype=torch.float16)
tensor(2.0430, device='cuda:0', dtype=torch.float16) tensor(0.1356, device='cuda:0', dtype=torch.float16)
tensor(0.0377, device='cuda:0')
old_score: tensor(0.1459, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1144, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.90633964538574
Validation after dual ascent:
out_inf: tensor(9.1094, device='cuda:0', dtype=torch.float16) tensor(0.4888, device='cuda:0', dtype=torch.float16)
tensor(1.2969, device='cuda:0', dtype=torch.float16) tensor(0.1096, device='cuda:0', dtype=torch.float16)
tensor(1.9141, device='cuda:0', dtype=torch.float16) tensor(0.1154, device='cuda:0', dtype=torch.float16)
tensor(1.5371, device='cuda:0', dtype=torch.float16) tensor(0.1293, device='cuda:0', dtype=torch.float16)
tensor(1.8574, device='cuda:0', dtype=torch.float16) tensor(0.1036, device='cuda:0', dtype=torch.float16)
29 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(20.5781, device='cuda:0', dtype=torch.float16) tensor(0.2686, device='cuda:0', dtype=torch.float16)
tensor(1.0898, device='cuda:0', dtype=torch.float16) tensor(0.0798, device='cuda:0', dtype=torch.float16)
tensor(0.9487, device='cuda:0', dtype=torch.float16) tensor(0.0831, device='cuda:0', dtype=torch.float16)
tensor(1.0615, device='cuda:0', dtype=torch.float16) tensor(0.0942, device='cuda:0', dtype=torch.float16)
tensor(0.9170, device='cuda:0', dtype=torch.float16) tensor(0.0757, device='cuda:0', dtype=torch.float16)
tensor(0.0274, device='cuda:0')
old_score: tensor(0.0832, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0732, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.29074764251709
Validation after dual ascent:
out_inf: tensor(20.5781, device='cuda:0', dtype=torch.float16) tensor(0.2686, device='cuda:0', dtype=torch.float16)
tensor(1.0195, device='cuda:0', dtype=torch.float16) tensor(0.0695, device='cuda:0', dtype=torch.float16)
tensor(0.9268, device='cuda:0', dtype=torch.float16) tensor(0.0729, device='cuda:0', dtype=torch.float16)
tensor(0.9585, device='cuda:0', dtype=torch.float16) tensor(0.0850, device='cuda:0', dtype=torch.float16)
tensor(0.9062, device='cuda:0', dtype=torch.float16) tensor(0.0652, device='cuda:0', dtype=torch.float16)
layer 29 done
30 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(15.3359, device='cuda:0', dtype=torch.float16) tensor(0.8896, device='cuda:0', dtype=torch.float16)
tensor(1.9492, device='cuda:0', dtype=torch.float16) tensor(0.1960, device='cuda:0', dtype=torch.float16)
tensor(1.9844, device='cuda:0', dtype=torch.float16) tensor(0.2091, device='cuda:0', dtype=torch.float16)
tensor(2.4043, device='cuda:0', dtype=torch.float16) tensor(0.2258, device='cuda:0', dtype=torch.float16)
tensor(2.1133, device='cuda:0', dtype=torch.float16) tensor(0.1913, device='cuda:0', dtype=torch.float16)
tensor(0.0808, device='cuda:0')
old_score: tensor(0.2056, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1564, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.184082508087158
Validation after dual ascent:
out_inf: tensor(15.3359, device='cuda:0', dtype=torch.float16) tensor(0.8896, device='cuda:0', dtype=torch.float16)
tensor(1.6934, device='cuda:0', dtype=torch.float16) tensor(0.1484, device='cuda:0', dtype=torch.float16)
tensor(1.7217, device='cuda:0', dtype=torch.float16) tensor(0.1581, device='cuda:0', dtype=torch.float16)
tensor(2.0684, device='cuda:0', dtype=torch.float16) tensor(0.1774, device='cuda:0', dtype=torch.float16)
tensor(1.7676, device='cuda:0', dtype=torch.float16) tensor(0.1416, device='cuda:0', dtype=torch.float16)
30 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(18.2188, device='cuda:0', dtype=torch.float16) tensor(1.0439, device='cuda:0', dtype=torch.float16)
tensor(2.1016, device='cuda:0', dtype=torch.float16) tensor(0.2014, device='cuda:0', dtype=torch.float16)
tensor(2.1680, device='cuda:0', dtype=torch.float16) tensor(0.2146, device='cuda:0', dtype=torch.float16)
tensor(1.9316, device='cuda:0', dtype=torch.float16) tensor(0.2306, device='cuda:0', dtype=torch.float16)
tensor(2.7363, device='cuda:0', dtype=torch.float16) tensor(0.1963, device='cuda:0', dtype=torch.float16)
tensor(0.0949, device='cuda:0')
old_score: tensor(0.2107, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1584, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.207646369934082
Validation after dual ascent:
out_inf: tensor(18.2188, device='cuda:0', dtype=torch.float16) tensor(1.0439, device='cuda:0', dtype=torch.float16)
tensor(1.4971, device='cuda:0', dtype=torch.float16) tensor(0.1504, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.1603, device='cuda:0', dtype=torch.float16)
tensor(1.7031, device='cuda:0', dtype=torch.float16) tensor(0.1799, device='cuda:0', dtype=torch.float16)
tensor(2.0723, device='cuda:0', dtype=torch.float16) tensor(0.1434, device='cuda:0', dtype=torch.float16)
30 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.9922, device='cuda:0', dtype=torch.float16) tensor(0.5654, device='cuda:0', dtype=torch.float16)
tensor(1.8906, device='cuda:0', dtype=torch.float16) tensor(0.1837, device='cuda:0', dtype=torch.float16)
tensor(1.6084, device='cuda:0', dtype=torch.float16) tensor(0.1956, device='cuda:0', dtype=torch.float16)
tensor(1.6895, device='cuda:0', dtype=torch.float16) tensor(0.2108, device='cuda:0', dtype=torch.float16)
tensor(2.2285, device='cuda:0', dtype=torch.float16) tensor(0.1798, device='cuda:0', dtype=torch.float16)
tensor(0.0418, device='cuda:0')
old_score: tensor(0.1925, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1497, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.228814125061035
Validation after dual ascent:
out_inf: tensor(7.9922, device='cuda:0', dtype=torch.float16) tensor(0.5654, device='cuda:0', dtype=torch.float16)
tensor(1.6133, device='cuda:0', dtype=torch.float16) tensor(0.1425, device='cuda:0', dtype=torch.float16)
tensor(1.4082, device='cuda:0', dtype=torch.float16) tensor(0.1511, device='cuda:0', dtype=torch.float16)
tensor(1.5977, device='cuda:0', dtype=torch.float16) tensor(0.1696, device='cuda:0', dtype=torch.float16)
tensor(2.2734, device='cuda:0', dtype=torch.float16) tensor(0.1359, device='cuda:0', dtype=torch.float16)
30 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(16.9219, device='cuda:0', dtype=torch.float16) tensor(0.1809, device='cuda:0', dtype=torch.float16)
tensor(0.9004, device='cuda:0', dtype=torch.float16) tensor(0.0500, device='cuda:0', dtype=torch.float16)
tensor(1.0459, device='cuda:0', dtype=torch.float16) tensor(0.0634, device='cuda:0', dtype=torch.float16)
tensor(1.1523, device='cuda:0', dtype=torch.float16) tensor(0.0707, device='cuda:0', dtype=torch.float16)
tensor(0.9824, device='cuda:0', dtype=torch.float16) tensor(0.0537, device='cuda:0', dtype=torch.float16)
tensor(0.3117, device='cuda:0')
old_score: tensor(0.0594, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0480, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.165966749191284
Validation after dual ascent:
out_inf: tensor(16.9219, device='cuda:0', dtype=torch.float16) tensor(0.1809, device='cuda:0', dtype=torch.float16)
tensor(0.6953, device='cuda:0', dtype=torch.float16) tensor(0.0403, device='cuda:0', dtype=torch.float16)
tensor(0.9697, device='cuda:0', dtype=torch.float16) tensor(0.0503, device='cuda:0', dtype=torch.float16)
tensor(1.1172, device='cuda:0', dtype=torch.float16) tensor(0.0583, device='cuda:0', dtype=torch.float16)
tensor(0.7886, device='cuda:0', dtype=torch.float16) tensor(0.0430, device='cuda:0', dtype=torch.float16)
30 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(38.8438, device='cuda:0', dtype=torch.float16) tensor(0.5762, device='cuda:0', dtype=torch.float16)
tensor(2.3477, device='cuda:0', dtype=torch.float16) tensor(0.1483, device='cuda:0', dtype=torch.float16)
tensor(2.4727, device='cuda:0', dtype=torch.float16) tensor(0.1588, device='cuda:0', dtype=torch.float16)
tensor(2.3672, device='cuda:0', dtype=torch.float16) tensor(0.1687, device='cuda:0', dtype=torch.float16)
tensor(2.2578, device='cuda:0', dtype=torch.float16) tensor(0.1442, device='cuda:0', dtype=torch.float16)
tensor(0.0521, device='cuda:0')
old_score: tensor(0.1550, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1169, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.874024391174316
Validation after dual ascent:
out_inf: tensor(38.8438, device='cuda:0', dtype=torch.float16) tensor(0.5762, device='cuda:0', dtype=torch.float16)
tensor(1.6602, device='cuda:0', dtype=torch.float16) tensor(0.1124, device='cuda:0', dtype=torch.float16)
tensor(1.8516, device='cuda:0', dtype=torch.float16) tensor(0.1172, device='cuda:0', dtype=torch.float16)
tensor(1.8281, device='cuda:0', dtype=torch.float16) tensor(0.1324, device='cuda:0', dtype=torch.float16)
tensor(1.6094, device='cuda:0', dtype=torch.float16) tensor(0.1057, device='cuda:0', dtype=torch.float16)
30 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(39.5000, device='cuda:0', dtype=torch.float16) tensor(0.5576, device='cuda:0', dtype=torch.float16)
tensor(2.1133, device='cuda:0', dtype=torch.float16) tensor(0.1431, device='cuda:0', dtype=torch.float16)
tensor(2.2207, device='cuda:0', dtype=torch.float16) tensor(0.1517, device='cuda:0', dtype=torch.float16)
tensor(2.3672, device='cuda:0', dtype=torch.float16) tensor(0.1619, device='cuda:0', dtype=torch.float16)
tensor(2.1992, device='cuda:0', dtype=torch.float16) tensor(0.1383, device='cuda:0', dtype=torch.float16)
tensor(0.0524, device='cuda:0')
old_score: tensor(0.1488, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1122, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.89653420448303
Validation after dual ascent:
out_inf: tensor(39.5000, device='cuda:0', dtype=torch.float16) tensor(0.5576, device='cuda:0', dtype=torch.float16)
tensor(1.6172, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
tensor(1.8652, device='cuda:0', dtype=torch.float16) tensor(0.1125, device='cuda:0', dtype=torch.float16)
tensor(1.7695, device='cuda:0', dtype=torch.float16) tensor(0.1271, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
30 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(1836., device='cuda:0', dtype=torch.float16) tensor(0.4368, device='cuda:0', dtype=torch.float16)
tensor(1.2861, device='cuda:0', dtype=torch.float16) tensor(0.0906, device='cuda:0', dtype=torch.float16)
tensor(1.2021, device='cuda:0', dtype=torch.float16) tensor(0.0948, device='cuda:0', dtype=torch.float16)
tensor(1.2217, device='cuda:0', dtype=torch.float16) tensor(0.1086, device='cuda:0', dtype=torch.float16)
tensor(1.1426, device='cuda:0', dtype=torch.float16) tensor(0.0865, device='cuda:0', dtype=torch.float16)
tensor(0.0630, device='cuda:0')
old_score: tensor(0.0951, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0820, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 100.34211993217468
Validation after dual ascent:
out_inf: tensor(1836., device='cuda:0', dtype=torch.float16) tensor(0.4368, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0775, device='cuda:0', dtype=torch.float16)
tensor(1.1006, device='cuda:0', dtype=torch.float16) tensor(0.0814, device='cuda:0', dtype=torch.float16)
tensor(2., device='cuda:0', dtype=torch.float16) tensor(0.0961, device='cuda:0', dtype=torch.float16)
tensor(0.9683, device='cuda:0', dtype=torch.float16) tensor(0.0731, device='cuda:0', dtype=torch.float16)
layer 30 done
31 self_attn.q_proj
Pruning ...
Validation after prune:
out_inf: tensor(13.3828, device='cuda:0', dtype=torch.float16) tensor(0.8867, device='cuda:0', dtype=torch.float16)
tensor(1.5566, device='cuda:0', dtype=torch.float16) tensor(0.1726, device='cuda:0', dtype=torch.float16)
tensor(1.8154, device='cuda:0', dtype=torch.float16) tensor(0.1860, device='cuda:0', dtype=torch.float16)
tensor(1.6924, device='cuda:0', dtype=torch.float16) tensor(0.1976, device='cuda:0', dtype=torch.float16)
tensor(2.5430, device='cuda:0', dtype=torch.float16) tensor(0.1685, device='cuda:0', dtype=torch.float16)
tensor(0.0794, device='cuda:0')
old_score: tensor(0.1812, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1266, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.158485651016235
Validation after dual ascent:
out_inf: tensor(13.3828, device='cuda:0', dtype=torch.float16) tensor(0.8867, device='cuda:0', dtype=torch.float16)
tensor(1.3154, device='cuda:0', dtype=torch.float16) tensor(0.1202, device='cuda:0', dtype=torch.float16)
tensor(1.3203, device='cuda:0', dtype=torch.float16) tensor(0.1274, device='cuda:0', dtype=torch.float16)
tensor(1.5215, device='cuda:0', dtype=torch.float16) tensor(0.1454, device='cuda:0', dtype=torch.float16)
tensor(1.8975, device='cuda:0', dtype=torch.float16) tensor(0.1135, device='cuda:0', dtype=torch.float16)
31 self_attn.k_proj
Pruning ...
Validation after prune:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(1.1260, device='cuda:0', dtype=torch.float16)
tensor(1.6387, device='cuda:0', dtype=torch.float16) tensor(0.1846, device='cuda:0', dtype=torch.float16)
tensor(1.6543, device='cuda:0', dtype=torch.float16) tensor(0.1982, device='cuda:0', dtype=torch.float16)
tensor(1.9238, device='cuda:0', dtype=torch.float16) tensor(0.2081, device='cuda:0', dtype=torch.float16)
tensor(2.0137, device='cuda:0', dtype=torch.float16) tensor(0.1792, device='cuda:0', dtype=torch.float16)
tensor(0.0987, device='cuda:0')
old_score: tensor(0.1925, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1310, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.177037954330444
Validation after dual ascent:
out_inf: tensor(17., device='cuda:0', dtype=torch.float16) tensor(1.1260, device='cuda:0', dtype=torch.float16)
tensor(1.1973, device='cuda:0', dtype=torch.float16) tensor(0.1244, device='cuda:0', dtype=torch.float16)
tensor(1.3701, device='cuda:0', dtype=torch.float16) tensor(0.1321, device='cuda:0', dtype=torch.float16)
tensor(1.6270, device='cuda:0', dtype=torch.float16) tensor(0.1503, device='cuda:0', dtype=torch.float16)
tensor(1.9814, device='cuda:0', dtype=torch.float16) tensor(0.1172, device='cuda:0', dtype=torch.float16)
31 self_attn.v_proj
Pruning ...
Validation after prune:
out_inf: tensor(7.1016, device='cuda:0', dtype=torch.float16) tensor(0.4424, device='cuda:0', dtype=torch.float16)
tensor(1.3281, device='cuda:0', dtype=torch.float16) tensor(0.1406, device='cuda:0', dtype=torch.float16)
tensor(1.4805, device='cuda:0', dtype=torch.float16) tensor(0.1504, device='cuda:0', dtype=torch.float16)
tensor(1.3525, device='cuda:0', dtype=torch.float16) tensor(0.1604, device='cuda:0', dtype=torch.float16)
tensor(1.6328, device='cuda:0', dtype=torch.float16) tensor(0.1368, device='cuda:0', dtype=torch.float16)
tensor(0.0220, device='cuda:0')
old_score: tensor(0.1471, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1094, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.21207880973816
Validation after dual ascent:
out_inf: tensor(7.1016, device='cuda:0', dtype=torch.float16) tensor(0.4424, device='cuda:0', dtype=torch.float16)
tensor(0.9951, device='cuda:0', dtype=torch.float16) tensor(0.1044, device='cuda:0', dtype=torch.float16)
tensor(1.0947, device='cuda:0', dtype=torch.float16) tensor(0.1101, device='cuda:0', dtype=torch.float16)
tensor(1.2041, device='cuda:0', dtype=torch.float16) tensor(0.1248, device='cuda:0', dtype=torch.float16)
tensor(1.4219, device='cuda:0', dtype=torch.float16) tensor(0.0981, device='cuda:0', dtype=torch.float16)
31 self_attn.o_proj
Pruning ...
Validation after prune:
out_inf: tensor(253.8750, device='cuda:0', dtype=torch.float16) tensor(0.3535, device='cuda:0', dtype=torch.float16)
tensor(1.0664, device='cuda:0', dtype=torch.float16) tensor(0.0872, device='cuda:0', dtype=torch.float16)
tensor(1.0957, device='cuda:0', dtype=torch.float16) tensor(0.0902, device='cuda:0', dtype=torch.float16)
tensor(1.2773, device='cuda:0', dtype=torch.float16) tensor(0.1078, device='cuda:0', dtype=torch.float16)
tensor(1.3096, device='cuda:0', dtype=torch.float16) tensor(0.0826, device='cuda:0', dtype=torch.float16)
tensor(0.0636, device='cuda:0')
old_score: tensor(0.0920, device='cuda:0', dtype=torch.float16) new_score: tensor(0.0696, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 15.206600427627563
Validation after dual ascent:
out_inf: tensor(253.8750, device='cuda:0', dtype=torch.float16) tensor(0.3535, device='cuda:0', dtype=torch.float16)
tensor(0.9761, device='cuda:0', dtype=torch.float16) tensor(0.0675, device='cuda:0', dtype=torch.float16)
tensor(0.8242, device='cuda:0', dtype=torch.float16) tensor(0.0677, device='cuda:0', dtype=torch.float16)
tensor(1.0303, device='cuda:0', dtype=torch.float16) tensor(0.0856, device='cuda:0', dtype=torch.float16)
tensor(0.8516, device='cuda:0', dtype=torch.float16) tensor(0.0577, device='cuda:0', dtype=torch.float16)
31 mlp.gate_proj
Pruning ...
Validation after prune:
out_inf: tensor(27.7188, device='cuda:0', dtype=torch.float16) tensor(0.6250, device='cuda:0', dtype=torch.float16)
tensor(2.5430, device='cuda:0', dtype=torch.float16) tensor(0.1400, device='cuda:0', dtype=torch.float16)
tensor(2.6211, device='cuda:0', dtype=torch.float16) tensor(0.1479, device='cuda:0', dtype=torch.float16)
tensor(2.4941, device='cuda:0', dtype=torch.float16) tensor(0.1611, device='cuda:0', dtype=torch.float16)
tensor(2.7891, device='cuda:0', dtype=torch.float16) tensor(0.1320, device='cuda:0', dtype=torch.float16)
tensor(0.0836, device='cuda:0')
old_score: tensor(0.1453, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1049, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.84665250778198
Validation after dual ascent:
out_inf: tensor(27.7188, device='cuda:0', dtype=torch.float16) tensor(0.6250, device='cuda:0', dtype=torch.float16)
tensor(2.1328, device='cuda:0', dtype=torch.float16) tensor(0.1014, device='cuda:0', dtype=torch.float16)
tensor(2.1641, device='cuda:0', dtype=torch.float16) tensor(0.1053, device='cuda:0', dtype=torch.float16)
tensor(2.0430, device='cuda:0', dtype=torch.float16) tensor(0.1213, device='cuda:0', dtype=torch.float16)
tensor(2.5723, device='cuda:0', dtype=torch.float16) tensor(0.0916, device='cuda:0', dtype=torch.float16)
31 mlp.up_proj
Pruning ...
Validation after prune:
out_inf: tensor(26.9531, device='cuda:0', dtype=torch.float16) tensor(0.6421, device='cuda:0', dtype=torch.float16)
tensor(2.0117, device='cuda:0', dtype=torch.float16) tensor(0.1360, device='cuda:0', dtype=torch.float16)
tensor(1.9883, device='cuda:0', dtype=torch.float16) tensor(0.1432, device='cuda:0', dtype=torch.float16)
tensor(2.0508, device='cuda:0', dtype=torch.float16) tensor(0.1562, device='cuda:0', dtype=torch.float16)
tensor(2.0703, device='cuda:0', dtype=torch.float16) tensor(0.1262, device='cuda:0', dtype=torch.float16)
tensor(0.0801, device='cuda:0')
old_score: tensor(0.1404, device='cuda:0', dtype=torch.float16) new_score: tensor(0.1000, device='cuda:0', dtype=torch.float16)
Converged!
Dual ascent finished!
Time: 39.8571240901947
Validation after dual ascent:
out_inf: tensor(26.9531, device='cuda:0', dtype=torch.float16) tensor(0.6421, device='cuda:0', dtype=torch.float16)
tensor(1.4473, device='cuda:0', dtype=torch.float16) tensor(0.0966, device='cuda:0', dtype=torch.float16)
tensor(1.4443, device='cuda:0', dtype=torch.float16) tensor(0.1002, device='cuda:0', dtype=torch.float16)
tensor(1.7559, device='cuda:0', dtype=torch.float16) tensor(0.1157, device='cuda:0', dtype=torch.float16)
tensor(1.6406, device='cuda:0', dtype=torch.float16) tensor(0.0875, device='cuda:0', dtype=torch.float16)
31 mlp.down_proj
Pruning ...
Validation after prune:
out_inf: tensor(60.9062, device='cuda:0', dtype=torch.float16) tensor(1.2920, device='cuda:0', dtype=torch.float16)
tensor(1.3135, device='cuda:0', dtype=torch.float16) tensor(0.1107, device='cuda:0', dtype=torch.float16)
tensor(1.5645, device='cuda:0', dtype=torch.float16) tensor(0.1172, device='cuda:0', dtype=torch.float16)
tensor(1.7402, device='cuda:0', dtype=torch.float16) tensor(0.1379, device='cuda:0', dtype=torch.float16)
tensor(1.5107, device='cuda:0', dtype=torch.float16) tensor(0.0988, device='cuda:0', dtype=torch.float16)
layer 31 done
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.08it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.14it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.95it/s]
{'model.embed_tokens': 0, 'model.layers.0': 0, 'model.layers.1': 0, 'model.layers.2': 0, 'model.layers.3': 0, 'model.layers.4': 0, 'model.layers.5': 0, 'model.layers.6': 0, 'model.layers.7': 0, 'model.layers.8': 0, 'model.layers.9': 0, 'model.layers.10': 0, 'model.layers.11': 0, 'model.layers.12': 0, 'model.layers.13': 0, 'model.layers.14': 0, 'model.layers.15': 0, 'model.layers.16': 0, 'model.layers.17': 0, 'model.layers.18': 0, 'model.layers.19': 0, 'model.layers.20': 0, 'model.layers.21': 0, 'model.layers.22': 0, 'model.layers.23': 0, 'model.layers.24': 0, 'model.layers.25': 0, 'model.layers.26': 0, 'model.layers.27': 1, 'model.layers.28': 1, 'model.layers.29': 1, 'model.layers.30': 1, 'model.layers.31': 1, 'model.norm': 1, 'model.rotary_emb': 1, 'lm_head': 1}
use device  1
******************************
layer 0 sparsity 0.900001
layer 1 sparsity 0.900001
layer 2 sparsity 0.900001
layer 3 sparsity 0.900001
layer 4 sparsity 0.900001
layer 5 sparsity 0.900001
layer 6 sparsity 0.900001
layer 7 sparsity 0.900001
layer 8 sparsity 0.900001
layer 9 sparsity 0.900001
layer 10 sparsity 0.900001
layer 11 sparsity 0.900001
layer 12 sparsity 0.900001
layer 13 sparsity 0.900001
layer 14 sparsity 0.900001
layer 15 sparsity 0.900001
layer 16 sparsity 0.900001
layer 17 sparsity 0.900001
layer 18 sparsity 0.900001
layer 19 sparsity 0.900001
layer 20 sparsity 0.900001
layer 21 sparsity 0.900001
layer 22 sparsity 0.900001
layer 23 sparsity 0.900001
layer 24 sparsity 0.900001
layer 25 sparsity 0.900001
layer 26 sparsity 0.900001
layer 27 sparsity 0.900001
layer 28 sparsity 0.900001
layer 29 sparsity 0.900001
layer 30 sparsity 0.900001
layer 31 sparsity 0.900001
sparsity sanity check 0.9000
******************************
evaluating on wikitext2
nsamples 83
sample 0
sample 50
wikitext perplexity 673.2353515625
sparsegpt_dual_3	0.9000	673.2354	256
Namespace(model='/h3cstore_ns/jcxie/hf_weights/llama-2-7b-hf', seed=0, nsamples=256, dual_theld=0.03, n_batch=8, sparsity_ratio=0.9, epsilon=0.02, n_flod=1, sparsity_type='unstructured', prune_method='sparsegpt_dual_3', cache_dir='llm_weights', use_variant=False, save='/h3cstore_ns/jcxie/LISA/nips2024/log', save_model=None, exclude='gate_proj', ww_metric='alpha_peak', ww_metric_cache='/h3cstore_ns/jcxie/LISA/wanda-main/data/llama2-7b-hf', wanda_scale=0.01, ww_epsilon=0.02, mapping_type='block_wise', dual_sp_theld=0.0, Hyper_m=3, Lamda=0.2, eval_zero_shot=0, save_ckpt=0)
